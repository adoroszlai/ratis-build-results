2025-11-20 15:47:49,235 [main] INFO  util.LogUtils (Slf4jUtils.java:setLogLevel(38)) - Successfully set org.apache.ratis.conf.ConfUtils log level to WARN
2025-11-20 15:47:49,236 [main] INFO  util.LogUtils (Slf4jUtils.java:setLogLevel(38)) - Successfully set org.apache.ratis.util.FileUtils log level to TRACE
2025-11-20 15:47:49,238 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:runWithNewCluster(137)) - Running runWithNewCluster
2025-11-20 15:47:49,241 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:<init>(297)) - new MiniRaftClusterWithSimulatedRpc with group-74690665B863:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]
2025-11-20 15:47:49,241 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(330)) - .............................................................. 
2025-11-20 15:47:49,241 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(331)) - ... 
2025-11-20 15:47:49,241 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(332)) - ...     Starting MiniRaftClusterWithSimulatedRpc
2025-11-20 15:47:49,241 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(333)) - ... 
2025-11-20 15:47:49,241 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(334)) - .............................................................. 
2025-11-20 15:47:49,241 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:initServers(309)) - servers = {}
2025-11-20 15:47:49,242 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(376)) - newRaftServer: s0, group-74690665B863:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068], format? true
2025-11-20 15:47:49,242 [main] TRACE util.FileUtils (FileUtils.java:deleteFully(355)) - deleteFully target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s0
2025-11-20 15:47:49,242 [main] TRACE util.FileUtils (FileUtils.java:deleteFully(368)) - deleteFully: target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s0 does not exist.
2025-11-20 15:47:49,242 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(381)) - Formatted directory target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s0
2025-11-20 15:47:49,242 [main] INFO  server.RaftServer (VersionInfo.java:printStartupMessages(132)) - Starting Apache Ratis Test -- RaftServerProxy s0
2025-11-20 15:47:49,242 [main] INFO  server.RaftServer (VersionInfo.java:printStartupMessages(136)) -                version: 3.3.0-SNAPSHOT
2025-11-20 15:47:49,242 [main] INFO  server.RaftServer (VersionInfo.java:printStartupMessages(136)) -                    url: https://github.com/apache/ratis
2025-11-20 15:47:49,243 [main] INFO  server.RaftServer (VersionInfo.java:printStartupMessages(136)) -               revision: 1fd1349a891f6725cffd1eccff7f306bd33f474f
2025-11-20 15:47:49,243 [main] INFO  server.RaftServer (VersionInfo.java:printStartupMessages(139)) -                   java: OpenJDK 64-Bit Server VM 17.0.17+10
2025-11-20 15:47:49,243 [main] INFO  server.RaftServer (VersionInfo.java:printStartupMessages(139)) -                   user: runner
2025-11-20 15:47:49,245 [main] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(62)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s0] (custom)
2025-11-20 15:47:49,248 [s0-groupManagement] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(269)) - s0: new RaftServerImpl for group-74690665B863:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068] with BaseStateMachine-26:uninitialized
2025-11-20 15:47:49,248 [main] INFO  server.RaftServer (RaftServerProxy.java:addNew(106)) - s0: addNew group-74690665B863:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068] returns group-74690665B863:java.util.concurrent.CompletableFuture@2bfeb1ef[Not completed]
2025-11-20 15:47:49,249 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(376)) - newRaftServer: s1, group-74690665B863:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068], format? true
2025-11-20 15:47:49,249 [main] TRACE util.FileUtils (FileUtils.java:deleteFully(355)) - deleteFully target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s1
2025-11-20 15:47:49,249 [main] TRACE util.FileUtils (FileUtils.java:deleteFully(368)) - deleteFully: target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s1 does not exist.
2025-11-20 15:47:49,249 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(381)) - Formatted directory target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s1
2025-11-20 15:47:49,249 [main] INFO  server.RaftServer (VersionInfo.java:printStartupMessages(132)) - Starting Apache Ratis Test -- RaftServerProxy s1
2025-11-20 15:47:49,249 [main] INFO  server.RaftServer (VersionInfo.java:printStartupMessages(136)) -                version: 3.3.0-SNAPSHOT
2025-11-20 15:47:49,249 [main] INFO  server.RaftServer (VersionInfo.java:printStartupMessages(136)) -                    url: https://github.com/apache/ratis
2025-11-20 15:47:49,249 [main] INFO  server.RaftServer (VersionInfo.java:printStartupMessages(136)) -               revision: 1fd1349a891f6725cffd1eccff7f306bd33f474f
2025-11-20 15:47:49,249 [main] INFO  server.RaftServer (VersionInfo.java:printStartupMessages(139)) -                   java: OpenJDK 64-Bit Server VM 17.0.17+10
2025-11-20 15:47:49,250 [main] INFO  server.RaftServer (VersionInfo.java:printStartupMessages(139)) -                   user: runner
2025-11-20 15:47:49,250 [main] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(62)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s1] (custom)
2025-11-20 15:47:49,250 [s0-groupManagement] INFO  server.RaftServer$Division (ServerState.java:<init>(115)) - s0@group-74690665B863: ConfigurationManager, init=conf: {index: -1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}, confs=<EMPTY_MAP>
2025-11-20 15:47:49,251 [main] INFO  server.RaftServer (RaftServerProxy.java:addNew(106)) - s1: addNew group-74690665B863:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068] returns group-74690665B863:java.util.concurrent.CompletableFuture@78b236a0[Not completed]
2025-11-20 15:47:49,252 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(376)) - newRaftServer: s2, group-74690665B863:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068], format? true
2025-11-20 15:47:49,252 [s1-groupManagement] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(269)) - s1: new RaftServerImpl for group-74690665B863:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068] with BaseStateMachine-27:uninitialized
2025-11-20 15:47:49,252 [s1-groupManagement] INFO  server.RaftServer$Division (ServerState.java:<init>(115)) - s1@group-74690665B863: ConfigurationManager, init=conf: {index: -1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}, confs=<EMPTY_MAP>
2025-11-20 15:47:49,253 [main] TRACE util.FileUtils (FileUtils.java:deleteFully(355)) - deleteFully target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s2
2025-11-20 15:47:49,253 [main] TRACE util.FileUtils (FileUtils.java:deleteFully(368)) - deleteFully: target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s2 does not exist.
2025-11-20 15:47:49,254 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(381)) - Formatted directory target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s2
2025-11-20 15:47:49,255 [main] INFO  server.RaftServer (VersionInfo.java:printStartupMessages(132)) - Starting Apache Ratis Test -- RaftServerProxy s2
2025-11-20 15:47:49,255 [main] INFO  server.RaftServer (VersionInfo.java:printStartupMessages(136)) -                version: 3.3.0-SNAPSHOT
2025-11-20 15:47:49,255 [main] INFO  server.RaftServer (VersionInfo.java:printStartupMessages(136)) -                    url: https://github.com/apache/ratis
2025-11-20 15:47:49,255 [main] INFO  server.RaftServer (VersionInfo.java:printStartupMessages(136)) -               revision: 1fd1349a891f6725cffd1eccff7f306bd33f474f
2025-11-20 15:47:49,255 [main] INFO  server.RaftServer (VersionInfo.java:printStartupMessages(139)) -                   java: OpenJDK 64-Bit Server VM 17.0.17+10
2025-11-20 15:47:49,255 [main] INFO  server.RaftServer (VersionInfo.java:printStartupMessages(139)) -                   user: runner
2025-11-20 15:47:49,255 [main] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(62)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s2] (custom)
2025-11-20 15:47:49,258 [main] INFO  server.RaftServer (RaftServerProxy.java:addNew(106)) - s2: addNew group-74690665B863:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068] returns group-74690665B863:java.util.concurrent.CompletableFuture@60e9df3c[Not completed]
2025-11-20 15:47:49,258 [s2-groupManagement] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(269)) - s2: new RaftServerImpl for group-74690665B863:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068] with BaseStateMachine-28:uninitialized
2025-11-20 15:47:49,258 [s2-groupManagement] INFO  server.RaftServer$Division (ServerState.java:<init>(115)) - s2@group-74690665B863: ConfigurationManager, init=conf: {index: -1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}, confs=<EMPTY_MAP>
2025-11-20 15:47:49,259 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(62)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s0] (custom)
2025-11-20 15:47:49,259 [s0-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(138)) - The storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s0/b937fbd3-626a-4da1-bac9-74690665b863 does not exist. Creating ...
2025-11-20 15:47:49,259 [s0-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s0/b937fbd3-626a-4da1-bac9-74690665b863
2025-11-20 15:47:49,261 [s0-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(229)) - Lock on /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s0/b937fbd3-626a-4da1-bac9-74690665b863/in_use.lock acquired by nodename 4731@runnervmg1sw1
2025-11-20 15:47:49,261 [s0-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s0/b937fbd3-626a-4da1-bac9-74690665b863/current
2025-11-20 15:47:49,262 [s0-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s0/b937fbd3-626a-4da1-bac9-74690665b863/sm
2025-11-20 15:47:49,262 [s0-impl-thread1] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s0/b937fbd3-626a-4da1-bac9-74690665b863/current/raft-meta.tmp with options [CREATE, TRUNCATE_EXISTING, WRITE]: sun.nio.ch.FileChannelImpl@5163baab
2025-11-20 15:47:49,264 [s0-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s0/b937fbd3-626a-4da1-bac9-74690665b863/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s0/b937fbd3-626a-4da1-bac9-74690665b863/current/raft-meta with options [REPLACE_EXISTING]
2025-11-20 15:47:49,264 [s0-impl-thread1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(98)) - Storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s0/b937fbd3-626a-4da1-bac9-74690665b863 has been successfully formatted.
2025-11-20 15:47:49,264 [s0-impl-thread1] INFO  server.RaftServer$Division (ServerState.java:getSnapshotIndexFromStateMachine(155)) - s0@group-74690665B863: getLatestSnapshot(BaseStateMachine-26:s0:group-74690665B863) returns null
2025-11-20 15:47:49,264 [s0-impl-thread1] INFO  raftlog.RaftLog (RaftLogBase.java:<init>(90)) - s0@group-74690665B863-SegmentedRaftLog: snapshotIndexFromStateMachine = -1
2025-11-20 15:47:49,265 [s0-impl-thread1] INFO  util.AwaitToRun (AwaitToRun.java:start(81)) - Thread[s0@group-74690665B863-cacheEviction-AwaitToRun,5,main] started
2025-11-20 15:47:49,265 [s0-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(190)) - new s0@group-74690665B863-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s0/b937fbd3-626a-4da1-bac9-74690665b863
2025-11-20 15:47:49,267 [s0-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(141)) - s0@group-74690665B863-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2025-11-20 15:47:49,267 [s0-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(141)) - s0@group-74690665B863-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2025-11-20 15:47:49,268 [s0-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(406)) - s0@group-74690665B863: start as a follower, conf=conf: {index: -1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:47:49,268 [s0-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(393)) - s0@group-74690665B863: changes role from      null to FOLLOWER at term 0 for startAsFollower
2025-11-20 15:47:49,268 [s0-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(148)) - s0: start s0@group-74690665B863-FollowerState
2025-11-20 15:47:49,268 [s0-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-74690665B863,id=s0
2025-11-20 15:47:49,268 [s0-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:register(58)) - register mxBean class org.apache.ratis.server.impl.RaftServerJmxAdapter as Ratis:service=RaftServer,group=group-74690665B863,id=s0
2025-11-20 15:47:49,268 [s0@group-74690665B863-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(69)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2025-11-20 15:47:49,268 [s0@group-74690665B863-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(69)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2025-11-20 15:47:49,268 [s0-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(420)) - s0@group-74690665B863: Successfully started.
2025-11-20 15:47:49,269 [main] INFO  server.RaftServer (RaftServerProxy.java:startImpl(415)) - s0: start RPC server
2025-11-20 15:47:49,269 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(62)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s1] (custom)
2025-11-20 15:47:49,270 [s1-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(138)) - The storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s1/b937fbd3-626a-4da1-bac9-74690665b863 does not exist. Creating ...
2025-11-20 15:47:49,270 [JvmPauseMonitor20] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(146)) - JvmPauseMonitor-s0: Started
2025-11-20 15:47:49,270 [s1-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s1/b937fbd3-626a-4da1-bac9-74690665b863
2025-11-20 15:47:49,271 [s1-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(229)) - Lock on /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s1/b937fbd3-626a-4da1-bac9-74690665b863/in_use.lock acquired by nodename 4731@runnervmg1sw1
2025-11-20 15:47:49,271 [s1-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s1/b937fbd3-626a-4da1-bac9-74690665b863/current
2025-11-20 15:47:49,271 [s1-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s1/b937fbd3-626a-4da1-bac9-74690665b863/sm
2025-11-20 15:47:49,272 [s1-impl-thread1] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s1/b937fbd3-626a-4da1-bac9-74690665b863/current/raft-meta.tmp with options [CREATE, TRUNCATE_EXISTING, WRITE]: sun.nio.ch.FileChannelImpl@1bb1ee79
2025-11-20 15:47:49,274 [s1-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s1/b937fbd3-626a-4da1-bac9-74690665b863/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s1/b937fbd3-626a-4da1-bac9-74690665b863/current/raft-meta with options [REPLACE_EXISTING]
2025-11-20 15:47:49,274 [s1-impl-thread1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(98)) - Storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s1/b937fbd3-626a-4da1-bac9-74690665b863 has been successfully formatted.
2025-11-20 15:47:49,275 [s1-impl-thread1] INFO  server.RaftServer$Division (ServerState.java:getSnapshotIndexFromStateMachine(155)) - s1@group-74690665B863: getLatestSnapshot(BaseStateMachine-27:s1:group-74690665B863) returns null
2025-11-20 15:47:49,275 [s1-impl-thread1] INFO  raftlog.RaftLog (RaftLogBase.java:<init>(90)) - s1@group-74690665B863-SegmentedRaftLog: snapshotIndexFromStateMachine = -1
2025-11-20 15:47:49,275 [s1-impl-thread1] INFO  util.AwaitToRun (AwaitToRun.java:start(81)) - Thread[s1@group-74690665B863-cacheEviction-AwaitToRun,5,main] started
2025-11-20 15:47:49,275 [s1-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(190)) - new s1@group-74690665B863-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s1/b937fbd3-626a-4da1-bac9-74690665b863
2025-11-20 15:47:49,278 [s1-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(141)) - s1@group-74690665B863-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2025-11-20 15:47:49,278 [s1-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(141)) - s1@group-74690665B863-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2025-11-20 15:47:49,278 [s1-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(406)) - s1@group-74690665B863: start as a follower, conf=conf: {index: -1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:47:49,278 [s1-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(393)) - s1@group-74690665B863: changes role from      null to FOLLOWER at term 0 for startAsFollower
2025-11-20 15:47:49,278 [s1-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(148)) - s1: start s1@group-74690665B863-FollowerState
2025-11-20 15:47:49,278 [s1@group-74690665B863-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(69)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2025-11-20 15:47:49,278 [s1@group-74690665B863-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(69)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2025-11-20 15:47:49,278 [s1-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-74690665B863,id=s1
2025-11-20 15:47:49,278 [s1-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:register(58)) - register mxBean class org.apache.ratis.server.impl.RaftServerJmxAdapter as Ratis:service=RaftServer,group=group-74690665B863,id=s1
2025-11-20 15:47:49,279 [s1-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(420)) - s1@group-74690665B863: Successfully started.
2025-11-20 15:47:49,279 [main] INFO  server.RaftServer (RaftServerProxy.java:startImpl(415)) - s1: start RPC server
2025-11-20 15:47:49,281 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(62)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s2] (custom)
2025-11-20 15:47:49,281 [s2-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(138)) - The storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s2/b937fbd3-626a-4da1-bac9-74690665b863 does not exist. Creating ...
2025-11-20 15:47:49,281 [s2-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s2/b937fbd3-626a-4da1-bac9-74690665b863
2025-11-20 15:47:49,282 [JvmPauseMonitor21] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(146)) - JvmPauseMonitor-s1: Started
2025-11-20 15:47:49,282 [s2-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(229)) - Lock on /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s2/b937fbd3-626a-4da1-bac9-74690665b863/in_use.lock acquired by nodename 4731@runnervmg1sw1
2025-11-20 15:47:49,283 [s2-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s2/b937fbd3-626a-4da1-bac9-74690665b863/current
2025-11-20 15:47:49,283 [s2-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s2/b937fbd3-626a-4da1-bac9-74690665b863/sm
2025-11-20 15:47:49,283 [s2-impl-thread1] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s2/b937fbd3-626a-4da1-bac9-74690665b863/current/raft-meta.tmp with options [CREATE, TRUNCATE_EXISTING, WRITE]: sun.nio.ch.FileChannelImpl@6e70e024
2025-11-20 15:47:49,284 [s2-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s2/b937fbd3-626a-4da1-bac9-74690665b863/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s2/b937fbd3-626a-4da1-bac9-74690665b863/current/raft-meta with options [REPLACE_EXISTING]
2025-11-20 15:47:49,285 [s2-impl-thread1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(98)) - Storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s2/b937fbd3-626a-4da1-bac9-74690665b863 has been successfully formatted.
2025-11-20 15:47:49,285 [s2-impl-thread1] INFO  server.RaftServer$Division (ServerState.java:getSnapshotIndexFromStateMachine(155)) - s2@group-74690665B863: getLatestSnapshot(BaseStateMachine-28:s2:group-74690665B863) returns null
2025-11-20 15:47:49,285 [s2-impl-thread1] INFO  raftlog.RaftLog (RaftLogBase.java:<init>(90)) - s2@group-74690665B863-SegmentedRaftLog: snapshotIndexFromStateMachine = -1
2025-11-20 15:47:49,286 [s2-impl-thread1] INFO  util.AwaitToRun (AwaitToRun.java:start(81)) - Thread[s2@group-74690665B863-cacheEviction-AwaitToRun,5,main] started
2025-11-20 15:47:49,286 [s2-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(190)) - new s2@group-74690665B863-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s2/b937fbd3-626a-4da1-bac9-74690665b863
2025-11-20 15:47:49,288 [s2-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(141)) - s2@group-74690665B863-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2025-11-20 15:47:49,288 [s2-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(141)) - s2@group-74690665B863-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2025-11-20 15:47:49,289 [s2-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(406)) - s2@group-74690665B863: start as a follower, conf=conf: {index: -1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:47:49,289 [s2-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(393)) - s2@group-74690665B863: changes role from      null to FOLLOWER at term 0 for startAsFollower
2025-11-20 15:47:49,289 [s2-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(148)) - s2: start s2@group-74690665B863-FollowerState
2025-11-20 15:47:49,289 [s2-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-74690665B863,id=s2
2025-11-20 15:47:49,289 [s2@group-74690665B863-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(69)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2025-11-20 15:47:49,290 [s2@group-74690665B863-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(69)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2025-11-20 15:47:49,290 [s2-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:register(58)) - register mxBean class org.apache.ratis.server.impl.RaftServerJmxAdapter as Ratis:service=RaftServer,group=group-74690665B863,id=s2
2025-11-20 15:47:49,290 [s2-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(420)) - s2@group-74690665B863: Successfully started.
2025-11-20 15:47:49,290 [main] INFO  server.RaftServer (RaftServerProxy.java:startImpl(415)) - s2: start RPC server
2025-11-20 15:47:49,291 [JvmPauseMonitor22] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(146)) - JvmPauseMonitor-s2: Started
2025-11-20 15:47:49,291 [main] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(107)) - printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-74690665B863:t0, leader=null, voted=, raftlog=Memoized:s0@group-74690665B863-SegmentedRaftLog:OPENED:c-1:lastnull, conf=conf: {index: -1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
  s1:  RUNNING  FOLLOWER (RUNNING): s1@group-74690665B863:t0, leader=null, voted=, raftlog=Memoized:s1@group-74690665B863-SegmentedRaftLog:OPENED:c-1:lastnull, conf=conf: {index: -1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
  s2:  RUNNING  FOLLOWER (RUNNING): s2@group-74690665B863:t0, leader=null, voted=, raftlog=Memoized:s2@group-74690665B863-SegmentedRaftLog:OPENED:c-1:lastnull, conf=conf: {index: -1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:47:49,292 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #1 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-74690665B863:t0, leader=null, voted=, raftlog=Memoized:s0@group-74690665B863-SegmentedRaftLog:OPENED:c-1:lastnull, conf=conf: {index: -1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
  s1:  RUNNING  FOLLOWER (RUNNING): s1@group-74690665B863:t0, leader=null, voted=, raftlog=Memoized:s1@group-74690665B863-SegmentedRaftLog:OPENED:c-1:lastnull, conf=conf: {index: -1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
  s2:  RUNNING  FOLLOWER (RUNNING): s2@group-74690665B863:t0, leader=null, voted=, raftlog=Memoized:s2@group-74690665B863-SegmentedRaftLog:OPENED:c-1:lastnull, conf=conf: {index: -1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:47:49,452 [s0@group-74690665B863-FollowerState] INFO  impl.FollowerState (FollowerState.java:runImpl(161)) - s0@group-74690665B863-FollowerState: change to CANDIDATE, lastRpcElapsedTime:183870457ns, electionTimeout:183ms
2025-11-20 15:47:49,452 [s0@group-74690665B863-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - s0: shutdown s0@group-74690665B863-FollowerState
2025-11-20 15:47:49,452 [s0@group-74690665B863-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(393)) - s0@group-74690665B863: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2025-11-20 15:47:49,452 [s0@group-74690665B863-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(148)) - s0: start s0@group-74690665B863-LeaderElection18
2025-11-20 15:47:49,452 [s0@group-74690665B863-LeaderElection18] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(448)) - s0@group-74690665B863-LeaderElection18 PRE_VOTE round 0: submit vote requests at term 0 for conf: {index: -1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:47:49,453 [HandlerDaemon-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1434)) - s1@group-74690665B863: receive requestVote(PRE_VOTE, s0, group-74690665B863, 0, <PROTO_DEFAULT>)
2025-11-20 15:47:49,453 [s0@group-74690665B863-LeaderElection18] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(69)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2025-11-20 15:47:49,453 [HandlerDaemon-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1434)) - s2@group-74690665B863: receive requestVote(PRE_VOTE, s0, group-74690665B863, 0, <PROTO_DEFAULT>)
2025-11-20 15:47:49,453 [HandlerDaemon-0] INFO  impl.VoteContext (VoteContext.java:log(49)) - s1@group-74690665B863-FOLLOWER: accept PRE_VOTE from s0: our priority 0 <= candidate's priority 0
2025-11-20 15:47:49,453 [HandlerDaemon-0] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-74690665B863-FOLLOWER: accept PRE_VOTE from s0: our priority 0 <= candidate's priority 0
2025-11-20 15:47:49,453 [s0@group-74690665B863-LeaderElection18] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(69)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2025-11-20 15:47:49,453 [HandlerDaemon-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1468)) - s2@group-74690665B863 replies to PRE_VOTE vote request: s0<-s2#0:OK-t0-last:<INITIAL_VALUE>. Peer's state: s2@group-74690665B863:t0, leader=null, voted=, raftlog=Memoized:s2@group-74690665B863-SegmentedRaftLog:OPENED:c-1:lastnull, conf=conf: {index: -1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:47:49,453 [HandlerDaemon-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1468)) - s1@group-74690665B863 replies to PRE_VOTE vote request: s0<-s1#0:OK-t0-last:<INITIAL_VALUE>. Peer's state: s1@group-74690665B863:t0, leader=null, voted=, raftlog=Memoized:s1@group-74690665B863-SegmentedRaftLog:OPENED:c-1:lastnull, conf=conf: {index: -1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:47:49,453 [s0@group-74690665B863-LeaderElection18] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(206)) - s0@group-74690665B863-LeaderElection18: PRE_VOTE PASSED received 1 response(s) and 0 exception(s):
2025-11-20 15:47:49,453 [s0@group-74690665B863-LeaderElection18] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(210)) -   Response 0: s0<-s2#0:OK-t0-last:<INITIAL_VALUE>
2025-11-20 15:47:49,453 [s0@group-74690665B863-LeaderElection18] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(450)) - s0@group-74690665B863-LeaderElection18 PRE_VOTE round 0: result PASSED
2025-11-20 15:47:49,454 [s0@group-74690665B863-LeaderElection18] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s0/b937fbd3-626a-4da1-bac9-74690665b863/current/raft-meta.tmp with options [CREATE, TRUNCATE_EXISTING, WRITE]: sun.nio.ch.FileChannelImpl@5f0a89f2
2025-11-20 15:47:49,456 [s0@group-74690665B863-LeaderElection18] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s0/b937fbd3-626a-4da1-bac9-74690665b863/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s0/b937fbd3-626a-4da1-bac9-74690665b863/current/raft-meta with options [REPLACE_EXISTING]
2025-11-20 15:47:49,456 [s0@group-74690665B863-LeaderElection18] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(448)) - s0@group-74690665B863-LeaderElection18 ELECTION round 0: submit vote requests at term 1 for conf: {index: -1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:47:49,456 [HandlerDaemon-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1434)) - s1@group-74690665B863: receive requestVote(ELECTION, s0, group-74690665B863, 1, <PROTO_DEFAULT>)
2025-11-20 15:47:49,456 [HandlerDaemon-1] INFO  impl.VoteContext (VoteContext.java:log(49)) - s1@group-74690665B863-FOLLOWER: accept ELECTION from s0: our priority 0 <= candidate's priority 0
2025-11-20 15:47:49,456 [HandlerDaemon-1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(393)) - s1@group-74690665B863: changes role from  FOLLOWER to FOLLOWER at term 0 for candidate:s0
2025-11-20 15:47:49,456 [HandlerDaemon-1] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - s1: shutdown s1@group-74690665B863-FollowerState
2025-11-20 15:47:49,456 [s0@group-74690665B863-LeaderElection18] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(69)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2025-11-20 15:47:49,456 [s1@group-74690665B863-FollowerState] INFO  impl.FollowerState (FollowerState.java:runImpl(170)) - s1@group-74690665B863-FollowerState was interrupted
2025-11-20 15:47:49,456 [HandlerDaemon-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(148)) - s1: start s1@group-74690665B863-FollowerState
2025-11-20 15:47:49,456 [HandlerDaemon-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1434)) - s2@group-74690665B863: receive requestVote(ELECTION, s0, group-74690665B863, 1, <PROTO_DEFAULT>)
2025-11-20 15:47:49,457 [HandlerDaemon-1] INFO  server.RaftServer$Division (RaftServerImpl.java:setFirstElection(577)) - s1@group-74690665B863: set firstElectionSinceStartup to false for candidate:s0
2025-11-20 15:47:49,456 [s0@group-74690665B863-LeaderElection18] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(69)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2025-11-20 15:47:49,457 [HandlerDaemon-1] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s1/b937fbd3-626a-4da1-bac9-74690665b863/current/raft-meta.tmp with options [CREATE, TRUNCATE_EXISTING, WRITE]: sun.nio.ch.FileChannelImpl@8bc48f1
2025-11-20 15:47:49,457 [HandlerDaemon-1] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-74690665B863-FOLLOWER: accept ELECTION from s0: our priority 0 <= candidate's priority 0
2025-11-20 15:47:49,457 [HandlerDaemon-1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(393)) - s2@group-74690665B863: changes role from  FOLLOWER to FOLLOWER at term 0 for candidate:s0
2025-11-20 15:47:49,457 [HandlerDaemon-1] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - s2: shutdown s2@group-74690665B863-FollowerState
2025-11-20 15:47:49,457 [HandlerDaemon-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(148)) - s2: start s2@group-74690665B863-FollowerState
2025-11-20 15:47:49,457 [s2@group-74690665B863-FollowerState] INFO  impl.FollowerState (FollowerState.java:runImpl(170)) - s2@group-74690665B863-FollowerState was interrupted
2025-11-20 15:47:49,457 [HandlerDaemon-1] INFO  server.RaftServer$Division (RaftServerImpl.java:setFirstElection(577)) - s2@group-74690665B863: set firstElectionSinceStartup to false for candidate:s0
2025-11-20 15:47:49,457 [HandlerDaemon-1] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s2/b937fbd3-626a-4da1-bac9-74690665b863/current/raft-meta.tmp with options [CREATE, TRUNCATE_EXISTING, WRITE]: sun.nio.ch.FileChannelImpl@14acd5f1
2025-11-20 15:47:49,458 [HandlerDaemon-1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s1/b937fbd3-626a-4da1-bac9-74690665b863/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s1/b937fbd3-626a-4da1-bac9-74690665b863/current/raft-meta with options [REPLACE_EXISTING]
2025-11-20 15:47:49,458 [HandlerDaemon-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1468)) - s1@group-74690665B863 replies to ELECTION vote request: s0<-s1#0:OK-t1-last:<INITIAL_VALUE>. Peer's state: s1@group-74690665B863:t1, leader=null, voted=s0, raftlog=Memoized:s1@group-74690665B863-SegmentedRaftLog:OPENED:c-1:lastnull, conf=conf: {index: -1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:47:49,458 [s0@group-74690665B863-LeaderElection18] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(206)) - s0@group-74690665B863-LeaderElection18: ELECTION PASSED received 1 response(s) and 0 exception(s):
2025-11-20 15:47:49,459 [s0@group-74690665B863-LeaderElection18] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(210)) -   Response 0: s0<-s1#0:OK-t1-last:<INITIAL_VALUE>
2025-11-20 15:47:49,459 [HandlerDaemon-1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s2/b937fbd3-626a-4da1-bac9-74690665b863/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s2/b937fbd3-626a-4da1-bac9-74690665b863/current/raft-meta with options [REPLACE_EXISTING]
2025-11-20 15:47:49,459 [HandlerDaemon-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1468)) - s2@group-74690665B863 replies to ELECTION vote request: s0<-s2#0:OK-t1-last:<INITIAL_VALUE>. Peer's state: s2@group-74690665B863:t1, leader=null, voted=s0, raftlog=Memoized:s2@group-74690665B863-SegmentedRaftLog:OPENED:c-1:lastnull, conf=conf: {index: -1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:47:49,459 [s0@group-74690665B863-LeaderElection18] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(450)) - s0@group-74690665B863-LeaderElection18 ELECTION round 0: result PASSED
2025-11-20 15:47:49,459 [s0@group-74690665B863-LeaderElection18] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(141)) - s0: shutdown s0@group-74690665B863-LeaderElection18
2025-11-20 15:47:49,459 [s0@group-74690665B863-LeaderElection18] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(393)) - s0@group-74690665B863: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2025-11-20 15:47:49,459 [s0@group-74690665B863-LeaderElection18] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(69)) - raft.server.staging.timeout = 900ms (fallback to raft.server.rpc.timeout.max)
2025-11-20 15:47:49,460 [s0@group-74690665B863-LeaderElection18] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(148)) - s0: start s0@group-74690665B863-LeaderStateImpl
2025-11-20 15:47:49,460 [s0@group-74690665B863-LeaderElection18] INFO  server.RaftServer$Division (RaftServerImpl.java:setFirstElection(577)) - s0@group-74690665B863: set firstElectionSinceStartup to false for becomeLeader
2025-11-20 15:47:49,460 [s0@group-74690665B863-LeaderElection18] INFO  server.RaftServer$Division (ServerState.java:setLeader(278)) - s0@group-74690665B863: change Leader from null to s0 at term 1 for becomeLeader, leader elected after 209ms
2025-11-20 15:47:49,460 [s0@group-74690665B863-LeaderElection18] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(440)) - s0@group-74690665B863-SegmentedRaftLogWorker: Starting segment from index:0
2025-11-20 15:47:49,461 [s0@group-74690665B863-LeaderElection18] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(392)) - s0@group-74690665B863: set configuration conf: {index: 0, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:47:49,461 [s0@group-74690665B863-SegmentedRaftLogWorker] INFO  segmented.BufferedWriteChannel (BufferedWriteChannel.java:open(61)) - open log_inprogress_0 at position 0
2025-11-20 15:47:49,461 [HandlerDaemon-2] INFO  server.RaftServer$Division (ServerState.java:setLeader(278)) - s1@group-74690665B863: change Leader from null to s0 at term 1 for APPEND_ENTRIES, leader elected after 207ms
2025-11-20 15:47:49,461 [HandlerDaemon-2] INFO  server.RaftServer$Division (ServerState.java:setLeader(278)) - s2@group-74690665B863: change Leader from null to s0 at term 1 for APPEND_ENTRIES, leader elected after 203ms
2025-11-20 15:47:49,462 [HandlerDaemon-0] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1537)) - s1@group-74690665B863: appendEntries* s0->s1#3014-t1,previous=<PROTO_DEFAULT>,leaderCommit=-1,initializing? false,entries: size=1, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
2025-11-20 15:47:49,462 [HandlerDaemon-0] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1537)) - s2@group-74690665B863: appendEntries* s0->s2#3015-t1,previous=<PROTO_DEFAULT>,leaderCommit=-1,initializing? false,entries: size=1, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
2025-11-20 15:47:49,462 [HandlerDaemon-0] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(392)) - s1@group-74690665B863: set configuration conf: {index: 0, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:47:49,462 [HandlerDaemon-0] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(392)) - s2@group-74690665B863: set configuration conf: {index: 0, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:47:49,462 [s1-server-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(440)) - s1@group-74690665B863-SegmentedRaftLogWorker: Starting segment from index:0
2025-11-20 15:47:49,462 [s2-server-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(440)) - s2@group-74690665B863-SegmentedRaftLogWorker: Starting segment from index:0
2025-11-20 15:47:49,463 [s2@group-74690665B863-SegmentedRaftLogWorker] INFO  segmented.BufferedWriteChannel (BufferedWriteChannel.java:open(61)) - open log_inprogress_0 at position 0
2025-11-20 15:47:49,465 [s1@group-74690665B863-SegmentedRaftLogWorker] INFO  segmented.BufferedWriteChannel (BufferedWriteChannel.java:open(61)) - open log_inprogress_0 at position 0
2025-11-20 15:47:49,469 [s0@group-74690665B863-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(647)) - s0@group-74690665B863-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s0/b937fbd3-626a-4da1-bac9-74690665b863/current/log_inprogress_0
2025-11-20 15:47:49,472 [s2@group-74690665B863-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(647)) - s2@group-74690665B863-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s2/b937fbd3-626a-4da1-bac9-74690665b863/current/log_inprogress_0
2025-11-20 15:47:49,473 [s2-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1537)) - s2@group-74690665B863: appendEntries* reply s0<-s2#3015:OK-t1,SUCCESS,nextIndex=1,followerCommit=-1,matchIndex=0
2025-11-20 15:47:49,473 [s1@group-74690665B863-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(647)) - s1@group-74690665B863-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s1/b937fbd3-626a-4da1-bac9-74690665b863/current/log_inprogress_0
2025-11-20 15:47:49,474 [s0@group-74690665B863-StateMachineUpdater] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s0/b937fbd3-626a-4da1-bac9-74690665b863/current/raft-meta.conf.tmp with options [CREATE, TRUNCATE_EXISTING, WRITE]: sun.nio.ch.FileChannelImpl@4305d047
2025-11-20 15:47:49,474 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1537)) - s1@group-74690665B863: appendEntries* reply s0<-s1#3014:OK-t1,SUCCESS,nextIndex=1,followerCommit=-1,matchIndex=0
2025-11-20 15:47:49,475 [s0@group-74690665B863-StateMachineUpdater] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s0/b937fbd3-626a-4da1-bac9-74690665b863/current/raft-meta.conf.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s0/b937fbd3-626a-4da1-bac9-74690665b863/current/raft-meta.conf with options [REPLACE_EXISTING]
2025-11-20 15:47:49,476 [s0@group-74690665B863-StateMachineUpdater] INFO  server.RaftServer$Division (LeaderStateImpl.java:checkStartIndex(309)) - Leader s0@group-74690665B863-LeaderStateImpl is ready since appliedIndex == startIndex == 0
2025-11-20 15:47:49,549 [s2@group-74690665B863-StateMachineUpdater] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s2/b937fbd3-626a-4da1-bac9-74690665b863/current/raft-meta.conf.tmp with options [CREATE, TRUNCATE_EXISTING, WRITE]: sun.nio.ch.FileChannelImpl@f2228a
2025-11-20 15:47:49,551 [s1@group-74690665B863-StateMachineUpdater] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s1/b937fbd3-626a-4da1-bac9-74690665b863/current/raft-meta.conf.tmp with options [CREATE, TRUNCATE_EXISTING, WRITE]: sun.nio.ch.FileChannelImpl@72aa215f
2025-11-20 15:47:49,551 [s2@group-74690665B863-StateMachineUpdater] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s2/b937fbd3-626a-4da1-bac9-74690665b863/current/raft-meta.conf.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s2/b937fbd3-626a-4da1-bac9-74690665b863/current/raft-meta.conf with options [REPLACE_EXISTING]
2025-11-20 15:47:49,552 [s1@group-74690665B863-StateMachineUpdater] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s1/b937fbd3-626a-4da1-bac9-74690665b863/current/raft-meta.conf.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s1/b937fbd3-626a-4da1-bac9-74690665b863/current/raft-meta.conf with options [REPLACE_EXISTING]
2025-11-20 15:47:49,742 [main] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(131)) - printing ALL groups
  s0:  RUNNING    LEADER (RUNNING): s0@group-74690665B863:t1, leader=s0, voted=s0, raftlog=Memoized:s0@group-74690665B863-SegmentedRaftLog:OPENED:c0:last(t:1, i:0), conf=conf: {index: 0, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
  s1:  RUNNING  FOLLOWER (RUNNING): s1@group-74690665B863:t1, leader=s0, voted=s0, raftlog=Memoized:s1@group-74690665B863-SegmentedRaftLog:OPENED:c0:last(t:1, i:0), conf=conf: {index: 0, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
  s2:  RUNNING  FOLLOWER (RUNNING): s2@group-74690665B863:t1, leader=s0, voted=s0, raftlog=Memoized:s2@group-74690665B863-SegmentedRaftLog:OPENED:c0:last(t:1, i:0), conf=conf: {index: 0, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:47:49,742 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:addNewPeers(438)) - Add new peers [s3]
2025-11-20 15:47:49,742 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(376)) - newRaftServer: s3, group-74690665B863:[], format? true
2025-11-20 15:47:49,742 [main] TRACE util.FileUtils (FileUtils.java:deleteFully(355)) - deleteFully target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s3
2025-11-20 15:47:49,743 [main] TRACE util.FileUtils (FileUtils.java:deleteFully(368)) - deleteFully: target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s3 does not exist.
2025-11-20 15:47:49,743 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(381)) - Formatted directory target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s3
2025-11-20 15:47:49,743 [main] INFO  server.RaftServer (VersionInfo.java:printStartupMessages(132)) - Starting Apache Ratis Test -- RaftServerProxy s3
2025-11-20 15:47:49,743 [main] INFO  server.RaftServer (VersionInfo.java:printStartupMessages(136)) -                version: 3.3.0-SNAPSHOT
2025-11-20 15:47:49,743 [main] INFO  server.RaftServer (VersionInfo.java:printStartupMessages(136)) -                    url: https://github.com/apache/ratis
2025-11-20 15:47:49,743 [main] INFO  server.RaftServer (VersionInfo.java:printStartupMessages(136)) -               revision: 1fd1349a891f6725cffd1eccff7f306bd33f474f
2025-11-20 15:47:49,743 [main] INFO  server.RaftServer (VersionInfo.java:printStartupMessages(139)) -                   java: OpenJDK 64-Bit Server VM 17.0.17+10
2025-11-20 15:47:49,744 [main] INFO  server.RaftServer (VersionInfo.java:printStartupMessages(139)) -                   user: runner
2025-11-20 15:47:49,744 [main] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(62)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s3] (custom)
2025-11-20 15:47:49,745 [main] INFO  server.RaftServer (RaftServerProxy.java:addNew(106)) - s3: addNew group-74690665B863:[] returns group-74690665B863:java.util.concurrent.CompletableFuture@537b32ef[Not completed]
2025-11-20 15:47:49,745 [s3-groupManagement] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(269)) - s3: new RaftServerImpl for group-74690665B863:[] with BaseStateMachine-29:uninitialized
2025-11-20 15:47:49,745 [s3-groupManagement] INFO  server.RaftServer$Division (ServerState.java:<init>(115)) - s3@group-74690665B863: ConfigurationManager, init=conf: {index: -1, cur=peers:[]|listeners:[], old=null}, confs=<EMPTY_MAP>
2025-11-20 15:47:49,746 [main] INFO  simulation.TestRaftReconfigurationWithSimulatedRpc (RaftReconfigurationBaseTest.java:runTestKillLeaderDuringReconf(525)) - Start setConf: [s3, s0|localhost:15060, s2|localhost:15068]
2025-11-20 15:47:49,746 [main] INFO  simulation.TestRaftReconfigurationWithSimulatedRpc (RaftReconfigurationBaseTest.java:runTestKillLeaderDuringReconf(526)) - printing ALL groups
  s3:      NEW      null (NEW): s3@group-74690665B863:t0, leader=null, voted=null, raftlog=UNINITIALIZED, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
  s0:  RUNNING    LEADER (RUNNING): s0@group-74690665B863:t1, leader=s0, voted=s0, raftlog=Memoized:s0@group-74690665B863-SegmentedRaftLog:OPENED:c0:last(t:1, i:0), conf=conf: {index: 0, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
  s1:  RUNNING  FOLLOWER (RUNNING): s1@group-74690665B863:t1, leader=s0, voted=s0, raftlog=Memoized:s1@group-74690665B863-SegmentedRaftLog:OPENED:c0:last(t:1, i:0), conf=conf: {index: 0, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
  s2:  RUNNING  FOLLOWER (RUNNING): s2@group-74690665B863:t1, leader=s0, voted=s0, raftlog=Memoized:s2@group-74690665B863-SegmentedRaftLog:OPENED:c0:last(t:1, i:0), conf=conf: {index: 0, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:47:49,747 [main] INFO  simulation.TestRaftReconfigurationWithSimulatedRpc (RaftReconfigurationBaseTest.java:runTestKillLeaderDuringReconf(555)) - (t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
2025-11-20 15:47:49,747 [main] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(107)) - printing ALL groups
  s3:      NEW      null (NEW): s3@group-74690665B863:t0, leader=null, voted=null, raftlog=UNINITIALIZED, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
  s0:  RUNNING    LEADER (RUNNING): s0@group-74690665B863:t1, leader=s0, voted=s0, raftlog=Memoized:s0@group-74690665B863-SegmentedRaftLog:OPENED:c0:last(t:1, i:0), conf=conf: {index: 0, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
  s1:  RUNNING  FOLLOWER (RUNNING): s1@group-74690665B863:t1, leader=s0, voted=s0, raftlog=Memoized:s1@group-74690665B863-SegmentedRaftLog:OPENED:c0:last(t:1, i:0), conf=conf: {index: 0, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
  s2:  RUNNING  FOLLOWER (RUNNING): s2@group-74690665B863:t1, leader=s0, voted=s0, raftlog=Memoized:s2@group-74690665B863-SegmentedRaftLog:OPENED:c0:last(t:1, i:0), conf=conf: {index: 0, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:47:49,747 [main] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(131)) - printing ALL groups
  s3:      NEW      null (NEW): s3@group-74690665B863:t0, leader=null, voted=null, raftlog=UNINITIALIZED, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
  s0:  RUNNING    LEADER (RUNNING): s0@group-74690665B863:t1, leader=s0, voted=s0, raftlog=Memoized:s0@group-74690665B863-SegmentedRaftLog:OPENED:c0:last(t:1, i:0), conf=conf: {index: 0, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
  s1:  RUNNING  FOLLOWER (RUNNING): s1@group-74690665B863:t1, leader=s0, voted=s0, raftlog=Memoized:s1@group-74690665B863-SegmentedRaftLog:OPENED:c0:last(t:1, i:0), conf=conf: {index: 0, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
  s2:  RUNNING  FOLLOWER (RUNNING): s2@group-74690665B863:t1, leader=s0, voted=s0, raftlog=Memoized:s2@group-74690665B863-SegmentedRaftLog:OPENED:c0:last(t:1, i:0), conf=conf: {index: 0, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:47:49,747 [main] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitAndKillLeader(147)) - killing leader =    LEADER (RUNNING): s0@group-74690665B863:t1, leader=s0, voted=s0, raftlog=Memoized:s0@group-74690665B863-SegmentedRaftLog:OPENED:c0:last(t:1, i:0), conf=conf: {index: 0, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:47:49,747 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:killServer(496)) - killServer s0
2025-11-20 15:47:49,747 [main] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$9(425)) - s0: close
2025-11-20 15:47:49,747 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setConfigurationAsync(1323)) - s0@group-74690665B863: receive setConfiguration SetConfigurationRequest:client-638A5BB21BE3->s0@group-74690665B863, cid=3028, seq=null, RW, null, SET_UNCONDITIONALLY, servers:[s3, s0|localhost:15060, s2|localhost:15068], listeners:[]
2025-11-20 15:47:49,748 [s0-server-thread1] INFO  server.RaftServer$Division (LeaderStateImpl.java:startSetConfiguration(483)) - s0@group-74690665B863-LeaderStateImpl: startSetConfiguration SetConfigurationRequest:client-638A5BB21BE3->s0@group-74690665B863, cid=3028, seq=null, RW, null, SET_UNCONDITIONALLY, servers:[s3, s0|localhost:15060, s2|localhost:15068], listeners:[]
2025-11-20 15:47:49,748 [s0@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] INFO  leader.FollowerInfo (FollowerInfoImpl.java:setAttemptedToInstallSnapshot(154)) - Follower s0@group-74690665B863->s3 acknowledged installing snapshot
2025-11-20 15:47:49,748 [s0-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$1(528)) - s0@group-74690665B863: shutdown
2025-11-20 15:47:49,749 [s0-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:unregister(74)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-74690665B863,id=s0
2025-11-20 15:47:49,749 [s0-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(103)) - s0: shutdown s0@group-74690665B863-LeaderStateImpl
2025-11-20 15:47:49,749 [s0@group-74690665B863->s1-LogAppenderDefault-LogAppenderDaemon] INFO  leader.LogAppenderDaemon (LogAppenderDaemon.java:run(85)) - s0@group-74690665B863->s1-LogAppenderDefault-LogAppenderDaemon was interrupted: java.lang.InterruptedException
2025-11-20 15:47:49,749 [s0@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] INFO  leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s0@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon I/O was interrupted: java.io.InterruptedIOException: 
2025-11-20 15:47:49,749 [s0-impl-thread1] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(281)) - s0@group-74690665B863-PendingRequests: sendNotLeaderResponses
2025-11-20 15:47:49,749 [HandlerDaemon-1] INFO  simulation.RequestHandler (RequestHandler.java:run(127)) - s0.clientHandler1 is interrupted by java.io.InterruptedIOException: 
2025-11-20 15:47:49,749 [HandlerDaemon-2] INFO  simulation.RequestHandler (RequestHandler.java:run(127)) - s0.clientHandler2 is interrupted by java.io.InterruptedIOException: 
2025-11-20 15:47:49,749 [HandlerDaemon-0] INFO  simulation.RequestHandler (RequestHandler.java:run(127)) - s0.serverHandler0 is interrupted by java.io.InterruptedIOException: 
2025-11-20 15:47:49,749 [HandlerDaemon-1] INFO  simulation.RequestHandler (RequestHandler.java:run(127)) - s0.serverHandler1 is interrupted by java.io.InterruptedIOException: 
2025-11-20 15:47:49,749 [HandlerDaemon-2] INFO  simulation.RequestHandler (RequestHandler.java:run(127)) - s0.serverHandler2 is interrupted by java.io.InterruptedIOException: 
2025-11-20 15:47:49,750 [s0@group-74690665B863->s2-LogAppenderDefault-LogAppenderDaemon] INFO  leader.LogAppenderDaemon (LogAppenderDaemon.java:run(85)) - s0@group-74690665B863->s2-LogAppenderDefault-LogAppenderDaemon was interrupted: java.lang.InterruptedException
2025-11-20 15:47:49,750 [s0-impl-thread1] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(164)) - s0@group-74690665B863-StateMachineUpdater: set stopIndex = 0
2025-11-20 15:47:49,750 [s0@group-74690665B863-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stop(141)) - s0@group-74690665B863-StateMachineUpdater: closing BaseStateMachine, lastApplied=(t:1, i:0)
2025-11-20 15:47:49,750 [s0@group-74690665B863-cacheEviction-AwaitToRun] INFO  util.AwaitToRun (AwaitToRun.java:run(49)) - s0@group-74690665B863-cacheEviction-AwaitToRun-AwaitForSignal is interrupted
2025-11-20 15:47:50,143 [s2@group-74690665B863-FollowerState] INFO  impl.FollowerState (FollowerState.java:runImpl(161)) - s2@group-74690665B863-FollowerState: change to CANDIDATE, lastRpcElapsedTime:442583280ns, electionTimeout:297ms
2025-11-20 15:47:50,143 [s2@group-74690665B863-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - s2: shutdown s2@group-74690665B863-FollowerState
2025-11-20 15:47:50,143 [s2@group-74690665B863-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(393)) - s2@group-74690665B863: changes role from  FOLLOWER to CANDIDATE at term 1 for changeToCandidate
2025-11-20 15:47:50,143 [s2@group-74690665B863-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(148)) - s2: start s2@group-74690665B863-LeaderElection19
2025-11-20 15:47:50,143 [s2@group-74690665B863-LeaderElection19] INFO  server.RaftServer$Division (ServerState.java:setLeader(278)) - s2@group-74690665B863: change Leader from s0 to null at term 1 for PRE_VOTE
2025-11-20 15:47:50,144 [s2@group-74690665B863-LeaderElection19] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(448)) - s2@group-74690665B863-LeaderElection19 PRE_VOTE round 0: submit vote requests at term 1 for conf: {index: 0, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:47:50,144 [s2@group-74690665B863-LeaderElection19] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(142)) - s2@group-74690665B863-LeaderElection19 got exception when requesting votes: java.util.concurrent.ExecutionException: java.io.IOException: The peer s0 is not alive.
2025-11-20 15:47:50,144 [HandlerDaemon-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1434)) - s1@group-74690665B863: receive requestVote(PRE_VOTE, s2, group-74690665B863, 1, (t:1, i:0))
2025-11-20 15:47:50,144 [HandlerDaemon-1] INFO  impl.VoteContext (VoteContext.java:log(49)) - s1@group-74690665B863-FOLLOWER: accept PRE_VOTE from s2: our priority 0 <= candidate's priority 0
2025-11-20 15:47:50,144 [HandlerDaemon-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1468)) - s1@group-74690665B863 replies to PRE_VOTE vote request: s2<-s1#0:OK-t1-last:(t:1, i:0). Peer's state: s1@group-74690665B863:t1, leader=s0, voted=s0, raftlog=Memoized:s1@group-74690665B863-SegmentedRaftLog:OPENED:c0:last(t:1, i:0), conf=conf: {index: 0, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:47:50,144 [s2@group-74690665B863-LeaderElection19] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(206)) - s2@group-74690665B863-LeaderElection19: PRE_VOTE PASSED received 1 response(s) and 1 exception(s):
2025-11-20 15:47:50,144 [s2@group-74690665B863-LeaderElection19] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(210)) -   Response 0: s2<-s1#0:OK-t1-last:(t:1, i:0)
2025-11-20 15:47:50,144 [s2@group-74690665B863-LeaderElection19] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(142)) -   Exception 1: java.util.concurrent.ExecutionException: java.io.IOException: The peer s0 is not alive.
2025-11-20 15:47:50,144 [s2@group-74690665B863-LeaderElection19] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(450)) - s2@group-74690665B863-LeaderElection19 PRE_VOTE round 0: result PASSED
2025-11-20 15:47:50,145 [s2@group-74690665B863-LeaderElection19] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s2/b937fbd3-626a-4da1-bac9-74690665b863/current/raft-meta.tmp with options [CREATE, TRUNCATE_EXISTING, WRITE]: sun.nio.ch.FileChannelImpl@6b442cf
2025-11-20 15:47:50,146 [s2@group-74690665B863-LeaderElection19] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s2/b937fbd3-626a-4da1-bac9-74690665b863/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s2/b937fbd3-626a-4da1-bac9-74690665b863/current/raft-meta with options [REPLACE_EXISTING]
2025-11-20 15:47:50,146 [s2@group-74690665B863-LeaderElection19] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(448)) - s2@group-74690665B863-LeaderElection19 ELECTION round 0: submit vote requests at term 2 for conf: {index: 0, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:47:50,146 [s2@group-74690665B863-LeaderElection19] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(142)) - s2@group-74690665B863-LeaderElection19 got exception when requesting votes: java.util.concurrent.ExecutionException: java.io.IOException: The peer s0 is not alive.
2025-11-20 15:47:50,146 [HandlerDaemon-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1434)) - s1@group-74690665B863: receive requestVote(ELECTION, s2, group-74690665B863, 2, (t:1, i:0))
2025-11-20 15:47:50,147 [HandlerDaemon-2] INFO  impl.VoteContext (VoteContext.java:log(49)) - s1@group-74690665B863-FOLLOWER: accept ELECTION from s2: our priority 0 <= candidate's priority 0
2025-11-20 15:47:50,147 [HandlerDaemon-2] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(393)) - s1@group-74690665B863: changes role from  FOLLOWER to FOLLOWER at term 1 for candidate:s2
2025-11-20 15:47:50,147 [HandlerDaemon-2] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - s1: shutdown s1@group-74690665B863-FollowerState
2025-11-20 15:47:50,147 [HandlerDaemon-2] INFO  server.RaftServer$Division (ServerState.java:setLeader(278)) - s1@group-74690665B863: change Leader from s0 to null at term 2 for updateCurrentTerm
2025-11-20 15:47:50,147 [s1@group-74690665B863-FollowerState] INFO  impl.FollowerState (FollowerState.java:runImpl(170)) - s1@group-74690665B863-FollowerState was interrupted
2025-11-20 15:47:50,147 [HandlerDaemon-2] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(148)) - s1: start s1@group-74690665B863-FollowerState
2025-11-20 15:47:50,147 [HandlerDaemon-2] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s1/b937fbd3-626a-4da1-bac9-74690665b863/current/raft-meta.tmp with options [CREATE, TRUNCATE_EXISTING, WRITE]: sun.nio.ch.FileChannelImpl@77dad212
2025-11-20 15:47:50,148 [HandlerDaemon-2] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s1/b937fbd3-626a-4da1-bac9-74690665b863/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s1/b937fbd3-626a-4da1-bac9-74690665b863/current/raft-meta with options [REPLACE_EXISTING]
2025-11-20 15:47:50,148 [HandlerDaemon-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1468)) - s1@group-74690665B863 replies to ELECTION vote request: s2<-s1#0:OK-t2-last:(t:1, i:0). Peer's state: s1@group-74690665B863:t2, leader=null, voted=s2, raftlog=Memoized:s1@group-74690665B863-SegmentedRaftLog:OPENED:c0:last(t:1, i:0), conf=conf: {index: 0, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:47:50,148 [s2@group-74690665B863-LeaderElection19] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(206)) - s2@group-74690665B863-LeaderElection19: ELECTION PASSED received 1 response(s) and 1 exception(s):
2025-11-20 15:47:50,148 [s2@group-74690665B863-LeaderElection19] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(210)) -   Response 0: s2<-s1#0:OK-t2-last:(t:1, i:0)
2025-11-20 15:47:50,148 [s2@group-74690665B863-LeaderElection19] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(142)) -   Exception 1: java.util.concurrent.ExecutionException: java.io.IOException: The peer s0 is not alive.
2025-11-20 15:47:50,148 [s2@group-74690665B863-LeaderElection19] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(450)) - s2@group-74690665B863-LeaderElection19 ELECTION round 0: result PASSED
2025-11-20 15:47:50,148 [s2@group-74690665B863-LeaderElection19] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(141)) - s2: shutdown s2@group-74690665B863-LeaderElection19
2025-11-20 15:47:50,148 [s2@group-74690665B863-LeaderElection19] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(393)) - s2@group-74690665B863: changes role from CANDIDATE to LEADER at term 2 for changeToLeader
2025-11-20 15:47:50,148 [s2@group-74690665B863-LeaderElection19] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(69)) - raft.server.staging.timeout = 900ms (fallback to raft.server.rpc.timeout.max)
2025-11-20 15:47:50,149 [s2@group-74690665B863-LeaderElection19] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(148)) - s2: start s2@group-74690665B863-LeaderStateImpl
2025-11-20 15:47:50,149 [s2@group-74690665B863-LeaderElection19] INFO  server.RaftServer$Division (ServerState.java:setLeader(278)) - s2@group-74690665B863: change Leader from null to s2 at term 2 for becomeLeader, leader elected after 5ms
2025-11-20 15:47:50,150 [s2@group-74690665B863-LeaderElection19] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(445)) - s2@group-74690665B863-SegmentedRaftLogWorker: Rolling segment log-0_0 to index:0
2025-11-20 15:47:50,150 [s2@group-74690665B863-LeaderElection19] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(392)) - s2@group-74690665B863: set configuration conf: {index: 1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:47:50,150 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=1)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:47:50,151 [HandlerDaemon-0] INFO  server.RaftServer$Division (ServerState.java:setLeader(278)) - s1@group-74690665B863: change Leader from null to s2 at term 2 for APPEND_ENTRIES, leader elected after 4ms
2025-11-20 15:47:50,151 [s2@group-74690665B863-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s2/b937fbd3-626a-4da1-bac9-74690665b863/current/log_inprogress_0 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s2/b937fbd3-626a-4da1-bac9-74690665b863/current/log_0-0
2025-11-20 15:47:50,151 [s2@group-74690665B863-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(604)) - s2@group-74690665B863-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s2/b937fbd3-626a-4da1-bac9-74690665b863/current/log_inprogress_0 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s2/b937fbd3-626a-4da1-bac9-74690665b863/current/log_0-0
2025-11-20 15:47:50,151 [HandlerDaemon-1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1537)) - s1@group-74690665B863: appendEntries* s2->s1#3035-t2,previous=(t:1, i:0),leaderCommit=0,initializing? false,entries: size=1, first=(t:2, i:1), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
2025-11-20 15:47:50,151 [s2@group-74690665B863-SegmentedRaftLogWorker] INFO  segmented.BufferedWriteChannel (BufferedWriteChannel.java:open(61)) - open log_inprogress_1 at position 0
2025-11-20 15:47:50,152 [HandlerDaemon-1] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(392)) - s1@group-74690665B863: set configuration conf: {index: 1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:47:50,152 [s1-server-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(445)) - s1@group-74690665B863-SegmentedRaftLogWorker: Rolling segment log-0_0 to index:0
2025-11-20 15:47:50,153 [s1@group-74690665B863-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s1/b937fbd3-626a-4da1-bac9-74690665b863/current/log_inprogress_0 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s1/b937fbd3-626a-4da1-bac9-74690665b863/current/log_0-0
2025-11-20 15:47:50,153 [s1@group-74690665B863-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(604)) - s1@group-74690665B863-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s1/b937fbd3-626a-4da1-bac9-74690665b863/current/log_inprogress_0 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s1/b937fbd3-626a-4da1-bac9-74690665b863/current/log_0-0
2025-11-20 15:47:50,153 [s1@group-74690665B863-SegmentedRaftLogWorker] INFO  segmented.BufferedWriteChannel (BufferedWriteChannel.java:open(61)) - open log_inprogress_1 at position 0
2025-11-20 15:47:50,159 [s2@group-74690665B863-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(647)) - s2@group-74690665B863-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s2/b937fbd3-626a-4da1-bac9-74690665b863/current/log_inprogress_1
2025-11-20 15:47:50,160 [s1@group-74690665B863-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(647)) - s1@group-74690665B863-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s1/b937fbd3-626a-4da1-bac9-74690665b863/current/log_inprogress_1
2025-11-20 15:47:50,160 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1537)) - s1@group-74690665B863: appendEntries* reply s2<-s1#3035:OK-t2,SUCCESS,nextIndex=2,followerCommit=0,matchIndex=1
2025-11-20 15:47:50,161 [s2@group-74690665B863-StateMachineUpdater] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s2/b937fbd3-626a-4da1-bac9-74690665b863/current/raft-meta.conf.tmp with options [CREATE, TRUNCATE_EXISTING, WRITE]: sun.nio.ch.FileChannelImpl@e35dce4
2025-11-20 15:47:50,161 [HandlerDaemon-2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1537)) - s1@group-74690665B863: appendEntries* s2->s1#3036-t2,previous=(t:2, i:1),leaderCommit=1,initializing? false,entries: size=1, first=(t:2, i:2), METADATAENTRY(c:1)
2025-11-20 15:47:50,161 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1537)) - s1@group-74690665B863: appendEntries* reply s2<-s1#3036:OK-t2,SUCCESS,nextIndex=3,followerCommit=1,matchIndex=2
2025-11-20 15:47:50,162 [s1@group-74690665B863-StateMachineUpdater] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s1/b937fbd3-626a-4da1-bac9-74690665b863/current/raft-meta.conf.tmp with options [CREATE, TRUNCATE_EXISTING, WRITE]: sun.nio.ch.FileChannelImpl@7c6dd17a
2025-11-20 15:47:50,162 [s2@group-74690665B863-StateMachineUpdater] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s2/b937fbd3-626a-4da1-bac9-74690665b863/current/raft-meta.conf.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s2/b937fbd3-626a-4da1-bac9-74690665b863/current/raft-meta.conf with options [REPLACE_EXISTING]
2025-11-20 15:47:50,162 [s2@group-74690665B863-StateMachineUpdater] INFO  server.RaftServer$Division (LeaderStateImpl.java:checkStartIndex(309)) - Leader s2@group-74690665B863-LeaderStateImpl is ready since appliedIndex == startIndex == 1
2025-11-20 15:47:50,163 [s1@group-74690665B863-StateMachineUpdater] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s1/b937fbd3-626a-4da1-bac9-74690665b863/current/raft-meta.conf.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s1/b937fbd3-626a-4da1-bac9-74690665b863/current/raft-meta.conf with options [REPLACE_EXISTING]
2025-11-20 15:47:50,402 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=11)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:47:50,470 [s0-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(254)) - s0@group-74690665B863-SegmentedRaftLogWorker close()
2025-11-20 15:47:50,471 [JvmPauseMonitor20] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(152)) - JvmPauseMonitor-s0: Stopped
2025-11-20 15:47:50,471 [main] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(107)) - printing ALL groups
  s3:      NEW      null (NEW): s3@group-74690665B863:t0, leader=null, voted=null, raftlog=UNINITIALIZED, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
  s0:   CLOSED    LEADER (CLOSED): s0@group-74690665B863:t1, leader=s0, voted=s0, raftlog=Memoized:s0@group-74690665B863-SegmentedRaftLog:CLOSED:c0, conf=conf: {index: 0, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
  s1:  RUNNING  FOLLOWER (RUNNING): s1@group-74690665B863:t2, leader=s2, voted=s2, raftlog=Memoized:s1@group-74690665B863-SegmentedRaftLog:OPENED:c2:last(t:2, i:2), conf=conf: {index: 1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
  s2:  RUNNING    LEADER (RUNNING): s2@group-74690665B863:t2, leader=s2, voted=s2, raftlog=Memoized:s2@group-74690665B863-SegmentedRaftLog:OPENED:c2:last(t:2, i:2), conf=conf: {index: 1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:47:50,472 [main] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(131)) - printing ALL groups
  s3:      NEW      null (NEW): s3@group-74690665B863:t0, leader=null, voted=null, raftlog=UNINITIALIZED, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
  s0:   CLOSED    LEADER (CLOSED): s0@group-74690665B863:t1, leader=s0, voted=s0, raftlog=Memoized:s0@group-74690665B863-SegmentedRaftLog:CLOSED:c0, conf=conf: {index: 0, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
  s1:  RUNNING  FOLLOWER (RUNNING): s1@group-74690665B863:t2, leader=s2, voted=s2, raftlog=Memoized:s1@group-74690665B863-SegmentedRaftLog:OPENED:c2:last(t:2, i:2), conf=conf: {index: 1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
  s2:  RUNNING    LEADER (RUNNING): s2@group-74690665B863:t2, leader=s2, voted=s2, raftlog=Memoized:s2@group-74690665B863-SegmentedRaftLog:OPENED:c2:last(t:2, i:2), conf=conf: {index: 1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:47:50,472 [main] INFO  simulation.TestRaftReconfigurationWithSimulatedRpc (RaftReconfigurationBaseTest.java:runTestKillLeaderDuringReconf(564)) - newLeaderId: s2
2025-11-20 15:47:50,653 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=21)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:47:50,904 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=31)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:47:51,156 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=41)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:47:51,407 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=51)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:47:51,658 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=61)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:47:51,910 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=71)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:47:51,972 [main] INFO  simulation.TestRaftReconfigurationWithSimulatedRpc (RaftReconfigurationBaseTest.java:runTestKillLeaderDuringReconf(567)) - start new peers: [s3]
2025-11-20 15:47:51,972 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:killServer(496)) - killServer s3
2025-11-20 15:47:51,972 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(376)) - newRaftServer: s3, group-74690665B863:[s3, s0|localhost:15060, s2|localhost:15068], format? false
2025-11-20 15:47:51,973 [main] INFO  server.RaftServer (VersionInfo.java:printStartupMessages(132)) - Starting Apache Ratis Test -- RaftServerProxy s3
2025-11-20 15:47:51,973 [main] INFO  server.RaftServer (VersionInfo.java:printStartupMessages(136)) -                version: 3.3.0-SNAPSHOT
2025-11-20 15:47:51,973 [main] INFO  server.RaftServer (VersionInfo.java:printStartupMessages(136)) -                    url: https://github.com/apache/ratis
2025-11-20 15:47:51,973 [main] INFO  server.RaftServer (VersionInfo.java:printStartupMessages(136)) -               revision: 1fd1349a891f6725cffd1eccff7f306bd33f474f
2025-11-20 15:47:51,973 [main] INFO  server.RaftServer (VersionInfo.java:printStartupMessages(139)) -                   java: OpenJDK 64-Bit Server VM 17.0.17+10
2025-11-20 15:47:51,973 [main] INFO  server.RaftServer (VersionInfo.java:printStartupMessages(139)) -                   user: runner
2025-11-20 15:47:51,974 [main] INFO  server.RaftServer (RaftServerProxy.java:addNew(106)) - s3: addNew group-74690665B863:[s3, s0|localhost:15060, s2|localhost:15068] returns group-74690665B863:java.util.concurrent.CompletableFuture@6f815e7f[Not completed]
2025-11-20 15:47:51,974 [s3-groupManagement] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(269)) - s3: new RaftServerImpl for group-74690665B863:[s3, s0|localhost:15060, s2|localhost:15068] with BaseStateMachine-30:uninitialized
2025-11-20 15:47:51,974 [s3-groupManagement] INFO  server.RaftServer$Division (ServerState.java:<init>(115)) - s3@group-74690665B863: ConfigurationManager, init=conf: {index: -1, cur=peers:[s3, s0|localhost:15060, s2|localhost:15068]|listeners:[], old=null}, confs=<EMPTY_MAP>
2025-11-20 15:47:51,975 [s3-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(138)) - The storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s3/b937fbd3-626a-4da1-bac9-74690665b863 does not exist. Creating ...
2025-11-20 15:47:51,975 [s3-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s3/b937fbd3-626a-4da1-bac9-74690665b863
2025-11-20 15:47:51,976 [s3-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(229)) - Lock on /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s3/b937fbd3-626a-4da1-bac9-74690665b863/in_use.lock acquired by nodename 4731@runnervmg1sw1
2025-11-20 15:47:51,976 [s3-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s3/b937fbd3-626a-4da1-bac9-74690665b863/current
2025-11-20 15:47:51,976 [s3-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s3/b937fbd3-626a-4da1-bac9-74690665b863/sm
2025-11-20 15:47:51,976 [s3-impl-thread1] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s3/b937fbd3-626a-4da1-bac9-74690665b863/current/raft-meta.tmp with options [CREATE, TRUNCATE_EXISTING, WRITE]: sun.nio.ch.FileChannelImpl@7c8dae59
2025-11-20 15:47:51,977 [s3-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s3/b937fbd3-626a-4da1-bac9-74690665b863/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s3/b937fbd3-626a-4da1-bac9-74690665b863/current/raft-meta with options [REPLACE_EXISTING]
2025-11-20 15:47:51,977 [s3-impl-thread1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(98)) - Storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s3/b937fbd3-626a-4da1-bac9-74690665b863 has been successfully formatted.
2025-11-20 15:47:51,978 [s3-impl-thread1] INFO  server.RaftServer$Division (ServerState.java:getSnapshotIndexFromStateMachine(155)) - s3@group-74690665B863: getLatestSnapshot(BaseStateMachine-30:s3:group-74690665B863) returns null
2025-11-20 15:47:51,978 [s3-impl-thread1] INFO  raftlog.RaftLog (RaftLogBase.java:<init>(90)) - s3@group-74690665B863-SegmentedRaftLog: snapshotIndexFromStateMachine = -1
2025-11-20 15:47:51,978 [s3-impl-thread1] INFO  util.AwaitToRun (AwaitToRun.java:start(81)) - Thread[s3@group-74690665B863-cacheEviction-AwaitToRun,5,main] started
2025-11-20 15:47:51,978 [s3-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(190)) - new s3@group-74690665B863-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/a414a92a/MiniRaftClusterWithSimulatedRpc2b74f9e8/s3/b937fbd3-626a-4da1-bac9-74690665b863
2025-11-20 15:47:51,979 [s3-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(141)) - s3@group-74690665B863-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2025-11-20 15:47:51,979 [s3-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(141)) - s3@group-74690665B863-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2025-11-20 15:47:51,979 [s3-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(406)) - s3@group-74690665B863: start as a follower, conf=conf: {index: -1, cur=peers:[s3, s0|localhost:15060, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:47:51,979 [s3-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(393)) - s3@group-74690665B863: changes role from      null to FOLLOWER at term 0 for startAsFollower
2025-11-20 15:47:51,979 [s3-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(148)) - s3: start s3@group-74690665B863-FollowerState
2025-11-20 15:47:51,980 [s3@group-74690665B863-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(69)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2025-11-20 15:47:51,980 [s3-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-74690665B863,id=s3
2025-11-20 15:47:51,980 [s3-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:register(58)) - register mxBean class org.apache.ratis.server.impl.RaftServerJmxAdapter as Ratis:service=RaftServer,group=group-74690665B863,id=s3
2025-11-20 15:47:51,980 [s3@group-74690665B863-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(69)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2025-11-20 15:47:51,980 [s3-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(420)) - s3@group-74690665B863: Successfully started.
2025-11-20 15:47:51,980 [main] INFO  server.RaftServer (RaftServerProxy.java:startImpl(415)) - s3: start RPC server
2025-11-20 15:47:51,981 [JvmPauseMonitor23] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(146)) - JvmPauseMonitor-s3: Started
2025-11-20 15:47:52,161 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=81)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:47:52,167 [s3@group-74690665B863-FollowerState] INFO  impl.FollowerState (FollowerState.java:runImpl(161)) - s3@group-74690665B863-FollowerState: change to CANDIDATE, lastRpcElapsedTime:187515822ns, electionTimeout:187ms
2025-11-20 15:47:52,167 [s3@group-74690665B863-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - s3: shutdown s3@group-74690665B863-FollowerState
2025-11-20 15:47:52,167 [s3@group-74690665B863-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(393)) - s3@group-74690665B863: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2025-11-20 15:47:52,167 [s3@group-74690665B863-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(148)) - s3: start s3@group-74690665B863-LeaderElection20
2025-11-20 15:47:52,168 [s3@group-74690665B863-LeaderElection20] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(448)) - s3@group-74690665B863-LeaderElection20 PRE_VOTE round 0: submit vote requests at term 0 for conf: {index: -1, cur=peers:[s3, s0|localhost:15060, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:47:52,168 [s3@group-74690665B863-LeaderElection20] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(69)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2025-11-20 15:47:52,168 [s3@group-74690665B863-LeaderElection20] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(69)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2025-11-20 15:47:52,168 [HandlerDaemon-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1434)) - s2@group-74690665B863: receive requestVote(PRE_VOTE, s3, group-74690665B863, 0, <PROTO_DEFAULT>)
2025-11-20 15:47:52,168 [s3@group-74690665B863-LeaderElection20] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(142)) - s3@group-74690665B863-LeaderElection20 got exception when requesting votes: java.util.concurrent.ExecutionException: java.io.IOException: The peer s0 is not alive.
2025-11-20 15:47:52,168 [HandlerDaemon-1] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-74690665B863-LEADER: reject PRE_VOTE from s3: s3 is not in current conf [s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]
2025-11-20 15:47:52,169 [HandlerDaemon-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1468)) - s2@group-74690665B863 replies to PRE_VOTE vote request: s3<-s2#0:FAIL-t2-last:(t:2, i:2). Peer's state: s2@group-74690665B863:t2, leader=s2, voted=s2, raftlog=Memoized:s2@group-74690665B863-SegmentedRaftLog:OPENED:c2:last(t:2, i:2), conf=conf: {index: 1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:47:52,169 [s3@group-74690665B863-LeaderElection20] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(206)) - s3@group-74690665B863-LeaderElection20: PRE_VOTE SHUTDOWN received 1 response(s) and 1 exception(s):
2025-11-20 15:47:52,169 [s3@group-74690665B863-LeaderElection20] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(210)) -   Response 0: s3<-s2#0:FAIL-t2-last:(t:2, i:2)
2025-11-20 15:47:52,169 [s3@group-74690665B863-LeaderElection20] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(142)) -   Exception 1: java.util.concurrent.ExecutionException: java.io.IOException: The peer s0 is not alive.
2025-11-20 15:47:52,169 [s3@group-74690665B863-LeaderElection20] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(450)) - s3@group-74690665B863-LeaderElection20 PRE_VOTE round 0: result SHUTDOWN
2025-11-20 15:47:52,169 [s3@group-74690665B863-LeaderElection20] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$1(528)) - s3@group-74690665B863: shutdown
2025-11-20 15:47:52,169 [s3@group-74690665B863-LeaderElection20] INFO  util.JmxRegister (JmxRegister.java:unregister(74)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-74690665B863,id=s3
2025-11-20 15:47:52,169 [s3@group-74690665B863-LeaderElection20] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(141)) - s3: shutdown s3@group-74690665B863-LeaderElection20
2025-11-20 15:47:52,169 [s3@group-74690665B863-LeaderElection20] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(164)) - s3@group-74690665B863-StateMachineUpdater: set stopIndex = -1
2025-11-20 15:47:52,169 [s3@group-74690665B863-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stop(141)) - s3@group-74690665B863-StateMachineUpdater: closing BaseStateMachine, lastApplied=<INITIAL_VALUE>
2025-11-20 15:47:52,169 [s3@group-74690665B863-cacheEviction-AwaitToRun] INFO  util.AwaitToRun (AwaitToRun.java:run(49)) - s3@group-74690665B863-cacheEviction-AwaitToRun-AwaitForSignal is interrupted
2025-11-20 15:47:52,412 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=91)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:47:52,664 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=101)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:47:52,915 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=111)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:47:52,980 [s3@group-74690665B863-LeaderElection20] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(254)) - s3@group-74690665B863-SegmentedRaftLogWorker close()
2025-11-20 15:47:53,151 [s2-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setConfigurationAsync(1323)) - s2@group-74690665B863: receive setConfiguration SetConfigurationRequest:client-638A5BB21BE3->s2@group-74690665B863, cid=3028, seq=null, RW, null, SET_UNCONDITIONALLY, servers:[s3, s0|localhost:15060, s2|localhost:15068], listeners:[]
2025-11-20 15:47:53,152 [s2-server-thread1] INFO  server.RaftServer$Division (LeaderStateImpl.java:startSetConfiguration(483)) - s2@group-74690665B863-LeaderStateImpl: startSetConfiguration SetConfigurationRequest:client-638A5BB21BE3->s2@group-74690665B863, cid=3028, seq=null, RW, null, SET_UNCONDITIONALLY, servers:[s3, s0|localhost:15060, s2|localhost:15068], listeners:[]
2025-11-20 15:47:53,153 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] INFO  leader.FollowerInfo (FollowerInfoImpl.java:setAttemptedToInstallSnapshot(154)) - Follower s2@group-74690665B863->s3 acknowledged installing snapshot
2025-11-20 15:47:53,153 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3117-t2,previous=<PROTO_DEFAULT>,leaderCommit=0,initializing? true,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:53,153 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=1)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:53,166 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=121)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:47:53,178 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3118-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:53,204 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3118-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:53,229 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3118-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:53,255 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3118-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:53,280 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3118-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:53,306 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3118-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:53,331 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3118-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:53,356 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3118-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:53,382 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3118-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:53,407 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3118-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:53,407 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=11)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:53,418 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=131)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:47:53,433 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3118-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:53,458 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3118-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:53,484 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3118-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:53,509 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3118-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:53,534 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3118-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:53,560 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3118-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:53,585 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3118-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:53,610 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3118-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:53,636 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3118-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:53,661 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3118-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:53,661 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=21)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:53,669 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=141)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:47:53,687 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3118-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:53,712 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3118-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:53,737 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3118-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:53,763 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3118-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:53,764 [s2@group-74690665B863-LeaderStateImpl] DEBUG server.RaftServer$Division (LeaderStateImpl.java:checkProgress(794)) - s2@group-74690665B863-LeaderStateImpl detects a follower s2@group-74690665B863->s3(c-1,m-1,n0, caughtUp=false, lastRpcSendTime=1, lastRpcResponseTime=912) timeout (912ms) for bootstrapping
2025-11-20 15:47:53,764 [s2@group-74690665B863-LeaderStateImpl] DEBUG server.RaftServer$Division (LeaderStateImpl.java:fail(1271)) - s2@group-74690665B863-ConfigurationStagingState: Fail to set configuration peers:[s3, s0|localhost:15060, s2|localhost:15068]|listeners:[] due to NOPROGRESS
2025-11-20 15:47:53,764 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] INFO  leader.LogAppenderDaemon (LogAppenderDaemon.java:run(85)) - s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon was interrupted: java.lang.InterruptedException: sleep interrupted
2025-11-20 15:47:53,920 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=151)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:47:54,166 [s2-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setConfigurationAsync(1323)) - s2@group-74690665B863: receive setConfiguration SetConfigurationRequest:client-638A5BB21BE3->s2@group-74690665B863, cid=3028, seq=null, RW, null, SET_UNCONDITIONALLY, servers:[s3, s0|localhost:15060, s2|localhost:15068], listeners:[]
2025-11-20 15:47:54,167 [s2-server-thread1] INFO  server.RaftServer$Division (LeaderStateImpl.java:startSetConfiguration(483)) - s2@group-74690665B863-LeaderStateImpl: startSetConfiguration SetConfigurationRequest:client-638A5BB21BE3->s2@group-74690665B863, cid=3028, seq=null, RW, null, SET_UNCONDITIONALLY, servers:[s3, s0|localhost:15060, s2|localhost:15068], listeners:[]
2025-11-20 15:47:54,167 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] INFO  leader.FollowerInfo (FollowerInfoImpl.java:setAttemptedToInstallSnapshot(154)) - Follower s2@group-74690665B863->s3 acknowledged installing snapshot
2025-11-20 15:47:54,167 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3148-t2,previous=<PROTO_DEFAULT>,leaderCommit=0,initializing? true,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:54,168 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=1)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:54,171 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=161)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:47:54,193 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3149-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:54,218 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3149-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:54,244 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3149-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:54,269 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3149-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:54,295 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3149-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:54,320 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3149-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:54,346 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3149-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:54,371 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3149-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:54,397 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3149-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:54,422 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3149-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:54,422 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=171)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:47:54,422 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=11)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:54,448 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3149-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:54,473 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3149-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:54,498 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3149-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:54,524 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3149-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:54,549 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3149-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:54,574 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3149-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:54,600 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3149-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:54,625 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3149-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:54,651 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3149-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:54,673 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=181)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:47:54,676 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3149-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:54,676 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=21)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:54,702 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3149-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:54,727 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3149-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:54,752 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3149-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:54,778 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3149-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:54,803 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3149-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:54,829 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3149-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:54,854 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3149-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:54,880 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3149-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:54,905 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3149-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:54,925 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=191)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:47:54,931 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3149-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:54,931 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=31)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:54,956 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3149-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:54,965 [s2@group-74690665B863-LeaderStateImpl] DEBUG server.RaftServer$Division (LeaderStateImpl.java:checkProgress(794)) - s2@group-74690665B863-LeaderStateImpl detects a follower s2@group-74690665B863->s3(c-1,m-1,n0, caughtUp=false, lastRpcSendTime=9, lastRpcResponseTime=1098) timeout (1098ms) for bootstrapping
2025-11-20 15:47:54,965 [s2@group-74690665B863-LeaderStateImpl] DEBUG server.RaftServer$Division (LeaderStateImpl.java:fail(1271)) - s2@group-74690665B863-ConfigurationStagingState: Fail to set configuration peers:[s3, s0|localhost:15060, s2|localhost:15068]|listeners:[] due to NOPROGRESS
2025-11-20 15:47:54,966 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] INFO  leader.LogAppenderDaemon (LogAppenderDaemon.java:run(85)) - s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon was interrupted: java.lang.InterruptedException: sleep interrupted
2025-11-20 15:47:55,176 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=201)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:47:55,368 [s2-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setConfigurationAsync(1323)) - s2@group-74690665B863: receive setConfiguration SetConfigurationRequest:client-638A5BB21BE3->s2@group-74690665B863, cid=3028, seq=null, RW, null, SET_UNCONDITIONALLY, servers:[s3, s0|localhost:15060, s2|localhost:15068], listeners:[]
2025-11-20 15:47:55,368 [s2-server-thread1] INFO  server.RaftServer$Division (LeaderStateImpl.java:startSetConfiguration(483)) - s2@group-74690665B863-LeaderStateImpl: startSetConfiguration SetConfigurationRequest:client-638A5BB21BE3->s2@group-74690665B863, cid=3028, seq=null, RW, null, SET_UNCONDITIONALLY, servers:[s3, s0|localhost:15060, s2|localhost:15068], listeners:[]
2025-11-20 15:47:55,369 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] INFO  leader.FollowerInfo (FollowerInfoImpl.java:setAttemptedToInstallSnapshot(154)) - Follower s2@group-74690665B863->s3 acknowledged installing snapshot
2025-11-20 15:47:55,369 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3183-t2,previous=<PROTO_DEFAULT>,leaderCommit=0,initializing? true,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:55,369 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=1)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:55,394 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3184-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:55,420 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3184-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:55,427 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=211)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:47:55,445 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3184-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:55,471 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3184-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:55,496 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3184-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:55,521 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3184-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:55,547 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3184-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:55,572 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3184-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:55,597 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3184-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:55,623 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3184-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:55,623 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=11)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:55,648 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3184-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:55,674 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3184-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:55,678 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=221)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:47:55,699 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3184-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:55,724 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3184-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:55,750 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3184-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:55,775 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3184-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:55,800 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3184-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:55,826 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3184-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:55,851 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3184-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:55,876 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3184-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:55,876 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=21)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:55,902 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3184-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:55,927 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3184-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:55,929 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=231)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:47:55,952 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3184-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:55,978 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3184-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:56,003 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3184-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:56,028 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3184-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:56,054 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3184-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:56,079 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3184-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:56,104 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3184-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:56,130 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3184-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:56,130 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=31)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:56,155 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3184-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:56,166 [s2@group-74690665B863-LeaderStateImpl] DEBUG server.RaftServer$Division (LeaderStateImpl.java:checkProgress(794)) - s2@group-74690665B863-LeaderStateImpl detects a follower s2@group-74690665B863->s3(c-1,m-1,n0, caughtUp=false, lastRpcSendTime=11, lastRpcResponseTime=1098) timeout (1098ms) for bootstrapping
2025-11-20 15:47:56,166 [s2@group-74690665B863-LeaderStateImpl] DEBUG server.RaftServer$Division (LeaderStateImpl.java:fail(1271)) - s2@group-74690665B863-ConfigurationStagingState: Fail to set configuration peers:[s3, s0|localhost:15060, s2|localhost:15068]|listeners:[] due to NOPROGRESS
2025-11-20 15:47:56,167 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] INFO  leader.LogAppenderDaemon (LogAppenderDaemon.java:run(85)) - s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon was interrupted: java.lang.InterruptedException: sleep interrupted
2025-11-20 15:47:56,180 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=241)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:47:56,431 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=251)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:47:56,468 [s2-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setConfigurationAsync(1323)) - s2@group-74690665B863: receive setConfiguration SetConfigurationRequest:client-638A5BB21BE3->s2@group-74690665B863, cid=3028, seq=null, RW, null, SET_UNCONDITIONALLY, servers:[s3, s0|localhost:15060, s2|localhost:15068], listeners:[]
2025-11-20 15:47:56,468 [s2-server-thread1] INFO  server.RaftServer$Division (LeaderStateImpl.java:startSetConfiguration(483)) - s2@group-74690665B863-LeaderStateImpl: startSetConfiguration SetConfigurationRequest:client-638A5BB21BE3->s2@group-74690665B863, cid=3028, seq=null, RW, null, SET_UNCONDITIONALLY, servers:[s3, s0|localhost:15060, s2|localhost:15068], listeners:[]
2025-11-20 15:47:56,469 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] INFO  leader.FollowerInfo (FollowerInfoImpl.java:setAttemptedToInstallSnapshot(154)) - Follower s2@group-74690665B863->s3 acknowledged installing snapshot
2025-11-20 15:47:56,469 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3214-t2,previous=<PROTO_DEFAULT>,leaderCommit=0,initializing? true,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:56,469 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=1)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:56,495 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3215-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:56,520 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3215-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:56,545 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3215-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:56,570 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3215-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:56,596 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3215-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:56,621 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3215-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:56,646 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3215-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:56,672 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3215-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:56,682 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=261)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:47:56,697 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3215-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:56,722 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3215-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:56,723 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=11)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:56,748 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3215-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:56,773 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3215-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:56,799 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3215-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:56,824 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3215-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:56,850 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3215-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:56,875 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3215-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:56,901 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3215-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:56,926 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3215-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:56,933 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=271)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:47:56,952 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3215-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:56,977 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3215-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:56,977 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=21)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:57,002 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3215-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:57,028 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3215-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:57,053 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3215-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:57,079 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3215-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:57,104 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3215-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:57,129 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3215-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:57,155 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3215-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:57,180 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3215-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:57,184 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=281)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:47:57,206 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3215-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:57,231 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3215-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:57,231 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=31)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:57,257 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3215-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:57,282 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3215-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:57,307 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3215-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:57,333 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3215-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:57,358 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3215-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:57,367 [s2@group-74690665B863-LeaderStateImpl] DEBUG server.RaftServer$Division (LeaderStateImpl.java:checkProgress(794)) - s2@group-74690665B863-LeaderStateImpl detects a follower s2@group-74690665B863->s3(c-1,m-1,n0, caughtUp=false, lastRpcSendTime=9, lastRpcResponseTime=1199) timeout (1198ms) for bootstrapping
2025-11-20 15:47:57,367 [s2@group-74690665B863-LeaderStateImpl] DEBUG server.RaftServer$Division (LeaderStateImpl.java:fail(1271)) - s2@group-74690665B863-ConfigurationStagingState: Fail to set configuration peers:[s3, s0|localhost:15060, s2|localhost:15068]|listeners:[] due to NOPROGRESS
2025-11-20 15:47:57,368 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] INFO  leader.LogAppenderDaemon (LogAppenderDaemon.java:run(85)) - s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon was interrupted: java.lang.InterruptedException: sleep interrupted
2025-11-20 15:47:57,435 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=291)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:47:57,669 [s2-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setConfigurationAsync(1323)) - s2@group-74690665B863: receive setConfiguration SetConfigurationRequest:client-638A5BB21BE3->s2@group-74690665B863, cid=3028, seq=null, RW, null, SET_UNCONDITIONALLY, servers:[s3, s0|localhost:15060, s2|localhost:15068], listeners:[]
2025-11-20 15:47:57,669 [s2-server-thread1] INFO  server.RaftServer$Division (LeaderStateImpl.java:startSetConfiguration(483)) - s2@group-74690665B863-LeaderStateImpl: startSetConfiguration SetConfigurationRequest:client-638A5BB21BE3->s2@group-74690665B863, cid=3028, seq=null, RW, null, SET_UNCONDITIONALLY, servers:[s3, s0|localhost:15060, s2|localhost:15068], listeners:[]
2025-11-20 15:47:57,670 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] INFO  leader.FollowerInfo (FollowerInfoImpl.java:setAttemptedToInstallSnapshot(154)) - Follower s2@group-74690665B863->s3 acknowledged installing snapshot
2025-11-20 15:47:57,670 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3249-t2,previous=<PROTO_DEFAULT>,leaderCommit=0,initializing? true,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:57,670 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=1)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:57,686 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=301)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:47:57,695 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3250-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:57,721 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3250-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:57,746 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3250-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:57,771 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3250-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:57,797 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3250-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:57,822 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3250-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:57,848 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3250-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:57,873 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3250-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:57,898 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3250-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:57,924 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3250-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:57,924 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=11)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:57,938 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=311)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:47:57,949 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3250-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:57,975 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3250-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:58,000 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3250-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:58,026 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3250-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:58,051 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3250-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:58,076 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3250-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:58,102 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3250-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:58,127 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3250-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:58,152 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3250-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:58,178 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3250-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:58,178 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=21)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:58,189 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=321)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:47:58,203 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3250-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:58,229 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3250-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:58,254 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3250-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:58,280 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3250-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:58,305 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3250-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:58,330 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3250-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:58,356 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3250-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:58,381 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3250-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:58,407 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3250-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:58,432 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3250-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:58,432 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=31)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:58,440 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=331)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:47:58,458 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3250-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:58,483 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3250-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:58,508 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3250-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:58,534 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3250-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:58,559 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3250-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:58,568 [s2@group-74690665B863-LeaderStateImpl] DEBUG server.RaftServer$Division (LeaderStateImpl.java:checkProgress(794)) - s2@group-74690665B863-LeaderStateImpl detects a follower s2@group-74690665B863->s3(c-1,m-1,n0, caughtUp=false, lastRpcSendTime=9, lastRpcResponseTime=1199) timeout (1199ms) for bootstrapping
2025-11-20 15:47:58,568 [s2@group-74690665B863-LeaderStateImpl] DEBUG server.RaftServer$Division (LeaderStateImpl.java:fail(1271)) - s2@group-74690665B863-ConfigurationStagingState: Fail to set configuration peers:[s3, s0|localhost:15060, s2|localhost:15068]|listeners:[] due to NOPROGRESS
2025-11-20 15:47:58,568 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] INFO  leader.LogAppenderDaemon (LogAppenderDaemon.java:run(85)) - s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon was interrupted: java.lang.InterruptedException: sleep interrupted
2025-11-20 15:47:58,691 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=341)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:47:58,943 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=351)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:47:59,171 [s2-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setConfigurationAsync(1323)) - s2@group-74690665B863: receive setConfiguration SetConfigurationRequest:client-638A5BB21BE3->s2@group-74690665B863, cid=3028, seq=null, RW, null, SET_UNCONDITIONALLY, servers:[s3, s0|localhost:15060, s2|localhost:15068], listeners:[]
2025-11-20 15:47:59,171 [s2-server-thread1] INFO  server.RaftServer$Division (LeaderStateImpl.java:startSetConfiguration(483)) - s2@group-74690665B863-LeaderStateImpl: startSetConfiguration SetConfigurationRequest:client-638A5BB21BE3->s2@group-74690665B863, cid=3028, seq=null, RW, null, SET_UNCONDITIONALLY, servers:[s3, s0|localhost:15060, s2|localhost:15068], listeners:[]
2025-11-20 15:47:59,171 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] INFO  leader.FollowerInfo (FollowerInfoImpl.java:setAttemptedToInstallSnapshot(154)) - Follower s2@group-74690665B863->s3 acknowledged installing snapshot
2025-11-20 15:47:59,172 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3292-t2,previous=<PROTO_DEFAULT>,leaderCommit=0,initializing? true,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:59,172 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=1)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:59,194 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=361)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:47:59,197 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3293-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:59,222 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3293-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:59,248 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3293-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:59,273 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3293-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:59,291 [Timer-5] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$7(340)) - TIMED-PRINT: printing ALL groups
  s3:  RUNNING CANDIDATE (CLOSED): s3@group-74690665B863:t0, leader=null, voted=, raftlog=Memoized:s3@group-74690665B863-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[s3, s0|localhost:15060, s2|localhost:15068]|listeners:[], old=null}
  s0:   CLOSED    LEADER (CLOSED): s0@group-74690665B863:t1, leader=s0, voted=s0, raftlog=Memoized:s0@group-74690665B863-SegmentedRaftLog:CLOSED:c0, conf=conf: {index: 0, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
  s1:  RUNNING  FOLLOWER (RUNNING): s1@group-74690665B863:t2, leader=s2, voted=s2, raftlog=Memoized:s1@group-74690665B863-SegmentedRaftLog:OPENED:c2:last(t:2, i:2), conf=conf: {index: 1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
  s2:  RUNNING    LEADER (RUNNING): s2@group-74690665B863:t2, leader=s2, voted=s2, raftlog=Memoized:s2@group-74690665B863-SegmentedRaftLog:OPENED:c2:last(t:2, i:2), conf=conf: {index: 1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}.
2025-11-20 15:47:59,299 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3293-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:59,324 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3293-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:59,349 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3293-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:59,375 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3293-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:59,400 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3293-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:59,426 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3293-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:59,426 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=11)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:59,445 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=371)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:47:59,451 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3293-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:59,476 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3293-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:59,502 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3293-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:59,527 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3293-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:59,553 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3293-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:59,578 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3293-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:59,603 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3293-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:59,629 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3293-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:59,654 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3293-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:59,679 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3293-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:59,680 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=21)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:59,696 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=381)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:47:59,705 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3293-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:59,730 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3293-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:59,756 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3293-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:59,781 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3293-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:59,807 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3293-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:59,832 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3293-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:59,857 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3293-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:59,883 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3293-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:59,908 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3293-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:59,934 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3293-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:59,934 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=31)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:59,948 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=391)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:47:59,959 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3293-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:47:59,984 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3293-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:00,010 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3293-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:00,035 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3293-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:00,061 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3293-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:00,069 [s2@group-74690665B863-LeaderStateImpl] DEBUG server.RaftServer$Division (LeaderStateImpl.java:checkProgress(794)) - s2@group-74690665B863-LeaderStateImpl detects a follower s2@group-74690665B863->s3(c-1,m-1,n0, caughtUp=false, lastRpcSendTime=8, lastRpcResponseTime=1198) timeout (1198ms) for bootstrapping
2025-11-20 15:48:00,069 [s2@group-74690665B863-LeaderStateImpl] DEBUG server.RaftServer$Division (LeaderStateImpl.java:fail(1271)) - s2@group-74690665B863-ConfigurationStagingState: Fail to set configuration peers:[s3, s0|localhost:15060, s2|localhost:15068]|listeners:[] due to NOPROGRESS
2025-11-20 15:48:00,070 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] INFO  leader.LogAppenderDaemon (LogAppenderDaemon.java:run(85)) - s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon was interrupted: java.lang.InterruptedException: sleep interrupted
2025-11-20 15:48:00,199 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=401)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:48:00,270 [s2-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setConfigurationAsync(1323)) - s2@group-74690665B863: receive setConfiguration SetConfigurationRequest:client-638A5BB21BE3->s2@group-74690665B863, cid=3028, seq=null, RW, null, SET_UNCONDITIONALLY, servers:[s3, s0|localhost:15060, s2|localhost:15068], listeners:[]
2025-11-20 15:48:00,271 [s2-server-thread1] INFO  server.RaftServer$Division (LeaderStateImpl.java:startSetConfiguration(483)) - s2@group-74690665B863-LeaderStateImpl: startSetConfiguration SetConfigurationRequest:client-638A5BB21BE3->s2@group-74690665B863, cid=3028, seq=null, RW, null, SET_UNCONDITIONALLY, servers:[s3, s0|localhost:15060, s2|localhost:15068], listeners:[]
2025-11-20 15:48:00,271 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] INFO  leader.FollowerInfo (FollowerInfoImpl.java:setAttemptedToInstallSnapshot(154)) - Follower s2@group-74690665B863->s3 acknowledged installing snapshot
2025-11-20 15:48:00,271 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3325-t2,previous=<PROTO_DEFAULT>,leaderCommit=0,initializing? true,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:00,271 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=1)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:00,297 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3326-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:00,322 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3326-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:00,349 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3326-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:00,375 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3326-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:00,400 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3326-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:00,425 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3326-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:00,450 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=411)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:48:00,451 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3326-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:00,476 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3326-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:00,501 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3326-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:00,527 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3326-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:00,527 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=11)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:00,552 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3326-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:00,577 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3326-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:00,603 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3326-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:00,628 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3326-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:00,653 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3326-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:00,679 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3326-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:00,701 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=421)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:48:00,704 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3326-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:00,729 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3326-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:00,755 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3326-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:00,780 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3326-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:00,780 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=21)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:00,806 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3326-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:00,831 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3326-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:00,856 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3326-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:00,882 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3326-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:00,907 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3326-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:00,932 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3326-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:00,952 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=431)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:48:00,958 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3326-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:00,970 [s2@group-74690665B863-LeaderStateImpl] DEBUG server.RaftServer$Division (LeaderStateImpl.java:checkProgress(794)) - s2@group-74690665B863-LeaderStateImpl detects a follower s2@group-74690665B863->s3(c-1,m-1,n0, caughtUp=false, lastRpcSendTime=12, lastRpcResponseTime=999) timeout (999ms) for bootstrapping
2025-11-20 15:48:00,970 [s2@group-74690665B863-LeaderStateImpl] DEBUG server.RaftServer$Division (LeaderStateImpl.java:fail(1271)) - s2@group-74690665B863-ConfigurationStagingState: Fail to set configuration peers:[s3, s0|localhost:15060, s2|localhost:15068]|listeners:[] due to NOPROGRESS
2025-11-20 15:48:00,970 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] INFO  leader.LogAppenderDaemon (LogAppenderDaemon.java:run(85)) - s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon was interrupted: java.lang.InterruptedException: sleep interrupted
2025-11-20 15:48:01,204 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=441)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:48:01,455 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=451)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:48:01,472 [s2-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setConfigurationAsync(1323)) - s2@group-74690665B863: receive setConfiguration SetConfigurationRequest:client-638A5BB21BE3->s2@group-74690665B863, cid=3028, seq=null, RW, null, SET_UNCONDITIONALLY, servers:[s3, s0|localhost:15060, s2|localhost:15068], listeners:[]
2025-11-20 15:48:01,473 [s2-server-thread1] INFO  server.RaftServer$Division (LeaderStateImpl.java:startSetConfiguration(483)) - s2@group-74690665B863-LeaderStateImpl: startSetConfiguration SetConfigurationRequest:client-638A5BB21BE3->s2@group-74690665B863, cid=3028, seq=null, RW, null, SET_UNCONDITIONALLY, servers:[s3, s0|localhost:15060, s2|localhost:15068], listeners:[]
2025-11-20 15:48:01,473 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] INFO  leader.FollowerInfo (FollowerInfoImpl.java:setAttemptedToInstallSnapshot(154)) - Follower s2@group-74690665B863->s3 acknowledged installing snapshot
2025-11-20 15:48:01,473 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3358-t2,previous=<PROTO_DEFAULT>,leaderCommit=0,initializing? true,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:01,473 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=1)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:01,499 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3361-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:01,524 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3361-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:01,550 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3361-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:01,575 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3361-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:01,601 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3361-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:01,626 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3361-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:01,651 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3361-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:01,677 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3361-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:01,702 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3361-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:01,706 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=461)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:48:01,728 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3361-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:01,728 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=11)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:01,753 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3361-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:01,779 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3361-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:01,804 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3361-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:01,829 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3361-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:01,855 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3361-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:01,880 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3361-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:01,906 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3361-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:01,931 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3361-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:01,956 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3361-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:01,957 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=471)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:48:01,981 [main] INFO  impl.RaftServerTestUtil (RaftServerTestUtil.java:waitAndCheckNewConf(101)) - waitAndCheckNewConf: peers=[s3, s0|localhost:15060, s2|localhost:15068], deadPeers=[s0], printing ALL groups
  s3:  RUNNING CANDIDATE (CLOSED): s3@group-74690665B863:t0, leader=null, voted=, raftlog=Memoized:s3@group-74690665B863-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[s3, s0|localhost:15060, s2|localhost:15068]|listeners:[], old=null}
  s0:   CLOSED    LEADER (CLOSED): s0@group-74690665B863:t1, leader=s0, voted=s0, raftlog=Memoized:s0@group-74690665B863-SegmentedRaftLog:CLOSED:c0, conf=conf: {index: 0, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
  s1:  RUNNING  FOLLOWER (RUNNING): s1@group-74690665B863:t2, leader=s2, voted=s2, raftlog=Memoized:s1@group-74690665B863-SegmentedRaftLog:OPENED:c2:last(t:2, i:2), conf=conf: {index: 1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
  s2:  RUNNING    LEADER (RUNNING): s2@group-74690665B863:t2, leader=s2, voted=s2, raftlog=Memoized:s2@group-74690665B863-SegmentedRaftLog:OPENED:c2:last(t:2, i:2), conf=conf: {index: 1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:48:01,981 [main] INFO  impl.RaftServerTestUtil (RaftServerTestUtil.java:waitAndCheckNewConf(110)) - checking CANDIDATE (CLOSED): s3@group-74690665B863:t0, leader=null, voted=, raftlog=Memoized:s3@group-74690665B863-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[s3, s0|localhost:15060, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:48:01,982 [main] INFO  impl.RaftServerTestUtil (RaftServerTestUtil.java:waitAndCheckNewConf(110)) - checking    LEADER (CLOSED): s0@group-74690665B863:t1, leader=s0, voted=s0, raftlog=Memoized:s0@group-74690665B863-SegmentedRaftLog:CLOSED:c0, conf=conf: {index: 0, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:48:01,982 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3361-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:01,982 [main] INFO  impl.RaftServerTestUtil (RaftServerTestUtil.java:waitAndCheckNewConf(110)) - checking  FOLLOWER (RUNNING): s1@group-74690665B863:t2, leader=s2, voted=s2, raftlog=Memoized:s1@group-74690665B863-SegmentedRaftLog:OPENED:c2:last(t:2, i:2), conf=conf: {index: 1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:48:01,982 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=21)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:01,982 [main] WARN  impl.RaftServerTestUtil (JavaUtils.java:attempt(231)) - FAILED "waitAndCheckNewConf", attempt #1/10, sleep 900ms and then retry: org.opentest4j.AssertionFailedError: expected: <false> but was: <true>
2025-11-20 15:48:02,007 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3361-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:02,033 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3361-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:02,058 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3361-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:02,083 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3361-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:02,109 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3361-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:02,134 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3361-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:02,159 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3361-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:02,171 [s2@group-74690665B863-LeaderStateImpl] DEBUG server.RaftServer$Division (LeaderStateImpl.java:checkProgress(794)) - s2@group-74690665B863-LeaderStateImpl detects a follower s2@group-74690665B863->s3(c-1,m-1,n0, caughtUp=false, lastRpcSendTime=11, lastRpcResponseTime=998) timeout (998ms) for bootstrapping
2025-11-20 15:48:02,171 [s2@group-74690665B863-LeaderStateImpl] DEBUG server.RaftServer$Division (LeaderStateImpl.java:fail(1271)) - s2@group-74690665B863-ConfigurationStagingState: Fail to set configuration peers:[s3, s0|localhost:15060, s2|localhost:15068]|listeners:[] due to NOPROGRESS
2025-11-20 15:48:02,171 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] INFO  leader.LogAppenderDaemon (LogAppenderDaemon.java:run(85)) - s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon was interrupted: java.lang.InterruptedException: sleep interrupted
2025-11-20 15:48:02,208 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=481)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:48:02,372 [s2-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setConfigurationAsync(1323)) - s2@group-74690665B863: receive setConfiguration SetConfigurationRequest:client-638A5BB21BE3->s2@group-74690665B863, cid=3028, seq=null, RW, null, SET_UNCONDITIONALLY, servers:[s3, s0|localhost:15060, s2|localhost:15068], listeners:[]
2025-11-20 15:48:02,372 [s2-server-thread1] INFO  server.RaftServer$Division (LeaderStateImpl.java:startSetConfiguration(483)) - s2@group-74690665B863-LeaderStateImpl: startSetConfiguration SetConfigurationRequest:client-638A5BB21BE3->s2@group-74690665B863, cid=3028, seq=null, RW, null, SET_UNCONDITIONALLY, servers:[s3, s0|localhost:15060, s2|localhost:15068], listeners:[]
2025-11-20 15:48:02,373 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] INFO  leader.FollowerInfo (FollowerInfoImpl.java:setAttemptedToInstallSnapshot(154)) - Follower s2@group-74690665B863->s3 acknowledged installing snapshot
2025-11-20 15:48:02,373 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3385-t2,previous=<PROTO_DEFAULT>,leaderCommit=0,initializing? true,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:02,373 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=1)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:02,399 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3388-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:02,424 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3388-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:02,450 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3388-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:02,460 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=491)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:48:02,475 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3388-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:02,500 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3388-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:02,526 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3388-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:02,551 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3388-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:02,576 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3388-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:02,602 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3388-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:02,627 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3388-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:02,627 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=11)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:02,652 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3388-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:02,678 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3388-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:02,703 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3388-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:02,710 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=501)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:48:02,729 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3388-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:02,754 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3388-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:02,779 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3388-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:02,805 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3388-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:02,830 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3388-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:02,856 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3388-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:02,881 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3388-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:02,881 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=21)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:02,882 [main] INFO  impl.RaftServerTestUtil (RaftServerTestUtil.java:waitAndCheckNewConf(101)) - waitAndCheckNewConf: peers=[s3, s0|localhost:15060, s2|localhost:15068], deadPeers=[s0], printing ALL groups
  s3:  RUNNING CANDIDATE (CLOSED): s3@group-74690665B863:t0, leader=null, voted=, raftlog=Memoized:s3@group-74690665B863-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[s3, s0|localhost:15060, s2|localhost:15068]|listeners:[], old=null}
  s0:   CLOSED    LEADER (CLOSED): s0@group-74690665B863:t1, leader=s0, voted=s0, raftlog=Memoized:s0@group-74690665B863-SegmentedRaftLog:CLOSED:c0, conf=conf: {index: 0, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
  s1:  RUNNING  FOLLOWER (RUNNING): s1@group-74690665B863:t2, leader=s2, voted=s2, raftlog=Memoized:s1@group-74690665B863-SegmentedRaftLog:OPENED:c2:last(t:2, i:2), conf=conf: {index: 1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
  s2:  RUNNING    LEADER (RUNNING): s2@group-74690665B863:t2, leader=s2, voted=s2, raftlog=Memoized:s2@group-74690665B863-SegmentedRaftLog:OPENED:c2:last(t:2, i:2), conf=conf: {index: 1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:48:02,882 [main] INFO  impl.RaftServerTestUtil (RaftServerTestUtil.java:waitAndCheckNewConf(110)) - checking CANDIDATE (CLOSED): s3@group-74690665B863:t0, leader=null, voted=, raftlog=Memoized:s3@group-74690665B863-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[s3, s0|localhost:15060, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:48:02,883 [main] INFO  impl.RaftServerTestUtil (RaftServerTestUtil.java:waitAndCheckNewConf(110)) - checking    LEADER (CLOSED): s0@group-74690665B863:t1, leader=s0, voted=s0, raftlog=Memoized:s0@group-74690665B863-SegmentedRaftLog:CLOSED:c0, conf=conf: {index: 0, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:48:02,883 [main] INFO  impl.RaftServerTestUtil (RaftServerTestUtil.java:waitAndCheckNewConf(110)) - checking  FOLLOWER (RUNNING): s1@group-74690665B863:t2, leader=s2, voted=s2, raftlog=Memoized:s1@group-74690665B863-SegmentedRaftLog:OPENED:c2:last(t:2, i:2), conf=conf: {index: 1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:48:02,883 [main] WARN  impl.RaftServerTestUtil (JavaUtils.java:attempt(231)) - FAILED "waitAndCheckNewConf", attempt #2/10, sleep 900ms and then retry: org.opentest4j.AssertionFailedError: expected: <false> but was: <true>
2025-11-20 15:48:02,906 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3388-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:02,932 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3388-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:02,957 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3388-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:02,961 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=511)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:48:02,983 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3388-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:03,008 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3388-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:03,033 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3388-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:03,059 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3388-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:03,072 [s2@group-74690665B863-LeaderStateImpl] DEBUG server.RaftServer$Division (LeaderStateImpl.java:checkProgress(794)) - s2@group-74690665B863-LeaderStateImpl detects a follower s2@group-74690665B863->s3(c-1,m-1,n0, caughtUp=false, lastRpcSendTime=12, lastRpcResponseTime=999) timeout (999ms) for bootstrapping
2025-11-20 15:48:03,072 [s2@group-74690665B863-LeaderStateImpl] DEBUG server.RaftServer$Division (LeaderStateImpl.java:fail(1271)) - s2@group-74690665B863-ConfigurationStagingState: Fail to set configuration peers:[s3, s0|localhost:15060, s2|localhost:15068]|listeners:[] due to NOPROGRESS
2025-11-20 15:48:03,072 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] INFO  leader.LogAppenderDaemon (LogAppenderDaemon.java:run(85)) - s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon was interrupted: java.lang.InterruptedException: sleep interrupted
2025-11-20 15:48:03,212 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=521)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:48:03,273 [s2-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setConfigurationAsync(1323)) - s2@group-74690665B863: receive setConfiguration SetConfigurationRequest:client-638A5BB21BE3->s2@group-74690665B863, cid=3028, seq=null, RW, null, SET_UNCONDITIONALLY, servers:[s3, s0|localhost:15060, s2|localhost:15068], listeners:[]
2025-11-20 15:48:03,273 [s2-server-thread1] INFO  server.RaftServer$Division (LeaderStateImpl.java:startSetConfiguration(483)) - s2@group-74690665B863-LeaderStateImpl: startSetConfiguration SetConfigurationRequest:client-638A5BB21BE3->s2@group-74690665B863, cid=3028, seq=null, RW, null, SET_UNCONDITIONALLY, servers:[s3, s0|localhost:15060, s2|localhost:15068], listeners:[]
2025-11-20 15:48:03,274 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] INFO  leader.FollowerInfo (FollowerInfoImpl.java:setAttemptedToInstallSnapshot(154)) - Follower s2@group-74690665B863->s3 acknowledged installing snapshot
2025-11-20 15:48:03,274 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3412-t2,previous=<PROTO_DEFAULT>,leaderCommit=0,initializing? true,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:03,274 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=1)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:03,299 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3415-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:03,325 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3415-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:03,350 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3415-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:03,375 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3415-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:03,401 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3415-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:03,426 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3415-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:03,451 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3415-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:03,464 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=531)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:48:03,477 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3415-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:03,502 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3415-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:03,527 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3415-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:03,528 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=11)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:03,553 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3415-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:03,578 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3415-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:03,603 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3415-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:03,629 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3415-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:03,654 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3415-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:03,680 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3415-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:03,705 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3415-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:03,715 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=541)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:48:03,730 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3415-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:03,756 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3415-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:03,781 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3415-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:03,781 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=21)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:03,783 [main] INFO  impl.RaftServerTestUtil (RaftServerTestUtil.java:waitAndCheckNewConf(101)) - waitAndCheckNewConf: peers=[s3, s0|localhost:15060, s2|localhost:15068], deadPeers=[s0], printing ALL groups
  s3:  RUNNING CANDIDATE (CLOSED): s3@group-74690665B863:t0, leader=null, voted=, raftlog=Memoized:s3@group-74690665B863-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[s3, s0|localhost:15060, s2|localhost:15068]|listeners:[], old=null}
  s0:   CLOSED    LEADER (CLOSED): s0@group-74690665B863:t1, leader=s0, voted=s0, raftlog=Memoized:s0@group-74690665B863-SegmentedRaftLog:CLOSED:c0, conf=conf: {index: 0, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
  s1:  RUNNING  FOLLOWER (RUNNING): s1@group-74690665B863:t2, leader=s2, voted=s2, raftlog=Memoized:s1@group-74690665B863-SegmentedRaftLog:OPENED:c2:last(t:2, i:2), conf=conf: {index: 1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
  s2:  RUNNING    LEADER (RUNNING): s2@group-74690665B863:t2, leader=s2, voted=s2, raftlog=Memoized:s2@group-74690665B863-SegmentedRaftLog:OPENED:c2:last(t:2, i:2), conf=conf: {index: 1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:48:03,783 [main] INFO  impl.RaftServerTestUtil (RaftServerTestUtil.java:waitAndCheckNewConf(110)) - checking CANDIDATE (CLOSED): s3@group-74690665B863:t0, leader=null, voted=, raftlog=Memoized:s3@group-74690665B863-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[s3, s0|localhost:15060, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:48:03,784 [main] INFO  impl.RaftServerTestUtil (RaftServerTestUtil.java:waitAndCheckNewConf(110)) - checking    LEADER (CLOSED): s0@group-74690665B863:t1, leader=s0, voted=s0, raftlog=Memoized:s0@group-74690665B863-SegmentedRaftLog:CLOSED:c0, conf=conf: {index: 0, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:48:03,784 [main] INFO  impl.RaftServerTestUtil (RaftServerTestUtil.java:waitAndCheckNewConf(110)) - checking  FOLLOWER (RUNNING): s1@group-74690665B863:t2, leader=s2, voted=s2, raftlog=Memoized:s1@group-74690665B863-SegmentedRaftLog:OPENED:c2:last(t:2, i:2), conf=conf: {index: 1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:48:03,784 [main] WARN  impl.RaftServerTestUtil (JavaUtils.java:attempt(231)) - FAILED "waitAndCheckNewConf", attempt #3/10, sleep 900ms and then retry: org.opentest4j.AssertionFailedError: expected: <false> but was: <true>
2025-11-20 15:48:03,807 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3415-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:03,832 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3415-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:03,858 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3415-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:03,883 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3415-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:03,908 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3415-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:03,934 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3415-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:03,959 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3415-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:03,966 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=551)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:48:03,972 [s2@group-74690665B863-LeaderStateImpl] DEBUG server.RaftServer$Division (LeaderStateImpl.java:checkProgress(794)) - s2@group-74690665B863-LeaderStateImpl detects a follower s2@group-74690665B863->s3(c-1,m-1,n0, caughtUp=false, lastRpcSendTime=13, lastRpcResponseTime=999) timeout (999ms) for bootstrapping
2025-11-20 15:48:03,972 [s2@group-74690665B863-LeaderStateImpl] DEBUG server.RaftServer$Division (LeaderStateImpl.java:fail(1271)) - s2@group-74690665B863-ConfigurationStagingState: Fail to set configuration peers:[s3, s0|localhost:15060, s2|localhost:15068]|listeners:[] due to NOPROGRESS
2025-11-20 15:48:03,973 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] INFO  leader.LogAppenderDaemon (LogAppenderDaemon.java:run(85)) - s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon was interrupted: java.lang.InterruptedException: sleep interrupted
2025-11-20 15:48:04,173 [s2-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setConfigurationAsync(1323)) - s2@group-74690665B863: receive setConfiguration SetConfigurationRequest:client-638A5BB21BE3->s2@group-74690665B863, cid=3028, seq=null, RW, null, SET_UNCONDITIONALLY, servers:[s3, s0|localhost:15060, s2|localhost:15068], listeners:[]
2025-11-20 15:48:04,174 [s2-server-thread1] INFO  server.RaftServer$Division (LeaderStateImpl.java:startSetConfiguration(483)) - s2@group-74690665B863-LeaderStateImpl: startSetConfiguration SetConfigurationRequest:client-638A5BB21BE3->s2@group-74690665B863, cid=3028, seq=null, RW, null, SET_UNCONDITIONALLY, servers:[s3, s0|localhost:15060, s2|localhost:15068], listeners:[]
2025-11-20 15:48:04,174 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] INFO  leader.FollowerInfo (FollowerInfoImpl.java:setAttemptedToInstallSnapshot(154)) - Follower s2@group-74690665B863->s3 acknowledged installing snapshot
2025-11-20 15:48:04,174 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3439-t2,previous=<PROTO_DEFAULT>,leaderCommit=0,initializing? true,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:04,175 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=1)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:04,200 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3442-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:04,217 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=561)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:48:04,225 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3442-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:04,251 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3442-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:04,276 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3442-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:04,302 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3442-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:04,327 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3442-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:04,352 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3442-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:04,378 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3442-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:04,403 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3442-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:04,428 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3442-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:04,429 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=11)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:04,454 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3442-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:04,468 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=571)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:48:04,479 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3442-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:04,505 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3442-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:04,530 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3442-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:04,556 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3442-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:04,581 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3442-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:04,607 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3442-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:04,632 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3442-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:04,657 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3442-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:04,683 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3442-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:04,683 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=21)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:04,684 [main] INFO  impl.RaftServerTestUtil (RaftServerTestUtil.java:waitAndCheckNewConf(101)) - waitAndCheckNewConf: peers=[s3, s0|localhost:15060, s2|localhost:15068], deadPeers=[s0], printing ALL groups
  s3:  RUNNING CANDIDATE (CLOSED): s3@group-74690665B863:t0, leader=null, voted=, raftlog=Memoized:s3@group-74690665B863-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[s3, s0|localhost:15060, s2|localhost:15068]|listeners:[], old=null}
  s0:   CLOSED    LEADER (CLOSED): s0@group-74690665B863:t1, leader=s0, voted=s0, raftlog=Memoized:s0@group-74690665B863-SegmentedRaftLog:CLOSED:c0, conf=conf: {index: 0, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
  s1:  RUNNING  FOLLOWER (RUNNING): s1@group-74690665B863:t2, leader=s2, voted=s2, raftlog=Memoized:s1@group-74690665B863-SegmentedRaftLog:OPENED:c2:last(t:2, i:2), conf=conf: {index: 1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
  s2:  RUNNING    LEADER (RUNNING): s2@group-74690665B863:t2, leader=s2, voted=s2, raftlog=Memoized:s2@group-74690665B863-SegmentedRaftLog:OPENED:c2:last(t:2, i:2), conf=conf: {index: 1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:48:04,684 [main] INFO  impl.RaftServerTestUtil (RaftServerTestUtil.java:waitAndCheckNewConf(110)) - checking CANDIDATE (CLOSED): s3@group-74690665B863:t0, leader=null, voted=, raftlog=Memoized:s3@group-74690665B863-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[s3, s0|localhost:15060, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:48:04,685 [main] INFO  impl.RaftServerTestUtil (RaftServerTestUtil.java:waitAndCheckNewConf(110)) - checking    LEADER (CLOSED): s0@group-74690665B863:t1, leader=s0, voted=s0, raftlog=Memoized:s0@group-74690665B863-SegmentedRaftLog:CLOSED:c0, conf=conf: {index: 0, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:48:04,685 [main] INFO  impl.RaftServerTestUtil (RaftServerTestUtil.java:waitAndCheckNewConf(110)) - checking  FOLLOWER (RUNNING): s1@group-74690665B863:t2, leader=s2, voted=s2, raftlog=Memoized:s1@group-74690665B863-SegmentedRaftLog:OPENED:c2:last(t:2, i:2), conf=conf: {index: 1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:48:04,685 [main] WARN  impl.RaftServerTestUtil (JavaUtils.java:attempt(231)) - FAILED "waitAndCheckNewConf", attempt #4/10, sleep 900ms and then retry: org.opentest4j.AssertionFailedError: expected: <false> but was: <true>
2025-11-20 15:48:04,708 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3442-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:04,719 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=581)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:48:04,733 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3442-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:04,759 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3442-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:04,784 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3442-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:04,810 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3442-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:04,835 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3442-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:04,861 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3442-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:04,873 [s2@group-74690665B863-LeaderStateImpl] DEBUG server.RaftServer$Division (LeaderStateImpl.java:checkProgress(794)) - s2@group-74690665B863-LeaderStateImpl detects a follower s2@group-74690665B863->s3(c-1,m-1,n0, caughtUp=false, lastRpcSendTime=12, lastRpcResponseTime=999) timeout (999ms) for bootstrapping
2025-11-20 15:48:04,873 [s2@group-74690665B863-LeaderStateImpl] DEBUG server.RaftServer$Division (LeaderStateImpl.java:fail(1271)) - s2@group-74690665B863-ConfigurationStagingState: Fail to set configuration peers:[s3, s0|localhost:15060, s2|localhost:15068]|listeners:[] due to NOPROGRESS
2025-11-20 15:48:04,873 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] INFO  leader.LogAppenderDaemon (LogAppenderDaemon.java:run(85)) - s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon was interrupted: java.lang.InterruptedException: sleep interrupted
2025-11-20 15:48:04,971 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=591)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:48:05,222 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=601)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:48:05,275 [s2-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setConfigurationAsync(1323)) - s2@group-74690665B863: receive setConfiguration SetConfigurationRequest:client-638A5BB21BE3->s2@group-74690665B863, cid=3028, seq=null, RW, null, SET_UNCONDITIONALLY, servers:[s3, s0|localhost:15060, s2|localhost:15068], listeners:[]
2025-11-20 15:48:05,275 [s2-server-thread1] INFO  server.RaftServer$Division (LeaderStateImpl.java:startSetConfiguration(483)) - s2@group-74690665B863-LeaderStateImpl: startSetConfiguration SetConfigurationRequest:client-638A5BB21BE3->s2@group-74690665B863, cid=3028, seq=null, RW, null, SET_UNCONDITIONALLY, servers:[s3, s0|localhost:15060, s2|localhost:15068], listeners:[]
2025-11-20 15:48:05,276 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] INFO  leader.FollowerInfo (FollowerInfoImpl.java:setAttemptedToInstallSnapshot(154)) - Follower s2@group-74690665B863->s3 acknowledged installing snapshot
2025-11-20 15:48:05,276 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3472-t2,previous=<PROTO_DEFAULT>,leaderCommit=0,initializing? true,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:05,276 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=1)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:05,301 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3473-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:05,327 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3473-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:05,352 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3473-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:05,377 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3473-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:05,403 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3473-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:05,428 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3473-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:05,454 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3473-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:05,473 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=611)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:48:05,479 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3473-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:05,504 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3473-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:05,530 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3473-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:05,530 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=11)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:05,555 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3473-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:05,581 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3473-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:05,585 [main] INFO  impl.RaftServerTestUtil (RaftServerTestUtil.java:waitAndCheckNewConf(101)) - waitAndCheckNewConf: peers=[s3, s0|localhost:15060, s2|localhost:15068], deadPeers=[s0], printing ALL groups
  s3:  RUNNING CANDIDATE (CLOSED): s3@group-74690665B863:t0, leader=null, voted=, raftlog=Memoized:s3@group-74690665B863-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[s3, s0|localhost:15060, s2|localhost:15068]|listeners:[], old=null}
  s0:   CLOSED    LEADER (CLOSED): s0@group-74690665B863:t1, leader=s0, voted=s0, raftlog=Memoized:s0@group-74690665B863-SegmentedRaftLog:CLOSED:c0, conf=conf: {index: 0, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
  s1:  RUNNING  FOLLOWER (RUNNING): s1@group-74690665B863:t2, leader=s2, voted=s2, raftlog=Memoized:s1@group-74690665B863-SegmentedRaftLog:OPENED:c2:last(t:2, i:2), conf=conf: {index: 1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
  s2:  RUNNING    LEADER (RUNNING): s2@group-74690665B863:t2, leader=s2, voted=s2, raftlog=Memoized:s2@group-74690665B863-SegmentedRaftLog:OPENED:c2:last(t:2, i:2), conf=conf: {index: 1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:48:05,585 [main] INFO  impl.RaftServerTestUtil (RaftServerTestUtil.java:waitAndCheckNewConf(110)) - checking CANDIDATE (CLOSED): s3@group-74690665B863:t0, leader=null, voted=, raftlog=Memoized:s3@group-74690665B863-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[s3, s0|localhost:15060, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:48:05,586 [main] INFO  impl.RaftServerTestUtil (RaftServerTestUtil.java:waitAndCheckNewConf(110)) - checking    LEADER (CLOSED): s0@group-74690665B863:t1, leader=s0, voted=s0, raftlog=Memoized:s0@group-74690665B863-SegmentedRaftLog:CLOSED:c0, conf=conf: {index: 0, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:48:05,586 [main] INFO  impl.RaftServerTestUtil (RaftServerTestUtil.java:waitAndCheckNewConf(110)) - checking  FOLLOWER (RUNNING): s1@group-74690665B863:t2, leader=s2, voted=s2, raftlog=Memoized:s1@group-74690665B863-SegmentedRaftLog:OPENED:c2:last(t:2, i:2), conf=conf: {index: 1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:48:05,586 [main] WARN  impl.RaftServerTestUtil (JavaUtils.java:attempt(231)) - FAILED "waitAndCheckNewConf", attempt #5/10, sleep 900ms and then retry: org.opentest4j.AssertionFailedError: expected: <false> but was: <true>
2025-11-20 15:48:05,606 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3473-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:05,631 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3473-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:05,657 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3473-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:05,682 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3473-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:05,707 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3473-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:05,725 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=621)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:48:05,733 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3473-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:05,758 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3473-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:05,783 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3473-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:05,784 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=21)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:05,809 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3473-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:05,834 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3473-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:05,860 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3473-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:05,885 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3473-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:05,910 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3473-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:05,936 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3473-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:05,961 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3473-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:05,976 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=631)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:48:05,987 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3473-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:06,012 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3473-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:06,037 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3473-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:06,038 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=31)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:06,063 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3473-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:06,074 [s2@group-74690665B863-LeaderStateImpl] DEBUG server.RaftServer$Division (LeaderStateImpl.java:checkProgress(794)) - s2@group-74690665B863-LeaderStateImpl detects a follower s2@group-74690665B863->s3(c-1,m-1,n0, caughtUp=false, lastRpcSendTime=11, lastRpcResponseTime=1098) timeout (1098ms) for bootstrapping
2025-11-20 15:48:06,074 [s2@group-74690665B863-LeaderStateImpl] DEBUG server.RaftServer$Division (LeaderStateImpl.java:fail(1271)) - s2@group-74690665B863-ConfigurationStagingState: Fail to set configuration peers:[s3, s0|localhost:15060, s2|localhost:15068]|listeners:[] due to NOPROGRESS
2025-11-20 15:48:06,074 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] INFO  leader.LogAppenderDaemon (LogAppenderDaemon.java:run(85)) - s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon was interrupted: java.lang.InterruptedException: sleep interrupted
2025-11-20 15:48:06,227 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=641)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:48:06,376 [s2-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setConfigurationAsync(1323)) - s2@group-74690665B863: receive setConfiguration SetConfigurationRequest:client-638A5BB21BE3->s2@group-74690665B863, cid=3028, seq=null, RW, null, SET_UNCONDITIONALLY, servers:[s3, s0|localhost:15060, s2|localhost:15068], listeners:[]
2025-11-20 15:48:06,376 [s2-server-thread1] INFO  server.RaftServer$Division (LeaderStateImpl.java:startSetConfiguration(483)) - s2@group-74690665B863-LeaderStateImpl: startSetConfiguration SetConfigurationRequest:client-638A5BB21BE3->s2@group-74690665B863, cid=3028, seq=null, RW, null, SET_UNCONDITIONALLY, servers:[s3, s0|localhost:15060, s2|localhost:15068], listeners:[]
2025-11-20 15:48:06,376 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] INFO  leader.FollowerInfo (FollowerInfoImpl.java:setAttemptedToInstallSnapshot(154)) - Follower s2@group-74690665B863->s3 acknowledged installing snapshot
2025-11-20 15:48:06,377 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3503-t2,previous=<PROTO_DEFAULT>,leaderCommit=0,initializing? true,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:06,377 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=1)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:06,402 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3506-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:06,428 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3506-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:06,453 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3506-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:06,478 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=651)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:48:06,478 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3506-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:06,486 [main] INFO  impl.RaftServerTestUtil (RaftServerTestUtil.java:waitAndCheckNewConf(101)) - waitAndCheckNewConf: peers=[s3, s0|localhost:15060, s2|localhost:15068], deadPeers=[s0], printing ALL groups
  s3:  RUNNING CANDIDATE (CLOSED): s3@group-74690665B863:t0, leader=null, voted=, raftlog=Memoized:s3@group-74690665B863-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[s3, s0|localhost:15060, s2|localhost:15068]|listeners:[], old=null}
  s0:   CLOSED    LEADER (CLOSED): s0@group-74690665B863:t1, leader=s0, voted=s0, raftlog=Memoized:s0@group-74690665B863-SegmentedRaftLog:CLOSED:c0, conf=conf: {index: 0, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
  s1:  RUNNING  FOLLOWER (RUNNING): s1@group-74690665B863:t2, leader=s2, voted=s2, raftlog=Memoized:s1@group-74690665B863-SegmentedRaftLog:OPENED:c2:last(t:2, i:2), conf=conf: {index: 1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
  s2:  RUNNING    LEADER (RUNNING): s2@group-74690665B863:t2, leader=s2, voted=s2, raftlog=Memoized:s2@group-74690665B863-SegmentedRaftLog:OPENED:c2:last(t:2, i:2), conf=conf: {index: 1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:48:06,487 [main] INFO  impl.RaftServerTestUtil (RaftServerTestUtil.java:waitAndCheckNewConf(110)) - checking CANDIDATE (CLOSED): s3@group-74690665B863:t0, leader=null, voted=, raftlog=Memoized:s3@group-74690665B863-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[s3, s0|localhost:15060, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:48:06,487 [main] INFO  impl.RaftServerTestUtil (RaftServerTestUtil.java:waitAndCheckNewConf(110)) - checking    LEADER (CLOSED): s0@group-74690665B863:t1, leader=s0, voted=s0, raftlog=Memoized:s0@group-74690665B863-SegmentedRaftLog:CLOSED:c0, conf=conf: {index: 0, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:48:06,487 [main] INFO  impl.RaftServerTestUtil (RaftServerTestUtil.java:waitAndCheckNewConf(110)) - checking  FOLLOWER (RUNNING): s1@group-74690665B863:t2, leader=s2, voted=s2, raftlog=Memoized:s1@group-74690665B863-SegmentedRaftLog:OPENED:c2:last(t:2, i:2), conf=conf: {index: 1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:48:06,487 [main] WARN  impl.RaftServerTestUtil (JavaUtils.java:attempt(231)) - FAILED "waitAndCheckNewConf", attempt #6/10, sleep 900ms and then retry: org.opentest4j.AssertionFailedError: expected: <false> but was: <true>
2025-11-20 15:48:06,504 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3506-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:06,529 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3506-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:06,554 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3506-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:06,580 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3506-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:06,605 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3506-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:06,631 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3506-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:06,631 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=11)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:06,656 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3506-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:06,681 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3506-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:06,707 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3506-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:06,729 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=661)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:48:06,732 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3506-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:06,757 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3506-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:06,783 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3506-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:06,808 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3506-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:06,833 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3506-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:06,859 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3506-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:06,884 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3506-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:06,884 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=21)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:06,910 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3506-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:06,935 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3506-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:06,960 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3506-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:06,981 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=671)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:48:06,986 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3506-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:07,011 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3506-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:07,037 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3506-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:07,062 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3506-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:07,088 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3506-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:07,113 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3506-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:07,139 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3506-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:07,139 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=31)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:07,164 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3506-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:07,190 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3506-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:07,215 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3506-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:07,232 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=681)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:48:07,240 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3506-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:07,266 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3506-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:07,275 [s2@group-74690665B863-LeaderStateImpl] DEBUG server.RaftServer$Division (LeaderStateImpl.java:checkProgress(794)) - s2@group-74690665B863-LeaderStateImpl detects a follower s2@group-74690665B863->s3(c-1,m-1,n0, caughtUp=false, lastRpcSendTime=9, lastRpcResponseTime=1199) timeout (1199ms) for bootstrapping
2025-11-20 15:48:07,275 [s2@group-74690665B863-LeaderStateImpl] DEBUG server.RaftServer$Division (LeaderStateImpl.java:fail(1271)) - s2@group-74690665B863-ConfigurationStagingState: Fail to set configuration peers:[s3, s0|localhost:15060, s2|localhost:15068]|listeners:[] due to NOPROGRESS
2025-11-20 15:48:07,275 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] INFO  leader.LogAppenderDaemon (LogAppenderDaemon.java:run(85)) - s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon was interrupted: java.lang.InterruptedException: sleep interrupted
2025-11-20 15:48:07,387 [main] INFO  impl.RaftServerTestUtil (RaftServerTestUtil.java:waitAndCheckNewConf(101)) - waitAndCheckNewConf: peers=[s3, s0|localhost:15060, s2|localhost:15068], deadPeers=[s0], printing ALL groups
  s3:  RUNNING CANDIDATE (CLOSED): s3@group-74690665B863:t0, leader=null, voted=, raftlog=Memoized:s3@group-74690665B863-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[s3, s0|localhost:15060, s2|localhost:15068]|listeners:[], old=null}
  s0:   CLOSED    LEADER (CLOSED): s0@group-74690665B863:t1, leader=s0, voted=s0, raftlog=Memoized:s0@group-74690665B863-SegmentedRaftLog:CLOSED:c0, conf=conf: {index: 0, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
  s1:  RUNNING  FOLLOWER (RUNNING): s1@group-74690665B863:t2, leader=s2, voted=s2, raftlog=Memoized:s1@group-74690665B863-SegmentedRaftLog:OPENED:c2:last(t:2, i:2), conf=conf: {index: 1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
  s2:  RUNNING    LEADER (RUNNING): s2@group-74690665B863:t2, leader=s2, voted=s2, raftlog=Memoized:s2@group-74690665B863-SegmentedRaftLog:OPENED:c2:last(t:2, i:2), conf=conf: {index: 1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:48:07,388 [main] INFO  impl.RaftServerTestUtil (RaftServerTestUtil.java:waitAndCheckNewConf(110)) - checking CANDIDATE (CLOSED): s3@group-74690665B863:t0, leader=null, voted=, raftlog=Memoized:s3@group-74690665B863-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[s3, s0|localhost:15060, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:48:07,388 [main] INFO  impl.RaftServerTestUtil (RaftServerTestUtil.java:waitAndCheckNewConf(110)) - checking    LEADER (CLOSED): s0@group-74690665B863:t1, leader=s0, voted=s0, raftlog=Memoized:s0@group-74690665B863-SegmentedRaftLog:CLOSED:c0, conf=conf: {index: 0, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:48:07,388 [main] INFO  impl.RaftServerTestUtil (RaftServerTestUtil.java:waitAndCheckNewConf(110)) - checking  FOLLOWER (RUNNING): s1@group-74690665B863:t2, leader=s2, voted=s2, raftlog=Memoized:s1@group-74690665B863-SegmentedRaftLog:OPENED:c2:last(t:2, i:2), conf=conf: {index: 1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:48:07,388 [main] WARN  impl.RaftServerTestUtil (JavaUtils.java:attempt(231)) - FAILED "waitAndCheckNewConf", attempt #7/10, sleep 900ms and then retry: org.opentest4j.AssertionFailedError: expected: <false> but was: <true>
2025-11-20 15:48:07,484 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=691)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:48:07,577 [s2-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setConfigurationAsync(1323)) - s2@group-74690665B863: receive setConfiguration SetConfigurationRequest:client-638A5BB21BE3->s2@group-74690665B863, cid=3028, seq=null, RW, null, SET_UNCONDITIONALLY, servers:[s3, s0|localhost:15060, s2|localhost:15068], listeners:[]
2025-11-20 15:48:07,577 [s2-server-thread1] INFO  server.RaftServer$Division (LeaderStateImpl.java:startSetConfiguration(483)) - s2@group-74690665B863-LeaderStateImpl: startSetConfiguration SetConfigurationRequest:client-638A5BB21BE3->s2@group-74690665B863, cid=3028, seq=null, RW, null, SET_UNCONDITIONALLY, servers:[s3, s0|localhost:15060, s2|localhost:15068], listeners:[]
2025-11-20 15:48:07,577 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] INFO  leader.FollowerInfo (FollowerInfoImpl.java:setAttemptedToInstallSnapshot(154)) - Follower s2@group-74690665B863->s3 acknowledged installing snapshot
2025-11-20 15:48:07,578 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3538-t2,previous=<PROTO_DEFAULT>,leaderCommit=0,initializing? true,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:07,578 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=1)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:07,603 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3541-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:07,628 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3541-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:07,654 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3541-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:07,679 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3541-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:07,705 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3541-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:07,731 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3541-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:07,735 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=701)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:48:07,757 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3541-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:07,782 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3541-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:07,808 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3541-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:07,833 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3541-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:07,833 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=11)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:07,859 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3541-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:07,884 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3541-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:07,909 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3541-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:07,935 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3541-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:07,960 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3541-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:07,985 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3541-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:07,986 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=711)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:48:08,011 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3541-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:08,036 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3541-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:08,062 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3541-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:08,087 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3541-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:08,087 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=21)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:08,113 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3541-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:08,138 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3541-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:08,163 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3541-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:08,189 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3541-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:08,214 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3541-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:08,237 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=721)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:48:08,239 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3541-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:08,265 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3541-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:08,288 [main] INFO  impl.RaftServerTestUtil (RaftServerTestUtil.java:waitAndCheckNewConf(101)) - waitAndCheckNewConf: peers=[s3, s0|localhost:15060, s2|localhost:15068], deadPeers=[s0], printing ALL groups
  s3:  RUNNING CANDIDATE (CLOSED): s3@group-74690665B863:t0, leader=null, voted=, raftlog=Memoized:s3@group-74690665B863-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[s3, s0|localhost:15060, s2|localhost:15068]|listeners:[], old=null}
  s0:   CLOSED    LEADER (CLOSED): s0@group-74690665B863:t1, leader=s0, voted=s0, raftlog=Memoized:s0@group-74690665B863-SegmentedRaftLog:CLOSED:c0, conf=conf: {index: 0, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
  s1:  RUNNING  FOLLOWER (RUNNING): s1@group-74690665B863:t2, leader=s2, voted=s2, raftlog=Memoized:s1@group-74690665B863-SegmentedRaftLog:OPENED:c2:last(t:2, i:2), conf=conf: {index: 1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
  s2:  RUNNING    LEADER (RUNNING): s2@group-74690665B863:t2, leader=s2, voted=s2, raftlog=Memoized:s2@group-74690665B863-SegmentedRaftLog:OPENED:c2:last(t:2, i:2), conf=conf: {index: 1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:48:08,289 [main] INFO  impl.RaftServerTestUtil (RaftServerTestUtil.java:waitAndCheckNewConf(110)) - checking CANDIDATE (CLOSED): s3@group-74690665B863:t0, leader=null, voted=, raftlog=Memoized:s3@group-74690665B863-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[s3, s0|localhost:15060, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:48:08,289 [main] INFO  impl.RaftServerTestUtil (RaftServerTestUtil.java:waitAndCheckNewConf(110)) - checking    LEADER (CLOSED): s0@group-74690665B863:t1, leader=s0, voted=s0, raftlog=Memoized:s0@group-74690665B863-SegmentedRaftLog:CLOSED:c0, conf=conf: {index: 0, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:48:08,289 [main] INFO  impl.RaftServerTestUtil (RaftServerTestUtil.java:waitAndCheckNewConf(110)) - checking  FOLLOWER (RUNNING): s1@group-74690665B863:t2, leader=s2, voted=s2, raftlog=Memoized:s1@group-74690665B863-SegmentedRaftLog:OPENED:c2:last(t:2, i:2), conf=conf: {index: 1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:48:08,289 [main] WARN  impl.RaftServerTestUtil (JavaUtils.java:attempt(231)) - FAILED "waitAndCheckNewConf", attempt #8/10, sleep 900ms and then retry: org.opentest4j.AssertionFailedError: expected: <false> but was: <true>
2025-11-20 15:48:08,290 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3541-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:08,316 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3541-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:08,341 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3541-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:08,341 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=31)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:08,366 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3541-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:08,392 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3541-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:08,417 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3541-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:08,442 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3541-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:08,468 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3541-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:08,476 [s2@group-74690665B863-LeaderStateImpl] DEBUG server.RaftServer$Division (LeaderStateImpl.java:checkProgress(794)) - s2@group-74690665B863-LeaderStateImpl detects a follower s2@group-74690665B863->s3(c-1,m-1,n0, caughtUp=false, lastRpcSendTime=8, lastRpcResponseTime=1199) timeout (1199ms) for bootstrapping
2025-11-20 15:48:08,476 [s2@group-74690665B863-LeaderStateImpl] DEBUG server.RaftServer$Division (LeaderStateImpl.java:fail(1271)) - s2@group-74690665B863-ConfigurationStagingState: Fail to set configuration peers:[s3, s0|localhost:15060, s2|localhost:15068]|listeners:[] due to NOPROGRESS
2025-11-20 15:48:08,476 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] INFO  leader.LogAppenderDaemon (LogAppenderDaemon.java:run(85)) - s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon was interrupted: java.lang.InterruptedException: sleep interrupted
2025-11-20 15:48:08,488 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=731)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:48:08,677 [s2-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setConfigurationAsync(1323)) - s2@group-74690665B863: receive setConfiguration SetConfigurationRequest:client-638A5BB21BE3->s2@group-74690665B863, cid=3028, seq=null, RW, null, SET_UNCONDITIONALLY, servers:[s3, s0|localhost:15060, s2|localhost:15068], listeners:[]
2025-11-20 15:48:08,677 [s2-server-thread1] INFO  server.RaftServer$Division (LeaderStateImpl.java:startSetConfiguration(483)) - s2@group-74690665B863-LeaderStateImpl: startSetConfiguration SetConfigurationRequest:client-638A5BB21BE3->s2@group-74690665B863, cid=3028, seq=null, RW, null, SET_UNCONDITIONALLY, servers:[s3, s0|localhost:15060, s2|localhost:15068], listeners:[]
2025-11-20 15:48:08,678 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] INFO  leader.FollowerInfo (FollowerInfoImpl.java:setAttemptedToInstallSnapshot(154)) - Follower s2@group-74690665B863->s3 acknowledged installing snapshot
2025-11-20 15:48:08,678 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3571-t2,previous=<PROTO_DEFAULT>,leaderCommit=0,initializing? true,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:08,678 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=1)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:08,703 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3572-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:08,729 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3572-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:08,740 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=741)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:48:08,754 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3572-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:08,780 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3572-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:08,805 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3572-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:08,830 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3572-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:08,856 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3572-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:08,881 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3572-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:08,906 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3572-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:08,932 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3572-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:08,932 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=11)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:08,957 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3572-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:08,983 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3572-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:08,990 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=751)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:48:09,008 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3572-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:09,034 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3572-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:09,059 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3572-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:09,084 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3572-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:09,110 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3572-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:09,135 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3572-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:09,161 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3572-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:09,186 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3572-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:09,186 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=21)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:09,189 [main] INFO  impl.RaftServerTestUtil (RaftServerTestUtil.java:waitAndCheckNewConf(101)) - waitAndCheckNewConf: peers=[s3, s0|localhost:15060, s2|localhost:15068], deadPeers=[s0], printing ALL groups
  s3:  RUNNING CANDIDATE (CLOSED): s3@group-74690665B863:t0, leader=null, voted=, raftlog=Memoized:s3@group-74690665B863-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[s3, s0|localhost:15060, s2|localhost:15068]|listeners:[], old=null}
  s0:   CLOSED    LEADER (CLOSED): s0@group-74690665B863:t1, leader=s0, voted=s0, raftlog=Memoized:s0@group-74690665B863-SegmentedRaftLog:CLOSED:c0, conf=conf: {index: 0, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
  s1:  RUNNING  FOLLOWER (RUNNING): s1@group-74690665B863:t2, leader=s2, voted=s2, raftlog=Memoized:s1@group-74690665B863-SegmentedRaftLog:OPENED:c2:last(t:2, i:2), conf=conf: {index: 1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
  s2:  RUNNING    LEADER (RUNNING): s2@group-74690665B863:t2, leader=s2, voted=s2, raftlog=Memoized:s2@group-74690665B863-SegmentedRaftLog:OPENED:c2:last(t:2, i:2), conf=conf: {index: 1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:48:09,190 [main] INFO  impl.RaftServerTestUtil (RaftServerTestUtil.java:waitAndCheckNewConf(110)) - checking CANDIDATE (CLOSED): s3@group-74690665B863:t0, leader=null, voted=, raftlog=Memoized:s3@group-74690665B863-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[s3, s0|localhost:15060, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:48:09,190 [main] INFO  impl.RaftServerTestUtil (RaftServerTestUtil.java:waitAndCheckNewConf(110)) - checking    LEADER (CLOSED): s0@group-74690665B863:t1, leader=s0, voted=s0, raftlog=Memoized:s0@group-74690665B863-SegmentedRaftLog:CLOSED:c0, conf=conf: {index: 0, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:48:09,190 [main] INFO  impl.RaftServerTestUtil (RaftServerTestUtil.java:waitAndCheckNewConf(110)) - checking  FOLLOWER (RUNNING): s1@group-74690665B863:t2, leader=s2, voted=s2, raftlog=Memoized:s1@group-74690665B863-SegmentedRaftLog:OPENED:c2:last(t:2, i:2), conf=conf: {index: 1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:48:09,190 [main] WARN  impl.RaftServerTestUtil (JavaUtils.java:attempt(231)) - FAILED "waitAndCheckNewConf", attempt #9/10, sleep 900ms and then retry: org.opentest4j.AssertionFailedError: expected: <false> but was: <true>
2025-11-20 15:48:09,212 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3572-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:09,237 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3572-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:09,241 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=761)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:48:09,262 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3572-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:09,288 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3572-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:09,291 [Timer-5] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$7(340)) - TIMED-PRINT: printing ALL groups
  s3:  RUNNING CANDIDATE (CLOSED): s3@group-74690665B863:t0, leader=null, voted=, raftlog=Memoized:s3@group-74690665B863-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[s3, s0|localhost:15060, s2|localhost:15068]|listeners:[], old=null}
  s0:   CLOSED    LEADER (CLOSED): s0@group-74690665B863:t1, leader=s0, voted=s0, raftlog=Memoized:s0@group-74690665B863-SegmentedRaftLog:CLOSED:c0, conf=conf: {index: 0, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
  s1:  RUNNING  FOLLOWER (RUNNING): s1@group-74690665B863:t2, leader=s2, voted=s2, raftlog=Memoized:s1@group-74690665B863-SegmentedRaftLog:OPENED:c2:last(t:2, i:2), conf=conf: {index: 1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
  s2:  RUNNING    LEADER (RUNNING): s2@group-74690665B863:t2, leader=s2, voted=s2, raftlog=Memoized:s2@group-74690665B863-SegmentedRaftLog:OPENED:c2:last(t:2, i:2), conf=conf: {index: 1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}.
2025-11-20 15:48:09,313 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3572-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:09,339 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3572-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:09,364 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3572-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:09,377 [s2@group-74690665B863-LeaderStateImpl] DEBUG server.RaftServer$Division (LeaderStateImpl.java:checkProgress(794)) - s2@group-74690665B863-LeaderStateImpl detects a follower s2@group-74690665B863->s3(c-1,m-1,n0, caughtUp=false, lastRpcSendTime=12, lastRpcResponseTime=999) timeout (999ms) for bootstrapping
2025-11-20 15:48:09,377 [s2@group-74690665B863-LeaderStateImpl] DEBUG server.RaftServer$Division (LeaderStateImpl.java:fail(1271)) - s2@group-74690665B863-ConfigurationStagingState: Fail to set configuration peers:[s3, s0|localhost:15060, s2|localhost:15068]|listeners:[] due to NOPROGRESS
2025-11-20 15:48:09,377 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] INFO  leader.LogAppenderDaemon (LogAppenderDaemon.java:run(85)) - s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon was interrupted: java.lang.InterruptedException: sleep interrupted
2025-11-20 15:48:09,493 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=771)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:48:09,744 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=781)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:48:09,778 [s2-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setConfigurationAsync(1323)) - s2@group-74690665B863: receive setConfiguration SetConfigurationRequest:client-638A5BB21BE3->s2@group-74690665B863, cid=3028, seq=null, RW, null, SET_UNCONDITIONALLY, servers:[s3, s0|localhost:15060, s2|localhost:15068], listeners:[]
2025-11-20 15:48:09,779 [s2-server-thread1] INFO  server.RaftServer$Division (LeaderStateImpl.java:startSetConfiguration(483)) - s2@group-74690665B863-LeaderStateImpl: startSetConfiguration SetConfigurationRequest:client-638A5BB21BE3->s2@group-74690665B863, cid=3028, seq=null, RW, null, SET_UNCONDITIONALLY, servers:[s3, s0|localhost:15060, s2|localhost:15068], listeners:[]
2025-11-20 15:48:09,779 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] INFO  leader.FollowerInfo (FollowerInfoImpl.java:setAttemptedToInstallSnapshot(154)) - Follower s2@group-74690665B863->s3 acknowledged installing snapshot
2025-11-20 15:48:09,779 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3604-t2,previous=<PROTO_DEFAULT>,leaderCommit=0,initializing? true,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:09,780 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=1)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:09,805 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3605-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:09,830 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3605-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:09,856 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3605-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:09,881 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3605-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:09,907 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3605-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:09,932 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3605-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:09,957 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3605-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:09,983 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3605-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:09,995 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s0-LogAppenderDefault: Failed to appendEntries (retry=791)
java.io.IOException: The peer s0 is not alive.
	at org.apache.ratis.server.simulation.SimulatedRequestReply.sendRequest(SimulatedRequestReply.java:121)
	at org.apache.ratis.server.simulation.SimulatedServerRpc.appendEntries(SimulatedServerRpc.java:115)
	at org.apache.ratis.server.leader.LogAppenderDefault.sendAppendEntriesWithRetries(LogAppenderDefault.java:82)
	at org.apache.ratis.server.leader.LogAppenderDefault.run(LogAppenderDefault.java:163)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:80)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:48:10,008 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3605-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:10,034 [HandlerDaemon-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3605-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:10,034 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] WARN  leader.LogAppender (LogAppenderDefault.java:sendAppendEntriesWithRetries(95)) - s2@group-74690665B863->s3-LogAppenderDefault: Failed to appendEntries (retry=11)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:10,059 [HandlerDaemon-0] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3605-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:10,085 [HandlerDaemon-1] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1508)) - s3@group-74690665B863: Failed appendEntries* s2->s3#3605-t2,previous=<PROTO_DEFAULT>,leaderCommit=2,initializing? true,entries: size=3, first=(t:1, i:0), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15060"dataStreamAddress:"localhost:15063"clientAddress:"localhost:15062"adminAddress:"localhost:15061"startupRole:FOLLOWER, id:"s1"address:"localhost:15064"dataStreamAddress:"localhost:15067"clientAddress:"localhost:15066"adminAddress:"localhost:15065"startupRole:FOLLOWER, id:"s2"address:"localhost:15068"dataStreamAddress:"localhost:15071"clientAddress:"localhost:15070"adminAddress:"localhost:15069"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s3@group-74690665B863 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:263)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1499)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntries(RaftServerImpl.java:1482)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntries(RaftServerProxy.java:667)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:163)
	at org.apache.ratis.server.simulation.SimulatedServerRpc$1.handleRequest(SimulatedServerRpc.java:153)
	at org.apache.ratis.server.simulation.RequestHandler.handleRequest(RequestHandler.java:91)
	at org.apache.ratis.server.simulation.RequestHandler$HandlerDaemon.run(RequestHandler.java:125)
2025-11-20 15:48:10,090 [main] INFO  impl.RaftServerTestUtil (RaftServerTestUtil.java:waitAndCheckNewConf(101)) - waitAndCheckNewConf: peers=[s3, s0|localhost:15060, s2|localhost:15068], deadPeers=[s0], printing ALL groups
  s3:  RUNNING CANDIDATE (CLOSED): s3@group-74690665B863:t0, leader=null, voted=, raftlog=Memoized:s3@group-74690665B863-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[s3, s0|localhost:15060, s2|localhost:15068]|listeners:[], old=null}
  s0:   CLOSED    LEADER (CLOSED): s0@group-74690665B863:t1, leader=s0, voted=s0, raftlog=Memoized:s0@group-74690665B863-SegmentedRaftLog:CLOSED:c0, conf=conf: {index: 0, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
  s1:  RUNNING  FOLLOWER (RUNNING): s1@group-74690665B863:t2, leader=s2, voted=s2, raftlog=Memoized:s1@group-74690665B863-SegmentedRaftLog:OPENED:c2:last(t:2, i:2), conf=conf: {index: 1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
  s2:  RUNNING    LEADER (RUNNING): s2@group-74690665B863:t2, leader=s2, voted=s2, raftlog=Memoized:s2@group-74690665B863-SegmentedRaftLog:OPENED:c2:last(t:2, i:2), conf=conf: {index: 1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:48:10,091 [main] INFO  impl.RaftServerTestUtil (RaftServerTestUtil.java:waitAndCheckNewConf(110)) - checking CANDIDATE (CLOSED): s3@group-74690665B863:t0, leader=null, voted=, raftlog=Memoized:s3@group-74690665B863-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[s3, s0|localhost:15060, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:48:10,091 [main] INFO  impl.RaftServerTestUtil (RaftServerTestUtil.java:waitAndCheckNewConf(110)) - checking    LEADER (CLOSED): s0@group-74690665B863:t1, leader=s0, voted=s0, raftlog=Memoized:s0@group-74690665B863-SegmentedRaftLog:CLOSED:c0, conf=conf: {index: 0, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:48:10,091 [main] INFO  impl.RaftServerTestUtil (RaftServerTestUtil.java:waitAndCheckNewConf(110)) - checking  FOLLOWER (RUNNING): s1@group-74690665B863:t2, leader=s2, voted=s2, raftlog=Memoized:s1@group-74690665B863-SegmentedRaftLog:OPENED:c2:last(t:2, i:2), conf=conf: {index: 1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:48:10,091 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(796)) - ************************************************************** 
2025-11-20 15:48:10,091 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(797)) - *** 
2025-11-20 15:48:10,091 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(798)) - ***     Stopping MiniRaftClusterWithSimulatedRpc
2025-11-20 15:48:10,091 [Thread-650] ERROR simulation.TestRaftReconfigurationWithSimulatedRpc (RaftReconfigurationBaseTest.java:lambda$runTestKillLeaderDuringReconf$20(540)) - Failed to setConf
java.io.InterruptedIOException: retry policy=RetryForeverWithSleep(sleepTime = 100ms)
	at org.apache.ratis.client.impl.BlockingImpl.sendRequestWithRetry(BlockingImpl.java:138)
	at org.apache.ratis.client.impl.AdminImpl.setConfiguration(AdminImpl.java:46)
	at org.apache.ratis.client.api.AdminApi.setConfiguration(AdminApi.java:51)
	at org.apache.ratis.client.api.AdminApi.setConfiguration(AdminApi.java:40)
	at org.apache.ratis.server.impl.RaftReconfigurationBaseTest.lambda$runTestKillLeaderDuringReconf$20(RaftReconfigurationBaseTest.java:532)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-11-20 15:48:10,091 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(799)) - *** 
2025-11-20 15:48:10,091 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(800)) - ************************************************************** 
2025-11-20 15:48:10,092 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(801)) - printing ALL groups
  s3:  RUNNING CANDIDATE (CLOSED): s3@group-74690665B863:t0, leader=null, voted=, raftlog=Memoized:s3@group-74690665B863-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[s3, s0|localhost:15060, s2|localhost:15068]|listeners:[], old=null}
  s0:   CLOSED    LEADER (CLOSED): s0@group-74690665B863:t1, leader=s0, voted=s0, raftlog=Memoized:s0@group-74690665B863-SegmentedRaftLog:CLOSED:c0, conf=conf: {index: 0, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
  s1:  RUNNING  FOLLOWER (RUNNING): s1@group-74690665B863:t2, leader=s2, voted=s2, raftlog=Memoized:s1@group-74690665B863-SegmentedRaftLog:OPENED:c2:last(t:2, i:2), conf=conf: {index: 1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
  s2:  RUNNING    LEADER (RUNNING): s2@group-74690665B863:t2, leader=s2, voted=s2, raftlog=Memoized:s2@group-74690665B863-SegmentedRaftLog:OPENED:c2:last(t:2, i:2), conf=conf: {index: 1, cur=peers:[s0|localhost:15060, s1|localhost:15064, s2|localhost:15068]|listeners:[], old=null}
2025-11-20 15:48:10,092 [MiniRaftCluster-21] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$9(425)) - s3: close
2025-11-20 15:48:10,092 [MiniRaftCluster-23] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$9(425)) - s1: close
2025-11-20 15:48:10,092 [HandlerDaemon-1] INFO  simulation.RequestHandler (RequestHandler.java:run(127)) - s3.clientHandler1 is interrupted by java.io.InterruptedIOException: 
2025-11-20 15:48:10,092 [HandlerDaemon-0] INFO  simulation.RequestHandler (RequestHandler.java:run(127)) - s3.clientHandler0 is interrupted by java.io.InterruptedIOException: 
2025-11-20 15:48:10,092 [HandlerDaemon-2] INFO  simulation.RequestHandler (RequestHandler.java:run(127)) - s3.clientHandler2 is interrupted by java.io.InterruptedIOException: 
2025-11-20 15:48:10,093 [HandlerDaemon-2] INFO  simulation.RequestHandler (RequestHandler.java:run(127)) - s3.serverHandler2 is interrupted by java.io.InterruptedIOException: 
2025-11-20 15:48:10,093 [HandlerDaemon-1] INFO  simulation.RequestHandler (RequestHandler.java:run(127)) - s3.serverHandler1 is interrupted by java.io.InterruptedIOException: 
2025-11-20 15:48:10,093 [MiniRaftCluster-24] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$9(425)) - s2: close
2025-11-20 15:48:10,093 [HandlerDaemon-0] INFO  simulation.RequestHandler (RequestHandler.java:run(127)) - s3.serverHandler0 is interrupted by java.io.InterruptedIOException: 
2025-11-20 15:48:10,093 [s1-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$1(528)) - s1@group-74690665B863: shutdown
2025-11-20 15:48:10,093 [s1-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:unregister(74)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-74690665B863,id=s1
2025-11-20 15:48:10,093 [s1-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - s1: shutdown s1@group-74690665B863-FollowerState
2025-11-20 15:48:10,093 [s1-impl-thread1] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(164)) - s1@group-74690665B863-StateMachineUpdater: set stopIndex = 2
2025-11-20 15:48:10,093 [s1@group-74690665B863-FollowerState] INFO  impl.FollowerState (FollowerState.java:runImpl(170)) - s1@group-74690665B863-FollowerState was interrupted
2025-11-20 15:48:10,094 [HandlerDaemon-0] INFO  simulation.RequestHandler (RequestHandler.java:run(127)) - s1.clientHandler0 is interrupted by java.io.InterruptedIOException: 
2025-11-20 15:48:10,094 [s1@group-74690665B863-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stop(141)) - s1@group-74690665B863-StateMachineUpdater: closing BaseStateMachine, lastApplied=(t:2, i:2)
2025-11-20 15:48:10,094 [HandlerDaemon-1] INFO  simulation.RequestHandler (RequestHandler.java:run(127)) - s1.clientHandler1 is interrupted by java.io.InterruptedIOException: 
2025-11-20 15:48:10,094 [HandlerDaemon-2] INFO  simulation.RequestHandler (RequestHandler.java:run(127)) - s1.clientHandler2 is interrupted by java.io.InterruptedIOException: 
2025-11-20 15:48:10,094 [HandlerDaemon-0] INFO  simulation.RequestHandler (RequestHandler.java:run(127)) - s1.serverHandler0 is interrupted by java.io.InterruptedIOException: 
2025-11-20 15:48:10,094 [JvmPauseMonitor23] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(152)) - JvmPauseMonitor-s3: Stopped
2025-11-20 15:48:10,094 [HandlerDaemon-2] INFO  simulation.RequestHandler (RequestHandler.java:run(127)) - s1.serverHandler2 is interrupted by java.io.InterruptedIOException: 
2025-11-20 15:48:10,095 [HandlerDaemon-1] INFO  simulation.RequestHandler (RequestHandler.java:run(127)) - s1.serverHandler1 is interrupted by java.io.InterruptedIOException: 
2025-11-20 15:48:10,095 [s1@group-74690665B863-cacheEviction-AwaitToRun] INFO  util.AwaitToRun (AwaitToRun.java:run(49)) - s1@group-74690665B863-cacheEviction-AwaitToRun-AwaitForSignal is interrupted
2025-11-20 15:48:10,095 [HandlerDaemon-0] INFO  simulation.RequestHandler (RequestHandler.java:run(127)) - s2.clientHandler0 is interrupted by java.io.InterruptedIOException: 
2025-11-20 15:48:10,095 [s2-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$1(528)) - s2@group-74690665B863: shutdown
2025-11-20 15:48:10,095 [s2-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:unregister(74)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-74690665B863,id=s2
2025-11-20 15:48:10,095 [HandlerDaemon-2] INFO  simulation.RequestHandler (RequestHandler.java:run(127)) - s2.clientHandler2 is interrupted by java.io.InterruptedIOException: 
2025-11-20 15:48:10,095 [s2-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(103)) - s2: shutdown s2@group-74690665B863-LeaderStateImpl
2025-11-20 15:48:10,095 [HandlerDaemon-1] INFO  simulation.RequestHandler (RequestHandler.java:run(127)) - s2.clientHandler1 is interrupted by java.io.InterruptedIOException: 
2025-11-20 15:48:10,096 [s2-impl-thread1] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(281)) - s2@group-74690665B863-PendingRequests: sendNotLeaderResponses
2025-11-20 15:48:10,096 [HandlerDaemon-0] INFO  simulation.RequestHandler (RequestHandler.java:run(127)) - s2.serverHandler0 is interrupted by java.io.InterruptedIOException: 
2025-11-20 15:48:10,096 [HandlerDaemon-1] INFO  simulation.RequestHandler (RequestHandler.java:run(127)) - s2.serverHandler1 is interrupted by java.io.InterruptedIOException: 
2025-11-20 15:48:10,096 [s2@group-74690665B863->s1-LogAppenderDefault-LogAppenderDaemon] INFO  leader.LogAppenderDaemon (LogAppenderDaemon.java:run(85)) - s2@group-74690665B863->s1-LogAppenderDefault-LogAppenderDaemon was interrupted: java.lang.InterruptedException
2025-11-20 15:48:10,096 [HandlerDaemon-2] INFO  simulation.RequestHandler (RequestHandler.java:run(127)) - s2.serverHandler2 is interrupted by java.io.InterruptedIOException: 
2025-11-20 15:48:10,096 [s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon] INFO  leader.LogAppenderDaemon (LogAppenderDaemon.java:run(85)) - s2@group-74690665B863->s3-LogAppenderDefault-LogAppenderDaemon was interrupted: java.lang.InterruptedException: sleep interrupted
2025-11-20 15:48:10,096 [s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon] INFO  leader.LogAppenderDaemon (LogAppenderDaemon.java:run(85)) - s2@group-74690665B863->s0-LogAppenderDefault-LogAppenderDaemon was interrupted: java.lang.InterruptedException: sleep interrupted
2025-11-20 15:48:10,097 [s2@group-74690665B863-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stop(141)) - s2@group-74690665B863-StateMachineUpdater: closing BaseStateMachine, lastApplied=(t:2, i:2)
2025-11-20 15:48:10,097 [s2-impl-thread1] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(164)) - s2@group-74690665B863-StateMachineUpdater: set stopIndex = 2
2025-11-20 15:48:10,097 [s2@group-74690665B863-cacheEviction-AwaitToRun] INFO  util.AwaitToRun (AwaitToRun.java:run(49)) - s2@group-74690665B863-cacheEviction-AwaitToRun-AwaitForSignal is interrupted
2025-11-20 15:48:10,164 [s2-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(254)) - s2@group-74690665B863-SegmentedRaftLogWorker close()
2025-11-20 15:48:10,165 [s1-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(254)) - s1@group-74690665B863-SegmentedRaftLogWorker close()
2025-11-20 15:48:10,165 [JvmPauseMonitor22] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(152)) - JvmPauseMonitor-s2: Stopped
2025-11-20 15:48:10,165 [JvmPauseMonitor21] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(152)) - JvmPauseMonitor-s1: Stopped
2025-11-20 15:48:10,165 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(820)) - MiniRaftClusterWithSimulatedRpc shutdown completed
