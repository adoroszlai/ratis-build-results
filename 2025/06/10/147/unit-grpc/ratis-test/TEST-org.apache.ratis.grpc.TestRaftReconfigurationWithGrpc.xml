<?xml version="1.0" encoding="UTF-8"?>
<testsuite xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="https://maven.apache.org/surefire/maven-surefire-plugin/xsd/surefire-test-report-3.0.xsd" version="3.0" name="org.apache.ratis.grpc.TestRaftReconfigurationWithGrpc" time="106.749" tests="18" errors="1" skipped="0" failures="0">
  <properties>
    <property name="awt.toolkit" value="sun.awt.X11.XToolkit"/>
    <property name="file.encoding.pkg" value="sun.io"/>
    <property name="java.specification.version" value="1.8"/>
    <property name="sun.cpu.isalist" value=""/>
    <property name="sun.jnu.encoding" value="UTF-8"/>
    <property name="java.class.path" value="/home/runner/work/ratis/ratis/ratis-test/target/test-classes:/home/runner/work/ratis/ratis/ratis-test/target/classes:/home/runner/work/ratis/ratis/ratis-common/target/classes:/home/runner/.m2/repository/org/apache/ratis/ratis-thirdparty-misc/1.0.9/ratis-thirdparty-misc-1.0.9.jar:/home/runner/work/ratis/ratis/ratis-proto/target/classes:/home/runner/.m2/repository/jakarta/annotation/jakarta.annotation-api/1.3.5/jakarta.annotation-api-1.3.5.jar:/home/runner/work/ratis/ratis/ratis-common/target/test-classes:/home/runner/work/ratis/ratis/ratis-client/target/classes:/home/runner/work/ratis/ratis/ratis-server/target/classes:/home/runner/work/ratis/ratis/ratis-server-api/target/classes:/home/runner/work/ratis/ratis/ratis-metrics-api/target/classes:/home/runner/work/ratis/ratis/ratis-server/target/test-classes:/home/runner/work/ratis/ratis/ratis-metrics-default/target/classes:/home/runner/work/ratis/ratis/ratis-netty/target/classes:/home/runner/work/ratis/ratis/ratis-netty/target/test-classes:/home/runner/work/ratis/ratis/ratis-grpc/target/classes:/home/runner/work/ratis/ratis/ratis-grpc/target/test-classes:/home/runner/work/ratis/ratis/ratis-shell/target/classes:/home/runner/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/runner/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/runner/.m2/repository/org/javassist/javassist/3.28.0-GA/javassist-3.28.0-GA.jar:/home/runner/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:/home/runner/.m2/repository/org/bouncycastle/bcprov-jdk18on/1.78.1/bcprov-jdk18on-1.78.1.jar:/home/runner/.m2/repository/org/bouncycastle/bcpkix-jdk18on/1.78.1/bcpkix-jdk18on-1.78.1.jar:/home/runner/.m2/repository/org/bouncycastle/bcutil-jdk18on/1.78.1/bcutil-jdk18on-1.78.1.jar:/home/runner/.m2/repository/org/slf4j/slf4j-api/2.0.7/slf4j-api-2.0.7.jar:/home/runner/.m2/repository/org/slf4j/slf4j-reload4j/2.0.7/slf4j-reload4j-2.0.7.jar:/home/runner/.m2/repository/ch/qos/reload4j/reload4j/1.2.22/reload4j-1.2.22.jar:/home/runner/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.12.2/junit-jupiter-engine-5.12.2.jar:/home/runner/.m2/repository/org/junit/platform/junit-platform-engine/1.12.2/junit-platform-engine-1.12.2.jar:/home/runner/.m2/repository/org/apiguardian/apiguardian-api/1.1.2/apiguardian-api-1.1.2.jar:/home/runner/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.12.2/junit-jupiter-api-5.12.2.jar:/home/runner/.m2/repository/org/opentest4j/opentest4j/1.3.0/opentest4j-1.3.0.jar:/home/runner/.m2/repository/org/junit/platform/junit-platform-commons/1.12.2/junit-platform-commons-1.12.2.jar:/home/runner/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.12.2/junit-jupiter-params-5.12.2.jar:/home/runner/.m2/repository/org/junit/platform/junit-platform-launcher/1.12.2/junit-platform-launcher-1.12.2.jar:/home/runner/.m2/repository/org/mockito/mockito-core/4.11.0/mockito-core-4.11.0.jar:/home/runner/.m2/repository/net/bytebuddy/byte-buddy/1.12.19/byte-buddy-1.12.19.jar:/home/runner/.m2/repository/net/bytebuddy/byte-buddy-agent/1.12.19/byte-buddy-agent-1.12.19.jar:/home/runner/.m2/repository/org/objenesis/objenesis/3.3/objenesis-3.3.jar:/home/runner/work/ratis/ratis/ratis-test/target/gradle-enterprise/test-listeners.jar:"/>
    <property name="java.vm.vendor" value="Temurin"/>
    <property name="sun.arch.data.model" value="64"/>
    <property name="java.vendor.url" value="https://adoptium.net/"/>
    <property name="user.timezone" value="Etc/UTC"/>
    <property name="java.vm.specification.version" value="1.8"/>
    <property name="os.name" value="Linux"/>
    <property name="sun.java.launcher" value="SUN_STANDARD"/>
    <property name="sun.boot.library.path" value="/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/amd64"/>
    <property name="sun.java.command" value="/home/runner/work/ratis/ratis/ratis-test/target/surefire/surefirebooter5371293937203463112.jar /home/runner/work/ratis/ratis/ratis-test/target/surefire 2025-06-10T17-00-32_417-jvmRun1 surefire6042856782109461666tmp surefire_32918914544128253233tmp"/>
    <property name="surefire.test.class.path" value="/home/runner/work/ratis/ratis/ratis-test/target/test-classes:/home/runner/work/ratis/ratis/ratis-test/target/classes:/home/runner/work/ratis/ratis/ratis-common/target/classes:/home/runner/.m2/repository/org/apache/ratis/ratis-thirdparty-misc/1.0.9/ratis-thirdparty-misc-1.0.9.jar:/home/runner/work/ratis/ratis/ratis-proto/target/classes:/home/runner/.m2/repository/jakarta/annotation/jakarta.annotation-api/1.3.5/jakarta.annotation-api-1.3.5.jar:/home/runner/work/ratis/ratis/ratis-common/target/test-classes:/home/runner/work/ratis/ratis/ratis-client/target/classes:/home/runner/work/ratis/ratis/ratis-server/target/classes:/home/runner/work/ratis/ratis/ratis-server-api/target/classes:/home/runner/work/ratis/ratis/ratis-metrics-api/target/classes:/home/runner/work/ratis/ratis/ratis-server/target/test-classes:/home/runner/work/ratis/ratis/ratis-metrics-default/target/classes:/home/runner/work/ratis/ratis/ratis-netty/target/classes:/home/runner/work/ratis/ratis/ratis-netty/target/test-classes:/home/runner/work/ratis/ratis/ratis-grpc/target/classes:/home/runner/work/ratis/ratis/ratis-grpc/target/test-classes:/home/runner/work/ratis/ratis/ratis-shell/target/classes:/home/runner/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/runner/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/runner/.m2/repository/org/javassist/javassist/3.28.0-GA/javassist-3.28.0-GA.jar:/home/runner/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:/home/runner/.m2/repository/org/bouncycastle/bcprov-jdk18on/1.78.1/bcprov-jdk18on-1.78.1.jar:/home/runner/.m2/repository/org/bouncycastle/bcpkix-jdk18on/1.78.1/bcpkix-jdk18on-1.78.1.jar:/home/runner/.m2/repository/org/bouncycastle/bcutil-jdk18on/1.78.1/bcutil-jdk18on-1.78.1.jar:/home/runner/.m2/repository/org/slf4j/slf4j-api/2.0.7/slf4j-api-2.0.7.jar:/home/runner/.m2/repository/org/slf4j/slf4j-reload4j/2.0.7/slf4j-reload4j-2.0.7.jar:/home/runner/.m2/repository/ch/qos/reload4j/reload4j/1.2.22/reload4j-1.2.22.jar:/home/runner/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.12.2/junit-jupiter-engine-5.12.2.jar:/home/runner/.m2/repository/org/junit/platform/junit-platform-engine/1.12.2/junit-platform-engine-1.12.2.jar:/home/runner/.m2/repository/org/apiguardian/apiguardian-api/1.1.2/apiguardian-api-1.1.2.jar:/home/runner/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.12.2/junit-jupiter-api-5.12.2.jar:/home/runner/.m2/repository/org/opentest4j/opentest4j/1.3.0/opentest4j-1.3.0.jar:/home/runner/.m2/repository/org/junit/platform/junit-platform-commons/1.12.2/junit-platform-commons-1.12.2.jar:/home/runner/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.12.2/junit-jupiter-params-5.12.2.jar:/home/runner/.m2/repository/org/junit/platform/junit-platform-launcher/1.12.2/junit-platform-launcher-1.12.2.jar:/home/runner/.m2/repository/org/mockito/mockito-core/4.11.0/mockito-core-4.11.0.jar:/home/runner/.m2/repository/net/bytebuddy/byte-buddy/1.12.19/byte-buddy-1.12.19.jar:/home/runner/.m2/repository/net/bytebuddy/byte-buddy-agent/1.12.19/byte-buddy-agent-1.12.19.jar:/home/runner/.m2/repository/org/objenesis/objenesis/3.3/objenesis-3.3.jar:/home/runner/work/ratis/ratis/ratis-test/target/gradle-enterprise/test-listeners.jar:"/>
    <property name="sun.cpu.endian" value="little"/>
    <property name="user.home" value="/home/runner"/>
    <property name="user.language" value="en"/>
    <property name="java.specification.vendor" value="Oracle Corporation"/>
    <property name="java.home" value="/usr/lib/jvm/temurin-8-jdk-amd64/jre"/>
    <property name="basedir" value="/home/runner/work/ratis/ratis/ratis-test"/>
    <property name="file.separator" value="/"/>
    <property name="line.separator" value="&#10;"/>
    <property name="java.vm.specification.vendor" value="Oracle Corporation"/>
    <property name="java.specification.name" value="Java Platform API Specification"/>
    <property name="java.awt.graphicsenv" value="sun.awt.X11GraphicsEnvironment"/>
    <property name="surefire.real.class.path" value="/home/runner/work/ratis/ratis/ratis-test/target/surefire/surefirebooter5371293937203463112.jar:/home/runner/.m2/repository/org/jacoco/org.jacoco.agent/0.8.12/org.jacoco.agent-0.8.12-runtime.jar"/>
    <property name="sun.boot.class.path" value="/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/resources.jar:/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/rt.jar:/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/sunrsasign.jar:/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/jsse.jar:/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/jce.jar:/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/charsets.jar:/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/jfr.jar:/usr/lib/jvm/temurin-8-jdk-amd64/jre/classes"/>
    <property name="sun.management.compiler" value="HotSpot 64-Bit Tiered Compilers"/>
    <property name="java.runtime.version" value="1.8.0_452-b09"/>
    <property name="java.net.preferIPv4Stack" value="true"/>
    <property name="user.name" value="runner"/>
    <property name="path.separator" value=":"/>
    <property name="os.version" value="6.11.0-1015-azure"/>
    <property name="java.endorsed.dirs" value="/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/endorsed"/>
    <property name="java.runtime.name" value="OpenJDK Runtime Environment"/>
    <property name="com.gradle.maven.scan.extension.test.listener.junitplatform.NestedExecutionSafeDelegatingTestExecutionListener" value="5609159b"/>
    <property name="file.encoding" value="UTF-8"/>
    <property name="java.vm.name" value="OpenJDK 64-Bit Server VM"/>
    <property name="develocity.listener.surefire.forkId" value="1"/>
    <property name="localRepository" value="/home/runner/.m2/repository"/>
    <property name="java.vendor.url.bug" value="https://github.com/adoptium/adoptium-support/issues"/>
    <property name="java.io.tmpdir" value="/tmp"/>
    <property name="java.version" value="1.8.0_452"/>
    <property name="user.dir" value="/home/runner/work/ratis/ratis/ratis-test"/>
    <property name="os.arch" value="amd64"/>
    <property name="ratis.tmp.dir" value="/home/runner/work/ratis/ratis/ratis-test/target/tmp"/>
    <property name="java.vm.specification.name" value="Java Virtual Machine Specification"/>
    <property name="java.awt.printerjob" value="sun.print.PSPrinterJob"/>
    <property name="ratis.log.dir" value="/home/runner/work/ratis/ratis/ratis-test/target/log"/>
    <property name="sun.os.patch.level" value="unknown"/>
    <property name="org.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads" value="false"/>
    <property name="java.library.path" value="/usr/java/packages/lib/amd64:/usr/lib64:/lib64:/lib:/usr/lib"/>
    <property name="java.vm.info" value="mixed mode"/>
    <property name="java.vendor" value="Temurin"/>
    <property name="java.vm.version" value="25.452-b09"/>
    <property name="java.specification.maintenance.version" value="6"/>
    <property name="develocity.listener.port" value="37407"/>
    <property name="java.ext.dirs" value="/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/ext:/usr/java/packages/lib/ext"/>
    <property name="sun.io.unicode.encoding" value="UnicodeLittle"/>
    <property name="java.class.version" value="52.0"/>
  </properties>
  <testcase name="testChangeMajority" classname="org.apache.ratis.grpc.TestRaftReconfigurationWithGrpc" time="2.6"/>
  <testcase name="testNoChangeRequest" classname="org.apache.ratis.grpc.TestRaftReconfigurationWithGrpc" time="1.598"/>
  <testcase name="testRemovePeers" classname="org.apache.ratis.grpc.TestRaftReconfigurationWithGrpc" time="2.614"/>
  <testcase name="testAddRemovePeers" classname="org.apache.ratis.grpc.TestRaftReconfigurationWithGrpc" time="2.677"/>
  <testcase name="testRevertConfigurationChange" classname="org.apache.ratis.grpc.TestRaftReconfigurationWithGrpc" time="3.905"/>
  <testcase name="testBootstrapReconf" classname="org.apache.ratis.grpc.TestRaftReconfigurationWithGrpc" time="3.884"/>
  <testcase name="testAddPeers" classname="org.apache.ratis.grpc.TestRaftReconfigurationWithGrpc" time="1.92"/>
  <testcase name="testSetConfigurationInAddMode" classname="org.apache.ratis.grpc.TestRaftReconfigurationWithGrpc" time="1.595"/>
  <testcase name="testLeaderStepDown" classname="org.apache.ratis.grpc.TestRaftReconfigurationWithGrpc" time="2.099"/>
  <testcase name="testLeaderNotReadyException" classname="org.apache.ratis.grpc.TestRaftReconfigurationWithGrpc" time="3.469"/>
  <testcase name="testLeaderElectionWhenChangeFromSingleToHA" classname="org.apache.ratis.grpc.TestRaftReconfigurationWithGrpc" time="55.257">
    <error type="java.lang.IllegalStateException"><![CDATA[java.lang.IllegalStateException: 
No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t7, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:7, i:6), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
	at org.apache.ratis.server.impl.MiniRaftCluster.newIllegalStateExceptionForNoLeaders(MiniRaftCluster.java:586)
	at org.apache.ratis.RaftTestUtil.lambda$waitForLeader$1(RaftTestUtil.java:111)
	at org.apache.ratis.server.impl.MiniRaftCluster.getLeader(MiniRaftCluster.java:620)
	at org.apache.ratis.server.impl.MiniRaftCluster.getLeader(MiniRaftCluster.java:613)
	at org.apache.ratis.RaftTestUtil.lambda$waitForLeader$3(RaftTestUtil.java:120)
	at org.apache.ratis.util.JavaUtils.attempt(JavaUtils.java:225)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:118)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:99)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:94)
	at org.apache.ratis.server.impl.RaftReconfigurationBaseTest.lambda$testLeaderElectionWhenChangeFromSingleToHA$2(RaftReconfigurationBaseTest.java:180)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:142)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:120)
	at org.apache.ratis.server.impl.RaftReconfigurationBaseTest.testLeaderElectionWhenChangeFromSingleToHA(RaftReconfigurationBaseTest.java:159)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
]]></error>
    <system-out><![CDATA[2025-06-10 17:02:59,484 [main] INFO  util.LogUtils (Slf4jUtils.java:setLogLevel(38)) - Successfully set org.apache.ratis.conf.ConfUtils log level to WARN
2025-06-10 17:02:59,484 [main] INFO  util.LogUtils (Slf4jUtils.java:setLogLevel(38)) - Successfully set org.apache.ratis.util.FileUtils log level to TRACE
2025-06-10 17:02:59,485 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:runWithNewCluster(136)) - Running runWithNewCluster
2025-06-10 17:02:59,486 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:<init>(308)) - new MiniRaftClusterWithGrpc with group-6876B2C99B77:[s0|localhost:15176]
2025-06-10 17:02:59,486 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(341)) - .............................................................. 
2025-06-10 17:02:59,486 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(342)) - ... 
2025-06-10 17:02:59,486 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(343)) - ...     Starting MiniRaftClusterWithGrpc
2025-06-10 17:02:59,486 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(344)) - ... 
2025-06-10 17:02:59,486 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(345)) - .............................................................. 
2025-06-10 17:02:59,487 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:initServers(320)) - servers = {}
2025-06-10 17:02:59,487 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(385)) - newRaftServer: s0, group-6876B2C99B77:[s0|localhost:15176], format? true
2025-06-10 17:02:59,487 [main] TRACE util.FileUtils (FileUtils.java:deleteFully(351)) - deleteFully target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0
2025-06-10 17:02:59,487 [main] TRACE util.FileUtils (FileUtils.java:deleteFully(364)) - deleteFully: target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0 does not exist.
2025-06-10 17:02:59,487 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(390)) - Formatted directory target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0
2025-06-10 17:02:59,488 [main] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(69)) - raft.grpc.admin.host = null (fallback to raft.grpc.server.host)
2025-06-10 17:02:59,488 [main] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(62)) - raft.grpc.admin.port = 15177 (custom)
2025-06-10 17:02:59,488 [main] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(69)) - raft.grpc.client.host = null (fallback to raft.grpc.server.host)
2025-06-10 17:02:59,488 [main] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(62)) - raft.grpc.client.port = 15178 (custom)
2025-06-10 17:02:59,489 [main] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(62)) - raft.grpc.server.port = 15176 (custom)
2025-06-10 17:02:59,490 [main] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(62)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0] (custom)
2025-06-10 17:02:59,491 [main] INFO  server.RaftServer (RaftServerProxy.java:addNew(105)) - s0: addNew group-6876B2C99B77:[s0|localhost:15176] returns group-6876B2C99B77:java.util.concurrent.CompletableFuture@66c91224[Not completed]
2025-06-10 17:02:59,491 [s0-groupManagement] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(268)) - s0: new RaftServerImpl for group-6876B2C99B77:[s0|localhost:15176] with BaseStateMachine:uninitialized
2025-06-10 17:02:59,491 [s0-groupManagement] INFO  server.RaftServer$Division (ServerState.java:<init>(114)) - s0@group-6876B2C99B77: ConfigurationManager, init=conf: {index: -1, cur=peers:[s0|localhost:15176]|listeners:[], old=null}, confs=<EMPTY_MAP>
2025-06-10 17:02:59,492 [s0-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(138)) - The storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77 does not exist. Creating ...
2025-06-10 17:02:59,492 [s0-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77
2025-06-10 17:02:59,493 [s0-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(229)) - Lock on /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/in_use.lock acquired by nodename 5553@fv-az2209-831
2025-06-10 17:02:59,493 [s0-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current
2025-06-10 17:02:59,493 [s0-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/sm
2025-06-10 17:02:59,494 [s0-impl-thread1] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/raft-meta.tmp with options [CREATE, TRUNCATE_EXISTING, WRITE]: sun.nio.ch.FileChannelImpl@161958b9
2025-06-10 17:02:59,494 [s0-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/raft-meta with options [REPLACE_EXISTING]
2025-06-10 17:02:59,494 [s0-impl-thread1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(98)) - Storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77 has been successfully formatted.
2025-06-10 17:02:59,495 [s0-impl-thread1] INFO  util.AwaitToRun (AwaitToRun.java:start(81)) - Thread[s0@group-6876B2C99B77-cacheEviction-AwaitToRun,5,main] started
2025-06-10 17:02:59,495 [s0-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(190)) - new s0@group-6876B2C99B77-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77
2025-06-10 17:02:59,497 [s0-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(141)) - s0@group-6876B2C99B77-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2025-06-10 17:02:59,497 [s0-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(141)) - s0@group-6876B2C99B77-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2025-06-10 17:02:59,497 [s0-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(405)) - s0@group-6876B2C99B77: start as a follower, conf=conf: {index: -1, cur=peers:[s0|localhost:15176]|listeners:[], old=null}
2025-06-10 17:02:59,497 [s0-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(392)) - s0@group-6876B2C99B77: changes role from      null to FOLLOWER at term 0 for startAsFollower
2025-06-10 17:02:59,497 [s0-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(148)) - s0: start s0@group-6876B2C99B77-FollowerState
2025-06-10 17:02:59,497 [s0@group-6876B2C99B77-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(69)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2025-06-10 17:02:59,498 [s0@group-6876B2C99B77-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(69)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2025-06-10 17:02:59,497 [s0-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-6876B2C99B77,id=s0
2025-06-10 17:02:59,498 [s0-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:register(58)) - register mxBean class org.apache.ratis.server.impl.RaftServerJmxAdapter as Ratis:service=RaftServer,group=group-6876B2C99B77,id=s0
2025-06-10 17:02:59,498 [s0-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(419)) - s0@group-6876B2C99B77: Successfully started.
2025-06-10 17:02:59,498 [main] INFO  server.RaftServer (RaftServerProxy.java:startImpl(412)) - s0: start RPC server
2025-06-10 17:02:59,499 [main] INFO  server.GrpcServicesImpl (GrpcServicesImpl.java:startImpl(346)) - s0: GrpcServicesImpl started, listening on 15178
2025-06-10 17:02:59,499 [main] INFO  server.GrpcServicesImpl (GrpcServicesImpl.java:startImpl(346)) - s0: GrpcServicesImpl started, listening on 15176
2025-06-10 17:02:59,499 [main] INFO  server.GrpcServicesImpl (GrpcServicesImpl.java:startImpl(346)) - s0: GrpcServicesImpl started, listening on 15177
2025-06-10 17:02:59,500 [JvmPauseMonitor46] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(146)) - JvmPauseMonitor-s0: Started
2025-06-10 17:02:59,500 [main] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(107)) - printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t0, leader=null, voted=, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c-1:lastnull, conf=conf: {index: -1, cur=peers:[s0|localhost:15176]|listeners:[], old=null}
2025-06-10 17:02:59,500 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #1 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t0, leader=null, voted=, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c-1:lastnull, conf=conf: {index: -1, cur=peers:[s0|localhost:15176]|listeners:[], old=null}
2025-06-10 17:02:59,657 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:runImpl(161)) - s0@group-6876B2C99B77-FollowerState: change to CANDIDATE, lastRpcElapsedTime:159651610ns, electionTimeout:159ms
2025-06-10 17:02:59,657 [s0@group-6876B2C99B77-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - s0: shutdown s0@group-6876B2C99B77-FollowerState
2025-06-10 17:02:59,657 [s0@group-6876B2C99B77-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(392)) - s0@group-6876B2C99B77: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2025-06-10 17:02:59,657 [s0@group-6876B2C99B77-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(148)) - s0: start s0@group-6876B2C99B77-LeaderElection22
2025-06-10 17:02:59,657 [s0@group-6876B2C99B77-LeaderElection22] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(448)) - s0@group-6876B2C99B77-LeaderElection22 PRE_VOTE round 0: submit vote requests at term 0 for conf: {index: -1, cur=peers:[s0|localhost:15176]|listeners:[], old=null}
2025-06-10 17:02:59,658 [s0@group-6876B2C99B77-LeaderElection22] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(450)) - s0@group-6876B2C99B77-LeaderElection22 PRE_VOTE round 0: result PASSED (term=0)
2025-06-10 17:02:59,658 [s0@group-6876B2C99B77-LeaderElection22] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/raft-meta.tmp with options [CREATE, TRUNCATE_EXISTING, WRITE]: sun.nio.ch.FileChannelImpl@56d9438
2025-06-10 17:02:59,659 [s0@group-6876B2C99B77-LeaderElection22] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/raft-meta with options [REPLACE_EXISTING]
2025-06-10 17:02:59,659 [s0@group-6876B2C99B77-LeaderElection22] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(448)) - s0@group-6876B2C99B77-LeaderElection22 ELECTION round 0: submit vote requests at term 1 for conf: {index: -1, cur=peers:[s0|localhost:15176]|listeners:[], old=null}
2025-06-10 17:02:59,659 [s0@group-6876B2C99B77-LeaderElection22] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(450)) - s0@group-6876B2C99B77-LeaderElection22 ELECTION round 0: result PASSED (term=1)
2025-06-10 17:02:59,659 [s0@group-6876B2C99B77-LeaderElection22] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(141)) - s0: shutdown s0@group-6876B2C99B77-LeaderElection22
2025-06-10 17:02:59,659 [s0@group-6876B2C99B77-LeaderElection22] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(392)) - s0@group-6876B2C99B77: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2025-06-10 17:02:59,659 [s0@group-6876B2C99B77-LeaderElection22] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(69)) - raft.server.staging.timeout = 900ms (fallback to raft.server.rpc.timeout.max)
2025-06-10 17:02:59,660 [s0@group-6876B2C99B77-LeaderElection22] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(148)) - s0: start s0@group-6876B2C99B77-LeaderStateImpl
2025-06-10 17:02:59,660 [s0@group-6876B2C99B77-LeaderElection22] INFO  server.RaftServer$Division (RaftServerImpl.java:setFirstElection(576)) - s0@group-6876B2C99B77: set firstElectionSinceStartup to false for becomeLeader
2025-06-10 17:02:59,660 [s0@group-6876B2C99B77-LeaderElection22] INFO  server.RaftServer$Division (ServerState.java:setLeader(272)) - s0@group-6876B2C99B77: change Leader from null to s0 at term 1 for becomeLeader, leader elected after 168ms
2025-06-10 17:02:59,660 [s0@group-6876B2C99B77-LeaderElection22] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(440)) - s0@group-6876B2C99B77-SegmentedRaftLogWorker: Starting segment from index:0
2025-06-10 17:02:59,660 [s0@group-6876B2C99B77-LeaderElection22] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(386)) - s0@group-6876B2C99B77: set configuration conf: {index: 0, cur=peers:[s0|localhost:15176]|listeners:[], old=null}
2025-06-10 17:02:59,660 [s0@group-6876B2C99B77-SegmentedRaftLogWorker] INFO  segmented.BufferedWriteChannel (BufferedWriteChannel.java:open(61)) - open log_inprogress_0 at position 0
2025-06-10 17:02:59,669 [s0@group-6876B2C99B77-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(647)) - s0@group-6876B2C99B77-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/log_inprogress_0
2025-06-10 17:02:59,669 [s0@group-6876B2C99B77-StateMachineUpdater] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/raft-meta.conf.tmp with options [CREATE, TRUNCATE_EXISTING, WRITE]: sun.nio.ch.FileChannelImpl@878c1f8
2025-06-10 17:02:59,670 [s0@group-6876B2C99B77-StateMachineUpdater] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/raft-meta.conf.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/raft-meta.conf with options [REPLACE_EXISTING]
2025-06-10 17:02:59,670 [s0@group-6876B2C99B77-StateMachineUpdater] INFO  server.RaftServer$Division (LeaderStateImpl.java:checkStartIndex(309)) - Leader s0@group-6876B2C99B77-LeaderStateImpl is ready since appliedIndex == startIndex == 0
2025-06-10 17:02:59,776 [timer0] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:lambda$onCompleted$6(171)) - s6: Completed APPEND_ENTRIES, lastRequest: null  (Repeated 4 times in the last 5.002s)
2025-06-10 17:02:59,776 [timer2] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:lambda$onCompleted$6(171)) - s5: Completed APPEND_ENTRIES, lastRequest: null  (Repeated 4 times in the last 5.001s)
2025-06-10 17:02:59,777 [timer1] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:lambda$null$7(175)) - s6: Completed APPEND_ENTRIES, lastReply: serverReply {
  requestorId: "s4"
  replyId: "s6"
  raftGroupId {
    id: "$\024\322WD\326O\245\203>\315+Z!\342\355"
  }
  callId: 20
  success: true
}
term: 2
nextIndex: 7
followerCommit: 6
matchIndex: 18446744073709551615
isHearbeat: true
  (Repeated 4 times in the last 5.003s)
2025-06-10 17:02:59,780 [timer3] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:lambda$null$7(175)) - s5: Completed APPEND_ENTRIES, lastReply: serverReply {
  requestorId: "s4"
  replyId: "s5"
  raftGroupId {
    id: "$\024\322WD\326O\245\203>\315+Z!\342\355"
  }
  callId: 21
  success: true
}
term: 2
nextIndex: 7
followerCommit: 6
matchIndex: 18446744073709551615
isHearbeat: true
  (Repeated 4 times in the last 5.003s)
2025-06-10 17:02:59,951 [main] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(131)) - printing ALL groups
  s0:  RUNNING    LEADER (RUNNING): s0@group-6876B2C99B77:t1, leader=s0, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:1, i:0), conf=conf: {index: 0, cur=peers:[s0|localhost:15176]|listeners:[], old=null}
2025-06-10 17:02:59,951 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:addNewPeers(467)) - Add new peers [s1]
2025-06-10 17:02:59,951 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(385)) - newRaftServer: s1, group-6876B2C99B77:[], format? true
2025-06-10 17:02:59,951 [main] TRACE util.FileUtils (FileUtils.java:deleteFully(351)) - deleteFully target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s1
2025-06-10 17:02:59,952 [main] TRACE util.FileUtils (FileUtils.java:deleteFully(364)) - deleteFully: target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s1 does not exist.
2025-06-10 17:02:59,952 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(390)) - Formatted directory target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s1
2025-06-10 17:02:59,953 [main] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(69)) - raft.grpc.admin.host = null (fallback to raft.grpc.server.host)
2025-06-10 17:02:59,953 [main] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(69)) - raft.grpc.admin.port = 15180 (fallback to raft.grpc.server.port)
2025-06-10 17:02:59,953 [main] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(69)) - raft.grpc.client.host = null (fallback to raft.grpc.server.host)
2025-06-10 17:02:59,953 [main] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(69)) - raft.grpc.client.port = 15180 (fallback to raft.grpc.server.port)
2025-06-10 17:02:59,953 [main] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(62)) - raft.grpc.server.port = 15180 (custom)
2025-06-10 17:02:59,954 [main] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(62)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s1] (custom)
2025-06-10 17:02:59,955 [main] INFO  server.RaftServer (RaftServerProxy.java:addNew(105)) - s1: addNew group-6876B2C99B77:[] returns group-6876B2C99B77:java.util.concurrent.CompletableFuture@7fae6f43[Not completed]
2025-06-10 17:02:59,955 [s1-groupManagement] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(268)) - s1: new RaftServerImpl for group-6876B2C99B77:[] with BaseStateMachine:uninitialized
2025-06-10 17:02:59,955 [s1-groupManagement] INFO  server.RaftServer$Division (ServerState.java:<init>(114)) - s1@group-6876B2C99B77: ConfigurationManager, init=conf: {index: -1, cur=peers:[]|listeners:[], old=null}, confs=<EMPTY_MAP>
2025-06-10 17:02:59,956 [s1-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(138)) - The storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s1/92259f10-065a-49b5-89af-6876b2c99b77 does not exist. Creating ...
2025-06-10 17:02:59,957 [s1-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s1/92259f10-065a-49b5-89af-6876b2c99b77
2025-06-10 17:02:59,957 [s1-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(229)) - Lock on /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s1/92259f10-065a-49b5-89af-6876b2c99b77/in_use.lock acquired by nodename 5553@fv-az2209-831
2025-06-10 17:02:59,958 [s1-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s1/92259f10-065a-49b5-89af-6876b2c99b77/current
2025-06-10 17:02:59,958 [s1-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s1/92259f10-065a-49b5-89af-6876b2c99b77/sm
2025-06-10 17:02:59,958 [s1-impl-thread1] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s1/92259f10-065a-49b5-89af-6876b2c99b77/current/raft-meta.tmp with options [CREATE, TRUNCATE_EXISTING, WRITE]: sun.nio.ch.FileChannelImpl@412a959f
2025-06-10 17:02:59,959 [s1-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s1/92259f10-065a-49b5-89af-6876b2c99b77/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s1/92259f10-065a-49b5-89af-6876b2c99b77/current/raft-meta with options [REPLACE_EXISTING]
2025-06-10 17:02:59,959 [s1-impl-thread1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(98)) - Storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s1/92259f10-065a-49b5-89af-6876b2c99b77 has been successfully formatted.
2025-06-10 17:02:59,959 [s1-impl-thread1] INFO  util.AwaitToRun (AwaitToRun.java:start(81)) - Thread[s1@group-6876B2C99B77-cacheEviction-AwaitToRun,5,main] started
2025-06-10 17:02:59,959 [s1-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(190)) - new s1@group-6876B2C99B77-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s1/92259f10-065a-49b5-89af-6876b2c99b77
2025-06-10 17:02:59,960 [s1-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(141)) - s1@group-6876B2C99B77-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2025-06-10 17:02:59,960 [s1-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(141)) - s1@group-6876B2C99B77-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2025-06-10 17:02:59,960 [s1-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(411)) - s1@group-6876B2C99B77: start with initializing state, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:02:59,960 [s1-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(392)) - s1@group-6876B2C99B77: changes role from      null to FOLLOWER at term 0 for start
2025-06-10 17:02:59,960 [s1-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-6876B2C99B77,id=s1
2025-06-10 17:02:59,960 [s1-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:register(58)) - register mxBean class org.apache.ratis.server.impl.RaftServerJmxAdapter as Ratis:service=RaftServer,group=group-6876B2C99B77,id=s1
2025-06-10 17:02:59,961 [s1-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(419)) - s1@group-6876B2C99B77: Successfully started.
2025-06-10 17:02:59,961 [main] INFO  server.RaftServer (RaftServerProxy.java:startImpl(412)) - s1: start RPC server
2025-06-10 17:02:59,961 [main] INFO  server.GrpcServicesImpl (GrpcServicesImpl.java:startImpl(346)) - s1: GrpcServicesImpl started, listening on 15180
2025-06-10 17:02:59,962 [JvmPauseMonitor47] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(146)) - JvmPauseMonitor-s1: Started
2025-06-10 17:02:59,962 [main] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(386)) - s0@group-6876B2C99B77: set configuration conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
2025-06-10 17:02:59,970 [s0@group-6876B2C99B77-LeaderStateImpl] WARN  server.RaftServer$Division (LeaderStateImpl.java:checkLeadership(1121)) - s0@group-6876B2C99B77-LeaderStateImpl: Lost leadership on term: 1. Election timeout: 300ms. In charge for: 310ms. Conf: conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
2025-06-10 17:02:59,970 [s0@group-6876B2C99B77-LeaderStateImpl] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(392)) - s0@group-6876B2C99B77: changes role from    LEADER to FOLLOWER at term 1 for StepDownReason:LOST_MAJORITY_HEARTBEATS
2025-06-10 17:02:59,970 [s0@group-6876B2C99B77-LeaderStateImpl] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(103)) - s0: shutdown s0@group-6876B2C99B77-LeaderStateImpl
2025-06-10 17:02:59,970 [s0@group-6876B2C99B77-LeaderStateImpl] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(287)) - s0@group-6876B2C99B77-PendingRequests: sendNotLeaderResponses
2025-06-10 17:02:59,970 [s0@group-6876B2C99B77-LeaderStateImpl] INFO  server.RaftServer$Division (ServerState.java:setLeader(272)) - s0@group-6876B2C99B77: change Leader from s0 to null at term 1 for StepDownReason:LOST_MAJORITY_HEARTBEATS
2025-06-10 17:02:59,970 [s0@group-6876B2C99B77-LeaderStateImpl] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(148)) - s0: start s0@group-6876B2C99B77-FollowerState
2025-06-10 17:02:59,971 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:00,078 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:00,181 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:00,184 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 213ms < waitTime = 10s)
2025-06-10 17:03:00,284 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:00,387 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:00,448 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 477ms < waitTime = 10s)
2025-06-10 17:03:00,490 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:00,592 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:00,645 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 674ms < waitTime = 10s)
2025-06-10 17:03:00,696 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:00,799 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:00,866 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 895ms < waitTime = 10s)
2025-06-10 17:03:00,901 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:01,004 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:01,036 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 1065ms < waitTime = 10s)
2025-06-10 17:03:01,107 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:01,210 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:01,313 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:01,333 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 1362ms < waitTime = 10s)
2025-06-10 17:03:01,416 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:01,519 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:01,584 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 1613ms < waitTime = 10s)
2025-06-10 17:03:01,621 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:01,724 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:01,827 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:01,883 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 1912ms < waitTime = 10s)
2025-06-10 17:03:01,930 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:02,033 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:02,137 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:02,138 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 2167ms < waitTime = 10s)
2025-06-10 17:03:02,239 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:02,342 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:02,393 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 2422ms < waitTime = 10s)
2025-06-10 17:03:02,445 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:02,548 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:02,643 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 2672ms < waitTime = 10s)
2025-06-10 17:03:02,651 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:02,754 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:02,857 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:02,883 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 2912ms < waitTime = 10s)
2025-06-10 17:03:02,960 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:03,063 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:03,105 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 3134ms < waitTime = 10s)
2025-06-10 17:03:03,166 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:03,269 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:03,318 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 3347ms < waitTime = 10s)
2025-06-10 17:03:03,371 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:03,474 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:03,577 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:03,614 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 3643ms < waitTime = 10s)
2025-06-10 17:03:03,680 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:03,783 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:03,819 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 3848ms < waitTime = 10s)
2025-06-10 17:03:03,885 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:03,988 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:03,991 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 4020ms < waitTime = 10s)
2025-06-10 17:03:04,092 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:04,195 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:04,287 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 4316ms < waitTime = 10s)
2025-06-10 17:03:04,298 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:04,401 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:04,461 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 4491ms < waitTime = 10s)
2025-06-10 17:03:04,504 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:04,606 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:04,709 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:04,735 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 4764ms < waitTime = 10s)
2025-06-10 17:03:04,812 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:04,915 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:04,938 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 4967ms < waitTime = 10s)
2025-06-10 17:03:05,017 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:05,120 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:05,223 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:05,228 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 5257ms < waitTime = 10s)
2025-06-10 17:03:05,325 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:05,387 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 5416ms < waitTime = 10s)
2025-06-10 17:03:05,428 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:05,531 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:05,634 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:05,664 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 5693ms < waitTime = 10s)
2025-06-10 17:03:05,736 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:05,839 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:05,874 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 5903ms < waitTime = 10s)
2025-06-10 17:03:05,942 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:06,045 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:06,051 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 6080ms < waitTime = 10s)
2025-06-10 17:03:06,148 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:06,251 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:06,295 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 6324ms < waitTime = 10s)
2025-06-10 17:03:06,353 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:06,456 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:06,458 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 6487ms < waitTime = 10s)
2025-06-10 17:03:06,559 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:06,662 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:06,716 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 6745ms < waitTime = 10s)
2025-06-10 17:03:06,765 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:06,867 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:06,949 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 6978ms < waitTime = 10s)
2025-06-10 17:03:06,970 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:07,073 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:07,106 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 7135ms < waitTime = 10s)
2025-06-10 17:03:07,176 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:07,273 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 7302ms < waitTime = 10s)
2025-06-10 17:03:07,279 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:07,382 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:07,485 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:07,544 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 7573ms < waitTime = 10s)
2025-06-10 17:03:07,587 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:07,690 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:07,718 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 7747ms < waitTime = 10s)
2025-06-10 17:03:07,793 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:07,896 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:07,970 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 7999ms < waitTime = 10s)
2025-06-10 17:03:07,999 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:08,102 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:08,205 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:08,215 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 8244ms < waitTime = 10s)
2025-06-10 17:03:08,307 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:08,410 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:08,476 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 8505ms < waitTime = 10s)
2025-06-10 17:03:08,512 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:08,615 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:08,674 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 8703ms < waitTime = 10s)
2025-06-10 17:03:08,718 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:08,820 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:08,910 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 8939ms < waitTime = 10s)
2025-06-10 17:03:08,923 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:09,025 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:09,116 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 9145ms < waitTime = 10s)
2025-06-10 17:03:09,128 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:09,231 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:09,311 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 9340ms < waitTime = 10s)
2025-06-10 17:03:09,333 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:09,436 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:09,501 [Timer-10] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$null$7(351)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t1, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:1, i:0), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING  FOLLOWER (STARTING): s1@group-6876B2C99B77:t0, leader=null, voted=, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:OPENED:c-1:lastnull, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}.
2025-06-10 17:03:09,539 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:09,569 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 9599ms < waitTime = 10s)
2025-06-10 17:03:09,642 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:09,745 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:09,816 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 9845ms < waitTime = 10s)
2025-06-10 17:03:09,848 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:09,951 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:10,022 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:runImpl(161)) - s0@group-6876B2C99B77-FollowerState: change to CANDIDATE, lastRpcElapsedTime:10051579374ns, electionTimeout:206ms
2025-06-10 17:03:10,022 [s0@group-6876B2C99B77-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - s0: shutdown s0@group-6876B2C99B77-FollowerState
2025-06-10 17:03:10,022 [s0@group-6876B2C99B77-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(392)) - s0@group-6876B2C99B77: changes role from  FOLLOWER to CANDIDATE at term 1 for changeToCandidate
2025-06-10 17:03:10,022 [s0@group-6876B2C99B77-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(148)) - s0: start s0@group-6876B2C99B77-LeaderElection23
2025-06-10 17:03:10,023 [s0@group-6876B2C99B77-LeaderElection23] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(448)) - s0@group-6876B2C99B77-LeaderElection23 PRE_VOTE round 0: submit vote requests at term 1 for conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
2025-06-10 17:03:10,024 [s0@group-6876B2C99B77-LeaderElection23-1] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(65)) - Build channel for s1|0.0.0.0:15180
2025-06-10 17:03:10,028 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1421)) - s1@group-6876B2C99B77: receive requestVote(PRE_VOTE, s0, group-6876B2C99B77, 1, (t:1, i:0))
2025-06-10 17:03:10,029 [grpc-default-executor-4] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: Failed requestVote s0->s1#0: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [RUNNING]: current state is STARTING
2025-06-10 17:03:10,034 [s0@group-6876B2C99B77-LeaderElection23] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(142)) - s0@group-6876B2C99B77-LeaderElection23 got exception when requesting votes: java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: s1@group-6876B2C99B77 is not in [RUNNING]: current state is STARTING
2025-06-10 17:03:10,034 [s0@group-6876B2C99B77-LeaderElection23] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(206)) - s0@group-6876B2C99B77-LeaderElection23: PRE_VOTE SINGLE_MODE_PASSED received 0 response(s) and 1 exception(s):
2025-06-10 17:03:10,034 [s0@group-6876B2C99B77-LeaderElection23] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(142)) -   Exception 0: java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: s1@group-6876B2C99B77 is not in [RUNNING]: current state is STARTING
2025-06-10 17:03:10,034 [s0@group-6876B2C99B77-LeaderElection23] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(450)) - s0@group-6876B2C99B77-LeaderElection23 PRE_VOTE round 0: result SINGLE_MODE_PASSED
2025-06-10 17:03:10,035 [s0@group-6876B2C99B77-LeaderElection23] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/raft-meta.tmp with options [CREATE, TRUNCATE_EXISTING, WRITE]: sun.nio.ch.FileChannelImpl@41f481cb
2025-06-10 17:03:10,036 [s0@group-6876B2C99B77-LeaderElection23] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/raft-meta with options [REPLACE_EXISTING]
2025-06-10 17:03:10,037 [s0@group-6876B2C99B77-LeaderElection23] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(448)) - s0@group-6876B2C99B77-LeaderElection23 ELECTION round 0: submit vote requests at term 2 for conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
2025-06-10 17:03:10,039 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1421)) - s1@group-6876B2C99B77: receive requestVote(ELECTION, s0, group-6876B2C99B77, 2, (t:1, i:0))
2025-06-10 17:03:10,039 [grpc-default-executor-4] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: Failed requestVote s0->s1#0: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [RUNNING]: current state is STARTING
2025-06-10 17:03:10,041 [s0@group-6876B2C99B77-LeaderElection23] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(142)) - s0@group-6876B2C99B77-LeaderElection23 got exception when requesting votes: java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: s1@group-6876B2C99B77 is not in [RUNNING]: current state is STARTING
2025-06-10 17:03:10,041 [s0@group-6876B2C99B77-LeaderElection23] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(206)) - s0@group-6876B2C99B77-LeaderElection23: ELECTION SINGLE_MODE_PASSED received 0 response(s) and 1 exception(s):
2025-06-10 17:03:10,041 [s0@group-6876B2C99B77-LeaderElection23] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(142)) -   Exception 0: java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: s1@group-6876B2C99B77 is not in [RUNNING]: current state is STARTING
2025-06-10 17:03:10,041 [s0@group-6876B2C99B77-LeaderElection23] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(450)) - s0@group-6876B2C99B77-LeaderElection23 ELECTION round 0: result SINGLE_MODE_PASSED
2025-06-10 17:03:10,042 [s0@group-6876B2C99B77-LeaderElection23] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(141)) - s0: shutdown s0@group-6876B2C99B77-LeaderElection23
2025-06-10 17:03:10,042 [s0@group-6876B2C99B77-LeaderElection23] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(392)) - s0@group-6876B2C99B77: changes role from CANDIDATE to LEADER at term 2 for changeToLeader
2025-06-10 17:03:10,042 [s0@group-6876B2C99B77-LeaderElection23] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(69)) - raft.server.staging.timeout = 900ms (fallback to raft.server.rpc.timeout.max)
2025-06-10 17:03:10,043 [s0@group-6876B2C99B77-LeaderElection23] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(148)) - s0: start s0@group-6876B2C99B77-LeaderStateImpl
2025-06-10 17:03:10,043 [s0@group-6876B2C99B77-LeaderElection23] INFO  server.RaftServer$Division (ServerState.java:setLeader(272)) - s0@group-6876B2C99B77: change Leader from null to s0 at term 2 for becomeLeader, leader elected after 10072ms
2025-06-10 17:03:10,043 [s0@group-6876B2C99B77-LeaderElection23] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(445)) - s0@group-6876B2C99B77-SegmentedRaftLogWorker: Rolling segment log-0_0 to index:0
2025-06-10 17:03:10,044 [s0@group-6876B2C99B77-LeaderElection23] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(386)) - s0@group-6876B2C99B77: set configuration conf: {index: 1, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=null}
2025-06-10 17:03:10,046 [s0@group-6876B2C99B77-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/log_inprogress_0 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/log_0-0
2025-06-10 17:03:10,046 [s0@group-6876B2C99B77-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(604)) - s0@group-6876B2C99B77-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/log_inprogress_0 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/log_0-0
2025-06-10 17:03:10,046 [s0@group-6876B2C99B77-SegmentedRaftLogWorker] INFO  segmented.BufferedWriteChannel (BufferedWriteChannel.java:open(61)) - open log_inprogress_1 at position 0
2025-06-10 17:03:10,052 [grpc-default-executor-3] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s1/92259f10-065a-49b5-89af-6876b2c99b77/current/raft-meta.tmp with options [CREATE, TRUNCATE_EXISTING, WRITE]: sun.nio.ch.FileChannelImpl@3ca8942e
2025-06-10 17:03:10,054 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:stepDownLeaderAsync(1293)) - s0@group-6876B2C99B77 receive stepDown leader request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:10,055 [grpc-default-executor-2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1524)) - s1@group-6876B2C99B77: appendEntries* s0->s1#1-t2,previous=(t:1, i:0),leaderCommit=0,initializing? false,entries: size=1, first=(t:2, i:1), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
2025-06-10 17:03:10,055 [s0@group-6876B2C99B77-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(647)) - s0@group-6876B2C99B77-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/log_inprogress_1
2025-06-10 17:03:10,056 [s0@group-6876B2C99B77-LeaderStateImpl] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(392)) - s0@group-6876B2C99B77: changes role from    LEADER to FOLLOWER at term 2 for StepDownReason:FORCE
2025-06-10 17:03:10,056 [s0@group-6876B2C99B77-LeaderStateImpl] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(103)) - s0: shutdown s0@group-6876B2C99B77-LeaderStateImpl
2025-06-10 17:03:10,055 [grpc-default-executor-3] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s1/92259f10-065a-49b5-89af-6876b2c99b77/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s1/92259f10-065a-49b5-89af-6876b2c99b77/current/raft-meta with options [REPLACE_EXISTING]
2025-06-10 17:03:10,056 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:setFirstElection(576)) - s1@group-6876B2C99B77: set firstElectionSinceStartup to false for appendEntries
2025-06-10 17:03:10,057 [grpc-default-executor-3] INFO  server.RaftServer$Division (ServerState.java:setLeader(272)) - s1@group-6876B2C99B77: change Leader from null to s0 at term 2 for appendEntries, leader elected after 10101ms
2025-06-10 17:03:10,056 [s0@group-6876B2C99B77-LeaderStateImpl] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(287)) - s0@group-6876B2C99B77-PendingRequests: sendNotLeaderResponses
2025-06-10 17:03:10,057 [grpc-default-executor-3] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(148)) - s1: start s1@group-6876B2C99B77-FollowerState
2025-06-10 17:03:10,057 [s0@group-6876B2C99B77-LeaderStateImpl] INFO  server.RaftServer$Division (ServerState.java:setLeader(272)) - s0@group-6876B2C99B77: change Leader from s0 to null at term 2 for StepDownReason:FORCE
2025-06-10 17:03:10,057 [s0@group-6876B2C99B77-LeaderStateImpl] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(148)) - s0: start s0@group-6876B2C99B77-FollowerState
2025-06-10 17:03:10,057 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1673)) - s1@group-6876B2C99B77: Failed appendEntries as previous log entry ((t:1, i:0)) is not found
2025-06-10 17:03:10,057 [s0@group-6876B2C99B77->s1-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(300)) - s0@group-6876B2C99B77->s1-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2025-06-10 17:03:10,057 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1594)) - s1@group-6876B2C99B77: appendEntries* reply s0<-s1#0:FAIL-t0,INCONSISTENCY,nextIndex=0,followerCommit=-1,matchIndex=-1
2025-06-10 17:03:10,058 [s0@group-6876B2C99B77-LeaderStateImpl] INFO  impl.PendingStepDown (PendingStepDown.java:complete(55)) - Successfully step down leader at s0@group-6876B2C99B77-LeaderStateImpl for request TransferLeadershipRequest:client-B00663968336->s0@group-6876B2C99B77, cid=40, seq=null, RO, null
2025-06-10 17:03:10,058 [grpc-default-executor-3] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:lambda$onCompleted$6(171)) - s1: Completed APPEND_ENTRIES, lastRequest: null 
2025-06-10 17:03:10,059 [grpc-default-executor-3] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:lambda$null$7(175)) - s1: Completed APPEND_ENTRIES, lastReply: serverReply {
  requestorId: "s0"
  replyId: "s1"
  raftGroupId {
    id: "\222%\237\020\006ZI\265\211\257hv\262\311\233w"
  }
}
result: INCONSISTENCY
followerCommit: 18446744073709551615
matchIndex: 18446744073709551615
isHearbeat: true
 
2025-06-10 17:03:10,060 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1673)) - s1@group-6876B2C99B77: Failed appendEntries as previous log entry ((t:1, i:0)) is not found
2025-06-10 17:03:10,060 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1594)) - s1@group-6876B2C99B77: appendEntries* reply s0<-s1#1:FAIL-t2,INCONSISTENCY,nextIndex=0,followerCommit=-1,matchIndex=-1
2025-06-10 17:03:10,062 [main] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(107)) - printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t2, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:2, i:1), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING  FOLLOWER (RUNNING): s1@group-6876B2C99B77:t2, leader=s0, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:OPENED:c-1:lastnull, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:10,063 [grpc-default-executor-3] WARN  server.GrpcLogAppender (GrpcLogAppender.java:lambda$onNextImpl$0(527)) - s0@group-6876B2C99B77->s1-AppendLogResponseHandler: received INCONSISTENCY reply with nextIndex 0, errorCount=2, request=AppendEntriesRequest:cid=1,entriesCount=1,entry=(t:2, i:1) 
2025-06-10 17:03:10,063 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #1 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t2, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:2, i:1), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING  FOLLOWER (RUNNING): s1@group-6876B2C99B77:t2, leader=s0, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:OPENED:c-1:lastnull, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:10,064 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:info(70)) - s0@group-6876B2C99B77->s1: setNextIndex nextIndex: updateUnconditionally 2 -> 0
2025-06-10 17:03:10,064 [grpc-default-executor-3] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(558)) - s0@group-6876B2C99B77->s1-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2025-06-10 17:03:10,064 [grpc-default-executor-4] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(558)) - s0@group-6876B2C99B77->s1-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2025-06-10 17:03:10,228 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:runImpl(161)) - s0@group-6876B2C99B77-FollowerState: change to CANDIDATE, lastRpcElapsedTime:171335632ns, electionTimeout:171ms
2025-06-10 17:03:10,228 [s0@group-6876B2C99B77-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - s0: shutdown s0@group-6876B2C99B77-FollowerState
2025-06-10 17:03:10,229 [s0@group-6876B2C99B77-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(392)) - s0@group-6876B2C99B77: changes role from  FOLLOWER to CANDIDATE at term 2 for changeToCandidate
2025-06-10 17:03:10,229 [s0@group-6876B2C99B77-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(148)) - s0: start s0@group-6876B2C99B77-LeaderElection24
2025-06-10 17:03:10,229 [s0@group-6876B2C99B77-LeaderElection24] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(448)) - s0@group-6876B2C99B77-LeaderElection24 PRE_VOTE round 0: submit vote requests at term 2 for conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
2025-06-10 17:03:10,231 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1421)) - s1@group-6876B2C99B77: receive requestVote(PRE_VOTE, s0, group-6876B2C99B77, 2, (t:2, i:1))
2025-06-10 17:03:10,231 [grpc-default-executor-4] INFO  impl.VoteContext (VoteContext.java:log(49)) - s1@group-6876B2C99B77-FOLLOWER: reject PRE_VOTE from s0: s0 is not in current conf []
2025-06-10 17:03:10,231 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1455)) - s1@group-6876B2C99B77 replies to PRE_VOTE vote request: s0<-s1#0:FAIL-t2-last:<INITIAL_VALUE>. Peer's state: s1@group-6876B2C99B77:t2, leader=s0, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:OPENED:c-1:lastnull, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:10,231 [s0@group-6876B2C99B77-LeaderElection24] INFO  impl.LeaderElection (LeaderElection.java:waitForResults(573)) - rejectedPeers: [s1], emptyCommit? false
2025-06-10 17:03:10,232 [s0@group-6876B2C99B77-LeaderElection24] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(206)) - s0@group-6876B2C99B77-LeaderElection24: PRE_VOTE REJECTED received 1 response(s) and 0 exception(s):
2025-06-10 17:03:10,232 [s0@group-6876B2C99B77-LeaderElection24] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(210)) -   Response 0: s0<-s1#0:FAIL-t2-last:<INITIAL_VALUE>
2025-06-10 17:03:10,232 [s0@group-6876B2C99B77-LeaderElection24] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(450)) - s0@group-6876B2C99B77-LeaderElection24 PRE_VOTE round 0: result REJECTED
2025-06-10 17:03:10,232 [s0@group-6876B2C99B77-LeaderElection24] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(392)) - s0@group-6876B2C99B77: changes role from CANDIDATE to FOLLOWER at term 2 for REJECTED
2025-06-10 17:03:10,232 [s0@group-6876B2C99B77-LeaderElection24] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(141)) - s0: shutdown s0@group-6876B2C99B77-LeaderElection24
2025-06-10 17:03:10,232 [s0@group-6876B2C99B77-LeaderElection24] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(148)) - s0: start s0@group-6876B2C99B77-FollowerState
2025-06-10 17:03:10,463 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:runImpl(161)) - s0@group-6876B2C99B77-FollowerState: change to CANDIDATE, lastRpcElapsedTime:231357524ns, electionTimeout:231ms
2025-06-10 17:03:10,463 [s0@group-6876B2C99B77-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - s0: shutdown s0@group-6876B2C99B77-FollowerState
2025-06-10 17:03:10,464 [s0@group-6876B2C99B77-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(392)) - s0@group-6876B2C99B77: changes role from  FOLLOWER to CANDIDATE at term 2 for changeToCandidate
2025-06-10 17:03:10,464 [s0@group-6876B2C99B77-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(148)) - s0: start s0@group-6876B2C99B77-LeaderElection25
2025-06-10 17:03:10,464 [s0@group-6876B2C99B77-LeaderElection25] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(448)) - s0@group-6876B2C99B77-LeaderElection25 PRE_VOTE round 0: submit vote requests at term 2 for conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
2025-06-10 17:03:10,466 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1421)) - s1@group-6876B2C99B77: receive requestVote(PRE_VOTE, s0, group-6876B2C99B77, 2, (t:2, i:1))
2025-06-10 17:03:10,466 [grpc-default-executor-4] INFO  impl.VoteContext (VoteContext.java:log(49)) - s1@group-6876B2C99B77-FOLLOWER: reject PRE_VOTE from s0: s0 is not in current conf []
2025-06-10 17:03:10,466 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1455)) - s1@group-6876B2C99B77 replies to PRE_VOTE vote request: s0<-s1#0:FAIL-t2-last:<INITIAL_VALUE>. Peer's state: s1@group-6876B2C99B77:t2, leader=s0, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:OPENED:c-1:lastnull, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:10,466 [s0@group-6876B2C99B77-LeaderElection25] INFO  impl.LeaderElection (LeaderElection.java:waitForResults(573)) - rejectedPeers: [s1], emptyCommit? false
2025-06-10 17:03:10,466 [s0@group-6876B2C99B77-LeaderElection25] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(206)) - s0@group-6876B2C99B77-LeaderElection25: PRE_VOTE REJECTED received 1 response(s) and 0 exception(s):
2025-06-10 17:03:10,467 [s0@group-6876B2C99B77-LeaderElection25] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(210)) -   Response 0: s0<-s1#0:FAIL-t2-last:<INITIAL_VALUE>
2025-06-10 17:03:10,467 [s0@group-6876B2C99B77-LeaderElection25] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(450)) - s0@group-6876B2C99B77-LeaderElection25 PRE_VOTE round 0: result REJECTED
2025-06-10 17:03:10,467 [s0@group-6876B2C99B77-LeaderElection25] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(392)) - s0@group-6876B2C99B77: changes role from CANDIDATE to FOLLOWER at term 2 for REJECTED
2025-06-10 17:03:10,467 [s0@group-6876B2C99B77-LeaderElection25] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(141)) - s0: shutdown s0@group-6876B2C99B77-LeaderElection25
2025-06-10 17:03:10,467 [s0@group-6876B2C99B77-LeaderElection25] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(148)) - s0: start s0@group-6876B2C99B77-FollowerState
2025-06-10 17:03:10,470 [s1@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:runImpl(161)) - s1@group-6876B2C99B77-FollowerState: change to CANDIDATE, lastRpcElapsedTime:409888357ns, electionTimeout:181ms
2025-06-10 17:03:10,470 [s1@group-6876B2C99B77-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - s1: shutdown s1@group-6876B2C99B77-FollowerState
2025-06-10 17:03:10,470 [s1@group-6876B2C99B77-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(392)) - s1@group-6876B2C99B77: changes role from  FOLLOWER to CANDIDATE at term 2 for changeToCandidate
2025-06-10 17:03:10,471 [s1@group-6876B2C99B77-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(148)) - s1: start s1@group-6876B2C99B77-LeaderElection26
2025-06-10 17:03:10,471 [s1@group-6876B2C99B77-LeaderElection26] INFO  server.RaftServer$Division (ServerState.java:setLeader(272)) - s1@group-6876B2C99B77: change Leader from s0 to null at term 2 for PRE_VOTE
2025-06-10 17:03:10,471 [s1@group-6876B2C99B77-LeaderElection26] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(448)) - s1@group-6876B2C99B77-LeaderElection26 PRE_VOTE round 0: submit vote requests at term 2 for conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:10,471 [s1@group-6876B2C99B77-LeaderElection26] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(450)) - s1@group-6876B2C99B77-LeaderElection26 PRE_VOTE round 0: result NOT_IN_CONF (term=2)
2025-06-10 17:03:10,471 [s1@group-6876B2C99B77-LeaderElection26] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$1(527)) - s1@group-6876B2C99B77: shutdown
2025-06-10 17:03:10,471 [s1@group-6876B2C99B77-LeaderElection26] INFO  util.JmxRegister (JmxRegister.java:unregister(74)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-6876B2C99B77,id=s1
2025-06-10 17:03:10,471 [s1@group-6876B2C99B77-LeaderElection26] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(141)) - s1: shutdown s1@group-6876B2C99B77-LeaderElection26
2025-06-10 17:03:10,471 [s1@group-6876B2C99B77-LeaderElection26] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(163)) - s1@group-6876B2C99B77-StateMachineUpdater: set stopIndex = -1
2025-06-10 17:03:10,471 [s1@group-6876B2C99B77-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stop(140)) - s1@group-6876B2C99B77-StateMachineUpdater: closing BaseStateMachine, lastApplied=<INITIAL_VALUE>
2025-06-10 17:03:10,471 [s1@group-6876B2C99B77-cacheEviction-AwaitToRun] INFO  util.AwaitToRun (AwaitToRun.java:run(49)) - s1@group-6876B2C99B77-cacheEviction-AwaitToRun-AwaitForSignal is interrupted
2025-06-10 17:03:10,513 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #2 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t2, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:2, i:1), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSING): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:10,670 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:runImpl(161)) - s0@group-6876B2C99B77-FollowerState: change to CANDIDATE, lastRpcElapsedTime:203376176ns, electionTimeout:203ms
2025-06-10 17:03:10,670 [s0@group-6876B2C99B77-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - s0: shutdown s0@group-6876B2C99B77-FollowerState
2025-06-10 17:03:10,670 [s0@group-6876B2C99B77-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(392)) - s0@group-6876B2C99B77: changes role from  FOLLOWER to CANDIDATE at term 2 for changeToCandidate
2025-06-10 17:03:10,671 [s0@group-6876B2C99B77-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(148)) - s0: start s0@group-6876B2C99B77-LeaderElection27
2025-06-10 17:03:10,671 [s0@group-6876B2C99B77-LeaderElection27] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(448)) - s0@group-6876B2C99B77-LeaderElection27 PRE_VOTE round 0: submit vote requests at term 2 for conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
2025-06-10 17:03:10,672 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1421)) - s1@group-6876B2C99B77: receive requestVote(PRE_VOTE, s0, group-6876B2C99B77, 2, (t:2, i:1))
2025-06-10 17:03:10,672 [grpc-default-executor-4] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: Failed requestVote s0->s1#0: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [RUNNING]: current state is CLOSING
2025-06-10 17:03:10,675 [s0@group-6876B2C99B77-LeaderElection27] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(142)) - s0@group-6876B2C99B77-LeaderElection27 got exception when requesting votes: java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: s1@group-6876B2C99B77 is not in [RUNNING]: current state is CLOSING
2025-06-10 17:03:10,675 [s0@group-6876B2C99B77-LeaderElection27] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(206)) - s0@group-6876B2C99B77-LeaderElection27: PRE_VOTE SINGLE_MODE_PASSED received 0 response(s) and 1 exception(s):
2025-06-10 17:03:10,675 [s0@group-6876B2C99B77-LeaderElection27] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(142)) -   Exception 0: java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: s1@group-6876B2C99B77 is not in [RUNNING]: current state is CLOSING
2025-06-10 17:03:10,675 [s0@group-6876B2C99B77-LeaderElection27] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(450)) - s0@group-6876B2C99B77-LeaderElection27 PRE_VOTE round 0: result SINGLE_MODE_PASSED
2025-06-10 17:03:10,676 [s0@group-6876B2C99B77-LeaderElection27] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/raft-meta.tmp with options [CREATE, TRUNCATE_EXISTING, WRITE]: sun.nio.ch.FileChannelImpl@7441416d
2025-06-10 17:03:10,677 [s0@group-6876B2C99B77-LeaderElection27] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/raft-meta with options [REPLACE_EXISTING]
2025-06-10 17:03:10,677 [s0@group-6876B2C99B77-LeaderElection27] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(448)) - s0@group-6876B2C99B77-LeaderElection27 ELECTION round 0: submit vote requests at term 3 for conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
2025-06-10 17:03:10,678 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1421)) - s1@group-6876B2C99B77: receive requestVote(ELECTION, s0, group-6876B2C99B77, 3, (t:2, i:1))
2025-06-10 17:03:10,678 [grpc-default-executor-4] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: Failed requestVote s0->s1#0: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [RUNNING]: current state is CLOSING
2025-06-10 17:03:10,680 [s0@group-6876B2C99B77-LeaderElection27] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(142)) - s0@group-6876B2C99B77-LeaderElection27 got exception when requesting votes: java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: s1@group-6876B2C99B77 is not in [RUNNING]: current state is CLOSING
2025-06-10 17:03:10,680 [s0@group-6876B2C99B77-LeaderElection27] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(206)) - s0@group-6876B2C99B77-LeaderElection27: ELECTION SINGLE_MODE_PASSED received 0 response(s) and 1 exception(s):
2025-06-10 17:03:10,680 [s0@group-6876B2C99B77-LeaderElection27] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(142)) -   Exception 0: java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: s1@group-6876B2C99B77 is not in [RUNNING]: current state is CLOSING
2025-06-10 17:03:10,680 [s0@group-6876B2C99B77-LeaderElection27] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(450)) - s0@group-6876B2C99B77-LeaderElection27 ELECTION round 0: result SINGLE_MODE_PASSED
2025-06-10 17:03:10,680 [s0@group-6876B2C99B77-LeaderElection27] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(141)) - s0: shutdown s0@group-6876B2C99B77-LeaderElection27
2025-06-10 17:03:10,680 [s0@group-6876B2C99B77-LeaderElection27] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(392)) - s0@group-6876B2C99B77: changes role from CANDIDATE to LEADER at term 3 for changeToLeader
2025-06-10 17:03:10,680 [s0@group-6876B2C99B77-LeaderElection27] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(69)) - raft.server.staging.timeout = 900ms (fallback to raft.server.rpc.timeout.max)
2025-06-10 17:03:10,681 [s0@group-6876B2C99B77-LeaderElection27] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(148)) - s0: start s0@group-6876B2C99B77-LeaderStateImpl
2025-06-10 17:03:10,681 [s0@group-6876B2C99B77-LeaderElection27] INFO  server.RaftServer$Division (ServerState.java:setLeader(272)) - s0@group-6876B2C99B77: change Leader from null to s0 at term 3 for becomeLeader, leader elected after 624ms
2025-06-10 17:03:10,681 [s0@group-6876B2C99B77-LeaderElection27] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(445)) - s0@group-6876B2C99B77-SegmentedRaftLogWorker: Rolling segment log-1_1 to index:1
2025-06-10 17:03:10,682 [s0@group-6876B2C99B77-LeaderElection27] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(386)) - s0@group-6876B2C99B77: set configuration conf: {index: 2, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=null}
2025-06-10 17:03:10,683 [s0@group-6876B2C99B77-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/log_inprogress_1 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/log_1-1
2025-06-10 17:03:10,683 [s0@group-6876B2C99B77-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(604)) - s0@group-6876B2C99B77-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/log_inprogress_1 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/log_1-1
2025-06-10 17:03:10,683 [s0@group-6876B2C99B77-SegmentedRaftLogWorker] INFO  segmented.BufferedWriteChannel (BufferedWriteChannel.java:open(61)) - open log_inprogress_2 at position 0
2025-06-10 17:03:10,684 [grpc-default-executor-4] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#0-t3,previous=(t:2, i:1),leaderCommit=0,initializing? false,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSING
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:137)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:10,686 [grpc-default-executor-4] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#1-t3,previous=(t:2, i:1),leaderCommit=0,initializing? false,entries: size=1, first=(t:3, i:2), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSING
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:10,687 [grpc-default-executor-4] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(129)) - s1: Failed APPEND_ENTRIES request s0->s1#1-t3,previous=(t:2, i:1),leaderCommit=0,initializing? false,entries: size=1, first=(t:3, i:2), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSING
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:122)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSING
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	... 16 more
2025-06-10 17:03:10,692 [grpc-default-executor-4] WARN  server.GrpcLogAppender (LogUtils.java:warn(127)) - s0@group-6876B2C99B77->s1-AppendLogResponseHandler: Failed appendEntries: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSING
2025-06-10 17:03:10,692 [grpc-default-executor-4] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 2
2025-06-10 17:03:10,692 [grpc-default-executor-4] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 2
2025-06-10 17:03:10,692 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:info(70)) - s0@group-6876B2C99B77->s1: computeNextIndex nextIndex: updateUnconditionally 3 -> 2
2025-06-10 17:03:10,694 [s0@group-6876B2C99B77-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(647)) - s0@group-6876B2C99B77-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/log_inprogress_2
2025-06-10 17:03:10,723 [grpc-default-executor-3] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#2-t3,previous=(t:2, i:1),leaderCommit=0,initializing? false,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSING
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:137)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:10,724 [grpc-default-executor-3] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#3-t3,previous=(t:2, i:1),leaderCommit=0,initializing? false,entries: size=1, first=(t:3, i:2), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSING
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:10,725 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(129)) - s1: Failed APPEND_ENTRIES request s0->s1#3-t3,previous=(t:2, i:1),leaderCommit=0,initializing? false,entries: size=1, first=(t:3, i:2), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSING
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:122)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSING
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	... 16 more
2025-06-10 17:03:10,727 [grpc-default-executor-3] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 2
2025-06-10 17:03:10,727 [grpc-default-executor-3] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 2
2025-06-10 17:03:10,727 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:info(70)) - s0@group-6876B2C99B77->s1: computeNextIndex nextIndex: updateUnconditionally 3 -> 2
2025-06-10 17:03:10,762 [grpc-default-executor-3] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#4-t3,previous=(t:2, i:1),leaderCommit=0,initializing? false,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSING
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:137)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:10,763 [grpc-default-executor-3] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#5-t3,previous=(t:2, i:1),leaderCommit=0,initializing? false,entries: size=1, first=(t:3, i:2), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSING
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:10,764 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(129)) - s1: Failed APPEND_ENTRIES request s0->s1#5-t3,previous=(t:2, i:1),leaderCommit=0,initializing? false,entries: size=1, first=(t:3, i:2), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSING
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:122)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSING
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	... 16 more
2025-06-10 17:03:10,766 [grpc-default-executor-3] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 2
2025-06-10 17:03:10,766 [grpc-default-executor-3] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 2
2025-06-10 17:03:10,766 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:info(70)) - s0@group-6876B2C99B77->s1: computeNextIndex nextIndex: updateUnconditionally 3 -> 2
2025-06-10 17:03:10,801 [grpc-default-executor-4] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#6-t3,previous=(t:2, i:1),leaderCommit=0,initializing? false,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSING
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:137)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:10,802 [grpc-default-executor-4] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#7-t3,previous=(t:2, i:1),leaderCommit=0,initializing? false,entries: size=1, first=(t:3, i:2), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSING
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:10,803 [grpc-default-executor-4] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(129)) - s1: Failed APPEND_ENTRIES request s0->s1#7-t3,previous=(t:2, i:1),leaderCommit=0,initializing? false,entries: size=1, first=(t:3, i:2), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSING
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:122)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSING
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	... 16 more
2025-06-10 17:03:10,805 [grpc-default-executor-4] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 2
2025-06-10 17:03:10,805 [grpc-default-executor-4] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 2
2025-06-10 17:03:10,805 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:info(70)) - s0@group-6876B2C99B77->s1: computeNextIndex nextIndex: updateUnconditionally 3 -> 2
2025-06-10 17:03:10,841 [grpc-default-executor-3] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#8-t3,previous=(t:2, i:1),leaderCommit=0,initializing? false,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSING
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:137)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:10,842 [grpc-default-executor-3] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#9-t3,previous=(t:2, i:1),leaderCommit=0,initializing? false,entries: size=1, first=(t:3, i:2), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSING
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:10,842 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(129)) - s1: Failed APPEND_ENTRIES request s0->s1#9-t3,previous=(t:2, i:1),leaderCommit=0,initializing? false,entries: size=1, first=(t:3, i:2), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSING
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:122)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSING
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	... 16 more
2025-06-10 17:03:10,844 [grpc-default-executor-3] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 2
2025-06-10 17:03:10,844 [grpc-default-executor-3] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 2
2025-06-10 17:03:10,845 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:info(70)) - s0@group-6876B2C99B77->s1: computeNextIndex nextIndex: updateUnconditionally 3 -> 2
2025-06-10 17:03:10,881 [grpc-default-executor-3] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#10-t3,previous=(t:2, i:1),leaderCommit=0,initializing? false,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSING
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:137)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:10,882 [grpc-default-executor-3] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#11-t3,previous=(t:2, i:1),leaderCommit=0,initializing? false,entries: size=1, first=(t:3, i:2), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSING
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:10,882 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(129)) - s1: Failed APPEND_ENTRIES request s0->s1#11-t3,previous=(t:2, i:1),leaderCommit=0,initializing? false,entries: size=1, first=(t:3, i:2), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSING
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:122)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSING
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	... 16 more
2025-06-10 17:03:10,884 [grpc-default-executor-3] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 2
2025-06-10 17:03:10,884 [grpc-default-executor-3] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 2
2025-06-10 17:03:10,884 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:info(70)) - s0@group-6876B2C99B77->s1: computeNextIndex nextIndex: updateUnconditionally 3 -> 2
2025-06-10 17:03:10,920 [grpc-default-executor-3] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#12-t3,previous=(t:2, i:1),leaderCommit=0,initializing? false,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSING
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:137)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:10,921 [grpc-default-executor-3] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#13-t3,previous=(t:2, i:1),leaderCommit=0,initializing? false,entries: size=1, first=(t:3, i:2), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSING
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:10,921 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(129)) - s1: Failed APPEND_ENTRIES request s0->s1#13-t3,previous=(t:2, i:1),leaderCommit=0,initializing? false,entries: size=1, first=(t:3, i:2), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSING
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:122)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSING
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	... 16 more
2025-06-10 17:03:10,924 [grpc-default-executor-3] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 2
2025-06-10 17:03:10,924 [grpc-default-executor-3] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 2
2025-06-10 17:03:10,924 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:info(70)) - s0@group-6876B2C99B77->s1: computeNextIndex nextIndex: updateUnconditionally 3 -> 2
2025-06-10 17:03:10,959 [grpc-default-executor-3] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#14-t3,previous=(t:2, i:1),leaderCommit=0,initializing? false,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSING
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:137)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:10,960 [grpc-default-executor-3] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#15-t3,previous=(t:2, i:1),leaderCommit=0,initializing? false,entries: size=1, first=(t:3, i:2), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSING
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:10,960 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(129)) - s1: Failed APPEND_ENTRIES request s0->s1#15-t3,previous=(t:2, i:1),leaderCommit=0,initializing? false,entries: size=1, first=(t:3, i:2), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSING
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:122)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSING
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	... 16 more
2025-06-10 17:03:10,961 [s1@group-6876B2C99B77-LeaderElection26] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(254)) - s1@group-6876B2C99B77-SegmentedRaftLogWorker close()
2025-06-10 17:03:10,962 [grpc-default-executor-3] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 2
2025-06-10 17:03:10,962 [grpc-default-executor-3] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 2
2025-06-10 17:03:10,962 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:info(70)) - s0@group-6876B2C99B77->s1: computeNextIndex nextIndex: updateUnconditionally 3 -> 2
2025-06-10 17:03:10,964 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #3 failed: java.lang.IllegalStateException: Leader: s0@group-6876B2C99B77 not ready
2025-06-10 17:03:10,995 [s0@group-6876B2C99B77-LeaderStateImpl] WARN  server.RaftServer$Division (LeaderStateImpl.java:checkLeadership(1121)) - s0@group-6876B2C99B77-LeaderStateImpl: Lost leadership on term: 3. Election timeout: 300ms. In charge for: 315ms. Conf: conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
2025-06-10 17:03:10,995 [s0@group-6876B2C99B77-LeaderStateImpl] WARN  server.RaftServer$Division (LeaderStateImpl.java:lambda$checkLeadership$20(1125)) - Follower s0@group-6876B2C99B77->s1(c-1,m-1,n2, caughtUp=true, lastRpcSendTime=35, lastRpcResponseTime=614)
2025-06-10 17:03:10,996 [s0@group-6876B2C99B77-LeaderStateImpl] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(392)) - s0@group-6876B2C99B77: changes role from    LEADER to FOLLOWER at term 3 for StepDownReason:LOST_MAJORITY_HEARTBEATS
2025-06-10 17:03:10,996 [s0@group-6876B2C99B77-LeaderStateImpl] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(103)) - s0: shutdown s0@group-6876B2C99B77-LeaderStateImpl
2025-06-10 17:03:10,996 [s0@group-6876B2C99B77-LeaderStateImpl] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(287)) - s0@group-6876B2C99B77-PendingRequests: sendNotLeaderResponses
2025-06-10 17:03:10,996 [s0@group-6876B2C99B77-LeaderStateImpl] INFO  server.RaftServer$Division (ServerState.java:setLeader(272)) - s0@group-6876B2C99B77: change Leader from s0 to null at term 3 for StepDownReason:LOST_MAJORITY_HEARTBEATS
2025-06-10 17:03:10,997 [s0@group-6876B2C99B77-LeaderStateImpl] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(148)) - s0: start s0@group-6876B2C99B77-FollowerState
2025-06-10 17:03:10,996 [s0@group-6876B2C99B77->s1-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(300)) - s0@group-6876B2C99B77->s1-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2025-06-10 17:03:10,998 [grpc-default-executor-4] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(558)) - s0@group-6876B2C99B77->s1-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2025-06-10 17:03:10,998 [grpc-default-executor-3] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(558)) - s0@group-6876B2C99B77->s1-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2025-06-10 17:03:10,998 [grpc-default-executor-4] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 0
2025-06-10 17:03:10,998 [grpc-default-executor-4] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 0
2025-06-10 17:03:10,998 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:info(70)) - s0@group-6876B2C99B77->s1: computeNextIndex nextIndex: updateUnconditionally 2 -> 0
2025-06-10 17:03:11,225 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 228ms < waitTime = 10s)
2025-06-10 17:03:11,415 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #4 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t3, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:3, i:2), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:11,469 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 472ms < waitTime = 10s)
2025-06-10 17:03:11,684 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 687ms < waitTime = 10s)
2025-06-10 17:03:11,865 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #5 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t3, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:3, i:2), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:11,913 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 916ms < waitTime = 10s)
2025-06-10 17:03:12,138 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 1141ms < waitTime = 10s)
2025-06-10 17:03:12,316 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #6 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t3, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:3, i:2), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:12,367 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 1370ms < waitTime = 10s)
2025-06-10 17:03:12,590 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 1593ms < waitTime = 10s)
2025-06-10 17:03:12,767 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #7 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t3, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:3, i:2), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:12,820 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 1823ms < waitTime = 10s)
2025-06-10 17:03:13,008 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 2011ms < waitTime = 10s)
2025-06-10 17:03:13,217 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #8 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t3, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:3, i:2), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:13,235 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 2238ms < waitTime = 10s)
2025-06-10 17:03:13,456 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 2459ms < waitTime = 10s)
2025-06-10 17:03:13,668 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #9 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t3, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:3, i:2), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:13,707 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 2710ms < waitTime = 10s)
2025-06-10 17:03:13,859 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 2862ms < waitTime = 10s)
2025-06-10 17:03:14,027 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 3030ms < waitTime = 10s)
2025-06-10 17:03:14,118 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #10 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t3, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:3, i:2), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:14,228 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 3230ms < waitTime = 10s)
2025-06-10 17:03:14,471 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 3474ms < waitTime = 10s)
2025-06-10 17:03:14,569 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #11 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t3, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:3, i:2), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:14,695 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 3698ms < waitTime = 10s)
2025-06-10 17:03:14,853 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 3856ms < waitTime = 10s)
2025-06-10 17:03:15,020 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #12 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t3, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:3, i:2), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:15,023 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 4026ms < waitTime = 10s)
2025-06-10 17:03:15,058 [timer4] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:lambda$onCompleted$6(171)) - s1: Completed APPEND_ENTRIES, lastRequest: null  (Repeated 4 times in the last 5.000s)
2025-06-10 17:03:15,059 [timer5] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:lambda$null$7(175)) - s1: Completed APPEND_ENTRIES, lastReply: null  (Repeated 4 times in the last 5.001s)
2025-06-10 17:03:15,063 [timer6] WARN  server.GrpcLogAppender (GrpcLogAppender.java:lambda$onNextImpl$0(527)) - s0@group-6876B2C99B77->s1-AppendLogResponseHandler: received INCONSISTENCY reply with nextIndex 0, errorCount=1, request=AppendEntriesRequest:cid=0,entriesCount=0  (Repeated 2 times in the last 5.001s)
2025-06-10 17:03:15,200 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 4203ms < waitTime = 10s)
2025-06-10 17:03:15,468 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 4471ms < waitTime = 10s)
2025-06-10 17:03:15,470 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #13 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t3, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:3, i:2), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:15,694 [timer1] WARN  server.GrpcLogAppender (LogUtils.java:warn(127)) - s0@group-6876B2C99B77->s1-AppendLogResponseHandler: Failed appendEntries (Repeated 8 times in the last 5.003s): org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSING
2025-06-10 17:03:15,703 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 4706ms < waitTime = 10s)
2025-06-10 17:03:15,921 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #14 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t3, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:3, i:2), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:15,931 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 4934ms < waitTime = 10s)
2025-06-10 17:03:16,121 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 5124ms < waitTime = 10s)
2025-06-10 17:03:16,308 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 5311ms < waitTime = 10s)
2025-06-10 17:03:16,372 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #15 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t3, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:3, i:2), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:16,529 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 5532ms < waitTime = 10s)
2025-06-10 17:03:16,773 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 5776ms < waitTime = 10s)
2025-06-10 17:03:16,823 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #16 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t3, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:3, i:2), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:17,001 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 6004ms < waitTime = 10s)
2025-06-10 17:03:17,237 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 6239ms < waitTime = 10s)
2025-06-10 17:03:17,273 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #17 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t3, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:3, i:2), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:17,389 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 6392ms < waitTime = 10s)
2025-06-10 17:03:17,639 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 6642ms < waitTime = 10s)
2025-06-10 17:03:17,724 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #18 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t3, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:3, i:2), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:17,861 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 6864ms < waitTime = 10s)
2025-06-10 17:03:18,092 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 7095ms < waitTime = 10s)
2025-06-10 17:03:18,174 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #19 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t3, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:3, i:2), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:18,271 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 7274ms < waitTime = 10s)
2025-06-10 17:03:18,449 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 7452ms < waitTime = 10s)
2025-06-10 17:03:18,614 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 7617ms < waitTime = 10s)
2025-06-10 17:03:18,625 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #20 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t3, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:3, i:2), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:18,900 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 7903ms < waitTime = 10s)
2025-06-10 17:03:19,076 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #21 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t3, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:3, i:2), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:19,106 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 8109ms < waitTime = 10s)
2025-06-10 17:03:19,290 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 8293ms < waitTime = 10s)
2025-06-10 17:03:19,500 [Timer-10] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$null$7(351)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t3, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:3, i:2), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}.
2025-06-10 17:03:19,527 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #22 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t3, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:3, i:2), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:19,555 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 8558ms < waitTime = 10s)
2025-06-10 17:03:19,715 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 8718ms < waitTime = 10s)
2025-06-10 17:03:19,918 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 8921ms < waitTime = 10s)
2025-06-10 17:03:19,977 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #23 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t3, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:3, i:2), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:20,094 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 9097ms < waitTime = 10s)
2025-06-10 17:03:20,367 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 9370ms < waitTime = 10s)
2025-06-10 17:03:20,428 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #24 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t3, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:3, i:2), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:20,623 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 9626ms < waitTime = 10s)
2025-06-10 17:03:20,846 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 9848ms < waitTime = 10s)
2025-06-10 17:03:20,878 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #25 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t3, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:3, i:2), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:21,143 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:runImpl(161)) - s0@group-6876B2C99B77-FollowerState: change to CANDIDATE, lastRpcElapsedTime:10146297063ns, electionTimeout:297ms
2025-06-10 17:03:21,143 [s0@group-6876B2C99B77-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - s0: shutdown s0@group-6876B2C99B77-FollowerState
2025-06-10 17:03:21,143 [s0@group-6876B2C99B77-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(392)) - s0@group-6876B2C99B77: changes role from  FOLLOWER to CANDIDATE at term 3 for changeToCandidate
2025-06-10 17:03:21,143 [s0@group-6876B2C99B77-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(148)) - s0: start s0@group-6876B2C99B77-LeaderElection28
2025-06-10 17:03:21,144 [s0@group-6876B2C99B77-LeaderElection28] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(448)) - s0@group-6876B2C99B77-LeaderElection28 PRE_VOTE round 0: submit vote requests at term 3 for conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
2025-06-10 17:03:21,145 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1421)) - s1@group-6876B2C99B77: receive requestVote(PRE_VOTE, s0, group-6876B2C99B77, 3, (t:3, i:2))
2025-06-10 17:03:21,145 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: Failed requestVote s0->s1#0: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [RUNNING]: current state is CLOSED
2025-06-10 17:03:21,147 [s0@group-6876B2C99B77-LeaderElection28] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(142)) - s0@group-6876B2C99B77-LeaderElection28 got exception when requesting votes: java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: s1@group-6876B2C99B77 is not in [RUNNING]: current state is CLOSED
2025-06-10 17:03:21,148 [s0@group-6876B2C99B77-LeaderElection28] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(206)) - s0@group-6876B2C99B77-LeaderElection28: PRE_VOTE SINGLE_MODE_PASSED received 0 response(s) and 1 exception(s):
2025-06-10 17:03:21,148 [s0@group-6876B2C99B77-LeaderElection28] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(142)) -   Exception 0: java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: s1@group-6876B2C99B77 is not in [RUNNING]: current state is CLOSED
2025-06-10 17:03:21,148 [s0@group-6876B2C99B77-LeaderElection28] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(450)) - s0@group-6876B2C99B77-LeaderElection28 PRE_VOTE round 0: result SINGLE_MODE_PASSED
2025-06-10 17:03:21,148 [s0@group-6876B2C99B77-LeaderElection28] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/raft-meta.tmp with options [CREATE, TRUNCATE_EXISTING, WRITE]: sun.nio.ch.FileChannelImpl@53d15fb7
2025-06-10 17:03:21,149 [s0@group-6876B2C99B77-LeaderElection28] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/raft-meta with options [REPLACE_EXISTING]
2025-06-10 17:03:21,149 [s0@group-6876B2C99B77-LeaderElection28] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(448)) - s0@group-6876B2C99B77-LeaderElection28 ELECTION round 0: submit vote requests at term 4 for conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
2025-06-10 17:03:21,151 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1421)) - s1@group-6876B2C99B77: receive requestVote(ELECTION, s0, group-6876B2C99B77, 4, (t:3, i:2))
2025-06-10 17:03:21,151 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: Failed requestVote s0->s1#0: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [RUNNING]: current state is CLOSED
2025-06-10 17:03:21,153 [s0@group-6876B2C99B77-LeaderElection28] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(142)) - s0@group-6876B2C99B77-LeaderElection28 got exception when requesting votes: java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: s1@group-6876B2C99B77 is not in [RUNNING]: current state is CLOSED
2025-06-10 17:03:21,153 [s0@group-6876B2C99B77-LeaderElection28] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(206)) - s0@group-6876B2C99B77-LeaderElection28: ELECTION SINGLE_MODE_PASSED received 0 response(s) and 1 exception(s):
2025-06-10 17:03:21,153 [s0@group-6876B2C99B77-LeaderElection28] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(142)) -   Exception 0: java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: s1@group-6876B2C99B77 is not in [RUNNING]: current state is CLOSED
2025-06-10 17:03:21,153 [s0@group-6876B2C99B77-LeaderElection28] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(450)) - s0@group-6876B2C99B77-LeaderElection28 ELECTION round 0: result SINGLE_MODE_PASSED
2025-06-10 17:03:21,153 [s0@group-6876B2C99B77-LeaderElection28] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(141)) - s0: shutdown s0@group-6876B2C99B77-LeaderElection28
2025-06-10 17:03:21,153 [s0@group-6876B2C99B77-LeaderElection28] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(392)) - s0@group-6876B2C99B77: changes role from CANDIDATE to LEADER at term 4 for changeToLeader
2025-06-10 17:03:21,153 [s0@group-6876B2C99B77-LeaderElection28] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(69)) - raft.server.staging.timeout = 900ms (fallback to raft.server.rpc.timeout.max)
2025-06-10 17:03:21,154 [s0@group-6876B2C99B77-LeaderElection28] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(148)) - s0: start s0@group-6876B2C99B77-LeaderStateImpl
2025-06-10 17:03:21,154 [s0@group-6876B2C99B77-LeaderElection28] INFO  server.RaftServer$Division (ServerState.java:setLeader(272)) - s0@group-6876B2C99B77: change Leader from null to s0 at term 4 for becomeLeader, leader elected after 10157ms
2025-06-10 17:03:21,154 [s0@group-6876B2C99B77-LeaderElection28] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(445)) - s0@group-6876B2C99B77-SegmentedRaftLogWorker: Rolling segment log-2_2 to index:2
2025-06-10 17:03:21,154 [s0@group-6876B2C99B77-LeaderElection28] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(386)) - s0@group-6876B2C99B77: set configuration conf: {index: 3, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=null}
2025-06-10 17:03:21,155 [s0@group-6876B2C99B77-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/log_inprogress_2 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/log_2-2
2025-06-10 17:03:21,156 [s0@group-6876B2C99B77-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(604)) - s0@group-6876B2C99B77-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/log_inprogress_2 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/log_2-2
2025-06-10 17:03:21,156 [s0@group-6876B2C99B77-SegmentedRaftLogWorker] INFO  segmented.BufferedWriteChannel (BufferedWriteChannel.java:open(61)) - open log_inprogress_3 at position 0
2025-06-10 17:03:21,157 [grpc-default-executor-3] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#0-t4,previous=(t:3, i:2),leaderCommit=0,initializing? false,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:137)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:21,159 [grpc-default-executor-3] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#1-t4,previous=(t:3, i:2),leaderCommit=0,initializing? false,entries: size=1, first=(t:4, i:3), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:21,159 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(129)) - s1: Failed APPEND_ENTRIES request s0->s1#1-t4,previous=(t:3, i:2),leaderCommit=0,initializing? false,entries: size=1, first=(t:4, i:3), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:122)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	... 16 more
2025-06-10 17:03:21,163 [grpc-default-executor-3] WARN  server.GrpcLogAppender (LogUtils.java:warn(127)) - s0@group-6876B2C99B77->s1-AppendLogResponseHandler: Failed appendEntries: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
2025-06-10 17:03:21,163 [grpc-default-executor-3] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 3
2025-06-10 17:03:21,163 [grpc-default-executor-3] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 3
2025-06-10 17:03:21,163 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:info(70)) - s0@group-6876B2C99B77->s1: computeNextIndex nextIndex: updateUnconditionally 4 -> 3
2025-06-10 17:03:21,165 [s0@group-6876B2C99B77-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(647)) - s0@group-6876B2C99B77-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/log_inprogress_3
2025-06-10 17:03:21,196 [grpc-default-executor-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#2-t4,previous=(t:3, i:2),leaderCommit=0,initializing? false,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:137)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:21,197 [grpc-default-executor-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#3-t4,previous=(t:3, i:2),leaderCommit=0,initializing? false,entries: size=1, first=(t:4, i:3), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:21,198 [grpc-default-executor-2] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(129)) - s1: Failed APPEND_ENTRIES request s0->s1#3-t4,previous=(t:3, i:2),leaderCommit=0,initializing? false,entries: size=1, first=(t:4, i:3), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:122)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	... 16 more
2025-06-10 17:03:21,199 [grpc-default-executor-2] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 3
2025-06-10 17:03:21,199 [grpc-default-executor-2] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 3
2025-06-10 17:03:21,199 [grpc-default-executor-2] INFO  leader.FollowerInfo (FollowerInfoImpl.java:info(70)) - s0@group-6876B2C99B77->s1: computeNextIndex nextIndex: updateUnconditionally 4 -> 3
2025-06-10 17:03:21,236 [grpc-default-executor-3] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#4-t4,previous=(t:3, i:2),leaderCommit=0,initializing? false,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:137)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:21,237 [grpc-default-executor-3] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#5-t4,previous=(t:3, i:2),leaderCommit=0,initializing? false,entries: size=1, first=(t:4, i:3), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:21,238 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(129)) - s1: Failed APPEND_ENTRIES request s0->s1#5-t4,previous=(t:3, i:2),leaderCommit=0,initializing? false,entries: size=1, first=(t:4, i:3), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:122)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	... 16 more
2025-06-10 17:03:21,240 [grpc-default-executor-3] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 3
2025-06-10 17:03:21,240 [grpc-default-executor-3] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 3
2025-06-10 17:03:21,240 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:info(70)) - s0@group-6876B2C99B77->s1: computeNextIndex nextIndex: updateUnconditionally 4 -> 3
2025-06-10 17:03:21,276 [grpc-default-executor-3] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#6-t4,previous=(t:3, i:2),leaderCommit=0,initializing? false,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:137)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:21,277 [grpc-default-executor-3] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#7-t4,previous=(t:3, i:2),leaderCommit=0,initializing? false,entries: size=1, first=(t:4, i:3), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:21,278 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(129)) - s1: Failed APPEND_ENTRIES request s0->s1#7-t4,previous=(t:3, i:2),leaderCommit=0,initializing? false,entries: size=1, first=(t:4, i:3), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:122)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	... 16 more
2025-06-10 17:03:21,280 [grpc-default-executor-3] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 3
2025-06-10 17:03:21,280 [grpc-default-executor-3] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 3
2025-06-10 17:03:21,280 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:info(70)) - s0@group-6876B2C99B77->s1: computeNextIndex nextIndex: updateUnconditionally 4 -> 3
2025-06-10 17:03:21,316 [grpc-default-executor-3] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#8-t4,previous=(t:3, i:2),leaderCommit=0,initializing? false,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:137)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:21,317 [grpc-default-executor-3] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#9-t4,previous=(t:3, i:2),leaderCommit=0,initializing? false,entries: size=1, first=(t:4, i:3), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:21,318 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(129)) - s1: Failed APPEND_ENTRIES request s0->s1#9-t4,previous=(t:3, i:2),leaderCommit=0,initializing? false,entries: size=1, first=(t:4, i:3), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:122)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	... 16 more
2025-06-10 17:03:21,319 [grpc-default-executor-3] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 3
2025-06-10 17:03:21,319 [grpc-default-executor-3] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 3
2025-06-10 17:03:21,320 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:info(70)) - s0@group-6876B2C99B77->s1: computeNextIndex nextIndex: updateUnconditionally 4 -> 3
2025-06-10 17:03:21,329 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #26 failed: java.lang.IllegalStateException: Leader: s0@group-6876B2C99B77 not ready
2025-06-10 17:03:21,356 [grpc-default-executor-3] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#10-t4,previous=(t:3, i:2),leaderCommit=0,initializing? false,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:137)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:21,357 [grpc-default-executor-3] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#11-t4,previous=(t:3, i:2),leaderCommit=0,initializing? false,entries: size=1, first=(t:4, i:3), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:21,357 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(129)) - s1: Failed APPEND_ENTRIES request s0->s1#11-t4,previous=(t:3, i:2),leaderCommit=0,initializing? false,entries: size=1, first=(t:4, i:3), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:122)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	... 16 more
2025-06-10 17:03:21,359 [grpc-default-executor-3] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 3
2025-06-10 17:03:21,359 [grpc-default-executor-3] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 3
2025-06-10 17:03:21,359 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:info(70)) - s0@group-6876B2C99B77->s1: computeNextIndex nextIndex: updateUnconditionally 4 -> 3
2025-06-10 17:03:21,395 [grpc-default-executor-3] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#12-t4,previous=(t:3, i:2),leaderCommit=0,initializing? false,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:137)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:21,396 [grpc-default-executor-3] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#13-t4,previous=(t:3, i:2),leaderCommit=0,initializing? false,entries: size=1, first=(t:4, i:3), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:21,396 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(129)) - s1: Failed APPEND_ENTRIES request s0->s1#13-t4,previous=(t:3, i:2),leaderCommit=0,initializing? false,entries: size=1, first=(t:4, i:3), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:122)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	... 16 more
2025-06-10 17:03:21,399 [grpc-default-executor-3] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 3
2025-06-10 17:03:21,399 [grpc-default-executor-3] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 3
2025-06-10 17:03:21,399 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:info(70)) - s0@group-6876B2C99B77->s1: computeNextIndex nextIndex: updateUnconditionally 4 -> 3
2025-06-10 17:03:21,433 [grpc-default-executor-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#14-t4,previous=(t:3, i:2),leaderCommit=0,initializing? false,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:137)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:21,435 [grpc-default-executor-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#15-t4,previous=(t:3, i:2),leaderCommit=0,initializing? false,entries: size=1, first=(t:4, i:3), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:21,435 [grpc-default-executor-2] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(129)) - s1: Failed APPEND_ENTRIES request s0->s1#15-t4,previous=(t:3, i:2),leaderCommit=0,initializing? false,entries: size=1, first=(t:4, i:3), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:122)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	... 16 more
2025-06-10 17:03:21,438 [grpc-default-executor-2] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 3
2025-06-10 17:03:21,438 [grpc-default-executor-2] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 3
2025-06-10 17:03:21,438 [grpc-default-executor-2] INFO  leader.FollowerInfo (FollowerInfoImpl.java:info(70)) - s0@group-6876B2C99B77->s1: computeNextIndex nextIndex: updateUnconditionally 4 -> 3
2025-06-10 17:03:21,466 [s0@group-6876B2C99B77-LeaderStateImpl] WARN  server.RaftServer$Division (LeaderStateImpl.java:checkLeadership(1121)) - s0@group-6876B2C99B77-LeaderStateImpl: Lost leadership on term: 4. Election timeout: 300ms. In charge for: 312ms. Conf: conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
2025-06-10 17:03:21,466 [s0@group-6876B2C99B77-LeaderStateImpl] WARN  server.RaftServer$Division (LeaderStateImpl.java:lambda$checkLeadership$20(1125)) - Follower s0@group-6876B2C99B77->s1(c-1,m-1,n3, caughtUp=true, lastRpcSendTime=31, lastRpcResponseTime=612)
2025-06-10 17:03:21,466 [s0@group-6876B2C99B77-LeaderStateImpl] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(392)) - s0@group-6876B2C99B77: changes role from    LEADER to FOLLOWER at term 4 for StepDownReason:LOST_MAJORITY_HEARTBEATS
2025-06-10 17:03:21,466 [s0@group-6876B2C99B77-LeaderStateImpl] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(103)) - s0: shutdown s0@group-6876B2C99B77-LeaderStateImpl
2025-06-10 17:03:21,466 [s0@group-6876B2C99B77->s1-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(300)) - s0@group-6876B2C99B77->s1-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2025-06-10 17:03:21,466 [s0@group-6876B2C99B77-LeaderStateImpl] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(287)) - s0@group-6876B2C99B77-PendingRequests: sendNotLeaderResponses
2025-06-10 17:03:21,467 [s0@group-6876B2C99B77-LeaderStateImpl] INFO  server.RaftServer$Division (ServerState.java:setLeader(272)) - s0@group-6876B2C99B77: change Leader from s0 to null at term 4 for StepDownReason:LOST_MAJORITY_HEARTBEATS
2025-06-10 17:03:21,467 [s0@group-6876B2C99B77-LeaderStateImpl] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(148)) - s0: start s0@group-6876B2C99B77-FollowerState
2025-06-10 17:03:21,669 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 202ms < waitTime = 10s)
2025-06-10 17:03:21,779 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #27 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t4, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:4, i:3), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:21,914 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 446ms < waitTime = 10s)
2025-06-10 17:03:22,070 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 603ms < waitTime = 10s)
2025-06-10 17:03:22,230 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #28 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t4, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:4, i:3), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:22,269 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 802ms < waitTime = 10s)
2025-06-10 17:03:22,469 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 1002ms < waitTime = 10s)
2025-06-10 17:03:22,681 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #29 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t4, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:4, i:3), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:22,695 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 1228ms < waitTime = 10s)
2025-06-10 17:03:22,965 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 1498ms < waitTime = 10s)
2025-06-10 17:03:23,132 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #30 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t4, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:4, i:3), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:23,187 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 1720ms < waitTime = 10s)
2025-06-10 17:03:23,411 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 1944ms < waitTime = 10s)
2025-06-10 17:03:23,582 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #31 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t4, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:4, i:3), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:23,634 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 2167ms < waitTime = 10s)
2025-06-10 17:03:23,812 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 2345ms < waitTime = 10s)
2025-06-10 17:03:23,995 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 2528ms < waitTime = 10s)
2025-06-10 17:03:24,033 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #32 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t4, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:4, i:3), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:24,259 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 2792ms < waitTime = 10s)
2025-06-10 17:03:24,457 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 2990ms < waitTime = 10s)
2025-06-10 17:03:24,483 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #33 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t4, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:4, i:3), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:24,739 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 3272ms < waitTime = 10s)
2025-06-10 17:03:24,934 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #34 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t4, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:4, i:3), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:24,988 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 3521ms < waitTime = 10s)
2025-06-10 17:03:25,254 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 3787ms < waitTime = 10s)
2025-06-10 17:03:25,385 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #35 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t4, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:4, i:3), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:25,433 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 3966ms < waitTime = 10s)
2025-06-10 17:03:25,590 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 4122ms < waitTime = 10s)
2025-06-10 17:03:25,835 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #36 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t4, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:4, i:3), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:25,862 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 4395ms < waitTime = 10s)
2025-06-10 17:03:26,161 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 4694ms < waitTime = 10s)
2025-06-10 17:03:26,164 [timer3] WARN  server.GrpcLogAppender (LogUtils.java:warn(127)) - s0@group-6876B2C99B77->s1-AppendLogResponseHandler: Failed appendEntries (Repeated 8 times in the last 5.001s): org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
2025-06-10 17:03:26,286 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #37 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t4, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:4, i:3), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:26,423 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 4955ms < waitTime = 10s)
2025-06-10 17:03:26,596 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 5129ms < waitTime = 10s)
2025-06-10 17:03:26,736 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #38 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t4, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:4, i:3), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:26,888 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 5421ms < waitTime = 10s)
2025-06-10 17:03:27,071 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 5604ms < waitTime = 10s)
2025-06-10 17:03:27,187 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #39 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t4, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:4, i:3), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:27,248 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 5781ms < waitTime = 10s)
2025-06-10 17:03:27,526 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 6059ms < waitTime = 10s)
2025-06-10 17:03:27,638 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #40 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t4, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:4, i:3), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:27,788 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 6321ms < waitTime = 10s)
2025-06-10 17:03:28,081 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 6613ms < waitTime = 10s)
2025-06-10 17:03:28,088 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #41 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t4, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:4, i:3), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:28,317 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 6850ms < waitTime = 10s)
2025-06-10 17:03:28,471 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 7004ms < waitTime = 10s)
2025-06-10 17:03:28,539 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #42 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t4, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:4, i:3), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:28,728 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 7261ms < waitTime = 10s)
2025-06-10 17:03:28,897 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 7430ms < waitTime = 10s)
2025-06-10 17:03:28,990 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #43 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t4, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:4, i:3), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:29,060 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 7593ms < waitTime = 10s)
2025-06-10 17:03:29,288 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 7821ms < waitTime = 10s)
2025-06-10 17:03:29,440 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #44 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t4, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:4, i:3), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:29,452 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 7984ms < waitTime = 10s)
2025-06-10 17:03:29,500 [Timer-10] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$null$7(351)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t4, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:4, i:3), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}.
2025-06-10 17:03:29,647 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 8180ms < waitTime = 10s)
2025-06-10 17:03:29,891 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #45 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t4, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:4, i:3), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:29,902 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 8435ms < waitTime = 10s)
2025-06-10 17:03:30,188 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 8721ms < waitTime = 10s)
2025-06-10 17:03:30,342 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #46 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t4, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:4, i:3), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:30,365 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 8897ms < waitTime = 10s)
2025-06-10 17:03:30,624 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 9157ms < waitTime = 10s)
2025-06-10 17:03:30,792 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #47 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t4, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:4, i:3), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:30,923 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 9456ms < waitTime = 10s)
2025-06-10 17:03:31,143 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 9676ms < waitTime = 10s)
2025-06-10 17:03:31,243 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #48 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t4, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:4, i:3), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:31,373 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 9906ms < waitTime = 10s)
2025-06-10 17:03:31,602 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:runImpl(161)) - s0@group-6876B2C99B77-FollowerState: change to CANDIDATE, lastRpcElapsedTime:10135379376ns, electionTimeout:229ms
2025-06-10 17:03:31,602 [s0@group-6876B2C99B77-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - s0: shutdown s0@group-6876B2C99B77-FollowerState
2025-06-10 17:03:31,602 [s0@group-6876B2C99B77-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(392)) - s0@group-6876B2C99B77: changes role from  FOLLOWER to CANDIDATE at term 4 for changeToCandidate
2025-06-10 17:03:31,602 [s0@group-6876B2C99B77-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(148)) - s0: start s0@group-6876B2C99B77-LeaderElection29
2025-06-10 17:03:31,603 [s0@group-6876B2C99B77-LeaderElection29] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(448)) - s0@group-6876B2C99B77-LeaderElection29 PRE_VOTE round 0: submit vote requests at term 4 for conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
2025-06-10 17:03:31,604 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1421)) - s1@group-6876B2C99B77: receive requestVote(PRE_VOTE, s0, group-6876B2C99B77, 4, (t:4, i:3))
2025-06-10 17:03:31,604 [grpc-default-executor-2] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: Failed requestVote s0->s1#0: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [RUNNING]: current state is CLOSED
2025-06-10 17:03:31,606 [s0@group-6876B2C99B77-LeaderElection29] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(142)) - s0@group-6876B2C99B77-LeaderElection29 got exception when requesting votes: java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: s1@group-6876B2C99B77 is not in [RUNNING]: current state is CLOSED
2025-06-10 17:03:31,606 [s0@group-6876B2C99B77-LeaderElection29] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(206)) - s0@group-6876B2C99B77-LeaderElection29: PRE_VOTE SINGLE_MODE_PASSED received 0 response(s) and 1 exception(s):
2025-06-10 17:03:31,606 [s0@group-6876B2C99B77-LeaderElection29] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(142)) -   Exception 0: java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: s1@group-6876B2C99B77 is not in [RUNNING]: current state is CLOSED
2025-06-10 17:03:31,607 [s0@group-6876B2C99B77-LeaderElection29] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(450)) - s0@group-6876B2C99B77-LeaderElection29 PRE_VOTE round 0: result SINGLE_MODE_PASSED
2025-06-10 17:03:31,607 [s0@group-6876B2C99B77-LeaderElection29] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/raft-meta.tmp with options [CREATE, TRUNCATE_EXISTING, WRITE]: sun.nio.ch.FileChannelImpl@354ca15e
2025-06-10 17:03:31,608 [s0@group-6876B2C99B77-LeaderElection29] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/raft-meta with options [REPLACE_EXISTING]
2025-06-10 17:03:31,608 [s0@group-6876B2C99B77-LeaderElection29] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(448)) - s0@group-6876B2C99B77-LeaderElection29 ELECTION round 0: submit vote requests at term 5 for conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
2025-06-10 17:03:31,610 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1421)) - s1@group-6876B2C99B77: receive requestVote(ELECTION, s0, group-6876B2C99B77, 5, (t:4, i:3))
2025-06-10 17:03:31,610 [grpc-default-executor-2] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: Failed requestVote s0->s1#0: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [RUNNING]: current state is CLOSED
2025-06-10 17:03:31,611 [s0@group-6876B2C99B77-LeaderElection29] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(142)) - s0@group-6876B2C99B77-LeaderElection29 got exception when requesting votes: java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: s1@group-6876B2C99B77 is not in [RUNNING]: current state is CLOSED
2025-06-10 17:03:31,611 [s0@group-6876B2C99B77-LeaderElection29] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(206)) - s0@group-6876B2C99B77-LeaderElection29: ELECTION SINGLE_MODE_PASSED received 0 response(s) and 1 exception(s):
2025-06-10 17:03:31,611 [s0@group-6876B2C99B77-LeaderElection29] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(142)) -   Exception 0: java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: s1@group-6876B2C99B77 is not in [RUNNING]: current state is CLOSED
2025-06-10 17:03:31,611 [s0@group-6876B2C99B77-LeaderElection29] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(450)) - s0@group-6876B2C99B77-LeaderElection29 ELECTION round 0: result SINGLE_MODE_PASSED
2025-06-10 17:03:31,611 [s0@group-6876B2C99B77-LeaderElection29] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(141)) - s0: shutdown s0@group-6876B2C99B77-LeaderElection29
2025-06-10 17:03:31,611 [s0@group-6876B2C99B77-LeaderElection29] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(392)) - s0@group-6876B2C99B77: changes role from CANDIDATE to LEADER at term 5 for changeToLeader
2025-06-10 17:03:31,612 [s0@group-6876B2C99B77-LeaderElection29] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(69)) - raft.server.staging.timeout = 900ms (fallback to raft.server.rpc.timeout.max)
2025-06-10 17:03:31,612 [s0@group-6876B2C99B77-LeaderElection29] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(148)) - s0: start s0@group-6876B2C99B77-LeaderStateImpl
2025-06-10 17:03:31,612 [s0@group-6876B2C99B77-LeaderElection29] INFO  server.RaftServer$Division (ServerState.java:setLeader(272)) - s0@group-6876B2C99B77: change Leader from null to s0 at term 5 for becomeLeader, leader elected after 10145ms
2025-06-10 17:03:31,613 [s0@group-6876B2C99B77-LeaderElection29] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(445)) - s0@group-6876B2C99B77-SegmentedRaftLogWorker: Rolling segment log-3_3 to index:3
2025-06-10 17:03:31,613 [s0@group-6876B2C99B77-LeaderElection29] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(386)) - s0@group-6876B2C99B77: set configuration conf: {index: 4, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=null}
2025-06-10 17:03:31,614 [s0@group-6876B2C99B77-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/log_inprogress_3 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/log_3-3
2025-06-10 17:03:31,614 [s0@group-6876B2C99B77-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(604)) - s0@group-6876B2C99B77-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/log_inprogress_3 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/log_3-3
2025-06-10 17:03:31,614 [s0@group-6876B2C99B77-SegmentedRaftLogWorker] INFO  segmented.BufferedWriteChannel (BufferedWriteChannel.java:open(61)) - open log_inprogress_4 at position 0
2025-06-10 17:03:31,615 [grpc-default-executor-3] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#0-t5,previous=(t:4, i:3),leaderCommit=0,initializing? false,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:137)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:31,617 [grpc-default-executor-3] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#1-t5,previous=(t:4, i:3),leaderCommit=0,initializing? false,entries: size=1, first=(t:5, i:4), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:31,617 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(129)) - s1: Failed APPEND_ENTRIES request s0->s1#1-t5,previous=(t:4, i:3),leaderCommit=0,initializing? false,entries: size=1, first=(t:5, i:4), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:122)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	... 16 more
2025-06-10 17:03:31,620 [grpc-default-executor-3] WARN  server.GrpcLogAppender (LogUtils.java:warn(127)) - s0@group-6876B2C99B77->s1-AppendLogResponseHandler: Failed appendEntries: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
2025-06-10 17:03:31,620 [grpc-default-executor-3] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 4
2025-06-10 17:03:31,620 [grpc-default-executor-3] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 4
2025-06-10 17:03:31,620 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:info(70)) - s0@group-6876B2C99B77->s1: computeNextIndex nextIndex: updateUnconditionally 5 -> 4
2025-06-10 17:03:31,623 [s0@group-6876B2C99B77-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(647)) - s0@group-6876B2C99B77-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/log_inprogress_4
2025-06-10 17:03:31,654 [grpc-default-executor-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#2-t5,previous=(t:4, i:3),leaderCommit=0,initializing? false,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:137)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:31,656 [grpc-default-executor-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#3-t5,previous=(t:4, i:3),leaderCommit=0,initializing? false,entries: size=1, first=(t:5, i:4), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:31,656 [grpc-default-executor-2] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(129)) - s1: Failed APPEND_ENTRIES request s0->s1#3-t5,previous=(t:4, i:3),leaderCommit=0,initializing? false,entries: size=1, first=(t:5, i:4), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:122)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	... 16 more
2025-06-10 17:03:31,658 [grpc-default-executor-2] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 4
2025-06-10 17:03:31,658 [grpc-default-executor-2] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 4
2025-06-10 17:03:31,658 [grpc-default-executor-2] INFO  leader.FollowerInfo (FollowerInfoImpl.java:info(70)) - s0@group-6876B2C99B77->s1: computeNextIndex nextIndex: updateUnconditionally 5 -> 4
2025-06-10 17:03:31,693 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #49 failed: java.lang.IllegalStateException: Leader: s0@group-6876B2C99B77 not ready
2025-06-10 17:03:31,694 [grpc-default-executor-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#4-t5,previous=(t:4, i:3),leaderCommit=0,initializing? false,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:137)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:31,696 [grpc-default-executor-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#5-t5,previous=(t:4, i:3),leaderCommit=0,initializing? false,entries: size=1, first=(t:5, i:4), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:31,696 [grpc-default-executor-2] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(129)) - s1: Failed APPEND_ENTRIES request s0->s1#5-t5,previous=(t:4, i:3),leaderCommit=0,initializing? false,entries: size=1, first=(t:5, i:4), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:122)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	... 16 more
2025-06-10 17:03:31,697 [grpc-default-executor-2] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 4
2025-06-10 17:03:31,698 [grpc-default-executor-2] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 4
2025-06-10 17:03:31,698 [grpc-default-executor-2] INFO  leader.FollowerInfo (FollowerInfoImpl.java:info(70)) - s0@group-6876B2C99B77->s1: computeNextIndex nextIndex: updateUnconditionally 5 -> 4
2025-06-10 17:03:31,733 [grpc-default-executor-3] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#6-t5,previous=(t:4, i:3),leaderCommit=0,initializing? false,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:137)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:31,734 [grpc-default-executor-3] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#7-t5,previous=(t:4, i:3),leaderCommit=0,initializing? false,entries: size=1, first=(t:5, i:4), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:31,735 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(129)) - s1: Failed APPEND_ENTRIES request s0->s1#7-t5,previous=(t:4, i:3),leaderCommit=0,initializing? false,entries: size=1, first=(t:5, i:4), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:122)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	... 16 more
2025-06-10 17:03:31,737 [grpc-default-executor-3] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 4
2025-06-10 17:03:31,737 [grpc-default-executor-3] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 4
2025-06-10 17:03:31,737 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:info(70)) - s0@group-6876B2C99B77->s1: computeNextIndex nextIndex: updateUnconditionally 5 -> 4
2025-06-10 17:03:31,773 [grpc-default-executor-3] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#8-t5,previous=(t:4, i:3),leaderCommit=0,initializing? false,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:137)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:31,774 [grpc-default-executor-3] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#9-t5,previous=(t:4, i:3),leaderCommit=0,initializing? false,entries: size=1, first=(t:5, i:4), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:31,775 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(129)) - s1: Failed APPEND_ENTRIES request s0->s1#9-t5,previous=(t:4, i:3),leaderCommit=0,initializing? false,entries: size=1, first=(t:5, i:4), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:122)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	... 16 more
2025-06-10 17:03:31,776 [grpc-default-executor-3] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 4
2025-06-10 17:03:31,776 [grpc-default-executor-3] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 4
2025-06-10 17:03:31,776 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:info(70)) - s0@group-6876B2C99B77->s1: computeNextIndex nextIndex: updateUnconditionally 5 -> 4
2025-06-10 17:03:31,813 [grpc-default-executor-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#10-t5,previous=(t:4, i:3),leaderCommit=0,initializing? false,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:137)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:31,814 [grpc-default-executor-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#11-t5,previous=(t:4, i:3),leaderCommit=0,initializing? false,entries: size=1, first=(t:5, i:4), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:31,815 [grpc-default-executor-2] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(129)) - s1: Failed APPEND_ENTRIES request s0->s1#11-t5,previous=(t:4, i:3),leaderCommit=0,initializing? false,entries: size=1, first=(t:5, i:4), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:122)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	... 16 more
2025-06-10 17:03:31,816 [grpc-default-executor-2] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 4
2025-06-10 17:03:31,816 [grpc-default-executor-2] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 4
2025-06-10 17:03:31,816 [grpc-default-executor-2] INFO  leader.FollowerInfo (FollowerInfoImpl.java:info(70)) - s0@group-6876B2C99B77->s1: computeNextIndex nextIndex: updateUnconditionally 5 -> 4
2025-06-10 17:03:31,853 [grpc-default-executor-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#12-t5,previous=(t:4, i:3),leaderCommit=0,initializing? false,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:137)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:31,854 [grpc-default-executor-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#13-t5,previous=(t:4, i:3),leaderCommit=0,initializing? false,entries: size=1, first=(t:5, i:4), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:31,854 [grpc-default-executor-2] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(129)) - s1: Failed APPEND_ENTRIES request s0->s1#13-t5,previous=(t:4, i:3),leaderCommit=0,initializing? false,entries: size=1, first=(t:5, i:4), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:122)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	... 16 more
2025-06-10 17:03:31,856 [grpc-default-executor-2] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 4
2025-06-10 17:03:31,857 [grpc-default-executor-2] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 4
2025-06-10 17:03:31,857 [grpc-default-executor-2] INFO  leader.FollowerInfo (FollowerInfoImpl.java:info(70)) - s0@group-6876B2C99B77->s1: computeNextIndex nextIndex: updateUnconditionally 5 -> 4
2025-06-10 17:03:31,892 [grpc-default-executor-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#14-t5,previous=(t:4, i:3),leaderCommit=0,initializing? false,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:137)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:31,893 [grpc-default-executor-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#15-t5,previous=(t:4, i:3),leaderCommit=0,initializing? false,entries: size=1, first=(t:5, i:4), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:31,893 [grpc-default-executor-2] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(129)) - s1: Failed APPEND_ENTRIES request s0->s1#15-t5,previous=(t:4, i:3),leaderCommit=0,initializing? false,entries: size=1, first=(t:5, i:4), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:122)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	... 16 more
2025-06-10 17:03:31,895 [grpc-default-executor-2] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 4
2025-06-10 17:03:31,895 [grpc-default-executor-2] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 4
2025-06-10 17:03:31,895 [grpc-default-executor-2] INFO  leader.FollowerInfo (FollowerInfoImpl.java:info(70)) - s0@group-6876B2C99B77->s1: computeNextIndex nextIndex: updateUnconditionally 5 -> 4
2025-06-10 17:03:31,924 [s0@group-6876B2C99B77-LeaderStateImpl] WARN  server.RaftServer$Division (LeaderStateImpl.java:checkLeadership(1121)) - s0@group-6876B2C99B77-LeaderStateImpl: Lost leadership on term: 5. Election timeout: 300ms. In charge for: 312ms. Conf: conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
2025-06-10 17:03:31,924 [s0@group-6876B2C99B77-LeaderStateImpl] WARN  server.RaftServer$Division (LeaderStateImpl.java:lambda$checkLeadership$20(1125)) - Follower s0@group-6876B2C99B77->s1(c-1,m-1,n4, caughtUp=true, lastRpcSendTime=31, lastRpcResponseTime=612)
2025-06-10 17:03:31,924 [s0@group-6876B2C99B77-LeaderStateImpl] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(392)) - s0@group-6876B2C99B77: changes role from    LEADER to FOLLOWER at term 5 for StepDownReason:LOST_MAJORITY_HEARTBEATS
2025-06-10 17:03:31,924 [s0@group-6876B2C99B77-LeaderStateImpl] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(103)) - s0: shutdown s0@group-6876B2C99B77-LeaderStateImpl
2025-06-10 17:03:31,924 [s0@group-6876B2C99B77->s1-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(300)) - s0@group-6876B2C99B77->s1-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2025-06-10 17:03:31,925 [s0@group-6876B2C99B77-LeaderStateImpl] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(287)) - s0@group-6876B2C99B77-PendingRequests: sendNotLeaderResponses
2025-06-10 17:03:31,925 [s0@group-6876B2C99B77-LeaderStateImpl] INFO  server.RaftServer$Division (ServerState.java:setLeader(272)) - s0@group-6876B2C99B77: change Leader from s0 to null at term 5 for StepDownReason:LOST_MAJORITY_HEARTBEATS
2025-06-10 17:03:31,925 [s0@group-6876B2C99B77-LeaderStateImpl] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(148)) - s0: start s0@group-6876B2C99B77-FollowerState
2025-06-10 17:03:32,141 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 216ms < waitTime = 10s)
2025-06-10 17:03:32,144 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #50 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t5, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:5, i:4), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:32,395 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 469ms < waitTime = 10s)
2025-06-10 17:03:32,594 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #51 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t5, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:5, i:4), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:32,670 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 744ms < waitTime = 10s)
2025-06-10 17:03:32,856 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 931ms < waitTime = 10s)
2025-06-10 17:03:33,017 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 1092ms < waitTime = 10s)
2025-06-10 17:03:33,045 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #52 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t5, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:5, i:4), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:33,240 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 1314ms < waitTime = 10s)
2025-06-10 17:03:33,496 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #53 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t5, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:5, i:4), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:33,523 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 1598ms < waitTime = 10s)
2025-06-10 17:03:33,700 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 1775ms < waitTime = 10s)
2025-06-10 17:03:33,855 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 1929ms < waitTime = 10s)
2025-06-10 17:03:33,946 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #54 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t5, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:5, i:4), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:34,060 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 2135ms < waitTime = 10s)
2025-06-10 17:03:34,266 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 2341ms < waitTime = 10s)
2025-06-10 17:03:34,397 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #55 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t5, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:5, i:4), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:34,460 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 2534ms < waitTime = 10s)
2025-06-10 17:03:34,657 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 2731ms < waitTime = 10s)
2025-06-10 17:03:34,812 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 2887ms < waitTime = 10s)
2025-06-10 17:03:34,847 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #56 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t5, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:5, i:4), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:35,013 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 3088ms < waitTime = 10s)
2025-06-10 17:03:35,165 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 3239ms < waitTime = 10s)
2025-06-10 17:03:35,298 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #57 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t5, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:5, i:4), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:35,392 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 3466ms < waitTime = 10s)
2025-06-10 17:03:35,548 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 3623ms < waitTime = 10s)
2025-06-10 17:03:35,744 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 3819ms < waitTime = 10s)
2025-06-10 17:03:35,749 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #58 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t5, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:5, i:4), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:35,908 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 3982ms < waitTime = 10s)
2025-06-10 17:03:36,100 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 4175ms < waitTime = 10s)
2025-06-10 17:03:36,199 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #59 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t5, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:5, i:4), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:36,278 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 4353ms < waitTime = 10s)
2025-06-10 17:03:36,577 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 4651ms < waitTime = 10s)
2025-06-10 17:03:36,622 [timer3] WARN  server.GrpcLogAppender (LogUtils.java:warn(127)) - s0@group-6876B2C99B77->s1-AppendLogResponseHandler: Failed appendEntries (Repeated 8 times in the last 5.001s): org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
2025-06-10 17:03:36,650 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #60 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t5, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:5, i:4), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:36,852 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 4927ms < waitTime = 10s)
2025-06-10 17:03:37,100 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #61 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t5, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:5, i:4), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:37,133 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 5208ms < waitTime = 10s)
2025-06-10 17:03:37,368 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 5443ms < waitTime = 10s)
2025-06-10 17:03:37,530 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 5604ms < waitTime = 10s)
2025-06-10 17:03:37,551 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #62 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t5, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:5, i:4), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:37,711 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 5786ms < waitTime = 10s)
2025-06-10 17:03:37,892 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 5967ms < waitTime = 10s)
2025-06-10 17:03:38,001 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #63 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t5, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:5, i:4), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:38,161 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 6235ms < waitTime = 10s)
2025-06-10 17:03:38,326 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 6400ms < waitTime = 10s)
2025-06-10 17:03:38,452 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #64 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t5, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:5, i:4), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:38,560 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 6635ms < waitTime = 10s)
2025-06-10 17:03:38,747 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 6822ms < waitTime = 10s)
2025-06-10 17:03:38,903 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #65 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t5, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:5, i:4), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:38,998 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 7072ms < waitTime = 10s)
2025-06-10 17:03:39,222 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 7297ms < waitTime = 10s)
2025-06-10 17:03:39,353 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #66 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t5, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:5, i:4), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:39,412 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 7487ms < waitTime = 10s)
2025-06-10 17:03:39,500 [Timer-10] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$null$7(351)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t5, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:5, i:4), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}.
2025-06-10 17:03:39,625 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 7699ms < waitTime = 10s)
2025-06-10 17:03:39,804 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #67 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t5, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:5, i:4), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:39,838 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 7912ms < waitTime = 10s)
2025-06-10 17:03:40,008 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 8083ms < waitTime = 10s)
2025-06-10 17:03:40,216 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 8291ms < waitTime = 10s)
2025-06-10 17:03:40,254 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #68 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t5, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:5, i:4), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:40,499 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 8573ms < waitTime = 10s)
2025-06-10 17:03:40,705 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #69 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t5, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:5, i:4), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:40,766 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 8841ms < waitTime = 10s)
2025-06-10 17:03:40,943 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 9018ms < waitTime = 10s)
2025-06-10 17:03:41,156 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #70 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t5, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:5, i:4), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:41,169 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 9244ms < waitTime = 10s)
2025-06-10 17:03:41,427 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 9501ms < waitTime = 10s)
2025-06-10 17:03:41,606 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #71 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t5, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:5, i:4), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:41,654 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 9729ms < waitTime = 10s)
2025-06-10 17:03:41,905 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 9980ms < waitTime = 10s)
2025-06-10 17:03:42,057 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #72 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t5, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:5, i:4), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:42,143 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:runImpl(161)) - s0@group-6876B2C99B77-FollowerState: change to CANDIDATE, lastRpcElapsedTime:10217704329ns, electionTimeout:237ms
2025-06-10 17:03:42,143 [s0@group-6876B2C99B77-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - s0: shutdown s0@group-6876B2C99B77-FollowerState
2025-06-10 17:03:42,143 [s0@group-6876B2C99B77-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(392)) - s0@group-6876B2C99B77: changes role from  FOLLOWER to CANDIDATE at term 5 for changeToCandidate
2025-06-10 17:03:42,143 [s0@group-6876B2C99B77-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(148)) - s0: start s0@group-6876B2C99B77-LeaderElection30
2025-06-10 17:03:42,143 [s0@group-6876B2C99B77-LeaderElection30] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(448)) - s0@group-6876B2C99B77-LeaderElection30 PRE_VOTE round 0: submit vote requests at term 5 for conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
2025-06-10 17:03:42,145 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1421)) - s1@group-6876B2C99B77: receive requestVote(PRE_VOTE, s0, group-6876B2C99B77, 5, (t:5, i:4))
2025-06-10 17:03:42,145 [grpc-default-executor-2] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: Failed requestVote s0->s1#0: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [RUNNING]: current state is CLOSED
2025-06-10 17:03:42,146 [s0@group-6876B2C99B77-LeaderElection30] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(142)) - s0@group-6876B2C99B77-LeaderElection30 got exception when requesting votes: java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: s1@group-6876B2C99B77 is not in [RUNNING]: current state is CLOSED
2025-06-10 17:03:42,146 [s0@group-6876B2C99B77-LeaderElection30] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(206)) - s0@group-6876B2C99B77-LeaderElection30: PRE_VOTE SINGLE_MODE_PASSED received 0 response(s) and 1 exception(s):
2025-06-10 17:03:42,147 [s0@group-6876B2C99B77-LeaderElection30] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(142)) -   Exception 0: java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: s1@group-6876B2C99B77 is not in [RUNNING]: current state is CLOSED
2025-06-10 17:03:42,147 [s0@group-6876B2C99B77-LeaderElection30] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(450)) - s0@group-6876B2C99B77-LeaderElection30 PRE_VOTE round 0: result SINGLE_MODE_PASSED
2025-06-10 17:03:42,147 [s0@group-6876B2C99B77-LeaderElection30] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/raft-meta.tmp with options [CREATE, TRUNCATE_EXISTING, WRITE]: sun.nio.ch.FileChannelImpl@6b3e843d
2025-06-10 17:03:42,148 [s0@group-6876B2C99B77-LeaderElection30] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/raft-meta with options [REPLACE_EXISTING]
2025-06-10 17:03:42,148 [s0@group-6876B2C99B77-LeaderElection30] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(448)) - s0@group-6876B2C99B77-LeaderElection30 ELECTION round 0: submit vote requests at term 6 for conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
2025-06-10 17:03:42,149 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1421)) - s1@group-6876B2C99B77: receive requestVote(ELECTION, s0, group-6876B2C99B77, 6, (t:5, i:4))
2025-06-10 17:03:42,149 [grpc-default-executor-2] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: Failed requestVote s0->s1#0: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [RUNNING]: current state is CLOSED
2025-06-10 17:03:42,150 [s0@group-6876B2C99B77-LeaderElection30] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(142)) - s0@group-6876B2C99B77-LeaderElection30 got exception when requesting votes: java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: s1@group-6876B2C99B77 is not in [RUNNING]: current state is CLOSED
2025-06-10 17:03:42,150 [s0@group-6876B2C99B77-LeaderElection30] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(206)) - s0@group-6876B2C99B77-LeaderElection30: ELECTION SINGLE_MODE_PASSED received 0 response(s) and 1 exception(s):
2025-06-10 17:03:42,150 [s0@group-6876B2C99B77-LeaderElection30] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(142)) -   Exception 0: java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: s1@group-6876B2C99B77 is not in [RUNNING]: current state is CLOSED
2025-06-10 17:03:42,150 [s0@group-6876B2C99B77-LeaderElection30] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(450)) - s0@group-6876B2C99B77-LeaderElection30 ELECTION round 0: result SINGLE_MODE_PASSED
2025-06-10 17:03:42,150 [s0@group-6876B2C99B77-LeaderElection30] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(141)) - s0: shutdown s0@group-6876B2C99B77-LeaderElection30
2025-06-10 17:03:42,150 [s0@group-6876B2C99B77-LeaderElection30] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(392)) - s0@group-6876B2C99B77: changes role from CANDIDATE to LEADER at term 6 for changeToLeader
2025-06-10 17:03:42,150 [s0@group-6876B2C99B77-LeaderElection30] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(69)) - raft.server.staging.timeout = 900ms (fallback to raft.server.rpc.timeout.max)
2025-06-10 17:03:42,151 [s0@group-6876B2C99B77-LeaderElection30] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(148)) - s0: start s0@group-6876B2C99B77-LeaderStateImpl
2025-06-10 17:03:42,151 [s0@group-6876B2C99B77-LeaderElection30] INFO  server.RaftServer$Division (ServerState.java:setLeader(272)) - s0@group-6876B2C99B77: change Leader from null to s0 at term 6 for becomeLeader, leader elected after 10226ms
2025-06-10 17:03:42,152 [s0@group-6876B2C99B77-LeaderElection30] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(445)) - s0@group-6876B2C99B77-SegmentedRaftLogWorker: Rolling segment log-4_4 to index:4
2025-06-10 17:03:42,152 [s0@group-6876B2C99B77-LeaderElection30] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(386)) - s0@group-6876B2C99B77: set configuration conf: {index: 5, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=null}
2025-06-10 17:03:42,153 [s0@group-6876B2C99B77-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/log_inprogress_4 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/log_4-4
2025-06-10 17:03:42,153 [s0@group-6876B2C99B77-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(604)) - s0@group-6876B2C99B77-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/log_inprogress_4 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/log_4-4
2025-06-10 17:03:42,153 [s0@group-6876B2C99B77-SegmentedRaftLogWorker] INFO  segmented.BufferedWriteChannel (BufferedWriteChannel.java:open(61)) - open log_inprogress_5 at position 0
2025-06-10 17:03:42,154 [grpc-default-executor-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#0-t6,previous=(t:5, i:4),leaderCommit=0,initializing? false,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:137)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:42,156 [grpc-default-executor-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#1-t6,previous=(t:5, i:4),leaderCommit=0,initializing? false,entries: size=1, first=(t:6, i:5), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:42,156 [grpc-default-executor-2] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(129)) - s1: Failed APPEND_ENTRIES request s0->s1#1-t6,previous=(t:5, i:4),leaderCommit=0,initializing? false,entries: size=1, first=(t:6, i:5), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:122)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	... 16 more
2025-06-10 17:03:42,159 [grpc-default-executor-2] WARN  server.GrpcLogAppender (LogUtils.java:warn(127)) - s0@group-6876B2C99B77->s1-AppendLogResponseHandler: Failed appendEntries: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
2025-06-10 17:03:42,159 [grpc-default-executor-2] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 5
2025-06-10 17:03:42,159 [grpc-default-executor-2] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 5
2025-06-10 17:03:42,159 [grpc-default-executor-2] INFO  leader.FollowerInfo (FollowerInfoImpl.java:info(70)) - s0@group-6876B2C99B77->s1: computeNextIndex nextIndex: updateUnconditionally 6 -> 5
2025-06-10 17:03:42,161 [s0@group-6876B2C99B77-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(647)) - s0@group-6876B2C99B77-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/log_inprogress_5
2025-06-10 17:03:42,194 [grpc-default-executor-4] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#2-t6,previous=(t:5, i:4),leaderCommit=0,initializing? false,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:137)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:42,195 [grpc-default-executor-4] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#3-t6,previous=(t:5, i:4),leaderCommit=0,initializing? false,entries: size=1, first=(t:6, i:5), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:42,196 [grpc-default-executor-4] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(129)) - s1: Failed APPEND_ENTRIES request s0->s1#3-t6,previous=(t:5, i:4),leaderCommit=0,initializing? false,entries: size=1, first=(t:6, i:5), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:122)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	... 16 more
2025-06-10 17:03:42,197 [grpc-default-executor-4] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 5
2025-06-10 17:03:42,197 [grpc-default-executor-4] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 5
2025-06-10 17:03:42,197 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:info(70)) - s0@group-6876B2C99B77->s1: computeNextIndex nextIndex: updateUnconditionally 6 -> 5
2025-06-10 17:03:42,234 [grpc-default-executor-4] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#4-t6,previous=(t:5, i:4),leaderCommit=0,initializing? false,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:137)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:42,235 [grpc-default-executor-4] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#5-t6,previous=(t:5, i:4),leaderCommit=0,initializing? false,entries: size=1, first=(t:6, i:5), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:42,236 [grpc-default-executor-4] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(129)) - s1: Failed APPEND_ENTRIES request s0->s1#5-t6,previous=(t:5, i:4),leaderCommit=0,initializing? false,entries: size=1, first=(t:6, i:5), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:122)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	... 16 more
2025-06-10 17:03:42,237 [grpc-default-executor-4] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 5
2025-06-10 17:03:42,237 [grpc-default-executor-4] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 5
2025-06-10 17:03:42,237 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:info(70)) - s0@group-6876B2C99B77->s1: computeNextIndex nextIndex: updateUnconditionally 6 -> 5
2025-06-10 17:03:42,273 [grpc-default-executor-4] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#6-t6,previous=(t:5, i:4),leaderCommit=0,initializing? false,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:137)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:42,274 [grpc-default-executor-4] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#7-t6,previous=(t:5, i:4),leaderCommit=0,initializing? false,entries: size=1, first=(t:6, i:5), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:42,275 [grpc-default-executor-4] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(129)) - s1: Failed APPEND_ENTRIES request s0->s1#7-t6,previous=(t:5, i:4),leaderCommit=0,initializing? false,entries: size=1, first=(t:6, i:5), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:122)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	... 16 more
2025-06-10 17:03:42,277 [grpc-default-executor-4] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 5
2025-06-10 17:03:42,277 [grpc-default-executor-4] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 5
2025-06-10 17:03:42,277 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:info(70)) - s0@group-6876B2C99B77->s1: computeNextIndex nextIndex: updateUnconditionally 6 -> 5
2025-06-10 17:03:42,313 [grpc-default-executor-4] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#8-t6,previous=(t:5, i:4),leaderCommit=0,initializing? false,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:137)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:42,314 [grpc-default-executor-4] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#9-t6,previous=(t:5, i:4),leaderCommit=0,initializing? false,entries: size=1, first=(t:6, i:5), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:42,314 [grpc-default-executor-4] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(129)) - s1: Failed APPEND_ENTRIES request s0->s1#9-t6,previous=(t:5, i:4),leaderCommit=0,initializing? false,entries: size=1, first=(t:6, i:5), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:122)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	... 16 more
2025-06-10 17:03:42,316 [grpc-default-executor-4] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 5
2025-06-10 17:03:42,316 [grpc-default-executor-4] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 5
2025-06-10 17:03:42,316 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:info(70)) - s0@group-6876B2C99B77->s1: computeNextIndex nextIndex: updateUnconditionally 6 -> 5
2025-06-10 17:03:42,352 [grpc-default-executor-4] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#10-t6,previous=(t:5, i:4),leaderCommit=0,initializing? false,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:137)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:42,353 [grpc-default-executor-4] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#11-t6,previous=(t:5, i:4),leaderCommit=0,initializing? false,entries: size=1, first=(t:6, i:5), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:42,354 [grpc-default-executor-4] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(129)) - s1: Failed APPEND_ENTRIES request s0->s1#11-t6,previous=(t:5, i:4),leaderCommit=0,initializing? false,entries: size=1, first=(t:6, i:5), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:122)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	... 16 more
2025-06-10 17:03:42,355 [grpc-default-executor-4] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 5
2025-06-10 17:03:42,355 [grpc-default-executor-4] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 5
2025-06-10 17:03:42,355 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:info(70)) - s0@group-6876B2C99B77->s1: computeNextIndex nextIndex: updateUnconditionally 6 -> 5
2025-06-10 17:03:42,392 [grpc-default-executor-4] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#12-t6,previous=(t:5, i:4),leaderCommit=0,initializing? false,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:137)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:42,393 [grpc-default-executor-4] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#13-t6,previous=(t:5, i:4),leaderCommit=0,initializing? false,entries: size=1, first=(t:6, i:5), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:42,393 [grpc-default-executor-4] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(129)) - s1: Failed APPEND_ENTRIES request s0->s1#13-t6,previous=(t:5, i:4),leaderCommit=0,initializing? false,entries: size=1, first=(t:6, i:5), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:122)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	... 16 more
2025-06-10 17:03:42,395 [grpc-default-executor-4] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 5
2025-06-10 17:03:42,395 [grpc-default-executor-4] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 5
2025-06-10 17:03:42,395 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:info(70)) - s0@group-6876B2C99B77->s1: computeNextIndex nextIndex: updateUnconditionally 6 -> 5
2025-06-10 17:03:42,430 [grpc-default-executor-3] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#14-t6,previous=(t:5, i:4),leaderCommit=0,initializing? false,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:137)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:42,432 [grpc-default-executor-3] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#15-t6,previous=(t:5, i:4),leaderCommit=0,initializing? false,entries: size=1, first=(t:6, i:5), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:42,432 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(129)) - s1: Failed APPEND_ENTRIES request s0->s1#15-t6,previous=(t:5, i:4),leaderCommit=0,initializing? false,entries: size=1, first=(t:6, i:5), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:122)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	... 16 more
2025-06-10 17:03:42,433 [grpc-default-executor-3] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 5
2025-06-10 17:03:42,433 [grpc-default-executor-3] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 5
2025-06-10 17:03:42,434 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:info(70)) - s0@group-6876B2C99B77->s1: computeNextIndex nextIndex: updateUnconditionally 6 -> 5
2025-06-10 17:03:42,462 [s0@group-6876B2C99B77-LeaderStateImpl] WARN  server.RaftServer$Division (LeaderStateImpl.java:checkLeadership(1121)) - s0@group-6876B2C99B77-LeaderStateImpl: Lost leadership on term: 6. Election timeout: 300ms. In charge for: 311ms. Conf: conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
2025-06-10 17:03:42,462 [s0@group-6876B2C99B77-LeaderStateImpl] WARN  server.RaftServer$Division (LeaderStateImpl.java:lambda$checkLeadership$20(1125)) - Follower s0@group-6876B2C99B77->s1(c-1,m-1,n5, caughtUp=true, lastRpcSendTime=30, lastRpcResponseTime=611)
2025-06-10 17:03:42,462 [s0@group-6876B2C99B77-LeaderStateImpl] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(392)) - s0@group-6876B2C99B77: changes role from    LEADER to FOLLOWER at term 6 for StepDownReason:LOST_MAJORITY_HEARTBEATS
2025-06-10 17:03:42,462 [s0@group-6876B2C99B77-LeaderStateImpl] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(103)) - s0: shutdown s0@group-6876B2C99B77-LeaderStateImpl
2025-06-10 17:03:42,463 [s0@group-6876B2C99B77->s1-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(300)) - s0@group-6876B2C99B77->s1-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2025-06-10 17:03:42,463 [s0@group-6876B2C99B77-LeaderStateImpl] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(287)) - s0@group-6876B2C99B77-PendingRequests: sendNotLeaderResponses
2025-06-10 17:03:42,463 [s0@group-6876B2C99B77-LeaderStateImpl] INFO  server.RaftServer$Division (ServerState.java:setLeader(272)) - s0@group-6876B2C99B77: change Leader from s0 to null at term 6 for StepDownReason:LOST_MAJORITY_HEARTBEATS
2025-06-10 17:03:42,463 [s0@group-6876B2C99B77-LeaderStateImpl] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(148)) - s0: start s0@group-6876B2C99B77-FollowerState
2025-06-10 17:03:42,507 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #73 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t6, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:6, i:5), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:42,743 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 280ms < waitTime = 10s)
2025-06-10 17:03:42,958 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #74 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t6, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:6, i:5), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:42,990 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 526ms < waitTime = 10s)
2025-06-10 17:03:43,290 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 827ms < waitTime = 10s)
2025-06-10 17:03:43,408 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #75 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t6, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:6, i:5), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:43,574 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 1111ms < waitTime = 10s)
2025-06-10 17:03:43,730 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 1266ms < waitTime = 10s)
2025-06-10 17:03:43,859 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #76 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t6, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:6, i:5), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:43,912 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 1448ms < waitTime = 10s)
2025-06-10 17:03:44,062 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 1599ms < waitTime = 10s)
2025-06-10 17:03:44,281 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 1818ms < waitTime = 10s)
2025-06-10 17:03:44,310 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #77 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t6, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:6, i:5), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:44,498 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 2034ms < waitTime = 10s)
2025-06-10 17:03:44,704 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 2240ms < waitTime = 10s)
2025-06-10 17:03:44,760 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #78 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t6, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:6, i:5), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:44,957 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 2494ms < waitTime = 10s)
2025-06-10 17:03:45,158 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 2695ms < waitTime = 10s)
2025-06-10 17:03:45,211 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #79 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t6, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:6, i:5), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:45,435 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 2971ms < waitTime = 10s)
2025-06-10 17:03:45,661 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #80 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t6, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:6, i:5), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:45,699 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 3236ms < waitTime = 10s)
2025-06-10 17:03:45,967 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 3504ms < waitTime = 10s)
2025-06-10 17:03:46,112 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #81 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t6, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:6, i:5), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:46,139 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 3676ms < waitTime = 10s)
2025-06-10 17:03:46,317 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 3853ms < waitTime = 10s)
2025-06-10 17:03:46,543 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 4080ms < waitTime = 10s)
2025-06-10 17:03:46,563 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #82 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t6, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:6, i:5), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:46,789 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 4326ms < waitTime = 10s)
2025-06-10 17:03:46,949 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 4485ms < waitTime = 10s)
2025-06-10 17:03:47,013 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #83 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t6, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:6, i:5), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:47,160 [timer3] WARN  server.GrpcLogAppender (LogUtils.java:warn(127)) - s0@group-6876B2C99B77->s1-AppendLogResponseHandler: Failed appendEntries (Repeated 8 times in the last 5.001s): org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
2025-06-10 17:03:47,245 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 4781ms < waitTime = 10s)
2025-06-10 17:03:47,464 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #84 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t6, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:6, i:5), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:47,509 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 5046ms < waitTime = 10s)
2025-06-10 17:03:47,804 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 5341ms < waitTime = 10s)
2025-06-10 17:03:47,915 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #85 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t6, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:6, i:5), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:47,961 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 5497ms < waitTime = 10s)
2025-06-10 17:03:48,146 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 5682ms < waitTime = 10s)
2025-06-10 17:03:48,365 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #86 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t6, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:6, i:5), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:48,368 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 5905ms < waitTime = 10s)
2025-06-10 17:03:48,635 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 6172ms < waitTime = 10s)
2025-06-10 17:03:48,799 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 6335ms < waitTime = 10s)
2025-06-10 17:03:48,816 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #87 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t6, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:6, i:5), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:48,985 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 6521ms < waitTime = 10s)
2025-06-10 17:03:49,233 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 6770ms < waitTime = 10s)
2025-06-10 17:03:49,266 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #88 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t6, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:6, i:5), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:49,500 [Timer-10] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$null$7(351)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t6, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:6, i:5), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}.
2025-06-10 17:03:49,501 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 7038ms < waitTime = 10s)
2025-06-10 17:03:49,715 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 7251ms < waitTime = 10s)
2025-06-10 17:03:49,717 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #89 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t6, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:6, i:5), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:49,916 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 7453ms < waitTime = 10s)
2025-06-10 17:03:50,160 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 7697ms < waitTime = 10s)
2025-06-10 17:03:50,167 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #90 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t6, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:6, i:5), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:50,346 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 7883ms < waitTime = 10s)
2025-06-10 17:03:50,538 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 8074ms < waitTime = 10s)
2025-06-10 17:03:50,618 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #91 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t6, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:6, i:5), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:50,688 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 8225ms < waitTime = 10s)
2025-06-10 17:03:50,871 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 8408ms < waitTime = 10s)
2025-06-10 17:03:51,068 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #92 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t6, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:6, i:5), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:51,147 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 8683ms < waitTime = 10s)
2025-06-10 17:03:51,437 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 8973ms < waitTime = 10s)
2025-06-10 17:03:51,519 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #93 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t6, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:6, i:5), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:51,706 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 9243ms < waitTime = 10s)
2025-06-10 17:03:51,970 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #94 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t6, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:6, i:5), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:52,003 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 9540ms < waitTime = 10s)
2025-06-10 17:03:52,216 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 9752ms < waitTime = 10s)
2025-06-10 17:03:52,420 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #95 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t6, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:6, i:5), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:52,458 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 9994ms < waitTime = 10s)
2025-06-10 17:03:52,715 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:runImpl(161)) - s0@group-6876B2C99B77-FollowerState: change to CANDIDATE, lastRpcElapsedTime:10252263052ns, electionTimeout:257ms
2025-06-10 17:03:52,715 [s0@group-6876B2C99B77-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - s0: shutdown s0@group-6876B2C99B77-FollowerState
2025-06-10 17:03:52,715 [s0@group-6876B2C99B77-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(392)) - s0@group-6876B2C99B77: changes role from  FOLLOWER to CANDIDATE at term 6 for changeToCandidate
2025-06-10 17:03:52,716 [s0@group-6876B2C99B77-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(148)) - s0: start s0@group-6876B2C99B77-LeaderElection31
2025-06-10 17:03:52,716 [s0@group-6876B2C99B77-LeaderElection31] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(448)) - s0@group-6876B2C99B77-LeaderElection31 PRE_VOTE round 0: submit vote requests at term 6 for conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
2025-06-10 17:03:52,717 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1421)) - s1@group-6876B2C99B77: receive requestVote(PRE_VOTE, s0, group-6876B2C99B77, 6, (t:6, i:5))
2025-06-10 17:03:52,717 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: Failed requestVote s0->s1#0: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [RUNNING]: current state is CLOSED
2025-06-10 17:03:52,719 [s0@group-6876B2C99B77-LeaderElection31] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(142)) - s0@group-6876B2C99B77-LeaderElection31 got exception when requesting votes: java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: s1@group-6876B2C99B77 is not in [RUNNING]: current state is CLOSED
2025-06-10 17:03:52,719 [s0@group-6876B2C99B77-LeaderElection31] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(206)) - s0@group-6876B2C99B77-LeaderElection31: PRE_VOTE SINGLE_MODE_PASSED received 0 response(s) and 1 exception(s):
2025-06-10 17:03:52,719 [s0@group-6876B2C99B77-LeaderElection31] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(142)) -   Exception 0: java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: s1@group-6876B2C99B77 is not in [RUNNING]: current state is CLOSED
2025-06-10 17:03:52,719 [s0@group-6876B2C99B77-LeaderElection31] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(450)) - s0@group-6876B2C99B77-LeaderElection31 PRE_VOTE round 0: result SINGLE_MODE_PASSED
2025-06-10 17:03:52,719 [s0@group-6876B2C99B77-LeaderElection31] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/raft-meta.tmp with options [CREATE, TRUNCATE_EXISTING, WRITE]: sun.nio.ch.FileChannelImpl@46246235
2025-06-10 17:03:52,720 [s0@group-6876B2C99B77-LeaderElection31] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/raft-meta with options [REPLACE_EXISTING]
2025-06-10 17:03:52,720 [s0@group-6876B2C99B77-LeaderElection31] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(448)) - s0@group-6876B2C99B77-LeaderElection31 ELECTION round 0: submit vote requests at term 7 for conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
2025-06-10 17:03:52,721 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1421)) - s1@group-6876B2C99B77: receive requestVote(ELECTION, s0, group-6876B2C99B77, 7, (t:6, i:5))
2025-06-10 17:03:52,721 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: Failed requestVote s0->s1#0: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [RUNNING]: current state is CLOSED
2025-06-10 17:03:52,722 [s0@group-6876B2C99B77-LeaderElection31] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(142)) - s0@group-6876B2C99B77-LeaderElection31 got exception when requesting votes: java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: s1@group-6876B2C99B77 is not in [RUNNING]: current state is CLOSED
2025-06-10 17:03:52,723 [s0@group-6876B2C99B77-LeaderElection31] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(206)) - s0@group-6876B2C99B77-LeaderElection31: ELECTION SINGLE_MODE_PASSED received 0 response(s) and 1 exception(s):
2025-06-10 17:03:52,723 [s0@group-6876B2C99B77-LeaderElection31] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(142)) -   Exception 0: java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: s1@group-6876B2C99B77 is not in [RUNNING]: current state is CLOSED
2025-06-10 17:03:52,723 [s0@group-6876B2C99B77-LeaderElection31] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(450)) - s0@group-6876B2C99B77-LeaderElection31 ELECTION round 0: result SINGLE_MODE_PASSED
2025-06-10 17:03:52,723 [s0@group-6876B2C99B77-LeaderElection31] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(141)) - s0: shutdown s0@group-6876B2C99B77-LeaderElection31
2025-06-10 17:03:52,723 [s0@group-6876B2C99B77-LeaderElection31] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(392)) - s0@group-6876B2C99B77: changes role from CANDIDATE to LEADER at term 7 for changeToLeader
2025-06-10 17:03:52,723 [s0@group-6876B2C99B77-LeaderElection31] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(69)) - raft.server.staging.timeout = 900ms (fallback to raft.server.rpc.timeout.max)
2025-06-10 17:03:52,724 [s0@group-6876B2C99B77-LeaderElection31] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(148)) - s0: start s0@group-6876B2C99B77-LeaderStateImpl
2025-06-10 17:03:52,724 [s0@group-6876B2C99B77-LeaderElection31] INFO  server.RaftServer$Division (ServerState.java:setLeader(272)) - s0@group-6876B2C99B77: change Leader from null to s0 at term 7 for becomeLeader, leader elected after 10260ms
2025-06-10 17:03:52,724 [s0@group-6876B2C99B77-LeaderElection31] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(445)) - s0@group-6876B2C99B77-SegmentedRaftLogWorker: Rolling segment log-5_5 to index:5
2025-06-10 17:03:52,724 [s0@group-6876B2C99B77-LeaderElection31] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(386)) - s0@group-6876B2C99B77: set configuration conf: {index: 6, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=null}
2025-06-10 17:03:52,726 [s0@group-6876B2C99B77-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/log_inprogress_5 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/log_5-5
2025-06-10 17:03:52,726 [s0@group-6876B2C99B77-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(604)) - s0@group-6876B2C99B77-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/log_inprogress_5 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/log_5-5
2025-06-10 17:03:52,726 [s0@group-6876B2C99B77-SegmentedRaftLogWorker] INFO  segmented.BufferedWriteChannel (BufferedWriteChannel.java:open(61)) - open log_inprogress_6 at position 0
2025-06-10 17:03:52,727 [grpc-default-executor-3] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#0-t7,previous=(t:6, i:5),leaderCommit=0,initializing? false,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:137)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:52,729 [grpc-default-executor-3] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#1-t7,previous=(t:6, i:5),leaderCommit=0,initializing? false,entries: size=1, first=(t:7, i:6), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:52,729 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(129)) - s1: Failed APPEND_ENTRIES request s0->s1#1-t7,previous=(t:6, i:5),leaderCommit=0,initializing? false,entries: size=1, first=(t:7, i:6), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:122)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	... 16 more
2025-06-10 17:03:52,732 [grpc-default-executor-3] WARN  server.GrpcLogAppender (LogUtils.java:warn(127)) - s0@group-6876B2C99B77->s1-AppendLogResponseHandler: Failed appendEntries: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
2025-06-10 17:03:52,732 [grpc-default-executor-3] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 6
2025-06-10 17:03:52,732 [grpc-default-executor-3] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 6
2025-06-10 17:03:52,732 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:info(70)) - s0@group-6876B2C99B77->s1: computeNextIndex nextIndex: updateUnconditionally 7 -> 6
2025-06-10 17:03:52,734 [s0@group-6876B2C99B77-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(647)) - s0@group-6876B2C99B77-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/38e4f167/MiniRaftClusterWithGrpce060a74a/s0/92259f10-065a-49b5-89af-6876b2c99b77/current/log_inprogress_6
2025-06-10 17:03:52,766 [grpc-default-executor-3] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#2-t7,previous=(t:6, i:5),leaderCommit=0,initializing? false,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:137)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:52,767 [grpc-default-executor-3] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#3-t7,previous=(t:6, i:5),leaderCommit=0,initializing? false,entries: size=1, first=(t:7, i:6), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:52,768 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(129)) - s1: Failed APPEND_ENTRIES request s0->s1#3-t7,previous=(t:6, i:5),leaderCommit=0,initializing? false,entries: size=1, first=(t:7, i:6), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:122)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	... 16 more
2025-06-10 17:03:52,769 [grpc-default-executor-3] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 6
2025-06-10 17:03:52,769 [grpc-default-executor-3] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 6
2025-06-10 17:03:52,769 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:info(70)) - s0@group-6876B2C99B77->s1: computeNextIndex nextIndex: updateUnconditionally 7 -> 6
2025-06-10 17:03:52,805 [grpc-default-executor-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#4-t7,previous=(t:6, i:5),leaderCommit=0,initializing? false,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:137)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:52,806 [grpc-default-executor-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#5-t7,previous=(t:6, i:5),leaderCommit=0,initializing? false,entries: size=1, first=(t:7, i:6), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:52,807 [grpc-default-executor-2] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(129)) - s1: Failed APPEND_ENTRIES request s0->s1#5-t7,previous=(t:6, i:5),leaderCommit=0,initializing? false,entries: size=1, first=(t:7, i:6), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:122)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	... 16 more
2025-06-10 17:03:52,808 [grpc-default-executor-2] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 6
2025-06-10 17:03:52,808 [grpc-default-executor-2] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 6
2025-06-10 17:03:52,808 [grpc-default-executor-2] INFO  leader.FollowerInfo (FollowerInfoImpl.java:info(70)) - s0@group-6876B2C99B77->s1: computeNextIndex nextIndex: updateUnconditionally 7 -> 6
2025-06-10 17:03:52,845 [grpc-default-executor-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#6-t7,previous=(t:6, i:5),leaderCommit=0,initializing? false,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:137)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:52,846 [grpc-default-executor-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#7-t7,previous=(t:6, i:5),leaderCommit=0,initializing? false,entries: size=1, first=(t:7, i:6), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:52,847 [grpc-default-executor-2] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(129)) - s1: Failed APPEND_ENTRIES request s0->s1#7-t7,previous=(t:6, i:5),leaderCommit=0,initializing? false,entries: size=1, first=(t:7, i:6), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:122)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	... 16 more
2025-06-10 17:03:52,849 [grpc-default-executor-2] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 6
2025-06-10 17:03:52,849 [grpc-default-executor-2] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 6
2025-06-10 17:03:52,849 [grpc-default-executor-2] INFO  leader.FollowerInfo (FollowerInfoImpl.java:info(70)) - s0@group-6876B2C99B77->s1: computeNextIndex nextIndex: updateUnconditionally 7 -> 6
2025-06-10 17:03:52,871 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #96 failed: java.lang.IllegalStateException: Leader: s0@group-6876B2C99B77 not ready
2025-06-10 17:03:52,884 [grpc-default-executor-3] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#8-t7,previous=(t:6, i:5),leaderCommit=0,initializing? false,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:137)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:52,885 [grpc-default-executor-3] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#9-t7,previous=(t:6, i:5),leaderCommit=0,initializing? false,entries: size=1, first=(t:7, i:6), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:52,885 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(129)) - s1: Failed APPEND_ENTRIES request s0->s1#9-t7,previous=(t:6, i:5),leaderCommit=0,initializing? false,entries: size=1, first=(t:7, i:6), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:122)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	... 16 more
2025-06-10 17:03:52,887 [grpc-default-executor-3] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 6
2025-06-10 17:03:52,887 [grpc-default-executor-3] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 6
2025-06-10 17:03:52,887 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:info(70)) - s0@group-6876B2C99B77->s1: computeNextIndex nextIndex: updateUnconditionally 7 -> 6
2025-06-10 17:03:52,924 [grpc-default-executor-3] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#10-t7,previous=(t:6, i:5),leaderCommit=0,initializing? false,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:137)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:52,925 [grpc-default-executor-3] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#11-t7,previous=(t:6, i:5),leaderCommit=0,initializing? false,entries: size=1, first=(t:7, i:6), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:52,925 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(129)) - s1: Failed APPEND_ENTRIES request s0->s1#11-t7,previous=(t:6, i:5),leaderCommit=0,initializing? false,entries: size=1, first=(t:7, i:6), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:122)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	... 16 more
2025-06-10 17:03:52,927 [grpc-default-executor-2] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 6
2025-06-10 17:03:52,927 [grpc-default-executor-2] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 6
2025-06-10 17:03:52,927 [grpc-default-executor-2] INFO  leader.FollowerInfo (FollowerInfoImpl.java:info(70)) - s0@group-6876B2C99B77->s1: computeNextIndex nextIndex: updateUnconditionally 7 -> 6
2025-06-10 17:03:52,963 [grpc-default-executor-3] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#12-t7,previous=(t:6, i:5),leaderCommit=0,initializing? false,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:137)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:52,965 [grpc-default-executor-3] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#13-t7,previous=(t:6, i:5),leaderCommit=0,initializing? false,entries: size=1, first=(t:7, i:6), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:52,965 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(129)) - s1: Failed APPEND_ENTRIES request s0->s1#13-t7,previous=(t:6, i:5),leaderCommit=0,initializing? false,entries: size=1, first=(t:7, i:6), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:122)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	... 16 more
2025-06-10 17:03:52,967 [grpc-default-executor-3] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 6
2025-06-10 17:03:52,967 [grpc-default-executor-3] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 6
2025-06-10 17:03:52,967 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:info(70)) - s0@group-6876B2C99B77->s1: computeNextIndex nextIndex: updateUnconditionally 7 -> 6
2025-06-10 17:03:53,002 [grpc-default-executor-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#14-t7,previous=(t:6, i:5),leaderCommit=0,initializing? false,HEARTBEAT
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:137)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:53,004 [grpc-default-executor-2] ERROR server.RaftServer$Division (RaftServerImpl.java:appendEntriesAsync(1495)) - s1@group-6876B2C99B77: Failed appendEntries* s0->s1#15-t7,previous=(t:6, i:5),leaderCommit=0,initializing? false,entries: size=1, first=(t:7, i:6), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2025-06-10 17:03:53,004 [grpc-default-executor-2] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(129)) - s1: Failed APPEND_ENTRIES request s0->s1#15-t7,previous=(t:6, i:5),leaderCommit=0,initializing? false,entries: size=1, first=(t:7, i:6), CONFIGURATIONENTRY(current:id:"s0"address:"localhost:15176"dataStreamAddress:"localhost:15179"clientAddress:"localhost:15178"adminAddress:"localhost:15177"startupRole:FOLLOWER, id:"s1"address:"0.0.0.0:15180"clientAddress:"0.0.0.0:15180"adminAddress:"0.0.0.0:15180"startupRole:FOLLOWER, old:)
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:122)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$29(RaftServerProxy.java:651)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:995)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2137)
	at org.apache.ratis.server.impl.RaftServerProxy.appendEntriesAsync(RaftServerProxy.java:651)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:245)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$1.process(GrpcServerProtocolService.java:242)
	at org.apache.ratis.grpc.server.GrpcServerProtocolService$ServerRequestStreamObserver.onNext(GrpcServerProtocolService.java:150)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:334)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:319)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.ServerNotReadyException: s1@group-6876B2C99B77 is not in [STARTING, RUNNING]: current state is CLOSED
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$assertLifeCycleState$7(RaftServerImpl.java:809)
	at org.apache.ratis.util.LifeCycle.assertCurrentState(LifeCycle.java:260)
	at org.apache.ratis.server.impl.RaftServerImpl.assertLifeCycleState(RaftServerImpl.java:808)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1486)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$28(RaftServerProxy.java:652)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	... 16 more
2025-06-10 17:03:53,006 [grpc-default-executor-2] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 6
2025-06-10 17:03:53,006 [grpc-default-executor-2] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(215)) - Decrease nextIndex to 6
2025-06-10 17:03:53,006 [grpc-default-executor-2] INFO  leader.FollowerInfo (FollowerInfoImpl.java:info(70)) - s0@group-6876B2C99B77->s1: computeNextIndex nextIndex: updateUnconditionally 7 -> 6
2025-06-10 17:03:53,035 [s0@group-6876B2C99B77-LeaderStateImpl] WARN  server.RaftServer$Division (LeaderStateImpl.java:checkLeadership(1121)) - s0@group-6876B2C99B77-LeaderStateImpl: Lost leadership on term: 7. Election timeout: 300ms. In charge for: 312ms. Conf: conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
2025-06-10 17:03:53,035 [s0@group-6876B2C99B77-LeaderStateImpl] WARN  server.RaftServer$Division (LeaderStateImpl.java:lambda$checkLeadership$20(1125)) - Follower s0@group-6876B2C99B77->s1(c-1,m-1,n6, caughtUp=true, lastRpcSendTime=31, lastRpcResponseTime=611)
2025-06-10 17:03:53,035 [s0@group-6876B2C99B77-LeaderStateImpl] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(392)) - s0@group-6876B2C99B77: changes role from    LEADER to FOLLOWER at term 7 for StepDownReason:LOST_MAJORITY_HEARTBEATS
2025-06-10 17:03:53,035 [s0@group-6876B2C99B77-LeaderStateImpl] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(103)) - s0: shutdown s0@group-6876B2C99B77-LeaderStateImpl
2025-06-10 17:03:53,036 [s0@group-6876B2C99B77->s1-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(300)) - s0@group-6876B2C99B77->s1-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2025-06-10 17:03:53,036 [s0@group-6876B2C99B77-LeaderStateImpl] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(287)) - s0@group-6876B2C99B77-PendingRequests: sendNotLeaderResponses
2025-06-10 17:03:53,036 [s0@group-6876B2C99B77-LeaderStateImpl] INFO  server.RaftServer$Division (ServerState.java:setLeader(272)) - s0@group-6876B2C99B77: change Leader from s0 to null at term 7 for StepDownReason:LOST_MAJORITY_HEARTBEATS
2025-06-10 17:03:53,036 [s0@group-6876B2C99B77-LeaderStateImpl] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(148)) - s0: start s0@group-6876B2C99B77-FollowerState
2025-06-10 17:03:53,245 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 208ms < waitTime = 10s)
2025-06-10 17:03:53,321 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #97 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t7, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:7, i:6), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:53,530 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 493ms < waitTime = 10s)
2025-06-10 17:03:53,723 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 687ms < waitTime = 10s)
2025-06-10 17:03:53,772 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #98 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t7, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:7, i:6), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:53,952 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 916ms < waitTime = 10s)
2025-06-10 17:03:54,110 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 1073ms < waitTime = 10s)
2025-06-10 17:03:54,222 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #99 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t7, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:7, i:6), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:54,404 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 1367ms < waitTime = 10s)
2025-06-10 17:03:54,609 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:lostMajorityHeartbeatsRecently(113)) - s0@group-6876B2C99B77-FollowerState: Skipping leader election since it stepped down recently (elapsed = 1573ms < waitTime = 10s)
2025-06-10 17:03:54,673 [main] WARN  ratis.RaftTestUtil (RaftTestUtil.java:lambda$waitForLeader$3(126)) - Attempt #100 failed: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t7, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:7, i:6), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:54,673 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:runWithNewCluster(144)) - printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t7, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:7, i:6), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:54,673 [main] ERROR impl.MiniRaftCluster (MiniRaftCluster.java:runWithNewCluster(145)) - Failed org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:120)
java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t7, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:7, i:6), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
	at org.apache.ratis.server.impl.MiniRaftCluster.newIllegalStateExceptionForNoLeaders(MiniRaftCluster.java:586)
	at org.apache.ratis.RaftTestUtil.lambda$waitForLeader$1(RaftTestUtil.java:111)
	at org.apache.ratis.server.impl.MiniRaftCluster.getLeader(MiniRaftCluster.java:620)
	at org.apache.ratis.server.impl.MiniRaftCluster.getLeader(MiniRaftCluster.java:613)
	at org.apache.ratis.RaftTestUtil.lambda$waitForLeader$3(RaftTestUtil.java:120)
	at org.apache.ratis.util.JavaUtils.attempt(JavaUtils.java:225)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:118)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:99)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:94)
	at org.apache.ratis.server.impl.RaftReconfigurationBaseTest.lambda$testLeaderElectionWhenChangeFromSingleToHA$2(RaftReconfigurationBaseTest.java:180)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:142)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:120)
	at org.apache.ratis.server.impl.RaftReconfigurationBaseTest.testLeaderElectionWhenChangeFromSingleToHA(RaftReconfigurationBaseTest.java:159)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:775)
	at org.junit.platform.commons.support.ReflectionSupport.invokeMethod(ReflectionSupport.java:479)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.SameThreadTimeoutInvocation.proceed(SameThreadTimeoutInvocation.java:49)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:161)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:152)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:91)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:112)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:94)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:93)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:87)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$7(TestMethodTestDescriptor.java:216)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:212)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:137)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:69)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:156)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:201)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:170)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:94)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:59)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:142)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:58)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:103)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:85)
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:47)
	at org.junit.platform.launcher.core.InterceptingLauncher.lambda$execute$1(InterceptingLauncher.java:39)
	at org.junit.platform.launcher.core.ClasspathAlignmentCheckingLauncherInterceptor.intercept(ClasspathAlignmentCheckingLauncherInterceptor.java:25)
	at org.junit.platform.launcher.core.InterceptingLauncher.execute(InterceptingLauncher.java:38)
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:47)
	at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:63)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
2025-06-10 17:03:54,675 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(836)) - ************************************************************** 
2025-06-10 17:03:54,675 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(837)) - *** 
2025-06-10 17:03:54,675 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(838)) - ***     Stopping MiniRaftClusterWithGrpc
2025-06-10 17:03:54,675 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(839)) - *** 
2025-06-10 17:03:54,676 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(840)) - ************************************************************** 
2025-06-10 17:03:54,676 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(841)) - printing ALL groups
  s0:  RUNNING  FOLLOWER (RUNNING): s0@group-6876B2C99B77:t7, leader=null, voted=s0, raftlog=Memoized:s0@group-6876B2C99B77-SegmentedRaftLog:OPENED:c0:last(t:7, i:6), conf=conf: {index: 4611686018427387903, cur=peers:[s0|localhost:15176, s1|0.0.0.0:15180]|listeners:[], old=peers:[s0|localhost:15176]|listeners:[]}
  s1:  RUNNING CANDIDATE (CLOSED): s1@group-6876B2C99B77:t2, leader=null, voted=null, raftlog=Memoized:s1@group-6876B2C99B77-SegmentedRaftLog:CLOSED:c-1, conf=conf: {index: -1, cur=peers:[]|listeners:[], old=null}
2025-06-10 17:03:54,676 [MiniRaftCluster-48] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$9(422)) - s0: close
2025-06-10 17:03:54,677 [MiniRaftCluster-48] INFO  server.GrpcServicesImpl (GrpcServicesImpl.java:closeImpl(355)) - s0: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService now
2025-06-10 17:03:54,677 [MiniRaftCluster-49] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$9(422)) - s1: close
2025-06-10 17:03:54,677 [s0-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$1(527)) - s0@group-6876B2C99B77: shutdown
2025-06-10 17:03:54,678 [s0-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:unregister(74)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-6876B2C99B77,id=s0
2025-06-10 17:03:54,678 [s0-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - s0: shutdown s0@group-6876B2C99B77-FollowerState
2025-06-10 17:03:54,678 [Thread-973] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:close(105)) - s1 Close channels
2025-06-10 17:03:54,678 [MiniRaftCluster-49] INFO  server.GrpcServicesImpl (GrpcServicesImpl.java:closeImpl(355)) - s1: shutdown server GrpcServerProtocolService now
2025-06-10 17:03:54,679 [s0-impl-thread1] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(163)) - s0@group-6876B2C99B77-StateMachineUpdater: set stopIndex = 0
2025-06-10 17:03:54,679 [s0@group-6876B2C99B77-FollowerState] INFO  impl.FollowerState (FollowerState.java:runImpl(170)) - s0@group-6876B2C99B77-FollowerState was interrupted
2025-06-10 17:03:54,679 [s0@group-6876B2C99B77-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stop(140)) - s0@group-6876B2C99B77-StateMachineUpdater: closing BaseStateMachine, lastApplied=(t:1, i:0)
2025-06-10 17:03:54,680 [grpc-default-executor-0] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: APPEND_ENTRIES onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2025-06-10 17:03:54,680 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: APPEND_ENTRIES onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2025-06-10 17:03:54,681 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: APPEND_ENTRIES onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2025-06-10 17:03:54,681 [grpc-default-executor-6] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: APPEND_ENTRIES onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2025-06-10 17:03:54,681 [s0@group-6876B2C99B77-cacheEviction-AwaitToRun] INFO  util.AwaitToRun (AwaitToRun.java:run(49)) - s0@group-6876B2C99B77-cacheEviction-AwaitToRun-AwaitForSignal is interrupted
2025-06-10 17:03:54,681 [grpc-default-executor-8] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: APPEND_ENTRIES onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2025-06-10 17:03:54,681 [grpc-default-executor-8] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: APPEND_ENTRIES onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2025-06-10 17:03:54,681 [grpc-default-executor-8] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: APPEND_ENTRIES onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2025-06-10 17:03:54,682 [grpc-default-executor-5] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: APPEND_ENTRIES onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2025-06-10 17:03:54,682 [grpc-default-executor-5] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: APPEND_ENTRIES onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2025-06-10 17:03:54,682 [grpc-default-executor-4] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: APPEND_ENTRIES onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2025-06-10 17:03:54,682 [grpc-default-executor-0] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: APPEND_ENTRIES onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2025-06-10 17:03:54,682 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: APPEND_ENTRIES onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2025-06-10 17:03:54,682 [grpc-default-executor-9] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: APPEND_ENTRIES onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2025-06-10 17:03:54,683 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: APPEND_ENTRIES onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2025-06-10 17:03:54,683 [grpc-default-executor-4] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: APPEND_ENTRIES onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2025-06-10 17:03:54,683 [grpc-default-executor-0] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: APPEND_ENTRIES onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2025-06-10 17:03:54,683 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: APPEND_ENTRIES onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2025-06-10 17:03:54,683 [grpc-default-executor-2] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: APPEND_ENTRIES onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2025-06-10 17:03:54,683 [grpc-default-executor-7] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: APPEND_ENTRIES onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2025-06-10 17:03:54,683 [grpc-default-executor-9] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: APPEND_ENTRIES onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2025-06-10 17:03:54,683 [grpc-default-executor-6] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: APPEND_ENTRIES onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2025-06-10 17:03:54,683 [grpc-default-executor-8] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: APPEND_ENTRIES onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2025-06-10 17:03:54,684 [grpc-default-executor-0] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: APPEND_ENTRIES onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2025-06-10 17:03:54,684 [grpc-default-executor-0] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: APPEND_ENTRIES onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2025-06-10 17:03:54,683 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: APPEND_ENTRIES onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2025-06-10 17:03:54,684 [grpc-default-executor-1] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: APPEND_ENTRIES onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2025-06-10 17:03:54,684 [grpc-default-executor-1] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: APPEND_ENTRIES onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2025-06-10 17:03:54,684 [grpc-default-executor-8] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: APPEND_ENTRIES onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2025-06-10 17:03:54,683 [grpc-default-executor-2] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: APPEND_ENTRIES onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2025-06-10 17:03:54,684 [grpc-default-executor-9] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: APPEND_ENTRIES onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2025-06-10 17:03:54,684 [grpc-default-executor-4] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: APPEND_ENTRIES onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2025-06-10 17:03:54,685 [grpc-default-executor-0] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: APPEND_ENTRIES onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2025-06-10 17:03:54,685 [grpc-default-executor-4] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: APPEND_ENTRIES onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2025-06-10 17:03:54,685 [grpc-default-executor-0] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: APPEND_ENTRIES onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2025-06-10 17:03:54,685 [grpc-default-executor-10] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: APPEND_ENTRIES onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2025-06-10 17:03:54,687 [grpc-default-executor-8] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: APPEND_ENTRIES onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2025-06-10 17:03:54,687 [grpc-default-executor-2] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: APPEND_ENTRIES onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2025-06-10 17:03:54,687 [grpc-default-executor-9] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: APPEND_ENTRIES onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2025-06-10 17:03:54,685 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: APPEND_ENTRIES onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2025-06-10 17:03:54,687 [MiniRaftCluster-49] INFO  server.GrpcServicesImpl (GrpcServicesImpl.java:closeImpl(364)) - s1: shutdown server GrpcServerProtocolService successfully
2025-06-10 17:03:54,687 [grpc-default-executor-5] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(545)) - s0@group-6876B2C99B77->s1-GrpcLogAppender is already stopped
2025-06-10 17:03:54,685 [grpc-default-executor-1] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(127)) - s1: APPEND_ENTRIES onError, lastRequest: null: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2025-06-10 17:03:54,687 [grpc-default-executor-9] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(545)) - s0@group-6876B2C99B77->s1-GrpcLogAppender is already stopped
2025-06-10 17:03:54,687 [grpc-default-executor-4] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(545)) - s0@group-6876B2C99B77->s1-GrpcLogAppender is already stopped
2025-06-10 17:03:54,688 [grpc-default-executor-8] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(545)) - s0@group-6876B2C99B77->s1-GrpcLogAppender is already stopped
2025-06-10 17:03:54,687 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(545)) - s0@group-6876B2C99B77->s1-GrpcLogAppender is already stopped
2025-06-10 17:03:54,687 [grpc-default-executor-0] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(545)) - s0@group-6876B2C99B77->s1-GrpcLogAppender is already stopped
2025-06-10 17:03:54,687 [grpc-default-executor-6] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(545)) - s0@group-6876B2C99B77->s1-GrpcLogAppender is already stopped
2025-06-10 17:03:54,688 [grpc-default-executor-2] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(545)) - s0@group-6876B2C99B77->s1-GrpcLogAppender is already stopped
2025-06-10 17:03:54,688 [grpc-default-executor-10] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(545)) - s0@group-6876B2C99B77->s1-GrpcLogAppender is already stopped
2025-06-10 17:03:54,688 [JvmPauseMonitor47] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(152)) - JvmPauseMonitor-s1: Stopped
2025-06-10 17:03:54,688 [grpc-default-executor-10] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(545)) - s0@group-6876B2C99B77->s1-GrpcLogAppender is already stopped
2025-06-10 17:03:54,688 [grpc-default-executor-2] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(545)) - s0@group-6876B2C99B77->s1-GrpcLogAppender is already stopped
2025-06-10 17:03:54,688 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(545)) - s0@group-6876B2C99B77->s1-GrpcLogAppender is already stopped
2025-06-10 17:03:54,688 [grpc-default-executor-4] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(545)) - s0@group-6876B2C99B77->s1-GrpcLogAppender is already stopped
2025-06-10 17:03:54,688 [grpc-default-executor-6] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(545)) - s0@group-6876B2C99B77->s1-GrpcLogAppender is already stopped
2025-06-10 17:03:54,688 [grpc-default-executor-2] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(545)) - s0@group-6876B2C99B77->s1-GrpcLogAppender is already stopped
2025-06-10 17:03:54,689 [grpc-default-executor-6] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(545)) - s0@group-6876B2C99B77->s1-GrpcLogAppender is already stopped
2025-06-10 17:03:54,689 [grpc-default-executor-1] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(545)) - s0@group-6876B2C99B77->s1-GrpcLogAppender is already stopped
2025-06-10 17:03:54,689 [grpc-default-executor-1] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(545)) - s0@group-6876B2C99B77->s1-GrpcLogAppender is already stopped
2025-06-10 17:03:54,689 [grpc-default-executor-2] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(545)) - s0@group-6876B2C99B77->s1-GrpcLogAppender is already stopped
2025-06-10 17:03:54,689 [grpc-default-executor-6] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(545)) - s0@group-6876B2C99B77->s1-GrpcLogAppender is already stopped
2025-06-10 17:03:54,688 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(545)) - s0@group-6876B2C99B77->s1-GrpcLogAppender is already stopped
2025-06-10 17:03:54,688 [grpc-default-executor-10] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(545)) - s0@group-6876B2C99B77->s1-GrpcLogAppender is already stopped
2025-06-10 17:03:54,688 [grpc-default-executor-8] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(545)) - s0@group-6876B2C99B77->s1-GrpcLogAppender is already stopped
2025-06-10 17:03:54,689 [grpc-default-executor-5] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(545)) - s0@group-6876B2C99B77->s1-GrpcLogAppender is already stopped
2025-06-10 17:03:54,689 [grpc-default-executor-10] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(545)) - s0@group-6876B2C99B77->s1-GrpcLogAppender is already stopped
2025-06-10 17:03:54,689 [grpc-default-executor-6] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(545)) - s0@group-6876B2C99B77->s1-GrpcLogAppender is already stopped
2025-06-10 17:03:54,689 [grpc-default-executor-7] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(545)) - s0@group-6876B2C99B77->s1-GrpcLogAppender is already stopped
2025-06-10 17:03:54,689 [grpc-default-executor-4] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(545)) - s0@group-6876B2C99B77->s1-GrpcLogAppender is already stopped
2025-06-10 17:03:54,690 [grpc-default-executor-0] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(545)) - s0@group-6876B2C99B77->s1-GrpcLogAppender is already stopped
2025-06-10 17:03:54,689 [grpc-default-executor-12] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(545)) - s0@group-6876B2C99B77->s1-GrpcLogAppender is already stopped
2025-06-10 17:03:54,690 [grpc-default-executor-12] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(545)) - s0@group-6876B2C99B77->s1-GrpcLogAppender is already stopped
2025-06-10 17:03:54,689 [grpc-default-executor-3] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(545)) - s0@group-6876B2C99B77->s1-GrpcLogAppender is already stopped
2025-06-10 17:03:54,689 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(545)) - s0@group-6876B2C99B77->s1-GrpcLogAppender is already stopped
2025-06-10 17:03:54,688 [grpc-default-executor-9] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(545)) - s0@group-6876B2C99B77->s1-GrpcLogAppender is already stopped
2025-06-10 17:03:54,691 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(545)) - s0@group-6876B2C99B77->s1-GrpcLogAppender is already stopped
2025-06-10 17:03:54,691 [grpc-default-executor-3] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(545)) - s0@group-6876B2C99B77->s1-GrpcLogAppender is already stopped
2025-06-10 17:03:54,692 [grpc-default-executor-12] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(545)) - s0@group-6876B2C99B77->s1-GrpcLogAppender is already stopped
2025-06-10 17:03:54,692 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(545)) - s0@group-6876B2C99B77->s1-GrpcLogAppender is already stopped
2025-06-10 17:03:54,693 [grpc-default-executor-3] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(545)) - s0@group-6876B2C99B77->s1-GrpcLogAppender is already stopped
2025-06-10 17:03:54,693 [grpc-default-executor-11] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(545)) - s0@group-6876B2C99B77->s1-GrpcLogAppender is already stopped
2025-06-10 17:03:54,694 [MiniRaftCluster-48] INFO  server.GrpcServicesImpl (GrpcServicesImpl.java:closeImpl(364)) - s0: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService successfully
2025-06-10 17:03:54,694 [MiniRaftCluster-48] INFO  server.GrpcServicesImpl (GrpcServicesImpl.java:closeImpl(355)) - s0: shutdown server GrpcServerProtocolService now
2025-06-10 17:03:54,695 [MiniRaftCluster-48] INFO  server.GrpcServicesImpl (GrpcServicesImpl.java:closeImpl(364)) - s0: shutdown server GrpcServerProtocolService successfully
2025-06-10 17:03:54,695 [MiniRaftCluster-48] INFO  server.GrpcServicesImpl (GrpcServicesImpl.java:closeImpl(355)) - s0: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService now
2025-06-10 17:03:54,696 [MiniRaftCluster-48] INFO  server.GrpcServicesImpl (GrpcServicesImpl.java:closeImpl(364)) - s0: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService successfully
2025-06-10 17:03:54,736 [s0-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(254)) - s0@group-6876B2C99B77-SegmentedRaftLogWorker close()
2025-06-10 17:03:54,737 [JvmPauseMonitor46] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(152)) - JvmPauseMonitor-s0: Stopped
2025-06-10 17:03:54,737 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(860)) - MiniRaftClusterWithGrpc shutdown completed
]]></system-out>
  </testcase>
  <testcase name="testOverlappedSetConfRequests" classname="org.apache.ratis.grpc.TestRaftReconfigurationWithGrpc" time="11.166"/>
  <testcase name="testRestorePriority" classname="org.apache.ratis.grpc.TestRaftReconfigurationWithGrpc" time="2.827"/>
  <testcase name="testSetConfigurationInCasMode" classname="org.apache.ratis.grpc.TestRaftReconfigurationWithGrpc" time="1.698"/>
  <testcase name="testReconfTwice" classname="org.apache.ratis.grpc.TestRaftReconfigurationWithGrpc" time="2.026"/>
  <testcase name="testReconfTimeout" classname="org.apache.ratis.grpc.TestRaftReconfigurationWithGrpc" time="3.112"/>
  <testcase name="testBootstrapReconfWithSingleNodeAddOne" classname="org.apache.ratis.grpc.TestRaftReconfigurationWithGrpc" time="2.573"/>
  <testcase name="testBootstrapReconfWithSingleNodeAddTwo" classname="org.apache.ratis.grpc.TestRaftReconfigurationWithGrpc" time="1.483"/>
</testsuite>