<?xml version="1.0" encoding="UTF-8"?>
<testsuite xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="https://maven.apache.org/surefire/maven-surefire-plugin/xsd/surefire-test-report-3.0.xsd" version="3.0" name="org.apache.ratis.grpc.TestRaftServerWithGrpc" time="82.848" tests="12" errors="1" skipped="0" failures="0">
  <properties>
    <property name="awt.toolkit" value="sun.awt.X11.XToolkit"/>
    <property name="file.encoding.pkg" value="sun.io"/>
    <property name="java.specification.version" value="1.8"/>
    <property name="sun.cpu.isalist" value=""/>
    <property name="sun.jnu.encoding" value="UTF-8"/>
    <property name="java.class.path" value="/home/runner/work/ratis/ratis/ratis-test/target/test-classes:/home/runner/work/ratis/ratis/ratis-test/target/classes:/home/runner/work/ratis/ratis/ratis-common/target/classes:/home/runner/.m2/repository/org/apache/ratis/ratis-thirdparty-misc/1.0.9/ratis-thirdparty-misc-1.0.9.jar:/home/runner/work/ratis/ratis/ratis-proto/target/classes:/home/runner/.m2/repository/jakarta/annotation/jakarta.annotation-api/1.3.5/jakarta.annotation-api-1.3.5.jar:/home/runner/work/ratis/ratis/ratis-common/target/test-classes:/home/runner/work/ratis/ratis/ratis-client/target/classes:/home/runner/work/ratis/ratis/ratis-server/target/classes:/home/runner/work/ratis/ratis/ratis-server-api/target/classes:/home/runner/work/ratis/ratis/ratis-metrics-api/target/classes:/home/runner/work/ratis/ratis/ratis-server/target/test-classes:/home/runner/work/ratis/ratis/ratis-metrics-default/target/classes:/home/runner/work/ratis/ratis/ratis-netty/target/classes:/home/runner/work/ratis/ratis/ratis-netty/target/test-classes:/home/runner/work/ratis/ratis/ratis-grpc/target/classes:/home/runner/work/ratis/ratis/ratis-grpc/target/test-classes:/home/runner/work/ratis/ratis/ratis-shell/target/classes:/home/runner/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/runner/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/runner/.m2/repository/org/javassist/javassist/3.28.0-GA/javassist-3.28.0-GA.jar:/home/runner/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:/home/runner/.m2/repository/org/bouncycastle/bcprov-jdk18on/1.78.1/bcprov-jdk18on-1.78.1.jar:/home/runner/.m2/repository/org/bouncycastle/bcpkix-jdk18on/1.78.1/bcpkix-jdk18on-1.78.1.jar:/home/runner/.m2/repository/org/bouncycastle/bcutil-jdk18on/1.78.1/bcutil-jdk18on-1.78.1.jar:/home/runner/.m2/repository/org/slf4j/slf4j-api/2.0.7/slf4j-api-2.0.7.jar:/home/runner/.m2/repository/org/slf4j/slf4j-reload4j/2.0.7/slf4j-reload4j-2.0.7.jar:/home/runner/.m2/repository/ch/qos/reload4j/reload4j/1.2.22/reload4j-1.2.22.jar:/home/runner/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.12.2/junit-jupiter-engine-5.12.2.jar:/home/runner/.m2/repository/org/junit/platform/junit-platform-engine/1.12.2/junit-platform-engine-1.12.2.jar:/home/runner/.m2/repository/org/apiguardian/apiguardian-api/1.1.2/apiguardian-api-1.1.2.jar:/home/runner/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.12.2/junit-jupiter-api-5.12.2.jar:/home/runner/.m2/repository/org/opentest4j/opentest4j/1.3.0/opentest4j-1.3.0.jar:/home/runner/.m2/repository/org/junit/platform/junit-platform-commons/1.12.2/junit-platform-commons-1.12.2.jar:/home/runner/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.12.2/junit-jupiter-params-5.12.2.jar:/home/runner/.m2/repository/org/junit/platform/junit-platform-launcher/1.12.2/junit-platform-launcher-1.12.2.jar:/home/runner/.m2/repository/org/mockito/mockito-core/4.11.0/mockito-core-4.11.0.jar:/home/runner/.m2/repository/net/bytebuddy/byte-buddy/1.12.19/byte-buddy-1.12.19.jar:/home/runner/.m2/repository/net/bytebuddy/byte-buddy-agent/1.12.19/byte-buddy-agent-1.12.19.jar:/home/runner/.m2/repository/org/objenesis/objenesis/3.3/objenesis-3.3.jar:/home/runner/work/ratis/ratis/ratis-test/target/gradle-enterprise/test-listeners.jar:"/>
    <property name="java.vm.vendor" value="Temurin"/>
    <property name="sun.arch.data.model" value="64"/>
    <property name="java.vendor.url" value="https://adoptium.net/"/>
    <property name="user.timezone" value="Etc/UTC"/>
    <property name="java.vm.specification.version" value="1.8"/>
    <property name="os.name" value="Linux"/>
    <property name="sun.java.launcher" value="SUN_STANDARD"/>
    <property name="sun.boot.library.path" value="/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/amd64"/>
    <property name="sun.java.command" value="/home/runner/work/ratis/ratis/ratis-test/target/surefire/surefirebooter1613573925658068265.jar /home/runner/work/ratis/ratis/ratis-test/target/surefire 2025-07-09T10-03-14_039-jvmRun1 surefire7367695186772769877tmp surefire_202910848194823120058tmp"/>
    <property name="surefire.test.class.path" value="/home/runner/work/ratis/ratis/ratis-test/target/test-classes:/home/runner/work/ratis/ratis/ratis-test/target/classes:/home/runner/work/ratis/ratis/ratis-common/target/classes:/home/runner/.m2/repository/org/apache/ratis/ratis-thirdparty-misc/1.0.9/ratis-thirdparty-misc-1.0.9.jar:/home/runner/work/ratis/ratis/ratis-proto/target/classes:/home/runner/.m2/repository/jakarta/annotation/jakarta.annotation-api/1.3.5/jakarta.annotation-api-1.3.5.jar:/home/runner/work/ratis/ratis/ratis-common/target/test-classes:/home/runner/work/ratis/ratis/ratis-client/target/classes:/home/runner/work/ratis/ratis/ratis-server/target/classes:/home/runner/work/ratis/ratis/ratis-server-api/target/classes:/home/runner/work/ratis/ratis/ratis-metrics-api/target/classes:/home/runner/work/ratis/ratis/ratis-server/target/test-classes:/home/runner/work/ratis/ratis/ratis-metrics-default/target/classes:/home/runner/work/ratis/ratis/ratis-netty/target/classes:/home/runner/work/ratis/ratis/ratis-netty/target/test-classes:/home/runner/work/ratis/ratis/ratis-grpc/target/classes:/home/runner/work/ratis/ratis/ratis-grpc/target/test-classes:/home/runner/work/ratis/ratis/ratis-shell/target/classes:/home/runner/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/runner/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/runner/.m2/repository/org/javassist/javassist/3.28.0-GA/javassist-3.28.0-GA.jar:/home/runner/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:/home/runner/.m2/repository/org/bouncycastle/bcprov-jdk18on/1.78.1/bcprov-jdk18on-1.78.1.jar:/home/runner/.m2/repository/org/bouncycastle/bcpkix-jdk18on/1.78.1/bcpkix-jdk18on-1.78.1.jar:/home/runner/.m2/repository/org/bouncycastle/bcutil-jdk18on/1.78.1/bcutil-jdk18on-1.78.1.jar:/home/runner/.m2/repository/org/slf4j/slf4j-api/2.0.7/slf4j-api-2.0.7.jar:/home/runner/.m2/repository/org/slf4j/slf4j-reload4j/2.0.7/slf4j-reload4j-2.0.7.jar:/home/runner/.m2/repository/ch/qos/reload4j/reload4j/1.2.22/reload4j-1.2.22.jar:/home/runner/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.12.2/junit-jupiter-engine-5.12.2.jar:/home/runner/.m2/repository/org/junit/platform/junit-platform-engine/1.12.2/junit-platform-engine-1.12.2.jar:/home/runner/.m2/repository/org/apiguardian/apiguardian-api/1.1.2/apiguardian-api-1.1.2.jar:/home/runner/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.12.2/junit-jupiter-api-5.12.2.jar:/home/runner/.m2/repository/org/opentest4j/opentest4j/1.3.0/opentest4j-1.3.0.jar:/home/runner/.m2/repository/org/junit/platform/junit-platform-commons/1.12.2/junit-platform-commons-1.12.2.jar:/home/runner/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.12.2/junit-jupiter-params-5.12.2.jar:/home/runner/.m2/repository/org/junit/platform/junit-platform-launcher/1.12.2/junit-platform-launcher-1.12.2.jar:/home/runner/.m2/repository/org/mockito/mockito-core/4.11.0/mockito-core-4.11.0.jar:/home/runner/.m2/repository/net/bytebuddy/byte-buddy/1.12.19/byte-buddy-1.12.19.jar:/home/runner/.m2/repository/net/bytebuddy/byte-buddy-agent/1.12.19/byte-buddy-agent-1.12.19.jar:/home/runner/.m2/repository/org/objenesis/objenesis/3.3/objenesis-3.3.jar:/home/runner/work/ratis/ratis/ratis-test/target/gradle-enterprise/test-listeners.jar:"/>
    <property name="sun.cpu.endian" value="little"/>
    <property name="user.home" value="/home/runner"/>
    <property name="user.language" value="en"/>
    <property name="java.specification.vendor" value="Oracle Corporation"/>
    <property name="java.home" value="/usr/lib/jvm/temurin-8-jdk-amd64/jre"/>
    <property name="basedir" value="/home/runner/work/ratis/ratis/ratis-test"/>
    <property name="file.separator" value="/"/>
    <property name="line.separator" value="&#10;"/>
    <property name="java.vm.specification.vendor" value="Oracle Corporation"/>
    <property name="java.specification.name" value="Java Platform API Specification"/>
    <property name="java.awt.graphicsenv" value="sun.awt.X11GraphicsEnvironment"/>
    <property name="surefire.real.class.path" value="/home/runner/work/ratis/ratis/ratis-test/target/surefire/surefirebooter1613573925658068265.jar:/home/runner/.m2/repository/org/jacoco/org.jacoco.agent/0.8.12/org.jacoco.agent-0.8.12-runtime.jar"/>
    <property name="sun.boot.class.path" value="/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/resources.jar:/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/rt.jar:/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/sunrsasign.jar:/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/jsse.jar:/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/jce.jar:/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/charsets.jar:/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/jfr.jar:/usr/lib/jvm/temurin-8-jdk-amd64/jre/classes"/>
    <property name="sun.management.compiler" value="HotSpot 64-Bit Tiered Compilers"/>
    <property name="java.runtime.version" value="1.8.0_452-b09"/>
    <property name="java.net.preferIPv4Stack" value="true"/>
    <property name="user.name" value="runner"/>
    <property name="path.separator" value=":"/>
    <property name="os.version" value="6.11.0-1015-azure"/>
    <property name="java.endorsed.dirs" value="/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/endorsed"/>
    <property name="java.runtime.name" value="OpenJDK Runtime Environment"/>
    <property name="com.gradle.maven.scan.extension.test.listener.junitplatform.NestedExecutionSafeDelegatingTestExecutionListener" value="1e800aaa"/>
    <property name="file.encoding" value="UTF-8"/>
    <property name="java.vm.name" value="OpenJDK 64-Bit Server VM"/>
    <property name="develocity.listener.surefire.forkId" value="1"/>
    <property name="localRepository" value="/home/runner/.m2/repository"/>
    <property name="java.vendor.url.bug" value="https://github.com/adoptium/adoptium-support/issues"/>
    <property name="java.io.tmpdir" value="/tmp"/>
    <property name="java.version" value="1.8.0_452"/>
    <property name="user.dir" value="/home/runner/work/ratis/ratis/ratis-test"/>
    <property name="os.arch" value="amd64"/>
    <property name="ratis.tmp.dir" value="/home/runner/work/ratis/ratis/ratis-test/target/tmp"/>
    <property name="java.vm.specification.name" value="Java Virtual Machine Specification"/>
    <property name="java.awt.printerjob" value="sun.print.PSPrinterJob"/>
    <property name="ratis.log.dir" value="/home/runner/work/ratis/ratis/ratis-test/target/log"/>
    <property name="sun.os.patch.level" value="unknown"/>
    <property name="org.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads" value="false"/>
    <property name="java.library.path" value="/usr/java/packages/lib/amd64:/usr/lib64:/lib64:/lib:/usr/lib"/>
    <property name="java.vm.info" value="mixed mode"/>
    <property name="java.vendor" value="Temurin"/>
    <property name="java.vm.version" value="25.452-b09"/>
    <property name="java.specification.maintenance.version" value="6"/>
    <property name="develocity.listener.port" value="39503"/>
    <property name="java.ext.dirs" value="/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/ext:/usr/java/packages/lib/ext"/>
    <property name="sun.io.unicode.encoding" value="UnicodeLittle"/>
    <property name="java.class.version" value="52.0"/>
  </properties>
  <testcase name="testRaftClientMetrics(Boolean)[1]" classname="org.apache.ratis.grpc.TestRaftServerWithGrpc" time="7.814"/>
  <testcase name="testRaftClientMetrics(Boolean)[2]" classname="org.apache.ratis.grpc.TestRaftServerWithGrpc" time="5.561"/>
  <testcase name="testTlsWithKeyAndTrustManager(Boolean)[1]" classname="org.apache.ratis.grpc.TestRaftServerWithGrpc" time="39.147">
    <error type="java.util.concurrent.TimeoutException"><![CDATA[java.util.concurrent.TimeoutException: Timed out waiting for condition.
	at org.apache.ratis.RaftTestUtil.waitFor(RaftTestUtil.java:167)
	at org.apache.ratis.grpc.TestRaftServerWithGrpc.testRequestMetrics(TestRaftServerWithGrpc.java:283)
	at org.apache.ratis.grpc.TestRaftServerWithGrpc.testTlsWithKeyAndTrustManager(TestRaftServerWithGrpc.java:401)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at java.util.Optional.ifPresent(Optional.java:159)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:647)
	at java.util.stream.ReferencePipeline$7$1.accept(ReferencePipeline.java:272)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at java.util.stream.ReferencePipeline$7$1.accept(ReferencePipeline.java:272)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1384)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at java.util.stream.ReferencePipeline$7$1.accept(ReferencePipeline.java:272)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1384)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
]]></error>
    <system-out><![CDATA[2025-07-09 10:10:12,513 [main] INFO  util.LogUtils (Slf4jUtils.java:setLogLevel(38)) - Successfully set org.apache.ratis.conf.ConfUtils log level to WARN
2025-07-09 10:10:12,513 [main] INFO  util.LogUtils (Slf4jUtils.java:setLogLevel(38)) - Successfully set org.apache.ratis.util.FileUtils log level to TRACE
2025-07-09 10:10:12,513 [main] INFO  util.LogUtils (Slf4jUtils.java:setLogLevel(38)) - Successfully set org.apache.ratis.grpc.client.GrpcClientProtocolClient log level to TRACE
2025-07-09 10:10:12,517 [main] INFO  security.SecurityTestUtils (SecurityTestUtils.java:getResource(79)) - Getting resource ssl/server.pem: /home/runner/work/ratis/ratis/ratis-test/target/test-classes/ssl/server.pem
2025-07-09 10:10:12,700 [main] INFO  security.SecurityTestUtils (SecurityTestUtils.java:getResource(79)) - Getting resource ssl/server.crt: /home/runner/work/ratis/ratis/ratis-test/target/test-classes/ssl/server.crt
2025-07-09 10:10:12,701 [main] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied Files.newInputStream /home/runner/work/ratis/ratis/ratis-test/target/test-classes/ssl/server.crt with options []: sun.nio.ch.ChannelInputStream@4769378c
2025-07-09 10:10:12,721 [main] INFO  security.SecurityTestUtils (SecurityTestUtils.java:getResource(79)) - Getting resource ssl/ca.crt: /home/runner/work/ratis/ratis/ratis-test/target/test-classes/ssl/ca.crt
2025-07-09 10:10:12,722 [main] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied Files.newInputStream /home/runner/work/ratis/ratis/ratis-test/target/test-classes/ssl/ca.crt with options []: sun.nio.ch.ChannelInputStream@5730b513
2025-07-09 10:10:12,729 [main] INFO  security.SecurityTestUtils (SecurityTestUtils.java:getResource(79)) - Getting resource ssl/client.pem: /home/runner/work/ratis/ratis/ratis-test/target/test-classes/ssl/client.pem
2025-07-09 10:10:12,730 [main] INFO  security.SecurityTestUtils (SecurityTestUtils.java:getResource(79)) - Getting resource ssl/client.crt: /home/runner/work/ratis/ratis/ratis-test/target/test-classes/ssl/client.crt
2025-07-09 10:10:12,731 [main] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied Files.newInputStream /home/runner/work/ratis/ratis/ratis-test/target/test-classes/ssl/client.crt with options []: sun.nio.ch.ChannelInputStream@1f4cb17b
2025-07-09 10:10:12,737 [main] INFO  security.SecurityTestUtils (SecurityTestUtils.java:getResource(79)) - Getting resource ssl/ca.crt: /home/runner/work/ratis/ratis/ratis-test/target/test-classes/ssl/ca.crt
2025-07-09 10:10:12,738 [main] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied Files.newInputStream /home/runner/work/ratis/ratis/ratis-test/target/test-classes/ssl/ca.crt with options []: sun.nio.ch.ChannelInputStream@7aca299e
2025-07-09 10:10:12,744 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:<init>(308)) - new MiniRaftClusterWithGrpc with group-640E6E1041F6:[s3|localhost:15024, s4|localhost:15028, s5|localhost:15032]
2025-07-09 10:10:12,745 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(341)) - .............................................................. 
2025-07-09 10:10:12,745 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(342)) - ... 
2025-07-09 10:10:12,745 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(343)) - ...     Starting MiniRaftClusterWithGrpc
2025-07-09 10:10:12,746 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(344)) - ... 
2025-07-09 10:10:12,746 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(345)) - .............................................................. 
2025-07-09 10:10:12,746 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:initServers(320)) - servers = {}
2025-07-09 10:10:12,746 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(385)) - newRaftServer: s3, group-640E6E1041F6:[s3|localhost:15024, s4|localhost:15028, s5|localhost:15032], format? true
2025-07-09 10:10:12,747 [main] TRACE util.FileUtils (FileUtils.java:deleteFully(351)) - deleteFully target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s3
2025-07-09 10:10:12,747 [main] TRACE util.FileUtils (FileUtils.java:deleteFully(364)) - deleteFully: target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s3 does not exist.
2025-07-09 10:10:12,747 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(390)) - Formatted directory target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s3
2025-07-09 10:10:12,748 [main] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(69)) - raft.grpc.admin.host = null (fallback to raft.grpc.server.host)
2025-07-09 10:10:12,748 [main] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(62)) - raft.grpc.admin.port = 15025 (custom)
2025-07-09 10:10:12,749 [main] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(69)) - raft.grpc.client.host = null (fallback to raft.grpc.server.host)
2025-07-09 10:10:12,749 [main] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(62)) - raft.grpc.client.port = 15026 (custom)
2025-07-09 10:10:12,749 [main] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(62)) - raft.grpc.server.port = 15024 (custom)
2025-07-09 10:10:12,750 [main] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(62)) - raft.grpc.server.heartbeat.channel = false (custom)
2025-07-09 10:10:12,750 [main] INFO  server.GrpcServicesImpl (GrpcServicesImpl.java:newNettyServerBuilder(209)) - Setting TLS for 0.0.0.0/0.0.0.0:15024
2025-07-09 10:10:12,896 [main] INFO  server.GrpcServicesImpl (GrpcServicesImpl.java:newNettyServerBuilder(209)) - Setting TLS for 0.0.0.0/0.0.0.0:15025
2025-07-09 10:10:12,898 [main] INFO  server.GrpcServicesImpl (GrpcServicesImpl.java:newNettyServerBuilder(209)) - Setting TLS for 0.0.0.0/0.0.0.0:15026
2025-07-09 10:10:12,900 [main] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(62)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s3] (custom)
2025-07-09 10:10:12,901 [main] INFO  server.RaftServer (RaftServerProxy.java:addNew(105)) - s3: addNew group-640E6E1041F6:[s3|localhost:15024, s4|localhost:15028, s5|localhost:15032] returns group-640E6E1041F6:java.util.concurrent.CompletableFuture@626ff077[Not completed]
2025-07-09 10:10:12,901 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(385)) - newRaftServer: s4, group-640E6E1041F6:[s3|localhost:15024, s4|localhost:15028, s5|localhost:15032], format? true
2025-07-09 10:10:12,901 [main] TRACE util.FileUtils (FileUtils.java:deleteFully(351)) - deleteFully target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s4
2025-07-09 10:10:12,901 [s3-groupManagement] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(268)) - s3: new RaftServerImpl for group-640E6E1041F6:[s3|localhost:15024, s4|localhost:15028, s5|localhost:15032] with SimpleStateMachine4Testing:uninitialized
2025-07-09 10:10:12,902 [main] TRACE util.FileUtils (FileUtils.java:deleteFully(364)) - deleteFully: target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s4 does not exist.
2025-07-09 10:10:12,902 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(390)) - Formatted directory target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s4
2025-07-09 10:10:12,902 [s3-groupManagement] INFO  server.RaftServer$Division (ServerState.java:<init>(114)) - s3@group-640E6E1041F6: ConfigurationManager, init=conf: {index: -1, cur=peers:[s3|localhost:15024, s4|localhost:15028, s5|localhost:15032]|listeners:[], old=null}, confs=<EMPTY_MAP>
2025-07-09 10:10:12,903 [main] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(69)) - raft.grpc.admin.host = null (fallback to raft.grpc.server.host)
2025-07-09 10:10:12,903 [main] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(62)) - raft.grpc.admin.port = 15029 (custom)
2025-07-09 10:10:12,903 [main] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(69)) - raft.grpc.client.host = null (fallback to raft.grpc.server.host)
2025-07-09 10:10:12,903 [main] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(62)) - raft.grpc.client.port = 15030 (custom)
2025-07-09 10:10:12,904 [main] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(62)) - raft.grpc.server.port = 15028 (custom)
2025-07-09 10:10:12,904 [main] INFO  server.GrpcServicesImpl (GrpcServicesImpl.java:newNettyServerBuilder(209)) - Setting TLS for 0.0.0.0/0.0.0.0:15028
2025-07-09 10:10:12,906 [main] INFO  server.GrpcServicesImpl (GrpcServicesImpl.java:newNettyServerBuilder(209)) - Setting TLS for 0.0.0.0/0.0.0.0:15029
2025-07-09 10:10:12,908 [main] INFO  server.GrpcServicesImpl (GrpcServicesImpl.java:newNettyServerBuilder(209)) - Setting TLS for 0.0.0.0/0.0.0.0:15030
2025-07-09 10:10:12,909 [main] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(62)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s4] (custom)
2025-07-09 10:10:12,911 [main] INFO  server.RaftServer (RaftServerProxy.java:addNew(105)) - s4: addNew group-640E6E1041F6:[s3|localhost:15024, s4|localhost:15028, s5|localhost:15032] returns group-640E6E1041F6:java.util.concurrent.CompletableFuture@3a225534[Not completed]
2025-07-09 10:10:12,911 [s4-groupManagement] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(268)) - s4: new RaftServerImpl for group-640E6E1041F6:[s3|localhost:15024, s4|localhost:15028, s5|localhost:15032] with SimpleStateMachine4Testing:uninitialized
2025-07-09 10:10:12,911 [s4-groupManagement] INFO  server.RaftServer$Division (ServerState.java:<init>(114)) - s4@group-640E6E1041F6: ConfigurationManager, init=conf: {index: -1, cur=peers:[s3|localhost:15024, s4|localhost:15028, s5|localhost:15032]|listeners:[], old=null}, confs=<EMPTY_MAP>
2025-07-09 10:10:12,911 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(385)) - newRaftServer: s5, group-640E6E1041F6:[s3|localhost:15024, s4|localhost:15028, s5|localhost:15032], format? true
2025-07-09 10:10:12,912 [main] TRACE util.FileUtils (FileUtils.java:deleteFully(351)) - deleteFully target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s5
2025-07-09 10:10:12,913 [main] TRACE util.FileUtils (FileUtils.java:deleteFully(364)) - deleteFully: target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s5 does not exist.
2025-07-09 10:10:12,913 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(390)) - Formatted directory target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s5
2025-07-09 10:10:12,914 [main] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(69)) - raft.grpc.admin.host = null (fallback to raft.grpc.server.host)
2025-07-09 10:10:12,914 [main] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(62)) - raft.grpc.admin.port = 15033 (custom)
2025-07-09 10:10:12,914 [main] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(69)) - raft.grpc.client.host = null (fallback to raft.grpc.server.host)
2025-07-09 10:10:12,915 [main] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(62)) - raft.grpc.client.port = 15034 (custom)
2025-07-09 10:10:12,915 [main] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(62)) - raft.grpc.server.port = 15032 (custom)
2025-07-09 10:10:12,916 [main] INFO  server.GrpcServicesImpl (GrpcServicesImpl.java:newNettyServerBuilder(209)) - Setting TLS for 0.0.0.0/0.0.0.0:15032
2025-07-09 10:10:12,917 [main] INFO  server.GrpcServicesImpl (GrpcServicesImpl.java:newNettyServerBuilder(209)) - Setting TLS for 0.0.0.0/0.0.0.0:15033
2025-07-09 10:10:12,918 [main] INFO  server.GrpcServicesImpl (GrpcServicesImpl.java:newNettyServerBuilder(209)) - Setting TLS for 0.0.0.0/0.0.0.0:15034
2025-07-09 10:10:12,920 [main] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(62)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s5] (custom)
2025-07-09 10:10:12,921 [main] INFO  server.RaftServer (RaftServerProxy.java:addNew(105)) - s5: addNew group-640E6E1041F6:[s3|localhost:15024, s4|localhost:15028, s5|localhost:15032] returns group-640E6E1041F6:java.util.concurrent.CompletableFuture@54224125[Not completed]
2025-07-09 10:10:12,921 [s5-groupManagement] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(268)) - s5: new RaftServerImpl for group-640E6E1041F6:[s3|localhost:15024, s4|localhost:15028, s5|localhost:15032] with SimpleStateMachine4Testing:uninitialized
2025-07-09 10:10:12,921 [s3-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(62)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s3] (custom)
2025-07-09 10:10:12,921 [s5-groupManagement] INFO  server.RaftServer$Division (ServerState.java:<init>(114)) - s5@group-640E6E1041F6: ConfigurationManager, init=conf: {index: -1, cur=peers:[s3|localhost:15024, s4|localhost:15028, s5|localhost:15032]|listeners:[], old=null}, confs=<EMPTY_MAP>
2025-07-09 10:10:12,922 [s3-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(138)) - The storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s3/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6 does not exist. Creating ...
2025-07-09 10:10:12,922 [s3-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s3/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6
2025-07-09 10:10:12,924 [s3-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(229)) - Lock on /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s3/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6/in_use.lock acquired by nodename 11875@fv-az1788-284
2025-07-09 10:10:12,924 [s3-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s3/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6/current
2025-07-09 10:10:12,925 [s3-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s3/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6/sm
2025-07-09 10:10:12,925 [s3-impl-thread1] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s3/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6/current/raft-meta.tmp with options [CREATE, TRUNCATE_EXISTING, WRITE]: sun.nio.ch.FileChannelImpl@77d3e9f3
2025-07-09 10:10:12,926 [s3-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s3/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s3/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6/current/raft-meta with options [REPLACE_EXISTING]
2025-07-09 10:10:12,926 [s3-impl-thread1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(98)) - Storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s3/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6 has been successfully formatted.
2025-07-09 10:10:12,926 [s3-impl-thread1] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:initialize(213)) - Initializing SimpleStateMachine4Testing:uninitialized
2025-07-09 10:10:12,927 [s3-impl-thread1] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:loadSnapshot(296)) - Loading snapshot null
2025-07-09 10:10:12,927 [s3-impl-thread1] INFO  util.AwaitToRun (AwaitToRun.java:start(81)) - Thread[s3@group-640E6E1041F6-cacheEviction-AwaitToRun,5,main] started
2025-07-09 10:10:12,928 [s3-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(190)) - new s3@group-640E6E1041F6-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s3/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6
2025-07-09 10:10:12,930 [s3-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(141)) - s3@group-640E6E1041F6-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2025-07-09 10:10:12,930 [s3-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(141)) - s3@group-640E6E1041F6-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2025-07-09 10:10:12,931 [s3-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(405)) - s3@group-640E6E1041F6: start as a follower, conf=conf: {index: -1, cur=peers:[s3|localhost:15024, s4|localhost:15028, s5|localhost:15032]|listeners:[], old=null}
2025-07-09 10:10:12,931 [s3-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(392)) - s3@group-640E6E1041F6: changes role from      null to FOLLOWER at term 0 for startAsFollower
2025-07-09 10:10:12,931 [s3-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(148)) - s3: start s3@group-640E6E1041F6-FollowerState
2025-07-09 10:10:12,931 [s3-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-640E6E1041F6,id=s3
2025-07-09 10:10:12,931 [s3-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:register(58)) - register mxBean class org.apache.ratis.server.impl.RaftServerJmxAdapter as Ratis:service=RaftServer,group=group-640E6E1041F6,id=s3
2025-07-09 10:10:12,932 [s3@group-640E6E1041F6-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(69)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2025-07-09 10:10:12,932 [s3@group-640E6E1041F6-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(69)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2025-07-09 10:10:12,932 [s3-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(419)) - s3@group-640E6E1041F6: Successfully started.
2025-07-09 10:10:12,932 [main] INFO  server.RaftServer (RaftServerProxy.java:startImpl(412)) - s3: start RPC server
2025-07-09 10:10:12,934 [main] INFO  server.GrpcServicesImpl (GrpcServicesImpl.java:startImpl(346)) - s3: GrpcServicesImpl started, listening on 15026
2025-07-09 10:10:12,935 [main] INFO  server.GrpcServicesImpl (GrpcServicesImpl.java:startImpl(346)) - s3: GrpcServicesImpl started, listening on 15024
2025-07-09 10:10:12,936 [main] INFO  server.GrpcServicesImpl (GrpcServicesImpl.java:startImpl(346)) - s3: GrpcServicesImpl started, listening on 15025
2025-07-09 10:10:12,936 [JvmPauseMonitor6] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(146)) - JvmPauseMonitor-s3: Started
2025-07-09 10:10:12,937 [s4-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(62)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s4] (custom)
2025-07-09 10:10:12,937 [s4-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(138)) - The storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s4/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6 does not exist. Creating ...
2025-07-09 10:10:12,937 [s4-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s4/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6
2025-07-09 10:10:12,938 [s4-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(229)) - Lock on /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s4/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6/in_use.lock acquired by nodename 11875@fv-az1788-284
2025-07-09 10:10:12,939 [s4-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s4/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6/current
2025-07-09 10:10:12,939 [s4-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s4/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6/sm
2025-07-09 10:10:12,939 [s4-impl-thread1] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s4/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6/current/raft-meta.tmp with options [CREATE, TRUNCATE_EXISTING, WRITE]: sun.nio.ch.FileChannelImpl@31a935f5
2025-07-09 10:10:12,940 [s4-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s4/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s4/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6/current/raft-meta with options [REPLACE_EXISTING]
2025-07-09 10:10:12,940 [s4-impl-thread1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(98)) - Storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s4/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6 has been successfully formatted.
2025-07-09 10:10:12,940 [s4-impl-thread1] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:initialize(213)) - Initializing SimpleStateMachine4Testing:uninitialized
2025-07-09 10:10:12,940 [s4-impl-thread1] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:loadSnapshot(296)) - Loading snapshot null
2025-07-09 10:10:12,941 [s4-impl-thread1] INFO  util.AwaitToRun (AwaitToRun.java:start(81)) - Thread[s4@group-640E6E1041F6-cacheEviction-AwaitToRun,5,main] started
2025-07-09 10:10:12,941 [s4-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(190)) - new s4@group-640E6E1041F6-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s4/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6
2025-07-09 10:10:12,942 [s4-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(141)) - s4@group-640E6E1041F6-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2025-07-09 10:10:12,942 [s4-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(141)) - s4@group-640E6E1041F6-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2025-07-09 10:10:12,943 [s4-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(405)) - s4@group-640E6E1041F6: start as a follower, conf=conf: {index: -1, cur=peers:[s3|localhost:15024, s4|localhost:15028, s5|localhost:15032]|listeners:[], old=null}
2025-07-09 10:10:12,943 [s4-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(392)) - s4@group-640E6E1041F6: changes role from      null to FOLLOWER at term 0 for startAsFollower
2025-07-09 10:10:12,943 [s4-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(148)) - s4: start s4@group-640E6E1041F6-FollowerState
2025-07-09 10:10:12,943 [s4@group-640E6E1041F6-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(69)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2025-07-09 10:10:12,943 [s4@group-640E6E1041F6-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(69)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2025-07-09 10:10:12,944 [s4-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-640E6E1041F6,id=s4
2025-07-09 10:10:12,944 [s4-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:register(58)) - register mxBean class org.apache.ratis.server.impl.RaftServerJmxAdapter as Ratis:service=RaftServer,group=group-640E6E1041F6,id=s4
2025-07-09 10:10:12,944 [s4-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(419)) - s4@group-640E6E1041F6: Successfully started.
2025-07-09 10:10:12,944 [main] INFO  server.RaftServer (RaftServerProxy.java:startImpl(412)) - s4: start RPC server
2025-07-09 10:10:12,946 [main] INFO  server.GrpcServicesImpl (GrpcServicesImpl.java:startImpl(346)) - s4: GrpcServicesImpl started, listening on 15030
2025-07-09 10:10:12,947 [main] INFO  server.GrpcServicesImpl (GrpcServicesImpl.java:startImpl(346)) - s4: GrpcServicesImpl started, listening on 15028
2025-07-09 10:10:12,948 [main] INFO  server.GrpcServicesImpl (GrpcServicesImpl.java:startImpl(346)) - s4: GrpcServicesImpl started, listening on 15029
2025-07-09 10:10:12,949 [JvmPauseMonitor7] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(146)) - JvmPauseMonitor-s4: Started
2025-07-09 10:10:12,949 [s5-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(62)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s5] (custom)
2025-07-09 10:10:12,949 [s5-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(138)) - The storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s5/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6 does not exist. Creating ...
2025-07-09 10:10:12,950 [s5-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s5/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6
2025-07-09 10:10:12,953 [s5-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(229)) - Lock on /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s5/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6/in_use.lock acquired by nodename 11875@fv-az1788-284
2025-07-09 10:10:12,953 [s5-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s5/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6/current
2025-07-09 10:10:12,953 [s5-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s5/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6/sm
2025-07-09 10:10:12,953 [s5-impl-thread1] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s5/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6/current/raft-meta.tmp with options [CREATE, TRUNCATE_EXISTING, WRITE]: sun.nio.ch.FileChannelImpl@257ea0d5
2025-07-09 10:10:12,954 [s5-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s5/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s5/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6/current/raft-meta with options [REPLACE_EXISTING]
2025-07-09 10:10:12,954 [s5-impl-thread1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(98)) - Storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s5/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6 has been successfully formatted.
2025-07-09 10:10:12,954 [s5-impl-thread1] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:initialize(213)) - Initializing SimpleStateMachine4Testing:uninitialized
2025-07-09 10:10:12,954 [s5-impl-thread1] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:loadSnapshot(296)) - Loading snapshot null
2025-07-09 10:10:12,957 [s5-impl-thread1] INFO  util.AwaitToRun (AwaitToRun.java:start(81)) - Thread[s5@group-640E6E1041F6-cacheEviction-AwaitToRun,5,main] started
2025-07-09 10:10:12,957 [s5-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(190)) - new s5@group-640E6E1041F6-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s5/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6
2025-07-09 10:10:12,960 [s5-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(141)) - s5@group-640E6E1041F6-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2025-07-09 10:10:12,960 [s5-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(141)) - s5@group-640E6E1041F6-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2025-07-09 10:10:12,960 [s5-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(405)) - s5@group-640E6E1041F6: start as a follower, conf=conf: {index: -1, cur=peers:[s3|localhost:15024, s4|localhost:15028, s5|localhost:15032]|listeners:[], old=null}
2025-07-09 10:10:12,961 [s5-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(392)) - s5@group-640E6E1041F6: changes role from      null to FOLLOWER at term 0 for startAsFollower
2025-07-09 10:10:12,961 [s5-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(148)) - s5: start s5@group-640E6E1041F6-FollowerState
2025-07-09 10:10:12,961 [s5@group-640E6E1041F6-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(69)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2025-07-09 10:10:12,961 [s5@group-640E6E1041F6-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(69)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2025-07-09 10:10:12,961 [s5-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-640E6E1041F6,id=s5
2025-07-09 10:10:12,961 [s5-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:register(58)) - register mxBean class org.apache.ratis.server.impl.RaftServerJmxAdapter as Ratis:service=RaftServer,group=group-640E6E1041F6,id=s5
2025-07-09 10:10:12,962 [s5-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(419)) - s5@group-640E6E1041F6: Successfully started.
2025-07-09 10:10:12,962 [main] INFO  server.RaftServer (RaftServerProxy.java:startImpl(412)) - s5: start RPC server
2025-07-09 10:10:12,964 [main] INFO  server.GrpcServicesImpl (GrpcServicesImpl.java:startImpl(346)) - s5: GrpcServicesImpl started, listening on 15034
2025-07-09 10:10:12,965 [main] INFO  server.GrpcServicesImpl (GrpcServicesImpl.java:startImpl(346)) - s5: GrpcServicesImpl started, listening on 15032
2025-07-09 10:10:12,966 [main] INFO  server.GrpcServicesImpl (GrpcServicesImpl.java:startImpl(346)) - s5: GrpcServicesImpl started, listening on 15033
2025-07-09 10:10:12,967 [JvmPauseMonitor8] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(146)) - JvmPauseMonitor-s5: Started
2025-07-09 10:10:12,968 [main] DEBUG client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:buildChannel(135)) - Setting TLS for localhost:15026
2025-07-09 10:10:12,975 [main] DEBUG client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:buildChannel(135)) - Setting TLS for localhost:15025
2025-07-09 10:10:13,127 [grpc-default-executor-2] TRACE client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(314)) - client-3A6E039DAA24->s3: receive RaftClientReply:client-3A6E039DAA24->s3@group-640E6E1041F6, cid=13, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s3@group-640E6E1041F6 is not the leader, logIndex=0, commits[s3:c-1]
2025-07-09 10:10:13,127 [grpc-default-executor-2] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$null$6(215)) -  client-3A6E039DAA24: Failed* RaftClientRequest:client-3A6E039DAA24->s3@group-640E6E1041F6, cid=13, seq=1*, Watch(0), null
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotLeaderException: Server s3@group-640E6E1041F6 is not the leader
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniAccept(CompletableFuture.java:661)
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:646)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:397)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:303)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:317)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:308)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:551)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:473)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:648)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.NotLeaderException: Server s3@group-640E6E1041F6 is not the leader
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:402)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:313)
	... 11 more
2025-07-09 10:10:13,150 [s3@group-640E6E1041F6-FollowerState] INFO  impl.FollowerState (FollowerState.java:runImpl(161)) - s3@group-640E6E1041F6-FollowerState: change to CANDIDATE, lastRpcElapsedTime:219150767ns, electionTimeout:218ms
2025-07-09 10:10:13,150 [s3@group-640E6E1041F6-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - s3: shutdown s3@group-640E6E1041F6-FollowerState
2025-07-09 10:10:13,150 [s3@group-640E6E1041F6-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(392)) - s3@group-640E6E1041F6: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2025-07-09 10:10:13,151 [s3@group-640E6E1041F6-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(148)) - s3: start s3@group-640E6E1041F6-LeaderElection6
2025-07-09 10:10:13,153 [s3@group-640E6E1041F6-LeaderElection6] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(448)) - s3@group-640E6E1041F6-LeaderElection6 PRE_VOTE round 0: submit vote requests at term 0 for conf: {index: -1, cur=peers:[s3|localhost:15024, s4|localhost:15028, s5|localhost:15032]|listeners:[], old=null}
2025-07-09 10:10:13,154 [s3@group-640E6E1041F6-LeaderElection6-1] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(65)) - Build channel for s4|localhost:15028
2025-07-09 10:10:13,155 [s3@group-640E6E1041F6-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(69)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2025-07-09 10:10:13,155 [s3@group-640E6E1041F6-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(69)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2025-07-09 10:10:13,155 [s3@group-640E6E1041F6-LeaderElection6-2] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(65)) - Build channel for s5|localhost:15032
2025-07-09 10:10:13,176 [s4@group-640E6E1041F6-FollowerState] INFO  impl.FollowerState (FollowerState.java:runImpl(161)) - s4@group-640E6E1041F6-FollowerState: change to CANDIDATE, lastRpcElapsedTime:232698584ns, electionTimeout:231ms
2025-07-09 10:10:13,176 [s4@group-640E6E1041F6-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - s4: shutdown s4@group-640E6E1041F6-FollowerState
2025-07-09 10:10:13,176 [s4@group-640E6E1041F6-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(392)) - s4@group-640E6E1041F6: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2025-07-09 10:10:13,176 [s4@group-640E6E1041F6-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(148)) - s4: start s4@group-640E6E1041F6-LeaderElection7
2025-07-09 10:10:13,181 [s4@group-640E6E1041F6-LeaderElection7] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(448)) - s4@group-640E6E1041F6-LeaderElection7 PRE_VOTE round 0: submit vote requests at term 0 for conf: {index: -1, cur=peers:[s3|localhost:15024, s4|localhost:15028, s5|localhost:15032]|listeners:[], old=null}
2025-07-09 10:10:13,184 [s4@group-640E6E1041F6-LeaderElection7-1] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(65)) - Build channel for s3|localhost:15024
2025-07-09 10:10:13,187 [s4@group-640E6E1041F6-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(69)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2025-07-09 10:10:13,187 [s4@group-640E6E1041F6-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(69)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2025-07-09 10:10:13,187 [s4@group-640E6E1041F6-LeaderElection7-2] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(65)) - Build channel for s5|localhost:15032
2025-07-09 10:10:13,216 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1433)) - s4@group-640E6E1041F6: receive requestVote(PRE_VOTE, s3, group-640E6E1041F6, 0, <PROTO_DEFAULT>)
2025-07-09 10:10:13,217 [grpc-default-executor-3] INFO  impl.VoteContext (VoteContext.java:log(49)) - s4@group-640E6E1041F6-CANDIDATE: accept PRE_VOTE from s3: our priority 0 <= candidate's priority 0
2025-07-09 10:10:13,217 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1467)) - s4@group-640E6E1041F6 replies to PRE_VOTE vote request: s3<-s4#0:OK-t0-last:<INITIAL_VALUE>. Peer's state: s4@group-640E6E1041F6:t0, leader=null, voted=, raftlog=Memoized:s4@group-640E6E1041F6-SegmentedRaftLog:OPENED:c-1:lastnull, conf=conf: {index: -1, cur=peers:[s3|localhost:15024, s4|localhost:15028, s5|localhost:15032]|listeners:[], old=null}
2025-07-09 10:10:13,220 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1433)) - s5@group-640E6E1041F6: receive requestVote(PRE_VOTE, s3, group-640E6E1041F6, 0, <PROTO_DEFAULT>)
2025-07-09 10:10:13,223 [grpc-default-executor-1] INFO  impl.VoteContext (VoteContext.java:log(49)) - s5@group-640E6E1041F6-FOLLOWER: accept PRE_VOTE from s3: our priority 0 <= candidate's priority 0
2025-07-09 10:10:13,223 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1467)) - s5@group-640E6E1041F6 replies to PRE_VOTE vote request: s3<-s5#0:OK-t0-last:<INITIAL_VALUE>. Peer's state: s5@group-640E6E1041F6:t0, leader=null, voted=, raftlog=Memoized:s5@group-640E6E1041F6-SegmentedRaftLog:OPENED:c-1:lastnull, conf=conf: {index: -1, cur=peers:[s3|localhost:15024, s4|localhost:15028, s5|localhost:15032]|listeners:[], old=null}
2025-07-09 10:10:13,223 [s3@group-640E6E1041F6-LeaderElection6] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(206)) - s3@group-640E6E1041F6-LeaderElection6: PRE_VOTE PASSED received 1 response(s) and 0 exception(s):
2025-07-09 10:10:13,224 [s3@group-640E6E1041F6-LeaderElection6] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(210)) -   Response 0: s3<-s4#0:OK-t0-last:<INITIAL_VALUE>
2025-07-09 10:10:13,224 [s3@group-640E6E1041F6-LeaderElection6] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(450)) - s3@group-640E6E1041F6-LeaderElection6 PRE_VOTE round 0: result PASSED
2025-07-09 10:10:13,224 [s3@group-640E6E1041F6-LeaderElection6] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s3/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6/current/raft-meta.tmp with options [CREATE, TRUNCATE_EXISTING, WRITE]: sun.nio.ch.FileChannelImpl@3abf0141
2025-07-09 10:10:13,225 [s3@group-640E6E1041F6-LeaderElection6] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s3/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s3/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6/current/raft-meta with options [REPLACE_EXISTING]
2025-07-09 10:10:13,226 [s3@group-640E6E1041F6-LeaderElection6] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(448)) - s3@group-640E6E1041F6-LeaderElection6 ELECTION round 0: submit vote requests at term 1 for conf: {index: -1, cur=peers:[s3|localhost:15024, s4|localhost:15028, s5|localhost:15032]|listeners:[], old=null}
2025-07-09 10:10:13,232 [s3@group-640E6E1041F6-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(69)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2025-07-09 10:10:13,232 [s3@group-640E6E1041F6-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(69)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2025-07-09 10:10:13,234 [s5@group-640E6E1041F6-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(69)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2025-07-09 10:10:13,234 [s5@group-640E6E1041F6-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(69)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2025-07-09 10:10:13,238 [timer4] DEBUG client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:buildChannel(135)) - Setting TLS for localhost:15034
2025-07-09 10:10:13,238 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1433)) - s5@group-640E6E1041F6: receive requestVote(ELECTION, s3, group-640E6E1041F6, 1, <PROTO_DEFAULT>)
2025-07-09 10:10:13,240 [grpc-default-executor-1] INFO  impl.VoteContext (VoteContext.java:log(49)) - s5@group-640E6E1041F6-FOLLOWER: accept ELECTION from s3: our priority 0 <= candidate's priority 0
2025-07-09 10:10:13,240 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(392)) - s5@group-640E6E1041F6: changes role from  FOLLOWER to FOLLOWER at term 0 for candidate:s3
2025-07-09 10:10:13,240 [grpc-default-executor-1] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - s5: shutdown s5@group-640E6E1041F6-FollowerState
2025-07-09 10:10:13,240 [s5@group-640E6E1041F6-FollowerState] INFO  impl.FollowerState (FollowerState.java:runImpl(170)) - s5@group-640E6E1041F6-FollowerState was interrupted
2025-07-09 10:10:13,241 [grpc-default-executor-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(148)) - s5: start s5@group-640E6E1041F6-FollowerState
2025-07-09 10:10:13,241 [timer4] DEBUG client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:buildChannel(135)) - Setting TLS for localhost:15033
2025-07-09 10:10:13,242 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:setFirstElection(576)) - s5@group-640E6E1041F6: set firstElectionSinceStartup to false for candidate:s3
2025-07-09 10:10:13,243 [grpc-default-executor-1] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s5/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6/current/raft-meta.tmp with options [CREATE, TRUNCATE_EXISTING, WRITE]: sun.nio.ch.FileChannelImpl@3312f363
2025-07-09 10:10:13,248 [grpc-default-executor-1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s5/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s5/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6/current/raft-meta with options [REPLACE_EXISTING]
2025-07-09 10:10:13,248 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1467)) - s5@group-640E6E1041F6 replies to ELECTION vote request: s3<-s5#0:OK-t1-last:<INITIAL_VALUE>. Peer's state: s5@group-640E6E1041F6:t1, leader=null, voted=s3, raftlog=Memoized:s5@group-640E6E1041F6-SegmentedRaftLog:OPENED:c-1:lastnull, conf=conf: {index: -1, cur=peers:[s3|localhost:15024, s4|localhost:15028, s5|localhost:15032]|listeners:[], old=null}
2025-07-09 10:10:13,252 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1433)) - s4@group-640E6E1041F6: receive requestVote(ELECTION, s3, group-640E6E1041F6, 1, <PROTO_DEFAULT>)
2025-07-09 10:10:13,252 [grpc-default-executor-3] INFO  impl.VoteContext (VoteContext.java:log(49)) - s4@group-640E6E1041F6-CANDIDATE: accept ELECTION from s3: our priority 0 <= candidate's priority 0
2025-07-09 10:10:13,253 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(392)) - s4@group-640E6E1041F6: changes role from CANDIDATE to FOLLOWER at term 0 for candidate:s3
2025-07-09 10:10:13,253 [grpc-default-executor-3] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(141)) - s4: shutdown s4@group-640E6E1041F6-LeaderElection7
2025-07-09 10:10:13,253 [grpc-default-executor-3] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(148)) - s4: start s4@group-640E6E1041F6-FollowerState
2025-07-09 10:10:13,254 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:setFirstElection(576)) - s4@group-640E6E1041F6: set firstElectionSinceStartup to false for candidate:s3
2025-07-09 10:10:13,254 [grpc-default-executor-3] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s4/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6/current/raft-meta.tmp with options [CREATE, TRUNCATE_EXISTING, WRITE]: sun.nio.ch.FileChannelImpl@409ef030
2025-07-09 10:10:13,255 [s3@group-640E6E1041F6-LeaderElection6] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(206)) - s3@group-640E6E1041F6-LeaderElection6: ELECTION PASSED received 1 response(s) and 0 exception(s):
2025-07-09 10:10:13,256 [s3@group-640E6E1041F6-LeaderElection6] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(210)) -   Response 0: s3<-s5#0:OK-t1-last:<INITIAL_VALUE>
2025-07-09 10:10:13,257 [s3@group-640E6E1041F6-LeaderElection6] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(450)) - s3@group-640E6E1041F6-LeaderElection6 ELECTION round 0: result PASSED
2025-07-09 10:10:13,258 [grpc-default-executor-3] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s4/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s4/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6/current/raft-meta with options [REPLACE_EXISTING]
2025-07-09 10:10:13,259 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1467)) - s4@group-640E6E1041F6 replies to ELECTION vote request: s3<-s4#0:OK-t1-last:<INITIAL_VALUE>. Peer's state: s4@group-640E6E1041F6:t1, leader=null, voted=s3, raftlog=Memoized:s4@group-640E6E1041F6-SegmentedRaftLog:OPENED:c-1:lastnull, conf=conf: {index: -1, cur=peers:[s3|localhost:15024, s4|localhost:15028, s5|localhost:15032]|listeners:[], old=null}
2025-07-09 10:10:13,259 [s3@group-640E6E1041F6-LeaderElection6] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(141)) - s3: shutdown s3@group-640E6E1041F6-LeaderElection6
2025-07-09 10:10:13,260 [s3@group-640E6E1041F6-LeaderElection6] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(392)) - s3@group-640E6E1041F6: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2025-07-09 10:10:13,260 [s3@group-640E6E1041F6-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(69)) - raft.server.staging.timeout = 900ms (fallback to raft.server.rpc.timeout.max)
2025-07-09 10:10:13,261 [s3@group-640E6E1041F6-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(62)) - raft.server.write.element-limit = 10 (custom)
2025-07-09 10:10:13,261 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1433)) - s3@group-640E6E1041F6: receive requestVote(PRE_VOTE, s4, group-640E6E1041F6, 0, <PROTO_DEFAULT>)
2025-07-09 10:10:13,262 [s3@group-640E6E1041F6-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(62)) - raft.server.write.byte-limit = 1MB (=1048576) (custom)
2025-07-09 10:10:13,264 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1433)) - s5@group-640E6E1041F6: receive requestVote(PRE_VOTE, s4, group-640E6E1041F6, 0, <PROTO_DEFAULT>)
2025-07-09 10:10:13,264 [grpc-default-executor-2] INFO  impl.VoteContext (VoteContext.java:log(49)) - s5@group-640E6E1041F6-FOLLOWER: accept PRE_VOTE from s4: our priority 0 <= candidate's priority 0
2025-07-09 10:10:13,264 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1467)) - s5@group-640E6E1041F6 replies to PRE_VOTE vote request: s4<-s5#0:OK-t1-last:<INITIAL_VALUE>. Peer's state: s5@group-640E6E1041F6:t1, leader=null, voted=s3, raftlog=Memoized:s5@group-640E6E1041F6-SegmentedRaftLog:OPENED:c-1:lastnull, conf=conf: {index: -1, cur=peers:[s3|localhost:15024, s4|localhost:15028, s5|localhost:15032]|listeners:[], old=null}
2025-07-09 10:10:13,265 [s3@group-640E6E1041F6-LeaderElection6] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(148)) - s3: start s3@group-640E6E1041F6-LeaderStateImpl
2025-07-09 10:10:13,266 [s3@group-640E6E1041F6-LeaderElection6] INFO  server.RaftServer$Division (RaftServerImpl.java:setFirstElection(576)) - s3@group-640E6E1041F6: set firstElectionSinceStartup to false for becomeLeader
2025-07-09 10:10:13,266 [s3@group-640E6E1041F6-LeaderElection6] INFO  server.RaftServer$Division (ServerState.java:setLeader(272)) - s3@group-640E6E1041F6: change Leader from null to s3 at term 1 for becomeLeader, leader elected after 363ms
2025-07-09 10:10:13,266 [s3@group-640E6E1041F6-LeaderElection6] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(440)) - s3@group-640E6E1041F6-SegmentedRaftLogWorker: Starting segment from index:0
2025-07-09 10:10:13,267 [s3@group-640E6E1041F6-LeaderElection6] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(386)) - s3@group-640E6E1041F6: set configuration conf: {index: 0, cur=peers:[s3|localhost:15024, s4|localhost:15028, s5|localhost:15032]|listeners:[], old=null}
2025-07-09 10:10:13,268 [s3@group-640E6E1041F6-SegmentedRaftLogWorker] INFO  segmented.BufferedWriteChannel (BufferedWriteChannel.java:open(61)) - open log_inprogress_0 at position 0
2025-07-09 10:10:13,275 [s4@group-640E6E1041F6-LeaderElection7] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(206)) - s4@group-640E6E1041F6-LeaderElection7: PRE_VOTE DISCOVERED_A_NEW_TERM (term=1) received 1 response(s) and 0 exception(s):
2025-07-09 10:10:13,275 [s4@group-640E6E1041F6-LeaderElection7] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(210)) -   Response 0: s4<-s5#0:OK-t1-last:<INITIAL_VALUE>
2025-07-09 10:10:13,275 [grpc-default-executor-0] INFO  impl.VoteContext (VoteContext.java:log(49)) - s3@group-640E6E1041F6-LEADER: reject PRE_VOTE from s4: this server is the leader and still has leadership
2025-07-09 10:10:13,275 [s4@group-640E6E1041F6-LeaderElection7] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(450)) - s4@group-640E6E1041F6-LeaderElection7 PRE_VOTE round 0: result DISCOVERED_A_NEW_TERM (term=1)
2025-07-09 10:10:13,276 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1467)) - s3@group-640E6E1041F6 replies to PRE_VOTE vote request: s4<-s3#0:FAIL-t1-last:(t:1, i:0). Peer's state: s3@group-640E6E1041F6:t1, leader=s3, voted=s3, raftlog=Memoized:s3@group-640E6E1041F6-SegmentedRaftLog:OPENED:c-1:last(t:1, i:0), conf=conf: {index: 0, cur=peers:[s3|localhost:15024, s4|localhost:15028, s5|localhost:15032]|listeners:[], old=null}
2025-07-09 10:10:13,278 [s3@group-640E6E1041F6-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(647)) - s3@group-640E6E1041F6-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s3/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6/current/log_inprogress_0
2025-07-09 10:10:13,281 [grpc-default-executor-5] INFO  server.RaftServer$Division (ServerState.java:setLeader(272)) - s5@group-640E6E1041F6: change Leader from null to s3 at term 1 for appendEntries, leader elected after 359ms
2025-07-09 10:10:13,284 [grpc-default-executor-5] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(386)) - s5@group-640E6E1041F6: set configuration conf: {index: 0, cur=peers:[s3|localhost:15024, s4|localhost:15028, s5|localhost:15032]|listeners:[], old=null}
2025-07-09 10:10:13,285 [s5-server-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(440)) - s5@group-640E6E1041F6-SegmentedRaftLogWorker: Starting segment from index:0
2025-07-09 10:10:13,284 [grpc-default-executor-4] INFO  server.RaftServer$Division (ServerState.java:setLeader(272)) - s4@group-640E6E1041F6: change Leader from null to s3 at term 1 for appendEntries, leader elected after 373ms
2025-07-09 10:10:13,286 [s5@group-640E6E1041F6-SegmentedRaftLogWorker] INFO  segmented.BufferedWriteChannel (BufferedWriteChannel.java:open(61)) - open log_inprogress_0 at position 0
2025-07-09 10:10:13,290 [grpc-default-executor-4] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(386)) - s4@group-640E6E1041F6: set configuration conf: {index: 0, cur=peers:[s3|localhost:15024, s4|localhost:15028, s5|localhost:15032]|listeners:[], old=null}
2025-07-09 10:10:13,292 [s4-server-thread2] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(440)) - s4@group-640E6E1041F6-SegmentedRaftLogWorker: Starting segment from index:0
2025-07-09 10:10:13,293 [s4@group-640E6E1041F6-SegmentedRaftLogWorker] INFO  segmented.BufferedWriteChannel (BufferedWriteChannel.java:open(61)) - open log_inprogress_0 at position 0
2025-07-09 10:10:13,296 [s5@group-640E6E1041F6-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(647)) - s5@group-640E6E1041F6-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s5/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6/current/log_inprogress_0
2025-07-09 10:10:13,309 [s3@group-640E6E1041F6-StateMachineUpdater] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s3/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6/current/raft-meta.conf.tmp with options [CREATE, TRUNCATE_EXISTING, WRITE]: sun.nio.ch.FileChannelImpl@7603eee3
2025-07-09 10:10:13,311 [s4@group-640E6E1041F6-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(647)) - s4@group-640E6E1041F6-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s4/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6/current/log_inprogress_0
2025-07-09 10:10:13,311 [s3@group-640E6E1041F6-StateMachineUpdater] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s3/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6/current/raft-meta.conf.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s3/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6/current/raft-meta.conf with options [REPLACE_EXISTING]
2025-07-09 10:10:13,312 [s3@group-640E6E1041F6-StateMachineUpdater] INFO  server.RaftServer$Division (LeaderStateImpl.java:checkStartIndex(309)) - Leader s3@group-640E6E1041F6-LeaderStateImpl is ready since appliedIndex == startIndex == 0
2025-07-09 10:10:13,313 [grpc-default-executor-1] TRACE client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(314)) - client-3A6E039DAA24->s5: receive RaftClientReply:client-3A6E039DAA24->s5@group-640E6E1041F6, cid=13, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s5@group-640E6E1041F6 is not the leader, suggested leader is: s3|localhost:15024, logIndex=0, commits[s5:c-1, s3:c-1, s4:c-1]
2025-07-09 10:10:13,314 [grpc-default-executor-1] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$null$6(215)) -  client-3A6E039DAA24: Failed* RaftClientRequest:client-3A6E039DAA24->s5@group-640E6E1041F6, cid=13, seq=1*, Watch(0), null
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.NotLeaderException: Server s5@group-640E6E1041F6 is not the leader, suggested leader is: s3|localhost:15024
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniAccept(CompletableFuture.java:661)
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:646)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:397)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:303)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:317)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:308)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:551)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onMessage(DelayedClientCall.java:473)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:648)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.NotLeaderException: Server s5@group-640E6E1041F6 is not the leader, suggested leader is: s3|localhost:15024
	at org.apache.ratis.client.impl.ClientProtoUtils.toRaftClientReply(ClientProtoUtils.java:402)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:313)
	... 11 more
2025-07-09 10:10:13,320 [timer4] DEBUG client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:buildChannel(135)) - Setting TLS for localhost:15026
2025-07-09 10:10:13,321 [timer4] DEBUG client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:buildChannel(135)) - Setting TLS for localhost:15025
2025-07-09 10:10:13,347 [grpc-default-executor-2] TRACE client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(314)) - client-3A6E039DAA24->s3: receive RaftClientReply:client-3A6E039DAA24->s3@group-640E6E1041F6, cid=13, SUCCESS, logIndex=0, commits[s3:c0, s4:c-1, s5:c-1]
2025-07-09 10:10:13,352 [s4@group-640E6E1041F6-StateMachineUpdater] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s4/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6/current/raft-meta.conf.tmp with options [CREATE, TRUNCATE_EXISTING, WRITE]: sun.nio.ch.FileChannelImpl@47fe6815
2025-07-09 10:10:13,353 [s5@group-640E6E1041F6-StateMachineUpdater] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s5/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6/current/raft-meta.conf.tmp with options [CREATE, TRUNCATE_EXISTING, WRITE]: sun.nio.ch.FileChannelImpl@231229ee
2025-07-09 10:10:13,355 [s3@group-640E6E1041F6-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:applyTransaction(248)) - applyTransaction for log index 1
2025-07-09 10:10:13,356 [s3@group-640E6E1041F6-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(205)) - s3: put 1, testing -> (t:1, i:1), STATEMACHINELOGENTRY, WRITE: logData.size=7, stateMachineData.size=17, logEntryProtoSerializedSize=0
2025-07-09 10:10:13,356 [s4@group-640E6E1041F6-StateMachineUpdater] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s4/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6/current/raft-meta.conf.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s4/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6/current/raft-meta.conf with options [REPLACE_EXISTING]
2025-07-09 10:10:13,357 [s4@group-640E6E1041F6-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:applyTransaction(248)) - applyTransaction for log index 1
2025-07-09 10:10:13,357 [s4@group-640E6E1041F6-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(205)) - s4: put 1, testing -> (t:1, i:1), STATEMACHINELOGENTRY, WRITE: logData.size=7, stateMachineData.size=17, logEntryProtoSerializedSize=0
2025-07-09 10:10:13,357 [s5@group-640E6E1041F6-StateMachineUpdater] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s5/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6/current/raft-meta.conf.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/d26fc21a/MiniRaftClusterWithGrpc3b90984/s5/c5727ebe-bcf9-4bf4-bd83-640e6e1041f6/current/raft-meta.conf with options [REPLACE_EXISTING]
2025-07-09 10:10:13,358 [s5@group-640E6E1041F6-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:applyTransaction(248)) - applyTransaction for log index 1
2025-07-09 10:10:13,358 [s5@group-640E6E1041F6-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(205)) - s5: put 1, testing -> (t:1, i:1), STATEMACHINELOGENTRY, WRITE: logData.size=7, stateMachineData.size=17, logEntryProtoSerializedSize=0
2025-07-09 10:10:13,359 [grpc-default-executor-4] TRACE client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(314)) - client-3A6E039DAA24->s3: receive RaftClientReply:client-3A6E039DAA24->s3@group-640E6E1041F6, cid=14, SUCCESS, logIndex=1, commits[s3:c1, s4:c0, s5:c0]
2025-07-09 10:10:13,365 [main] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:block(135)) - block FLUSH_STATE_MACHINE_DATA
2025-07-09 10:10:13,365 [main] DEBUG client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:buildChannel(135)) - Setting TLS for localhost:15026
2025-07-09 10:10:13,367 [main] DEBUG client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:buildChannel(135)) - Setting TLS for localhost:15025
2025-07-09 10:10:13,368 [main] DEBUG client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:buildChannel(135)) - Setting TLS for localhost:15026
2025-07-09 10:10:13,370 [main] DEBUG client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:buildChannel(135)) - Setting TLS for localhost:15025
2025-07-09 10:10:13,372 [main] DEBUG client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:buildChannel(135)) - Setting TLS for localhost:15026
2025-07-09 10:10:13,374 [main] DEBUG client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:buildChannel(135)) - Setting TLS for localhost:15025
2025-07-09 10:10:13,376 [main] DEBUG client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:buildChannel(135)) - Setting TLS for localhost:15026
2025-07-09 10:10:13,379 [main] DEBUG client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:buildChannel(135)) - Setting TLS for localhost:15025
2025-07-09 10:10:13,383 [main] DEBUG client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:buildChannel(135)) - Setting TLS for localhost:15026
2025-07-09 10:10:13,388 [main] DEBUG client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:buildChannel(135)) - Setting TLS for localhost:15025
2025-07-09 10:10:13,392 [main] DEBUG client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:buildChannel(135)) - Setting TLS for localhost:15026
2025-07-09 10:10:13,396 [main] DEBUG client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:buildChannel(135)) - Setting TLS for localhost:15025
2025-07-09 10:10:13,404 [main] DEBUG client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:buildChannel(135)) - Setting TLS for localhost:15026
2025-07-09 10:10:13,407 [main] DEBUG client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:buildChannel(135)) - Setting TLS for localhost:15025
2025-07-09 10:10:13,411 [main] DEBUG client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:buildChannel(135)) - Setting TLS for localhost:15026
2025-07-09 10:10:13,416 [main] DEBUG client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:buildChannel(135)) - Setting TLS for localhost:15025
2025-07-09 10:10:13,422 [main] DEBUG client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:buildChannel(135)) - Setting TLS for localhost:15026
2025-07-09 10:10:13,423 [main] DEBUG client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:buildChannel(135)) - Setting TLS for localhost:15025
2025-07-09 10:10:13,441 [main] DEBUG client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:buildChannel(135)) - Setting TLS for localhost:15026
2025-07-09 10:10:13,442 [main] DEBUG client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:buildChannel(135)) - Setting TLS for localhost:15025
2025-07-09 10:10:13,456 [main] DEBUG client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:buildChannel(135)) - Setting TLS for localhost:15026
2025-07-09 10:10:13,460 [grpc-default-executor-1] TRACE client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(314)) - client-E3EBBD9E13E7->s3: receive RaftClientReply:client-E3EBBD9E13E7->s3@group-640E6E1041F6, cid=15, SUCCESS, logIndex=2, commits[s3:c2, s4:c1, s5:c1]
2025-07-09 10:10:13,463 [grpc-default-executor-5] TRACE client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(314)) - client-8E952480CD98->s3: receive RaftClientReply:client-8E952480CD98->s3@group-640E6E1041F6, cid=17, SUCCESS, logIndex=2, commits[s3:c2, s4:c1, s5:c1]
2025-07-09 10:10:13,462 [main] DEBUG client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:buildChannel(135)) - Setting TLS for localhost:15025
2025-07-09 10:10:13,460 [grpc-default-executor-7] TRACE client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(314)) - client-7781907C6BD6->s3: receive RaftClientReply:client-7781907C6BD6->s3@group-640E6E1041F6, cid=19, SUCCESS, logIndex=2, commits[s3:c2, s4:c2, s5:c1]
2025-07-09 10:10:13,487 [grpc-default-executor-8] TRACE client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(314)) - client-61BF0E42C8D2->s3: receive RaftClientReply:client-61BF0E42C8D2->s3@group-640E6E1041F6, cid=21, SUCCESS, logIndex=2, commits[s3:c2, s4:c2, s5:c2]
2025-07-09 10:10:13,497 [grpc-default-executor-5] TRACE client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(314)) - client-EB1D1B3506EF->s3: receive RaftClientReply:client-EB1D1B3506EF->s3@group-640E6E1041F6, cid=23, SUCCESS, logIndex=2, commits[s3:c2, s4:c2, s5:c2]
2025-07-09 10:10:13,502 [grpc-default-executor-6] TRACE client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(314)) - client-87603C0349F3->s3: receive RaftClientReply:client-87603C0349F3->s3@group-640E6E1041F6, cid=27, SUCCESS, logIndex=2, commits[s3:c2, s4:c2, s5:c2]
2025-07-09 10:10:13,508 [grpc-default-executor-4] TRACE client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(314)) - client-ED7451308E0D->s3: receive RaftClientReply:client-ED7451308E0D->s3@group-640E6E1041F6, cid=25, SUCCESS, logIndex=2, commits[s3:c2, s4:c2, s5:c2]
2025-07-09 10:10:13,524 [grpc-default-executor-0] TRACE client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(314)) - client-29C0198291FB->s3: receive RaftClientReply:client-29C0198291FB->s3@group-640E6E1041F6, cid=29, SUCCESS, logIndex=2, commits[s3:c2, s4:c2, s5:c2]
2025-07-09 10:10:13,553 [grpc-default-executor-0] TRACE client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(314)) - client-682CF908C59B->s3: receive RaftClientReply:client-682CF908C59B->s3@group-640E6E1041F6, cid=33, SUCCESS, logIndex=2, commits[s3:c2, s4:c2, s5:c2]
2025-07-09 10:10:13,567 [grpc-default-executor-8] TRACE client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(314)) - client-F992FB088A8B->s3: receive RaftClientReply:client-F992FB088A8B->s3@group-640E6E1041F6, cid=31, SUCCESS, logIndex=2, commits[s3:c2, s4:c2, s5:c2]
2025-07-09 10:10:13,574 [grpc-default-executor-1] TRACE client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(314)) - client-CB572A742639->s3: receive RaftClientReply:client-CB572A742639->s3@group-640E6E1041F6, cid=35, SUCCESS, logIndex=2, commits[s3:c2, s4:c2, s5:c2]
2025-07-09 10:10:13,587 [grpc-default-executor-0] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$null$6(215)) -  client-87603C0349F3: Failed* RaftClientRequest:client-87603C0349F3->s3@group-640E6E1041F6, cid=28, seq=2, RW, message 5
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.ResourceUnavailableException: s3@group-640E6E1041F6: Failed to acquire a pending write request for RaftClientRequest:client-87603C0349F3->s3@group-640E6E1041F6, cid=28, seq=2, RW, Message:6d6573736167652035
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniAccept(CompletableFuture.java:661)
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:646)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:397)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:303)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:334)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:564)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:565)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$100(ClientCallImpl.java:72)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:733)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:714)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.ResourceUnavailableException: s3@group-640E6E1041F6: Failed to acquire a pending write request for RaftClientRequest:client-87603C0349F3->s3@group-640E6E1041F6, cid=28, seq=2, RW, Message:6d6573736167652035
	at org.apache.ratis.server.impl.RaftServerImpl.getResourceUnavailableReply(RaftServerImpl.java:813)
	at org.apache.ratis.server.impl.RaftServerImpl.appendTransaction(RaftServerImpl.java:833)
	at org.apache.ratis.server.impl.RaftServerImpl.writeAsyncImpl(RaftServerImpl.java:1008)
	at org.apache.ratis.server.impl.RaftServerImpl.writeAsync(RaftServerImpl.java:972)
	at org.apache.ratis.server.impl.RaftServerImpl.replyFuture(RaftServerImpl.java:965)
	at org.apache.ratis.server.impl.RaftServerImpl.submitClientRequestAsync(RaftServerImpl.java:942)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$null$11(RaftServerImpl.java:931)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitClientRequestAsync$12(RaftServerImpl.java:931)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	... 3 more
2025-07-09 10:10:13,592 [grpc-default-executor-0] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$send$4(181)) - Failed to send request, message=message 5
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.ResourceUnavailableException: s3@group-640E6E1041F6: Failed to acquire a pending write request for RaftClientRequest:client-87603C0349F3->s3@group-640E6E1041F6, cid=28, seq=2, RW, Message:6d6573736167652035
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.client.impl.OrderedAsync$PendingOrderedRequest.fail(OrderedAsync.java:111)
	at org.apache.ratis.util.SlidingWindow$Client.fail(SlidingWindow.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.failAllAsyncRequests(OrderedAsync.java:155)
	at org.apache.ratis.client.impl.OrderedAsync.handleException(OrderedAsync.java:239)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequestWithRetry$7(OrderedAsync.java:217)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:397)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:303)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:334)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:564)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:565)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$100(ClientCallImpl.java:72)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:733)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:714)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.ratis.protocol.exceptions.ResourceUnavailableException: s3@group-640E6E1041F6: Failed to acquire a pending write request for RaftClientRequest:client-87603C0349F3->s3@group-640E6E1041F6, cid=28, seq=2, RW, Message:6d6573736167652035
	at org.apache.ratis.server.impl.RaftServerImpl.getResourceUnavailableReply(RaftServerImpl.java:813)
	at org.apache.ratis.server.impl.RaftServerImpl.appendTransaction(RaftServerImpl.java:833)
	at org.apache.ratis.server.impl.RaftServerImpl.writeAsyncImpl(RaftServerImpl.java:1008)
	at org.apache.ratis.server.impl.RaftServerImpl.writeAsync(RaftServerImpl.java:972)
	at org.apache.ratis.server.impl.RaftServerImpl.replyFuture(RaftServerImpl.java:965)
	at org.apache.ratis.server.impl.RaftServerImpl.submitClientRequestAsync(RaftServerImpl.java:942)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$null$11(RaftServerImpl.java:931)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:118)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitClientRequestAsync$12(RaftServerImpl.java:931)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	... 3 more
2025-07-09 10:10:14,494 [timer3] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$null$6(215)) -  client-8E952480CD98: Failed* RaftClientRequest:client-8E952480CD98->s3@group-640E6E1041F6, cid=18, seq=2, RW, message 0
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.TimeoutIOException: client-8E952480CD98->s3 request #18 timeout 1s
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniAccept(CompletableFuture.java:661)
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:646)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:376)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:381)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:369)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:78)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: org.apache.ratis.protocol.exceptions.TimeoutIOException: client-8E952480CD98->s3 request #18 timeout 1s
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:377)
	... 10 more
2025-07-09 10:10:14,494 [timer3] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$send$4(181)) - Failed to send request, message=message 0
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.TimeoutIOException: client-8E952480CD98->s3 request #18 timeout 1s
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.client.impl.OrderedAsync$PendingOrderedRequest.fail(OrderedAsync.java:111)
	at org.apache.ratis.util.SlidingWindow$Client.fail(SlidingWindow.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.failAllAsyncRequests(OrderedAsync.java:155)
	at org.apache.ratis.client.impl.OrderedAsync.handleException(OrderedAsync.java:239)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequestWithRetry$7(OrderedAsync.java:217)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:376)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:381)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:369)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:78)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: org.apache.ratis.protocol.exceptions.TimeoutIOException: client-8E952480CD98->s3 request #18 timeout 1s
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:377)
	... 10 more
2025-07-09 10:10:14,494 [timer4] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$null$6(215)) -  client-E3EBBD9E13E7: Failed* RaftClientRequest:client-E3EBBD9E13E7->s3@group-640E6E1041F6, cid=16, seq=2, RW, 2nd Message
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.TimeoutIOException: client-E3EBBD9E13E7->s3 request #16 timeout 1s
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniAccept(CompletableFuture.java:661)
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:646)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:376)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:381)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:369)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:78)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: org.apache.ratis.protocol.exceptions.TimeoutIOException: client-E3EBBD9E13E7->s3 request #16 timeout 1s
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:377)
	... 10 more
2025-07-09 10:10:14,495 [timer4] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$send$4(181)) - Failed to send request, message=2nd Message
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.TimeoutIOException: client-E3EBBD9E13E7->s3 request #16 timeout 1s
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.client.impl.OrderedAsync$PendingOrderedRequest.fail(OrderedAsync.java:111)
	at org.apache.ratis.util.SlidingWindow$Client.fail(SlidingWindow.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.failAllAsyncRequests(OrderedAsync.java:155)
	at org.apache.ratis.client.impl.OrderedAsync.handleException(OrderedAsync.java:239)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequestWithRetry$7(OrderedAsync.java:217)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:376)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:381)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:369)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:78)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: org.apache.ratis.protocol.exceptions.TimeoutIOException: client-E3EBBD9E13E7->s3 request #16 timeout 1s
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:377)
	... 10 more
2025-07-09 10:10:14,496 [timer5] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$null$6(215)) -  client-7781907C6BD6: Failed* RaftClientRequest:client-7781907C6BD6->s3@group-640E6E1041F6, cid=20, seq=2, RW, message 1
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.TimeoutIOException: client-7781907C6BD6->s3 request #20 timeout 1s
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniAccept(CompletableFuture.java:661)
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:646)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:376)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:381)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:369)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:78)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: org.apache.ratis.protocol.exceptions.TimeoutIOException: client-7781907C6BD6->s3 request #20 timeout 1s
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:377)
	... 10 more
2025-07-09 10:10:14,496 [timer5] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$send$4(181)) - Failed to send request, message=message 1
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.TimeoutIOException: client-7781907C6BD6->s3 request #20 timeout 1s
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.client.impl.OrderedAsync$PendingOrderedRequest.fail(OrderedAsync.java:111)
	at org.apache.ratis.util.SlidingWindow$Client.fail(SlidingWindow.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.failAllAsyncRequests(OrderedAsync.java:155)
	at org.apache.ratis.client.impl.OrderedAsync.handleException(OrderedAsync.java:239)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequestWithRetry$7(OrderedAsync.java:217)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:376)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:381)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:369)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:78)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: org.apache.ratis.protocol.exceptions.TimeoutIOException: client-7781907C6BD6->s3 request #20 timeout 1s
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:377)
	... 10 more
2025-07-09 10:10:14,508 [timer2] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$null$6(215)) -  client-61BF0E42C8D2: Failed* RaftClientRequest:client-61BF0E42C8D2->s3@group-640E6E1041F6, cid=22, seq=2, RW, message 2
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.TimeoutIOException: client-61BF0E42C8D2->s3 request #22 timeout 1s
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniAccept(CompletableFuture.java:661)
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:646)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:376)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:381)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:369)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:78)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: org.apache.ratis.protocol.exceptions.TimeoutIOException: client-61BF0E42C8D2->s3 request #22 timeout 1s
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:377)
	... 10 more
2025-07-09 10:10:14,508 [timer2] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$send$4(181)) - Failed to send request, message=message 2
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.TimeoutIOException: client-61BF0E42C8D2->s3 request #22 timeout 1s
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.client.impl.OrderedAsync$PendingOrderedRequest.fail(OrderedAsync.java:111)
	at org.apache.ratis.util.SlidingWindow$Client.fail(SlidingWindow.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.failAllAsyncRequests(OrderedAsync.java:155)
	at org.apache.ratis.client.impl.OrderedAsync.handleException(OrderedAsync.java:239)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequestWithRetry$7(OrderedAsync.java:217)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:376)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:381)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:369)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:78)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: org.apache.ratis.protocol.exceptions.TimeoutIOException: client-61BF0E42C8D2->s3 request #22 timeout 1s
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:377)
	... 10 more
2025-07-09 10:10:14,515 [timer5] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$null$6(215)) -  client-EB1D1B3506EF: Failed* RaftClientRequest:client-EB1D1B3506EF->s3@group-640E6E1041F6, cid=24, seq=2, RW, message 3
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.TimeoutIOException: client-EB1D1B3506EF->s3 request #24 timeout 1s
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniAccept(CompletableFuture.java:661)
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:646)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:376)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:381)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:369)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:78)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: org.apache.ratis.protocol.exceptions.TimeoutIOException: client-EB1D1B3506EF->s3 request #24 timeout 1s
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:377)
	... 10 more
2025-07-09 10:10:14,515 [timer5] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$send$4(181)) - Failed to send request, message=message 3
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.TimeoutIOException: client-EB1D1B3506EF->s3 request #24 timeout 1s
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.client.impl.OrderedAsync$PendingOrderedRequest.fail(OrderedAsync.java:111)
	at org.apache.ratis.util.SlidingWindow$Client.fail(SlidingWindow.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.failAllAsyncRequests(OrderedAsync.java:155)
	at org.apache.ratis.client.impl.OrderedAsync.handleException(OrderedAsync.java:239)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequestWithRetry$7(OrderedAsync.java:217)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:376)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:381)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:369)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:78)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: org.apache.ratis.protocol.exceptions.TimeoutIOException: client-EB1D1B3506EF->s3 request #24 timeout 1s
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:377)
	... 10 more
2025-07-09 10:10:14,516 [timer6] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$null$6(215)) -  client-ED7451308E0D: Failed* RaftClientRequest:client-ED7451308E0D->s3@group-640E6E1041F6, cid=26, seq=2, RW, message 4
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.TimeoutIOException: client-ED7451308E0D->s3 request #26 timeout 1s
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniAccept(CompletableFuture.java:661)
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:646)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:376)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:381)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:369)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:78)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: org.apache.ratis.protocol.exceptions.TimeoutIOException: client-ED7451308E0D->s3 request #26 timeout 1s
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:377)
	... 10 more
2025-07-09 10:10:14,516 [timer6] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$send$4(181)) - Failed to send request, message=message 4
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.TimeoutIOException: client-ED7451308E0D->s3 request #26 timeout 1s
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.client.impl.OrderedAsync$PendingOrderedRequest.fail(OrderedAsync.java:111)
	at org.apache.ratis.util.SlidingWindow$Client.fail(SlidingWindow.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.failAllAsyncRequests(OrderedAsync.java:155)
	at org.apache.ratis.client.impl.OrderedAsync.handleException(OrderedAsync.java:239)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequestWithRetry$7(OrderedAsync.java:217)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:376)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:381)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:369)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:78)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: org.apache.ratis.protocol.exceptions.TimeoutIOException: client-ED7451308E0D->s3 request #26 timeout 1s
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:377)
	... 10 more
2025-07-09 10:10:14,544 [timer2] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$null$6(215)) -  client-29C0198291FB: Failed* RaftClientRequest:client-29C0198291FB->s3@group-640E6E1041F6, cid=30, seq=2, RW, message 6
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.TimeoutIOException: client-29C0198291FB->s3 request #30 timeout 1s
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniAccept(CompletableFuture.java:661)
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:646)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:376)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:381)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:369)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:78)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: org.apache.ratis.protocol.exceptions.TimeoutIOException: client-29C0198291FB->s3 request #30 timeout 1s
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:377)
	... 10 more
2025-07-09 10:10:14,544 [timer2] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$send$4(181)) - Failed to send request, message=message 6
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.TimeoutIOException: client-29C0198291FB->s3 request #30 timeout 1s
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.client.impl.OrderedAsync$PendingOrderedRequest.fail(OrderedAsync.java:111)
	at org.apache.ratis.util.SlidingWindow$Client.fail(SlidingWindow.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.failAllAsyncRequests(OrderedAsync.java:155)
	at org.apache.ratis.client.impl.OrderedAsync.handleException(OrderedAsync.java:239)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequestWithRetry$7(OrderedAsync.java:217)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:376)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:381)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:369)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:78)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: org.apache.ratis.protocol.exceptions.TimeoutIOException: client-29C0198291FB->s3 request #30 timeout 1s
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:377)
	... 10 more
2025-07-09 10:10:14,557 [timer2] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$null$6(215)) -  client-682CF908C59B: Failed* RaftClientRequest:client-682CF908C59B->s3@group-640E6E1041F6, cid=34, seq=2, RW, message 8
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.TimeoutIOException: client-682CF908C59B->s3 request #34 timeout 1s
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniAccept(CompletableFuture.java:661)
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:646)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:376)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:381)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:369)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:78)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: org.apache.ratis.protocol.exceptions.TimeoutIOException: client-682CF908C59B->s3 request #34 timeout 1s
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:377)
	... 10 more
2025-07-09 10:10:14,557 [timer2] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$send$4(181)) - Failed to send request, message=message 8
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.TimeoutIOException: client-682CF908C59B->s3 request #34 timeout 1s
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.client.impl.OrderedAsync$PendingOrderedRequest.fail(OrderedAsync.java:111)
	at org.apache.ratis.util.SlidingWindow$Client.fail(SlidingWindow.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.failAllAsyncRequests(OrderedAsync.java:155)
	at org.apache.ratis.client.impl.OrderedAsync.handleException(OrderedAsync.java:239)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequestWithRetry$7(OrderedAsync.java:217)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:376)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:381)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:369)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:78)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: org.apache.ratis.protocol.exceptions.TimeoutIOException: client-682CF908C59B->s3 request #34 timeout 1s
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:377)
	... 10 more
2025-07-09 10:10:14,569 [timer5] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$null$6(215)) -  client-F992FB088A8B: Failed* RaftClientRequest:client-F992FB088A8B->s3@group-640E6E1041F6, cid=32, seq=2, RW, message 7
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.TimeoutIOException: client-F992FB088A8B->s3 request #32 timeout 1s
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniAccept(CompletableFuture.java:661)
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:646)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:376)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:381)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:369)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:78)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: org.apache.ratis.protocol.exceptions.TimeoutIOException: client-F992FB088A8B->s3 request #32 timeout 1s
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:377)
	... 10 more
2025-07-09 10:10:14,570 [timer5] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$send$4(181)) - Failed to send request, message=message 7
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.TimeoutIOException: client-F992FB088A8B->s3 request #32 timeout 1s
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.client.impl.OrderedAsync$PendingOrderedRequest.fail(OrderedAsync.java:111)
	at org.apache.ratis.util.SlidingWindow$Client.fail(SlidingWindow.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.failAllAsyncRequests(OrderedAsync.java:155)
	at org.apache.ratis.client.impl.OrderedAsync.handleException(OrderedAsync.java:239)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequestWithRetry$7(OrderedAsync.java:217)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:376)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:381)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:369)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:78)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: org.apache.ratis.protocol.exceptions.TimeoutIOException: client-F992FB088A8B->s3 request #32 timeout 1s
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:377)
	... 10 more
2025-07-09 10:10:14,584 [timer2] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$null$6(215)) -  client-CB572A742639: Failed* RaftClientRequest:client-CB572A742639->s3@group-640E6E1041F6, cid=36, seq=2, RW, message 9
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.TimeoutIOException: client-CB572A742639->s3 request #36 timeout 1s
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniAccept(CompletableFuture.java:661)
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:646)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:376)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:381)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:369)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:78)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: org.apache.ratis.protocol.exceptions.TimeoutIOException: client-CB572A742639->s3 request #36 timeout 1s
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:377)
	... 10 more
2025-07-09 10:10:14,584 [timer2] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$send$4(181)) - Failed to send request, message=message 9
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.TimeoutIOException: client-CB572A742639->s3 request #36 timeout 1s
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniApply(CompletableFuture.java:607)
	at java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:591)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.client.impl.OrderedAsync$PendingOrderedRequest.fail(OrderedAsync.java:111)
	at org.apache.ratis.util.SlidingWindow$Client.fail(SlidingWindow.java:395)
	at org.apache.ratis.client.impl.OrderedAsync.failAllAsyncRequests(OrderedAsync.java:155)
	at org.apache.ratis.client.impl.OrderedAsync.handleException(OrderedAsync.java:239)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequestWithRetry$7(OrderedAsync.java:217)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture$UniExceptionally.tryFire(CompletableFuture.java:866)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:376)
	at java.util.Optional.ifPresent(Optional.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:381)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.timeoutCheck(GrpcClientProtocolClient.java:376)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$onNext$3(GrpcClientProtocolClient.java:369)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:78)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: org.apache.ratis.protocol.exceptions.TimeoutIOException: client-CB572A742639->s3 request #36 timeout 1s
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.lambda$timeoutCheck$5(GrpcClientProtocolClient.java:377)
	... 10 more
2025-07-09 10:10:21,595 [Thread-206] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(226)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=222, target=localhost:15026}}. 
2025-07-09 10:10:22,968 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$null$7(351)) - TIMED-PRINT: printing ALL groups
  s3:  RUNNING    LEADER (RUNNING): s3@group-640E6E1041F6:t1, leader=s3, voted=s3, raftlog=Memoized:s3@group-640E6E1041F6-SegmentedRaftLog:OPENED:c2:last(t:1, i:12), conf=conf: {index: 0, cur=peers:[s3|localhost:15024, s4|localhost:15028, s5|localhost:15032]|listeners:[], old=null}
  s4:  RUNNING  FOLLOWER (RUNNING): s4@group-640E6E1041F6:t1, leader=s3, voted=s3, raftlog=Memoized:s4@group-640E6E1041F6-SegmentedRaftLog:OPENED:c2:last(t:1, i:12), conf=conf: {index: 0, cur=peers:[s3|localhost:15024, s4|localhost:15028, s5|localhost:15032]|listeners:[], old=null}
  s5:  RUNNING  FOLLOWER (RUNNING): s5@group-640E6E1041F6:t1, leader=s3, voted=s3, raftlog=Memoized:s5@group-640E6E1041F6-SegmentedRaftLog:OPENED:c2:last(t:1, i:12), conf=conf: {index: 0, cur=peers:[s3|localhost:15024, s4|localhost:15028, s5|localhost:15032]|listeners:[], old=null}.
2025-07-09 10:10:23,502 [s3@group-640E6E1041F6-SegmentedRaftLogWorker] WARN  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:getFromFuture(98)) - Timeout 0/~
org.apache.ratis.protocol.exceptions.TimeoutIOException: Timeout 10s: s3@group-640E6E1041F6-SegmentedRaftLogWorker-flushStateMachineData
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:89)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:95)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.flushIfNecessary(SegmentedRaftLogWorker.java:377)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.access$1200(SegmentedRaftLogWorker.java:64)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:561)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:317)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.CompletableFuture.timedGet(CompletableFuture.java:1784)
	at java.util.concurrent.CompletableFuture.get(CompletableFuture.java:1928)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:80)
	... 10 more
2025-07-09 10:10:24,600 [Thread-209] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(226)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=229, target=localhost:15026}}. 
2025-07-09 10:10:27,603 [Thread-212] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(226)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=235, target=localhost:15026}}. 
2025-07-09 10:10:30,607 [Thread-215] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(226)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=242, target=localhost:15026}}. 
2025-07-09 10:10:32,968 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$null$7(351)) - TIMED-PRINT: printing ALL groups
  s3:  RUNNING    LEADER (RUNNING): s3@group-640E6E1041F6:t1, leader=s3, voted=s3, raftlog=Memoized:s3@group-640E6E1041F6-SegmentedRaftLog:OPENED:c2:last(t:1, i:12), conf=conf: {index: 0, cur=peers:[s3|localhost:15024, s4|localhost:15028, s5|localhost:15032]|listeners:[], old=null}
  s4:  RUNNING  FOLLOWER (RUNNING): s4@group-640E6E1041F6:t1, leader=s3, voted=s3, raftlog=Memoized:s4@group-640E6E1041F6-SegmentedRaftLog:OPENED:c2:last(t:1, i:12), conf=conf: {index: 0, cur=peers:[s3|localhost:15024, s4|localhost:15028, s5|localhost:15032]|listeners:[], old=null}
  s5:  RUNNING  FOLLOWER (RUNNING): s5@group-640E6E1041F6:t1, leader=s3, voted=s3, raftlog=Memoized:s5@group-640E6E1041F6-SegmentedRaftLog:OPENED:c2:last(t:1, i:12), conf=conf: {index: 0, cur=peers:[s3|localhost:15024, s4|localhost:15028, s5|localhost:15032]|listeners:[], old=null}.
2025-07-09 10:10:33,503 [s3@group-640E6E1041F6-SegmentedRaftLogWorker] WARN  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:getFromFuture(98)) - Timeout 1/~
org.apache.ratis.protocol.exceptions.TimeoutIOException: Timeout 10s: s3@group-640E6E1041F6-SegmentedRaftLogWorker-flushStateMachineData
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:89)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:95)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.flushIfNecessary(SegmentedRaftLogWorker.java:377)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.access$1200(SegmentedRaftLogWorker.java:64)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:561)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:317)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.CompletableFuture.timedGet(CompletableFuture.java:1784)
	at java.util.concurrent.CompletableFuture.get(CompletableFuture.java:1928)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:80)
	... 10 more
2025-07-09 10:10:33,611 [Thread-218] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(226)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=250, target=localhost:15026}}. 
2025-07-09 10:10:36,614 [Thread-221] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(226)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=256, target=localhost:15026}}. 
2025-07-09 10:10:39,619 [Thread-227] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(226)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=271, target=localhost:15026}}. 
2025-07-09 10:10:42,622 [Thread-230] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(226)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=278, target=localhost:15026}}. 
2025-07-09 10:10:42,968 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$null$7(351)) - TIMED-PRINT: printing ALL groups
  s3:  RUNNING    LEADER (RUNNING): s3@group-640E6E1041F6:t1, leader=s3, voted=s3, raftlog=Memoized:s3@group-640E6E1041F6-SegmentedRaftLog:OPENED:c2:last(t:1, i:12), conf=conf: {index: 0, cur=peers:[s3|localhost:15024, s4|localhost:15028, s5|localhost:15032]|listeners:[], old=null}
  s4:  RUNNING  FOLLOWER (RUNNING): s4@group-640E6E1041F6:t1, leader=s3, voted=s3, raftlog=Memoized:s4@group-640E6E1041F6-SegmentedRaftLog:OPENED:c2:last(t:1, i:12), conf=conf: {index: 0, cur=peers:[s3|localhost:15024, s4|localhost:15028, s5|localhost:15032]|listeners:[], old=null}
  s5:  RUNNING  FOLLOWER (RUNNING): s5@group-640E6E1041F6:t1, leader=s3, voted=s3, raftlog=Memoized:s5@group-640E6E1041F6-SegmentedRaftLog:OPENED:c2:last(t:1, i:12), conf=conf: {index: 0, cur=peers:[s3|localhost:15024, s4|localhost:15028, s5|localhost:15032]|listeners:[], old=null}.
2025-07-09 10:10:43,503 [s3@group-640E6E1041F6-SegmentedRaftLogWorker] WARN  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:getFromFuture(98)) - Timeout 2/~
org.apache.ratis.protocol.exceptions.TimeoutIOException: Timeout 10s: s3@group-640E6E1041F6-SegmentedRaftLogWorker-flushStateMachineData
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:89)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:95)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.flushIfNecessary(SegmentedRaftLogWorker.java:377)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.access$1200(SegmentedRaftLogWorker.java:64)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:561)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:317)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.CompletableFuture.timedGet(CompletableFuture.java:1784)
	at java.util.concurrent.CompletableFuture.get(CompletableFuture.java:1928)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:80)
	... 10 more
2025-07-09 10:10:45,626 [Thread-233] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(226)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=284, target=localhost:15026}}. 
2025-07-09 10:10:48,631 [Thread-236] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(226)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=292, target=localhost:15026}}. 
2025-07-09 10:10:48,633 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(836)) - ************************************************************** 
2025-07-09 10:10:48,633 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(837)) - *** 
2025-07-09 10:10:48,633 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(838)) - ***     Stopping MiniRaftClusterWithGrpc
2025-07-09 10:10:48,633 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(839)) - *** 
2025-07-09 10:10:48,633 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(840)) - ************************************************************** 
2025-07-09 10:10:48,634 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(841)) - printing ALL groups
  s3:  RUNNING    LEADER (RUNNING): s3@group-640E6E1041F6:t1, leader=s3, voted=s3, raftlog=Memoized:s3@group-640E6E1041F6-SegmentedRaftLog:OPENED:c2:last(t:1, i:12), conf=conf: {index: 0, cur=peers:[s3|localhost:15024, s4|localhost:15028, s5|localhost:15032]|listeners:[], old=null}
  s4:  RUNNING  FOLLOWER (RUNNING): s4@group-640E6E1041F6:t1, leader=s3, voted=s3, raftlog=Memoized:s4@group-640E6E1041F6-SegmentedRaftLog:OPENED:c2:last(t:1, i:12), conf=conf: {index: 0, cur=peers:[s3|localhost:15024, s4|localhost:15028, s5|localhost:15032]|listeners:[], old=null}
  s5:  RUNNING  FOLLOWER (RUNNING): s5@group-640E6E1041F6:t1, leader=s3, voted=s3, raftlog=Memoized:s5@group-640E6E1041F6-SegmentedRaftLog:OPENED:c2:last(t:1, i:12), conf=conf: {index: 0, cur=peers:[s3|localhost:15024, s4|localhost:15028, s5|localhost:15032]|listeners:[], old=null}
2025-07-09 10:10:48,634 [MiniRaftCluster-7] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$9(422)) - s3: close
2025-07-09 10:10:48,634 [MiniRaftCluster-8] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$9(422)) - s4: close
2025-07-09 10:10:48,635 [MiniRaftCluster-9] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$9(422)) - s5: close
2025-07-09 10:10:48,635 [s3-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$1(527)) - s3@group-640E6E1041F6: shutdown
2025-07-09 10:10:48,635 [s3-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:unregister(74)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-640E6E1041F6,id=s3
2025-07-09 10:10:48,635 [s3-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(103)) - s3: shutdown s3@group-640E6E1041F6-LeaderStateImpl
2025-07-09 10:10:48,635 [MiniRaftCluster-7] INFO  server.GrpcServicesImpl (GrpcServicesImpl.java:closeImpl(355)) - s3: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService now
2025-07-09 10:10:48,635 [s4-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$1(527)) - s4@group-640E6E1041F6: shutdown
2025-07-09 10:10:48,636 [s4-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:unregister(74)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-640E6E1041F6,id=s4
2025-07-09 10:10:48,636 [s4-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - s4: shutdown s4@group-640E6E1041F6-FollowerState
2025-07-09 10:10:48,636 [Thread-243] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:close(105)) - s4 Close channels
2025-07-09 10:10:48,635 [s5-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$1(527)) - s5@group-640E6E1041F6: shutdown
2025-07-09 10:10:48,636 [s5-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:unregister(74)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-640E6E1041F6,id=s5
2025-07-09 10:10:48,636 [s5-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - s5: shutdown s5@group-640E6E1041F6-FollowerState
2025-07-09 10:10:48,635 [MiniRaftCluster-9] INFO  server.GrpcServicesImpl (GrpcServicesImpl.java:closeImpl(355)) - s5: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService now
2025-07-09 10:10:48,635 [MiniRaftCluster-8] INFO  server.GrpcServicesImpl (GrpcServicesImpl.java:closeImpl(355)) - s4: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService now
2025-07-09 10:10:48,636 [s3@group-640E6E1041F6->s5-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(300)) - s3@group-640E6E1041F6->s5-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2025-07-09 10:10:48,635 [s3@group-640E6E1041F6->s4-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(300)) - s3@group-640E6E1041F6->s4-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2025-07-09 10:10:48,635 [s3-impl-thread1] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(287)) - s3@group-640E6E1041F6-PendingRequests: sendNotLeaderResponses
2025-07-09 10:10:48,638 [s5-impl-thread1] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(163)) - s5@group-640E6E1041F6-StateMachineUpdater: set stopIndex = 2
2025-07-09 10:10:48,638 [s4@group-640E6E1041F6-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stop(140)) - s4@group-640E6E1041F6-StateMachineUpdater: closing SimpleStateMachine4Testing, lastApplied=(t:1, i:2)
2025-07-09 10:10:48,638 [s5@group-640E6E1041F6-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stop(140)) - s5@group-640E6E1041F6-StateMachineUpdater: closing SimpleStateMachine4Testing, lastApplied=(t:1, i:2)
2025-07-09 10:10:48,638 [s4@group-640E6E1041F6-FollowerState] INFO  impl.FollowerState (FollowerState.java:runImpl(170)) - s4@group-640E6E1041F6-FollowerState was interrupted
2025-07-09 10:10:48,639 [Thread-244] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:close(105)) - s5 Close channels
2025-07-09 10:10:48,638 [s5@group-640E6E1041F6-FollowerState] INFO  impl.FollowerState (FollowerState.java:runImpl(170)) - s5@group-640E6E1041F6-FollowerState was interrupted
2025-07-09 10:10:48,638 [s4-impl-thread1] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(163)) - s4@group-640E6E1041F6-StateMachineUpdater: set stopIndex = 2
2025-07-09 10:10:48,639 [grpc-default-executor-1] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:lambda$onCompleted$6(171)) - s4: Completed APPEND_ENTRIES, lastRequest: s3->s4#18-t1,previous=(t:1, i:11),leaderCommit=2,initializing? false,entries: size=1, first=(t:1, i:12), STATEMACHINELOGENTRY, WRITE: logData.size=9, stateMachineData.size=17, logEntryProtoSerializedSize=0 
2025-07-09 10:10:48,640 [Thread-246] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:close(105)) - s3 Close channels
2025-07-09 10:10:48,640 [Thread-249] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:close(105)) - s5 Close channels
2025-07-09 10:10:48,640 [grpc-default-executor-8] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:lambda$onCompleted$6(171)) - s5: Completed APPEND_ENTRIES, lastRequest: s3->s5#16-t1,previous=(t:1, i:11),leaderCommit=2,initializing? false,entries: size=1, first=(t:1, i:12), STATEMACHINELOGENTRY, WRITE: logData.size=9, stateMachineData.size=17, logEntryProtoSerializedSize=0 
2025-07-09 10:10:48,643 [MiniRaftCluster-8] INFO  server.GrpcServicesImpl (GrpcServicesImpl.java:closeImpl(364)) - s4: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService successfully
2025-07-09 10:10:48,643 [MiniRaftCluster-8] INFO  server.GrpcServicesImpl (GrpcServicesImpl.java:closeImpl(355)) - s4: shutdown server GrpcServerProtocolService now
2025-07-09 10:10:48,643 [MiniRaftCluster-9] INFO  server.GrpcServicesImpl (GrpcServicesImpl.java:closeImpl(364)) - s5: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService successfully
2025-07-09 10:10:48,643 [MiniRaftCluster-9] INFO  server.GrpcServicesImpl (GrpcServicesImpl.java:closeImpl(355)) - s5: shutdown server GrpcServerProtocolService now
2025-07-09 10:10:48,644 [s5@group-640E6E1041F6-cacheEviction-AwaitToRun] INFO  util.AwaitToRun (AwaitToRun.java:run(49)) - s5@group-640E6E1041F6-cacheEviction-AwaitToRun-AwaitForSignal is interrupted
2025-07-09 10:10:48,644 [s4@group-640E6E1041F6-cacheEviction-AwaitToRun] INFO  util.AwaitToRun (AwaitToRun.java:run(49)) - s4@group-640E6E1041F6-cacheEviction-AwaitToRun-AwaitForSignal is interrupted
2025-07-09 10:10:48,648 [MiniRaftCluster-9] INFO  server.GrpcServicesImpl (GrpcServicesImpl.java:closeImpl(364)) - s5: shutdown server GrpcServerProtocolService successfully
2025-07-09 10:10:48,649 [MiniRaftCluster-9] INFO  server.GrpcServicesImpl (GrpcServicesImpl.java:closeImpl(355)) - s5: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService now
2025-07-09 10:10:48,650 [MiniRaftCluster-9] INFO  server.GrpcServicesImpl (GrpcServicesImpl.java:closeImpl(364)) - s5: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService successfully
2025-07-09 10:10:48,651 [grpc-default-executor-0] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(545)) - s3@group-640E6E1041F6->s5-GrpcLogAppender is already stopped
2025-07-09 10:10:48,652 [s3-impl-thread1] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(163)) - s3@group-640E6E1041F6-StateMachineUpdater: set stopIndex = 2
2025-07-09 10:10:48,652 [s3@group-640E6E1041F6-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stop(140)) - s3@group-640E6E1041F6-StateMachineUpdater: closing SimpleStateMachine4Testing, lastApplied=(t:1, i:2)
2025-07-09 10:10:48,653 [s3@group-640E6E1041F6-cacheEviction-AwaitToRun] INFO  util.AwaitToRun (AwaitToRun.java:run(49)) - s3@group-640E6E1041F6-cacheEviction-AwaitToRun-AwaitForSignal is interrupted
2025-07-09 10:10:48,654 [MiniRaftCluster-8] INFO  server.GrpcServicesImpl (GrpcServicesImpl.java:closeImpl(364)) - s4: shutdown server GrpcServerProtocolService successfully
2025-07-09 10:10:48,654 [MiniRaftCluster-8] INFO  server.GrpcServicesImpl (GrpcServicesImpl.java:closeImpl(355)) - s4: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService now
2025-07-09 10:10:48,656 [grpc-default-executor-0] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(545)) - s3@group-640E6E1041F6->s4-GrpcLogAppender is already stopped
2025-07-09 10:10:48,658 [MiniRaftCluster-8] INFO  server.GrpcServicesImpl (GrpcServicesImpl.java:closeImpl(364)) - s4: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService successfully
2025-07-09 10:10:48,658 [MiniRaftCluster-7] INFO  server.GrpcServicesImpl (GrpcServicesImpl.java:closeImpl(364)) - s3: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService successfully
2025-07-09 10:10:48,658 [MiniRaftCluster-7] INFO  server.GrpcServicesImpl (GrpcServicesImpl.java:closeImpl(355)) - s3: shutdown server GrpcServerProtocolService now
2025-07-09 10:10:48,658 [MiniRaftCluster-7] INFO  server.GrpcServicesImpl (GrpcServicesImpl.java:closeImpl(364)) - s3: shutdown server GrpcServerProtocolService successfully
2025-07-09 10:10:48,658 [MiniRaftCluster-7] INFO  server.GrpcServicesImpl (GrpcServicesImpl.java:closeImpl(355)) - s3: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService now
2025-07-09 10:10:48,660 [MiniRaftCluster-7] INFO  server.GrpcServicesImpl (GrpcServicesImpl.java:closeImpl(364)) - s3: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService successfully
2025-07-09 10:10:48,769 [grpc-default-executor-8] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:lambda$null$7(175)) - s5: Completed APPEND_ENTRIES, lastReply: serverReply {
  requestorId: "s3"
  replyId: "s5"
  raftGroupId {
    id: "\305r~\276\274\371K\364\275\203d\016n\020A\366"
  }
  callId: 471
  success: true
}
term: 1
nextIndex: 13
followerCommit: 2
matchIndex: 18446744073709551615
isHearbeat: true
 
2025-07-09 10:10:48,769 [grpc-default-executor-1] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:lambda$null$7(175)) - s4: Completed APPEND_ENTRIES, lastReply: serverReply {
  requestorId: "s3"
  replyId: "s4"
  raftGroupId {
    id: "\305r~\276\274\371K\364\275\203d\016n\020A\366"
  }
  callId: 473
  success: true
}
term: 1
nextIndex: 13
followerCommit: 2
matchIndex: 18446744073709551615
isHearbeat: true
 
2025-07-09 10:10:49,597 [s5-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(254)) - s5@group-640E6E1041F6-SegmentedRaftLogWorker close()
2025-07-09 10:10:49,597 [s4-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(254)) - s4@group-640E6E1041F6-SegmentedRaftLogWorker close()
2025-07-09 10:10:49,598 [JvmPauseMonitor7] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(152)) - JvmPauseMonitor-s4: Stopped
2025-07-09 10:10:49,599 [JvmPauseMonitor8] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(152)) - JvmPauseMonitor-s5: Stopped
2025-07-09 10:10:51,653 [s3-impl-thread1] WARN  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$close$3(251)) - s3@group-640E6E1041F6-SegmentedRaftLogWorker: shutdown timeout in 3s
2025-07-09 10:10:51,655 [s3-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(254)) - s3@group-640E6E1041F6-SegmentedRaftLogWorker close()
2025-07-09 10:10:51,656 [JvmPauseMonitor6] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(152)) - JvmPauseMonitor-s3: Stopped
2025-07-09 10:10:51,656 [main] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(860)) - MiniRaftClusterWithGrpc shutdown completed
]]></system-out>
  </testcase>
  <testcase name="testTlsWithKeyAndTrustManager(Boolean)[2]" classname="org.apache.ratis.grpc.TestRaftServerWithGrpc" time="1.817"/>
  <testcase name="testRaftServerMetrics(Boolean)[1]" classname="org.apache.ratis.grpc.TestRaftServerWithGrpc" time="1.782"/>
  <testcase name="testRaftServerMetrics(Boolean)[2]" classname="org.apache.ratis.grpc.TestRaftServerWithGrpc" time="1.654"/>
  <testcase name="testUnsupportedMethods(Boolean)[1]" classname="org.apache.ratis.grpc.TestRaftServerWithGrpc" time="1.311"/>
  <testcase name="testUnsupportedMethods(Boolean)[2]" classname="org.apache.ratis.grpc.TestRaftServerWithGrpc" time="1.207"/>
  <testcase name="testServerRestartOnException(Boolean)[1]" classname="org.apache.ratis.grpc.TestRaftServerWithGrpc" time="5.3"/>
  <testcase name="testServerRestartOnException(Boolean)[2]" classname="org.apache.ratis.grpc.TestRaftServerWithGrpc" time="5.224"/>
  <testcase name="testLeaderRestart(Boolean)[1]" classname="org.apache.ratis.grpc.TestRaftServerWithGrpc" time="5.94"/>
  <testcase name="testLeaderRestart(Boolean)[2]" classname="org.apache.ratis.grpc.TestRaftServerWithGrpc" time="5.881"/>
</testsuite>