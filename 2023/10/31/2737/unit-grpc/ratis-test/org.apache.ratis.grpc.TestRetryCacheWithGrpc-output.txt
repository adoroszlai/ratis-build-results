2023-10-31 16:08:59,669 [main] INFO  util.LogUtils (Slf4jUtils.java:setLogLevel(38)) - Successfully set org.apache.ratis.server.RaftServer$Division log level to DEBUG
2023-10-31 16:08:59,672 [main] INFO  util.LogUtils (Slf4jUtils.java:setLogLevel(38)) - Successfully set org.apache.ratis.conf.ConfUtils log level to WARN
2023-10-31 16:08:59,674 [main] INFO  util.LogUtils (Slf4jUtils.java:setLogLevel(38)) - Successfully set org.apache.ratis.util.FileUtils log level to TRACE
2023-10-31 16:08:59,676 [main] INFO  util.LogUtils (Slf4jUtils.java:setLogLevel(38)) - Successfully set org.apache.ratis.server.RetryCache log level to TRACE
2023-10-31 16:08:59,816 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:<init>(306)) - new MiniRaftClusterWithGrpc with group-E610FDAD83BB:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]
2023-10-31 16:08:59,816 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(339)) - .............................................................. 
2023-10-31 16:08:59,817 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(340)) - ... 
2023-10-31 16:08:59,818 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(341)) - ...     Starting MiniRaftClusterWithGrpc
2023-10-31 16:08:59,818 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(342)) - ... 
2023-10-31 16:08:59,818 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(343)) - .............................................................. 
2023-10-31 16:08:59,819 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:initServers(318)) - servers = {}
2023-10-31 16:08:59,825 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(382)) - newRaftServer: s0, group-E610FDAD83BB:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705], format? true
2023-10-31 16:08:59,827 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(305)) - deleteFully target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s0
2023-10-31 16:08:59,828 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(318)) - deleteFully: target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s0 does not exist.
2023-10-31 16:08:59,828 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(387)) - Formatted directory target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s0
2023-10-31 16:08:59,857 [Time-limited test] INFO  server.RaftServer (ConfUtils.java:logGet(46)) - raft.rpc.type = GRPC (default)
2023-10-31 16:08:59,907 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.admin.host = null (fallback to raft.grpc.server.host)
2023-10-31 16:08:59,908 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.admin.port = 45897 (custom)
2023-10-31 16:08:59,909 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.client.host = null (fallback to raft.grpc.server.host)
2023-10-31 16:08:59,909 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.client.port = 38937 (custom)
2023-10-31 16:08:59,910 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.host = null (default)
2023-10-31 16:08:59,910 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.port = 33069 (custom)
2023-10-31 16:08:59,911 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.message.size.max = 64MB (=67108864) (default)
2023-10-31 16:08:59,912 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:08:59,913 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2023-10-31 16:08:59,917 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:08:59,928 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:08:59,932 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.cached = true (default)
2023-10-31 16:08:59,932 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.size = 32 (default)
2023-10-31 16:09:00,083 [Time-limited test] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(46)) - raft.datastream.type = DISABLED (default)
2023-10-31 16:09:00,085 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.sleep.deviation.threshold = 300ms (default)
2023-10-31 16:09:00,085 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.close.threshold = 60s (default)
2023-10-31 16:09:00,086 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2023-10-31 16:09:00,090 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s0] (custom)
2023-10-31 16:09:00,091 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.cached = true (default)
2023-10-31 16:09:00,091 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.size = 0 (default)
2023-10-31 16:09:00,106 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:addNew(100)) - s0: addNew group-E610FDAD83BB:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705] returns group-E610FDAD83BB:java.util.concurrent.CompletableFuture@289bdd31[Not completed]
2023-10-31 16:09:00,106 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(382)) - newRaftServer: s1, group-E610FDAD83BB:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705], format? true
2023-10-31 16:09:00,106 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(305)) - deleteFully target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s1
2023-10-31 16:09:00,106 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(318)) - deleteFully: target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s1 does not exist.
2023-10-31 16:09:00,106 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(387)) - Formatted directory target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s1
2023-10-31 16:09:00,107 [Time-limited test] INFO  server.RaftServer (ConfUtils.java:logGet(46)) - raft.rpc.type = GRPC (default)
2023-10-31 16:09:00,107 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.admin.host = null (fallback to raft.grpc.server.host)
2023-10-31 16:09:00,107 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.admin.port = 40839 (custom)
2023-10-31 16:09:00,108 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.client.host = null (fallback to raft.grpc.server.host)
2023-10-31 16:09:00,108 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.client.port = 35351 (custom)
2023-10-31 16:09:00,108 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.host = null (default)
2023-10-31 16:09:00,108 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.port = 43557 (custom)
2023-10-31 16:09:00,108 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.message.size.max = 64MB (=67108864) (default)
2023-10-31 16:09:00,108 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:00,109 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2023-10-31 16:09:00,109 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:00,109 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:00,109 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.cached = true (default)
2023-10-31 16:09:00,109 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.size = 32 (default)
2023-10-31 16:09:00,111 [Time-limited test] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(46)) - raft.datastream.type = DISABLED (default)
2023-10-31 16:09:00,111 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.sleep.deviation.threshold = 300ms (default)
2023-10-31 16:09:00,112 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.close.threshold = 60s (default)
2023-10-31 16:09:00,112 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2023-10-31 16:09:00,112 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s1] (custom)
2023-10-31 16:09:00,112 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.cached = true (default)
2023-10-31 16:09:00,112 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.size = 0 (default)
2023-10-31 16:09:00,142 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:addNew(100)) - s1: addNew group-E610FDAD83BB:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705] returns group-E610FDAD83BB:java.util.concurrent.CompletableFuture@2d7c578e[Not completed]
2023-10-31 16:09:00,142 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(382)) - newRaftServer: s2, group-E610FDAD83BB:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705], format? true
2023-10-31 16:09:00,142 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(305)) - deleteFully target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s2
2023-10-31 16:09:00,143 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(318)) - deleteFully: target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s2 does not exist.
2023-10-31 16:09:00,143 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(387)) - Formatted directory target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s2
2023-10-31 16:09:00,143 [Time-limited test] INFO  server.RaftServer (ConfUtils.java:logGet(46)) - raft.rpc.type = GRPC (default)
2023-10-31 16:09:00,143 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.admin.host = null (fallback to raft.grpc.server.host)
2023-10-31 16:09:00,144 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.admin.port = 37569 (custom)
2023-10-31 16:09:00,144 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.client.host = null (fallback to raft.grpc.server.host)
2023-10-31 16:09:00,144 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.client.port = 43097 (custom)
2023-10-31 16:09:00,144 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.host = null (default)
2023-10-31 16:09:00,144 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.port = 44705 (custom)
2023-10-31 16:09:00,144 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.message.size.max = 64MB (=67108864) (default)
2023-10-31 16:09:00,144 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:00,145 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2023-10-31 16:09:00,145 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:00,145 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:00,145 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.cached = true (default)
2023-10-31 16:09:00,145 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.size = 32 (default)
2023-10-31 16:09:00,147 [Time-limited test] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(46)) - raft.datastream.type = DISABLED (default)
2023-10-31 16:09:00,147 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.sleep.deviation.threshold = 300ms (default)
2023-10-31 16:09:00,147 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.close.threshold = 60s (default)
2023-10-31 16:09:00,147 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2023-10-31 16:09:00,148 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s2] (custom)
2023-10-31 16:09:00,148 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.cached = true (default)
2023-10-31 16:09:00,148 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.size = 0 (default)
2023-10-31 16:09:00,139 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 32MB (=33554432) (default)
2023-10-31 16:09:00,153 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2023-10-31 16:09:00,154 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2023-10-31 16:09:00,148 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 32MB (=33554432) (default)
2023-10-31 16:09:00,155 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2023-10-31 16:09:00,155 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2023-10-31 16:09:00,160 [s0-groupManagement] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(255)) - s0: new RaftServerImpl for group-E610FDAD83BB:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705] with SimpleStateMachine4Testing:uninitialized
2023-10-31 16:09:00,161 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.min = 150ms (default)
2023-10-31 16:09:00,161 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2023-10-31 16:09:00,161 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.sleep.time = 25ms (default)
2023-10-31 16:09:00,161 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2023-10-31 16:09:00,162 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2023-10-31 16:09:00,162 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.sleep.deviation.threshold = 300ms (default)
2023-10-31 16:09:00,166 [s0-groupManagement] INFO  server.RaftServer$Division (ServerState.java:<init>(113)) - s0@group-E610FDAD83BB: ConfigurationManager, init=-1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null, confs=<EMPTY_MAP>
2023-10-31 16:09:00,166 [s1-groupManagement] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(255)) - s1: new RaftServerImpl for group-E610FDAD83BB:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705] with SimpleStateMachine4Testing:uninitialized
2023-10-31 16:09:00,169 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.min = 150ms (default)
2023-10-31 16:09:00,169 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2023-10-31 16:09:00,169 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.sleep.time = 25ms (default)
2023-10-31 16:09:00,169 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2023-10-31 16:09:00,169 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2023-10-31 16:09:00,170 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.sleep.deviation.threshold = 300ms (default)
2023-10-31 16:09:00,170 [s1-groupManagement] INFO  server.RaftServer$Division (ServerState.java:<init>(113)) - s1@group-E610FDAD83BB: ConfigurationManager, init=-1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null, confs=<EMPTY_MAP>
2023-10-31 16:09:00,169 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:addNew(100)) - s2: addNew group-E610FDAD83BB:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705] returns group-E610FDAD83BB:java.util.concurrent.CompletableFuture@17234dbd[Not completed]
2023-10-31 16:09:00,174 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 32MB (=33554432) (default)
2023-10-31 16:09:00,174 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2023-10-31 16:09:00,175 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2023-10-31 16:09:00,175 [s2-groupManagement] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(255)) - s2: new RaftServerImpl for group-E610FDAD83BB:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705] with SimpleStateMachine4Testing:uninitialized
2023-10-31 16:09:00,175 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.min = 150ms (default)
2023-10-31 16:09:00,175 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2023-10-31 16:09:00,175 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.sleep.time = 25ms (default)
2023-10-31 16:09:00,175 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.notification.no-leader.timeout = 60s (default)
2023-10-31 16:09:00,175 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.notification.no-leader.timeout = 60s (default)
2023-10-31 16:09:00,179 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.timeout = 10s (default)
2023-10-31 16:09:00,181 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2023-10-31 16:09:00,181 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2023-10-31 16:09:00,181 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.sleep.deviation.threshold = 300ms (default)
2023-10-31 16:09:00,181 [s2-groupManagement] INFO  server.RaftServer$Division (ServerState.java:<init>(113)) - s2@group-E610FDAD83BB: ConfigurationManager, init=-1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null, confs=<EMPTY_MAP>
2023-10-31 16:09:00,181 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.notification.no-leader.timeout = 60s (default)
2023-10-31 16:09:00,181 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.timeout = 10s (default)
2023-10-31 16:09:00,184 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.timeout = 10s (default)
2023-10-31 16:09:00,185 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.expirytime = 60s (default)
2023-10-31 16:09:00,185 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2023-10-31 16:09:00,186 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.expirytime = 60s (default)
2023-10-31 16:09:00,186 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.expirytime = 60s (default)
2023-10-31 16:09:00,186 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2023-10-31 16:09:00,186 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2023-10-31 16:09:00,190 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.option = DEFAULT (default)
2023-10-31 16:09:00,191 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.option = DEFAULT (default)
2023-10-31 16:09:00,191 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.read-after-write-consistent.write-index-cache.expiry-time = 60s (default)
2023-10-31 16:09:00,192 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.option = DEFAULT (default)
2023-10-31 16:09:00,193 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.read-after-write-consistent.write-index-cache.expiry-time = 60s (default)
2023-10-31 16:09:00,198 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.read-after-write-consistent.write-index-cache.expiry-time = 60s (default)
2023-10-31 16:09:00,201 [s1-groupManagement] INFO  metrics.MetricRegistries (MetricRegistriesLoader.java:load(64)) - Loaded MetricRegistries class org.apache.ratis.metrics.impl.MetricRegistriesImpl
2023-10-31 16:09:00,343 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:00,344 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:00,345 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:00,345 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.cached = true (default)
2023-10-31 16:09:00,346 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.size = 0 (default)
2023-10-31 16:09:00,347 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:00,347 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:00,347 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.cached = true (default)
2023-10-31 16:09:00,347 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.size = 0 (default)
2023-10-31 16:09:00,348 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.cached = true (default)
2023-10-31 16:09:00,348 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.size = 0 (default)
2023-10-31 16:09:00,345 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:00,348 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.cached = true (default)
2023-10-31 16:09:00,349 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.size = 0 (default)
2023-10-31 16:09:00,349 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.cached = true (default)
2023-10-31 16:09:00,349 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.size = 0 (default)
2023-10-31 16:09:00,349 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2023-10-31 16:09:00,350 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.corruption.policy = EXCEPTION (default)
2023-10-31 16:09:00,350 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s0] (custom)
2023-10-31 16:09:00,356 [s0-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(138)) - The storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s0/0993f678-55cd-451f-8458-e610fdad83bb does not exist. Creating ...
2023-10-31 16:09:00,359 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.cached = true (default)
2023-10-31 16:09:00,359 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.size = 0 (default)
2023-10-31 16:09:00,358 [s0-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s0/0993f678-55cd-451f-8458-e610fdad83bb
2023-10-31 16:09:00,364 [s0-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(232)) - Lock on /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s0/0993f678-55cd-451f-8458-e610fdad83bb/in_use.lock acquired by nodename 15111@fv-az220-516
2023-10-31 16:09:00,365 [s0-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s0/0993f678-55cd-451f-8458-e610fdad83bb/current
2023-10-31 16:09:00,365 [s0-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s0/0993f678-55cd-451f-8458-e610fdad83bb/sm
2023-10-31 16:09:00,369 [s0-impl-thread1] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s0/0993f678-55cd-451f-8458-e610fdad83bb/current/raft-meta.tmp with options [CREATE, WRITE]: sun.nio.ch.FileChannelImpl@1ca0cd3d
2023-10-31 16:09:00,388 [s0-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s0/0993f678-55cd-451f-8458-e610fdad83bb/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s0/0993f678-55cd-451f-8458-e610fdad83bb/current/raft-meta with options [REPLACE_EXISTING]
2023-10-31 16:09:00,389 [s0-impl-thread1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(97)) - Storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s0/0993f678-55cd-451f-8458-e610fdad83bb has been successfully formatted.
2023-10-31 16:09:00,389 [s0-impl-thread1] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:initialize(213)) - Initializing SimpleStateMachine4Testing:uninitialized
2023-10-31 16:09:00,393 [s0-impl-thread1] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:loadSnapshot(296)) - Loading snapshot null
2023-10-31 16:09:00,394 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.use.memory = false (default)
2023-10-31 16:09:00,400 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.gap = 1024 (default)
2023-10-31 16:09:00,400 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:00,401 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.read.timeout = 1000ms (default)
2023-10-31 16:09:00,403 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.preservation.log.num = 0 (default)
2023-10-31 16:09:00,406 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 32MB (=33554432) (default)
2023-10-31 16:09:00,410 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.num.max = 6 (default)
2023-10-31 16:09:00,410 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2023-10-31 16:09:00,411 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:00,412 [s0-impl-thread1] INFO  util.AwaitToRun (AwaitToRun.java:start(81)) - Thread[s0@group-E610FDAD83BB-cacheEviction-AwaitToRun,5,main] started
2023-10-31 16:09:00,415 [s0-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(184)) - new s0@group-E610FDAD83BB-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s0/0993f678-55cd-451f-8458-e610fdad83bb
2023-10-31 16:09:00,415 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2023-10-31 16:09:00,416 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.element-limit = 4096 (default)
2023-10-31 16:09:00,417 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 32MB (=33554432) (default)
2023-10-31 16:09:00,417 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2023-10-31 16:09:00,417 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.force.sync.num = 128 (default)
2023-10-31 16:09:00,418 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync = true (default)
2023-10-31 16:09:00,418 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2023-10-31 16:09:00,419 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2023-10-31 16:09:00,420 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2023-10-31 16:09:00,420 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:00,423 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.unsafe-flush.enabled = false (default)
2023-10-31 16:09:00,423 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.async-flush.enabled = false (default)
2023-10-31 16:09:00,423 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.caching.enabled = false (default)
2023-10-31 16:09:00,428 [s0-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(135)) - s0@group-E610FDAD83BB-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2023-10-31 16:09:00,428 [s0-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(135)) - s0@group-E610FDAD83BB-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2023-10-31 16:09:00,430 [s0-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(390)) - s0@group-E610FDAD83BB: start as a follower, conf=-1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null
2023-10-31 16:09:00,430 [s0-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s0@group-E610FDAD83BB: changes role from      null to FOLLOWER at term 0 for startAsFollower
2023-10-31 16:09:00,431 [s0-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s0: start s0@group-E610FDAD83BB-FollowerState
2023-10-31 16:09:00,437 [s0-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-E610FDAD83BB,id=s0
2023-10-31 16:09:00,439 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.trigger-when-stop.enabled = true (default)
2023-10-31 16:09:00,439 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.auto.trigger.enabled = false (default)
2023-10-31 16:09:00,439 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.retention.file.num = -1 (default)
2023-10-31 16:09:00,440 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.upto.snapshot.index = false (default)
2023-10-31 16:09:00,445 [s0@group-E610FDAD83BB-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2023-10-31 16:09:00,445 [s0@group-E610FDAD83BB-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2023-10-31 16:09:00,445 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:startImpl(406)) - s0: start RPC server
2023-10-31 16:09:00,487 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s0: GrpcService started, listening on 38937
2023-10-31 16:09:00,491 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s0: GrpcService started, listening on 33069
2023-10-31 16:09:00,495 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s0: GrpcService started, listening on 45897
2023-10-31 16:09:00,502 [JvmPauseMonitor0] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(146)) - JvmPauseMonitor-s0: Started
2023-10-31 16:09:00,502 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2023-10-31 16:09:00,502 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.corruption.policy = EXCEPTION (default)
2023-10-31 16:09:00,503 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s1] (custom)
2023-10-31 16:09:00,503 [s1-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(138)) - The storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s1/0993f678-55cd-451f-8458-e610fdad83bb does not exist. Creating ...
2023-10-31 16:09:00,504 [s1-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s1/0993f678-55cd-451f-8458-e610fdad83bb
2023-10-31 16:09:00,506 [s1-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(232)) - Lock on /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s1/0993f678-55cd-451f-8458-e610fdad83bb/in_use.lock acquired by nodename 15111@fv-az220-516
2023-10-31 16:09:00,506 [s1-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s1/0993f678-55cd-451f-8458-e610fdad83bb/current
2023-10-31 16:09:00,507 [s1-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s1/0993f678-55cd-451f-8458-e610fdad83bb/sm
2023-10-31 16:09:00,507 [s1-impl-thread1] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s1/0993f678-55cd-451f-8458-e610fdad83bb/current/raft-meta.tmp with options [CREATE, WRITE]: sun.nio.ch.FileChannelImpl@679653f1
2023-10-31 16:09:00,509 [s1-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s1/0993f678-55cd-451f-8458-e610fdad83bb/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s1/0993f678-55cd-451f-8458-e610fdad83bb/current/raft-meta with options [REPLACE_EXISTING]
2023-10-31 16:09:00,509 [s1-impl-thread1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(97)) - Storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s1/0993f678-55cd-451f-8458-e610fdad83bb has been successfully formatted.
2023-10-31 16:09:00,509 [s1-impl-thread1] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:initialize(213)) - Initializing SimpleStateMachine4Testing:uninitialized
2023-10-31 16:09:00,510 [s1-impl-thread1] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:loadSnapshot(296)) - Loading snapshot null
2023-10-31 16:09:00,510 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.use.memory = false (default)
2023-10-31 16:09:00,510 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.gap = 1024 (default)
2023-10-31 16:09:00,510 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:00,510 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.read.timeout = 1000ms (default)
2023-10-31 16:09:00,510 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.preservation.log.num = 0 (default)
2023-10-31 16:09:00,511 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 32MB (=33554432) (default)
2023-10-31 16:09:00,512 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.num.max = 6 (default)
2023-10-31 16:09:00,512 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2023-10-31 16:09:00,512 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:00,514 [s1-impl-thread1] INFO  util.AwaitToRun (AwaitToRun.java:start(81)) - Thread[s1@group-E610FDAD83BB-cacheEviction-AwaitToRun,5,main] started
2023-10-31 16:09:00,515 [s1-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(184)) - new s1@group-E610FDAD83BB-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s1/0993f678-55cd-451f-8458-e610fdad83bb
2023-10-31 16:09:00,516 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2023-10-31 16:09:00,516 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.element-limit = 4096 (default)
2023-10-31 16:09:00,516 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 32MB (=33554432) (default)
2023-10-31 16:09:00,516 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2023-10-31 16:09:00,516 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.force.sync.num = 128 (default)
2023-10-31 16:09:00,516 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync = true (default)
2023-10-31 16:09:00,516 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2023-10-31 16:09:00,516 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2023-10-31 16:09:00,517 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2023-10-31 16:09:00,517 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:00,519 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.unsafe-flush.enabled = false (default)
2023-10-31 16:09:00,519 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.async-flush.enabled = false (default)
2023-10-31 16:09:00,519 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.caching.enabled = false (default)
2023-10-31 16:09:00,520 [s1-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(135)) - s1@group-E610FDAD83BB-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2023-10-31 16:09:00,520 [s1-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(135)) - s1@group-E610FDAD83BB-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2023-10-31 16:09:00,525 [s1-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(390)) - s1@group-E610FDAD83BB: start as a follower, conf=-1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null
2023-10-31 16:09:00,525 [s1-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s1@group-E610FDAD83BB: changes role from      null to FOLLOWER at term 0 for startAsFollower
2023-10-31 16:09:00,526 [s1-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s1: start s1@group-E610FDAD83BB-FollowerState
2023-10-31 16:09:00,527 [s1@group-E610FDAD83BB-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2023-10-31 16:09:00,527 [s1@group-E610FDAD83BB-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2023-10-31 16:09:00,527 [s1-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-E610FDAD83BB,id=s1
2023-10-31 16:09:00,530 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.trigger-when-stop.enabled = true (default)
2023-10-31 16:09:00,531 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.auto.trigger.enabled = false (default)
2023-10-31 16:09:00,531 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.retention.file.num = -1 (default)
2023-10-31 16:09:00,531 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.upto.snapshot.index = false (default)
2023-10-31 16:09:00,532 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:startImpl(406)) - s1: start RPC server
2023-10-31 16:09:00,534 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s1: GrpcService started, listening on 35351
2023-10-31 16:09:00,535 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s1: GrpcService started, listening on 43557
2023-10-31 16:09:00,536 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s1: GrpcService started, listening on 40839
2023-10-31 16:09:00,536 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2023-10-31 16:09:00,537 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.corruption.policy = EXCEPTION (default)
2023-10-31 16:09:00,537 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s2] (custom)
2023-10-31 16:09:00,537 [s2-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(138)) - The storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s2/0993f678-55cd-451f-8458-e610fdad83bb does not exist. Creating ...
2023-10-31 16:09:00,537 [s2-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s2/0993f678-55cd-451f-8458-e610fdad83bb
2023-10-31 16:09:00,538 [s2-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(232)) - Lock on /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s2/0993f678-55cd-451f-8458-e610fdad83bb/in_use.lock acquired by nodename 15111@fv-az220-516
2023-10-31 16:09:00,539 [s2-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s2/0993f678-55cd-451f-8458-e610fdad83bb/current
2023-10-31 16:09:00,539 [s2-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s2/0993f678-55cd-451f-8458-e610fdad83bb/sm
2023-10-31 16:09:00,539 [s2-impl-thread1] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s2/0993f678-55cd-451f-8458-e610fdad83bb/current/raft-meta.tmp with options [CREATE, WRITE]: sun.nio.ch.FileChannelImpl@6bd3ce02
2023-10-31 16:09:00,541 [s2-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s2/0993f678-55cd-451f-8458-e610fdad83bb/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s2/0993f678-55cd-451f-8458-e610fdad83bb/current/raft-meta with options [REPLACE_EXISTING]
2023-10-31 16:09:00,542 [s2-impl-thread1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(97)) - Storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s2/0993f678-55cd-451f-8458-e610fdad83bb has been successfully formatted.
2023-10-31 16:09:00,542 [s2-impl-thread1] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:initialize(213)) - Initializing SimpleStateMachine4Testing:uninitialized
2023-10-31 16:09:00,542 [s2-impl-thread1] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:loadSnapshot(296)) - Loading snapshot null
2023-10-31 16:09:00,542 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.use.memory = false (default)
2023-10-31 16:09:00,543 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.gap = 1024 (default)
2023-10-31 16:09:00,543 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:00,544 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.read.timeout = 1000ms (default)
2023-10-31 16:09:00,544 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.preservation.log.num = 0 (default)
2023-10-31 16:09:00,536 [JvmPauseMonitor1] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(146)) - JvmPauseMonitor-s1: Started
2023-10-31 16:09:00,547 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 32MB (=33554432) (default)
2023-10-31 16:09:00,547 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.num.max = 6 (default)
2023-10-31 16:09:00,547 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2023-10-31 16:09:00,547 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:00,548 [s2-impl-thread1] INFO  util.AwaitToRun (AwaitToRun.java:start(81)) - Thread[s2@group-E610FDAD83BB-cacheEviction-AwaitToRun,5,main] started
2023-10-31 16:09:00,548 [s2-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(184)) - new s2@group-E610FDAD83BB-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s2/0993f678-55cd-451f-8458-e610fdad83bb
2023-10-31 16:09:00,548 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2023-10-31 16:09:00,549 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.element-limit = 4096 (default)
2023-10-31 16:09:00,549 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 32MB (=33554432) (default)
2023-10-31 16:09:00,549 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2023-10-31 16:09:00,549 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.force.sync.num = 128 (default)
2023-10-31 16:09:00,550 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync = true (default)
2023-10-31 16:09:00,550 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2023-10-31 16:09:00,551 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2023-10-31 16:09:00,553 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2023-10-31 16:09:00,554 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:00,556 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.unsafe-flush.enabled = false (default)
2023-10-31 16:09:00,556 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.async-flush.enabled = false (default)
2023-10-31 16:09:00,556 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.caching.enabled = false (default)
2023-10-31 16:09:00,557 [s2-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(135)) - s2@group-E610FDAD83BB-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2023-10-31 16:09:00,557 [s2-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(135)) - s2@group-E610FDAD83BB-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2023-10-31 16:09:00,557 [s2-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(390)) - s2@group-E610FDAD83BB: start as a follower, conf=-1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null
2023-10-31 16:09:00,557 [s2-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s2@group-E610FDAD83BB: changes role from      null to FOLLOWER at term 0 for startAsFollower
2023-10-31 16:09:00,557 [s2-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s2: start s2@group-E610FDAD83BB-FollowerState
2023-10-31 16:09:00,558 [s2-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-E610FDAD83BB,id=s2
2023-10-31 16:09:00,558 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.trigger-when-stop.enabled = true (default)
2023-10-31 16:09:00,558 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.auto.trigger.enabled = false (default)
2023-10-31 16:09:00,558 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.retention.file.num = -1 (default)
2023-10-31 16:09:00,558 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.upto.snapshot.index = false (default)
2023-10-31 16:09:00,562 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:startImpl(406)) - s2: start RPC server
2023-10-31 16:09:00,562 [s2@group-E610FDAD83BB-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2023-10-31 16:09:00,562 [s2@group-E610FDAD83BB-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2023-10-31 16:09:00,566 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s2: GrpcService started, listening on 43097
2023-10-31 16:09:00,567 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s2: GrpcService started, listening on 44705
2023-10-31 16:09:00,567 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s2: GrpcService started, listening on 37569
2023-10-31 16:09:00,568 [JvmPauseMonitor2] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(146)) - JvmPauseMonitor-s2: Started
2023-10-31 16:09:00,570 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2023-10-31 16:09:00,572 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(100)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-E610FDAD83BB:t0, leader=null, voted=, raftlog=Memoized:s0@group-E610FDAD83BB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-E610FDAD83BB:t0, leader=null, voted=, raftlog=Memoized:s1@group-E610FDAD83BB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-E610FDAD83BB:t0, leader=null, voted=, raftlog=Memoized:s2@group-E610FDAD83BB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null RUNNING
2023-10-31 16:09:00,578 [Time-limited test] WARN  ratis.RaftTestUtil (JavaUtils.java:attempt(223)) - FAILED "waitForLeader-null-(expectLeader? true)", attempt #1/100: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-E610FDAD83BB:t0, leader=null, voted=, raftlog=Memoized:s0@group-E610FDAD83BB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-E610FDAD83BB:t0, leader=null, voted=, raftlog=Memoized:s1@group-E610FDAD83BB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-E610FDAD83BB:t0, leader=null, voted=, raftlog=Memoized:s2@group-E610FDAD83BB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null RUNNING, sleep 450ms and then retry.
java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-E610FDAD83BB:t0, leader=null, voted=, raftlog=Memoized:s0@group-E610FDAD83BB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-E610FDAD83BB:t0, leader=null, voted=, raftlog=Memoized:s1@group-E610FDAD83BB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-E610FDAD83BB:t0, leader=null, voted=, raftlog=Memoized:s2@group-E610FDAD83BB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null RUNNING
	at org.apache.ratis.server.impl.MiniRaftCluster.newIllegalStateExceptionForNoLeaders(MiniRaftCluster.java:581)
	at org.apache.ratis.RaftTestUtil.lambda$waitForLeader$1(RaftTestUtil.java:104)
	at org.apache.ratis.server.impl.MiniRaftCluster.getLeader(MiniRaftCluster.java:615)
	at org.apache.ratis.server.impl.MiniRaftCluster.getLeader(MiniRaftCluster.java:608)
	at org.apache.ratis.RaftTestUtil.lambda$waitForLeader$3(RaftTestUtil.java:112)
	at org.apache.ratis.util.JavaUtils.attempt(JavaUtils.java:217)
	at org.apache.ratis.util.JavaUtils.attemptRepeatedly(JavaUtils.java:203)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:111)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:92)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:87)
	at org.apache.ratis.grpc.TestRetryCacheWithGrpc.testRetryOnResourceUnavailableException(TestRetryCacheWithGrpc.java:173)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:00,710 [s1@group-E610FDAD83BB-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s1@group-E610FDAD83BB-FollowerState: change to CANDIDATE, lastRpcElapsedTime:184246493ns, electionTimeout:182ms
2023-10-31 16:09:00,711 [s1@group-E610FDAD83BB-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(109)) - s1: shutdown s1@group-E610FDAD83BB-FollowerState
2023-10-31 16:09:00,711 [s1@group-E610FDAD83BB-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s1@group-E610FDAD83BB: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2023-10-31 16:09:00,715 [s1@group-E610FDAD83BB-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2023-10-31 16:09:00,715 [s1@group-E610FDAD83BB-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s1: start s1@group-E610FDAD83BB-LeaderElection1
2023-10-31 16:09:00,718 [s1@group-E610FDAD83BB-LeaderElection1] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(323)) - s1@group-E610FDAD83BB-LeaderElection1 PRE_VOTE round 0: submit vote requests at term 0 for -1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null
2023-10-31 16:09:00,726 [s0@group-E610FDAD83BB-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s0@group-E610FDAD83BB-FollowerState: change to CANDIDATE, lastRpcElapsedTime:295527764ns, electionTimeout:281ms
2023-10-31 16:09:00,726 [s0@group-E610FDAD83BB-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(109)) - s0: shutdown s0@group-E610FDAD83BB-FollowerState
2023-10-31 16:09:00,726 [s0@group-E610FDAD83BB-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s0@group-E610FDAD83BB: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2023-10-31 16:09:00,727 [s0@group-E610FDAD83BB-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2023-10-31 16:09:00,727 [s0@group-E610FDAD83BB-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s0: start s0@group-E610FDAD83BB-LeaderElection2
2023-10-31 16:09:00,741 [s1@group-E610FDAD83BB-LeaderElection1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2023-10-31 16:09:00,741 [s1@group-E610FDAD83BB-LeaderElection1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2023-10-31 16:09:00,741 [s0@group-E610FDAD83BB-LeaderElection2] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(323)) - s0@group-E610FDAD83BB-LeaderElection2 PRE_VOTE round 0: submit vote requests at term 0 for -1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null
2023-10-31 16:09:00,744 [s0@group-E610FDAD83BB-LeaderElection2] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2023-10-31 16:09:00,744 [s0@group-E610FDAD83BB-LeaderElection2] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2023-10-31 16:09:00,745 [s1@group-E610FDAD83BB-LeaderElection1-2] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(65)) - Build channel for s2
2023-10-31 16:09:00,746 [s0@group-E610FDAD83BB-LeaderElection2-2] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(65)) - Build channel for s2
2023-10-31 16:09:00,746 [s0@group-E610FDAD83BB-LeaderElection2-1] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(65)) - Build channel for s1
2023-10-31 16:09:00,746 [s1@group-E610FDAD83BB-LeaderElection1-1] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(65)) - Build channel for s0
2023-10-31 16:09:00,792 [s2@group-E610FDAD83BB-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s2@group-E610FDAD83BB-FollowerState: change to CANDIDATE, lastRpcElapsedTime:235048385ns, electionTimeout:230ms
2023-10-31 16:09:00,793 [s2@group-E610FDAD83BB-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(109)) - s2: shutdown s2@group-E610FDAD83BB-FollowerState
2023-10-31 16:09:00,793 [s2@group-E610FDAD83BB-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s2@group-E610FDAD83BB: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2023-10-31 16:09:00,793 [s2@group-E610FDAD83BB-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2023-10-31 16:09:00,794 [s2@group-E610FDAD83BB-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s2: start s2@group-E610FDAD83BB-LeaderElection3
2023-10-31 16:09:00,798 [s2@group-E610FDAD83BB-LeaderElection3] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(323)) - s2@group-E610FDAD83BB-LeaderElection3 PRE_VOTE round 0: submit vote requests at term 0 for -1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null
2023-10-31 16:09:00,802 [s2@group-E610FDAD83BB-LeaderElection3-1] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(65)) - Build channel for s0
2023-10-31 16:09:00,812 [s2@group-E610FDAD83BB-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2023-10-31 16:09:00,812 [s2@group-E610FDAD83BB-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2023-10-31 16:09:00,812 [s2@group-E610FDAD83BB-LeaderElection3-2] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(65)) - Build channel for s1
2023-10-31 16:09:01,026 [s1@group-E610FDAD83BB-LeaderElection1] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s1@group-E610FDAD83BB-LeaderElection1: PRE_VOTE TIMEOUT received 0 response(s) and 0 exception(s):
2023-10-31 16:09:01,029 [s1@group-E610FDAD83BB-LeaderElection1] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(325)) - s1@group-E610FDAD83BB-LeaderElection1 PRE_VOTE round 0: result TIMEOUT
2023-10-31 16:09:01,029 [s1@group-E610FDAD83BB-LeaderElection1] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(323)) - s1@group-E610FDAD83BB-LeaderElection1 PRE_VOTE round 1: submit vote requests at term 0 for -1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null
2023-10-31 16:09:01,031 [s0@group-E610FDAD83BB-LeaderElection2] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s0@group-E610FDAD83BB-LeaderElection2: PRE_VOTE TIMEOUT received 0 response(s) and 0 exception(s):
2023-10-31 16:09:01,031 [s0@group-E610FDAD83BB-LeaderElection2] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(325)) - s0@group-E610FDAD83BB-LeaderElection2 PRE_VOTE round 0: result TIMEOUT
2023-10-31 16:09:01,031 [s0@group-E610FDAD83BB-LeaderElection2] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(323)) - s0@group-E610FDAD83BB-LeaderElection2 PRE_VOTE round 1: submit vote requests at term 0 for -1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null
2023-10-31 16:09:01,033 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s0@group-E610FDAD83BB: receive requestVote(PRE_VOTE, s1, group-E610FDAD83BB, 0, (t:0, i:0))
2023-10-31 16:09:01,034 [Time-limited test] WARN  ratis.RaftTestUtil (JavaUtils.java:attempt(223)) - FAILED "waitForLeader-null-(expectLeader? true)", attempt #2/100: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING CANDIDATE s0@group-E610FDAD83BB:t0, leader=null, voted=, raftlog=Memoized:s0@group-E610FDAD83BB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null RUNNING
  s1:  RUNNING CANDIDATE s1@group-E610FDAD83BB:t0, leader=null, voted=, raftlog=Memoized:s1@group-E610FDAD83BB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null RUNNING
  s2:  RUNNING CANDIDATE s2@group-E610FDAD83BB:t0, leader=null, voted=, raftlog=Memoized:s2@group-E610FDAD83BB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null RUNNING, sleep 450ms and then retry.
java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING CANDIDATE s0@group-E610FDAD83BB:t0, leader=null, voted=, raftlog=Memoized:s0@group-E610FDAD83BB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null RUNNING
  s1:  RUNNING CANDIDATE s1@group-E610FDAD83BB:t0, leader=null, voted=, raftlog=Memoized:s1@group-E610FDAD83BB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null RUNNING
  s2:  RUNNING CANDIDATE s2@group-E610FDAD83BB:t0, leader=null, voted=, raftlog=Memoized:s2@group-E610FDAD83BB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null RUNNING
	at org.apache.ratis.server.impl.MiniRaftCluster.newIllegalStateExceptionForNoLeaders(MiniRaftCluster.java:581)
	at org.apache.ratis.RaftTestUtil.lambda$waitForLeader$1(RaftTestUtil.java:104)
	at org.apache.ratis.server.impl.MiniRaftCluster.getLeader(MiniRaftCluster.java:615)
	at org.apache.ratis.server.impl.MiniRaftCluster.getLeader(MiniRaftCluster.java:608)
	at org.apache.ratis.RaftTestUtil.lambda$waitForLeader$3(RaftTestUtil.java:112)
	at org.apache.ratis.util.JavaUtils.attempt(JavaUtils.java:217)
	at org.apache.ratis.util.JavaUtils.attemptRepeatedly(JavaUtils.java:203)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:111)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:92)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:87)
	at org.apache.ratis.grpc.TestRetryCacheWithGrpc.testRetryOnResourceUnavailableException(TestRetryCacheWithGrpc.java:173)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:01,035 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s1@group-E610FDAD83BB: receive requestVote(PRE_VOTE, s0, group-E610FDAD83BB, 0, (t:0, i:0))
2023-10-31 16:09:01,035 [grpc-default-executor-2] INFO  impl.VoteContext (VoteContext.java:log(49)) - s0@group-E610FDAD83BB-CANDIDATE: accept PRE_VOTE from s1: our priority 0 <= candidate's priority 0
2023-10-31 16:09:01,043 [s1@group-E610FDAD83BB-LeaderElection1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2023-10-31 16:09:01,054 [s1@group-E610FDAD83BB-LeaderElection1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2023-10-31 16:09:01,054 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s0@group-E610FDAD83BB: receive requestVote(PRE_VOTE, s2, group-E610FDAD83BB, 0, (t:0, i:0))
2023-10-31 16:09:01,035 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s2@group-E610FDAD83BB: receive requestVote(PRE_VOTE, s1, group-E610FDAD83BB, 0, (t:0, i:0))
2023-10-31 16:09:01,055 [grpc-default-executor-1] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-E610FDAD83BB-CANDIDATE: accept PRE_VOTE from s1: our priority 0 <= candidate's priority 0
2023-10-31 16:09:01,040 [grpc-default-executor-3] INFO  impl.VoteContext (VoteContext.java:log(49)) - s1@group-E610FDAD83BB-CANDIDATE: accept PRE_VOTE from s0: our priority 0 <= candidate's priority 0
2023-10-31 16:09:01,055 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s2@group-E610FDAD83BB: receive requestVote(PRE_VOTE, s0, group-E610FDAD83BB, 0, (t:0, i:0))
2023-10-31 16:09:01,035 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s1@group-E610FDAD83BB: receive requestVote(PRE_VOTE, s2, group-E610FDAD83BB, 0, (t:0, i:0))
2023-10-31 16:09:01,062 [s0@group-E610FDAD83BB-LeaderElection2] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2023-10-31 16:09:01,062 [s0@group-E610FDAD83BB-LeaderElection2] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2023-10-31 16:09:01,063 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s0@group-E610FDAD83BB replies to PRE_VOTE vote request: s1<-s0#0:OK-t0. Peer's state: s0@group-E610FDAD83BB:t0, leader=null, voted=, raftlog=Memoized:s0@group-E610FDAD83BB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null
2023-10-31 16:09:01,064 [grpc-default-executor-5] INFO  impl.VoteContext (VoteContext.java:log(49)) - s0@group-E610FDAD83BB-CANDIDATE: accept PRE_VOTE from s2: our priority 0 <= candidate's priority 0
2023-10-31 16:09:01,064 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s0@group-E610FDAD83BB replies to PRE_VOTE vote request: s2<-s0#0:OK-t0. Peer's state: s0@group-E610FDAD83BB:t0, leader=null, voted=, raftlog=Memoized:s0@group-E610FDAD83BB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null
2023-10-31 16:09:01,064 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s2@group-E610FDAD83BB replies to PRE_VOTE vote request: s1<-s2#0:OK-t0. Peer's state: s2@group-E610FDAD83BB:t0, leader=null, voted=, raftlog=Memoized:s2@group-E610FDAD83BB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null
2023-10-31 16:09:01,065 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s1@group-E610FDAD83BB replies to PRE_VOTE vote request: s0<-s1#0:OK-t0. Peer's state: s1@group-E610FDAD83BB:t0, leader=null, voted=, raftlog=Memoized:s1@group-E610FDAD83BB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null
2023-10-31 16:09:01,065 [grpc-default-executor-4] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-E610FDAD83BB-CANDIDATE: accept PRE_VOTE from s0: our priority 0 <= candidate's priority 0
2023-10-31 16:09:01,066 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s2@group-E610FDAD83BB replies to PRE_VOTE vote request: s0<-s2#0:OK-t0. Peer's state: s2@group-E610FDAD83BB:t0, leader=null, voted=, raftlog=Memoized:s2@group-E610FDAD83BB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null
2023-10-31 16:09:01,067 [grpc-default-executor-0] INFO  impl.VoteContext (VoteContext.java:log(49)) - s1@group-E610FDAD83BB-CANDIDATE: accept PRE_VOTE from s2: our priority 0 <= candidate's priority 0
2023-10-31 16:09:01,067 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s1@group-E610FDAD83BB replies to PRE_VOTE vote request: s2<-s1#0:OK-t0. Peer's state: s1@group-E610FDAD83BB:t0, leader=null, voted=, raftlog=Memoized:s1@group-E610FDAD83BB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null
2023-10-31 16:09:01,071 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s0@group-E610FDAD83BB: receive requestVote(PRE_VOTE, s1, group-E610FDAD83BB, 0, (t:0, i:0))
2023-10-31 16:09:01,072 [grpc-default-executor-6] INFO  impl.VoteContext (VoteContext.java:log(49)) - s0@group-E610FDAD83BB-CANDIDATE: accept PRE_VOTE from s1: our priority 0 <= candidate's priority 0
2023-10-31 16:09:01,072 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s0@group-E610FDAD83BB replies to PRE_VOTE vote request: s1<-s0#0:OK-t0. Peer's state: s0@group-E610FDAD83BB:t0, leader=null, voted=, raftlog=Memoized:s0@group-E610FDAD83BB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null
2023-10-31 16:09:01,075 [s2@group-E610FDAD83BB-LeaderElection3] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s2@group-E610FDAD83BB-LeaderElection3: PRE_VOTE TIMEOUT received 0 response(s) and 0 exception(s):
2023-10-31 16:09:01,075 [s2@group-E610FDAD83BB-LeaderElection3] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(325)) - s2@group-E610FDAD83BB-LeaderElection3 PRE_VOTE round 0: result TIMEOUT
2023-10-31 16:09:01,075 [s2@group-E610FDAD83BB-LeaderElection3] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(323)) - s2@group-E610FDAD83BB-LeaderElection3 PRE_VOTE round 1: submit vote requests at term 0 for -1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null
2023-10-31 16:09:01,078 [s2@group-E610FDAD83BB-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2023-10-31 16:09:01,078 [s2@group-E610FDAD83BB-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2023-10-31 16:09:01,090 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s1@group-E610FDAD83BB: receive requestVote(PRE_VOTE, s0, group-E610FDAD83BB, 0, (t:0, i:0))
2023-10-31 16:09:01,091 [grpc-default-executor-6] INFO  impl.VoteContext (VoteContext.java:log(49)) - s1@group-E610FDAD83BB-CANDIDATE: accept PRE_VOTE from s0: our priority 0 <= candidate's priority 0
2023-10-31 16:09:01,091 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s1@group-E610FDAD83BB replies to PRE_VOTE vote request: s0<-s1#0:OK-t0. Peer's state: s1@group-E610FDAD83BB:t0, leader=null, voted=, raftlog=Memoized:s1@group-E610FDAD83BB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null
2023-10-31 16:09:01,092 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s2@group-E610FDAD83BB: receive requestVote(PRE_VOTE, s1, group-E610FDAD83BB, 0, (t:0, i:0))
2023-10-31 16:09:01,093 [grpc-default-executor-6] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-E610FDAD83BB-CANDIDATE: accept PRE_VOTE from s1: our priority 0 <= candidate's priority 0
2023-10-31 16:09:01,093 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s2@group-E610FDAD83BB replies to PRE_VOTE vote request: s1<-s2#0:OK-t0. Peer's state: s2@group-E610FDAD83BB:t0, leader=null, voted=, raftlog=Memoized:s2@group-E610FDAD83BB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null
2023-10-31 16:09:01,095 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s1@group-E610FDAD83BB: receive requestVote(PRE_VOTE, s2, group-E610FDAD83BB, 0, (t:0, i:0))
2023-10-31 16:09:01,095 [grpc-default-executor-6] INFO  impl.VoteContext (VoteContext.java:log(49)) - s1@group-E610FDAD83BB-CANDIDATE: accept PRE_VOTE from s2: our priority 0 <= candidate's priority 0
2023-10-31 16:09:01,095 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s1@group-E610FDAD83BB replies to PRE_VOTE vote request: s2<-s1#0:OK-t0. Peer's state: s1@group-E610FDAD83BB:t0, leader=null, voted=, raftlog=Memoized:s1@group-E610FDAD83BB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null
2023-10-31 16:09:01,103 [s1@group-E610FDAD83BB-LeaderElection1] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s1@group-E610FDAD83BB-LeaderElection1: PRE_VOTE PASSED received 1 response(s) and 0 exception(s):
2023-10-31 16:09:01,104 [s1@group-E610FDAD83BB-LeaderElection1] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s1<-s2#0:OK-t0
2023-10-31 16:09:01,104 [s1@group-E610FDAD83BB-LeaderElection1] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(325)) - s1@group-E610FDAD83BB-LeaderElection1 PRE_VOTE round 1: result PASSED
2023-10-31 16:09:01,104 [s1@group-E610FDAD83BB-LeaderElection1] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s1/0993f678-55cd-451f-8458-e610fdad83bb/current/raft-meta.tmp with options [CREATE, WRITE]: sun.nio.ch.FileChannelImpl@4ffe676f
2023-10-31 16:09:01,106 [s1@group-E610FDAD83BB-LeaderElection1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s1/0993f678-55cd-451f-8458-e610fdad83bb/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s1/0993f678-55cd-451f-8458-e610fdad83bb/current/raft-meta with options [REPLACE_EXISTING]
2023-10-31 16:09:01,106 [s1@group-E610FDAD83BB-LeaderElection1] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(323)) - s1@group-E610FDAD83BB-LeaderElection1 ELECTION round 1: submit vote requests at term 1 for -1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null
2023-10-31 16:09:01,106 [s2@group-E610FDAD83BB-LeaderElection3] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s2@group-E610FDAD83BB-LeaderElection3: PRE_VOTE PASSED received 1 response(s) and 0 exception(s):
2023-10-31 16:09:01,106 [s2@group-E610FDAD83BB-LeaderElection3] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s2<-s1#0:OK-t0
2023-10-31 16:09:01,107 [s2@group-E610FDAD83BB-LeaderElection3] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(325)) - s2@group-E610FDAD83BB-LeaderElection3 PRE_VOTE round 1: result PASSED
2023-10-31 16:09:01,107 [s2@group-E610FDAD83BB-LeaderElection3] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s2/0993f678-55cd-451f-8458-e610fdad83bb/current/raft-meta.tmp with options [CREATE, WRITE]: sun.nio.ch.FileChannelImpl@5ef4c89
2023-10-31 16:09:01,108 [s2@group-E610FDAD83BB-LeaderElection3] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s2/0993f678-55cd-451f-8458-e610fdad83bb/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s2/0993f678-55cd-451f-8458-e610fdad83bb/current/raft-meta with options [REPLACE_EXISTING]
2023-10-31 16:09:01,108 [s2@group-E610FDAD83BB-LeaderElection3] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(323)) - s2@group-E610FDAD83BB-LeaderElection3 ELECTION round 1: submit vote requests at term 1 for -1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null
2023-10-31 16:09:01,108 [s0@group-E610FDAD83BB-LeaderElection2] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s0@group-E610FDAD83BB-LeaderElection2: PRE_VOTE PASSED received 1 response(s) and 0 exception(s):
2023-10-31 16:09:01,109 [s0@group-E610FDAD83BB-LeaderElection2] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s0<-s1#0:OK-t0
2023-10-31 16:09:01,109 [s0@group-E610FDAD83BB-LeaderElection2] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(325)) - s0@group-E610FDAD83BB-LeaderElection2 PRE_VOTE round 1: result PASSED
2023-10-31 16:09:01,109 [s0@group-E610FDAD83BB-LeaderElection2] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s0/0993f678-55cd-451f-8458-e610fdad83bb/current/raft-meta.tmp with options [CREATE, WRITE]: sun.nio.ch.FileChannelImpl@4efdb7f2
2023-10-31 16:09:01,110 [s0@group-E610FDAD83BB-LeaderElection2] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s0/0993f678-55cd-451f-8458-e610fdad83bb/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s0/0993f678-55cd-451f-8458-e610fdad83bb/current/raft-meta with options [REPLACE_EXISTING]
2023-10-31 16:09:01,110 [s0@group-E610FDAD83BB-LeaderElection2] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(323)) - s0@group-E610FDAD83BB-LeaderElection2 ELECTION round 1: submit vote requests at term 1 for -1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null
2023-10-31 16:09:01,117 [s1@group-E610FDAD83BB-LeaderElection1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2023-10-31 16:09:01,117 [s1@group-E610FDAD83BB-LeaderElection1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2023-10-31 16:09:01,119 [s0@group-E610FDAD83BB-LeaderElection2] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2023-10-31 16:09:01,119 [s0@group-E610FDAD83BB-LeaderElection2] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2023-10-31 16:09:01,120 [s2@group-E610FDAD83BB-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2023-10-31 16:09:01,120 [s2@group-E610FDAD83BB-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2023-10-31 16:09:01,123 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s2@group-E610FDAD83BB: receive requestVote(PRE_VOTE, s0, group-E610FDAD83BB, 0, (t:0, i:0))
2023-10-31 16:09:01,124 [grpc-default-executor-6] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-E610FDAD83BB-CANDIDATE: accept PRE_VOTE from s0: our priority 0 <= candidate's priority 0
2023-10-31 16:09:01,124 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s2@group-E610FDAD83BB replies to PRE_VOTE vote request: s0<-s2#0:OK-t1. Peer's state: s2@group-E610FDAD83BB:t1, leader=null, voted=s2, raftlog=Memoized:s2@group-E610FDAD83BB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null
2023-10-31 16:09:01,125 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s0@group-E610FDAD83BB: receive requestVote(ELECTION, s1, group-E610FDAD83BB, 1, (t:0, i:0))
2023-10-31 16:09:01,125 [grpc-default-executor-0] INFO  impl.VoteContext (VoteContext.java:log(49)) - s0@group-E610FDAD83BB-CANDIDATE: reject ELECTION from s1: already has voted for s0 at current term 1
2023-10-31 16:09:01,125 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s0@group-E610FDAD83BB replies to ELECTION vote request: s1<-s0#0:FAIL-t1. Peer's state: s0@group-E610FDAD83BB:t1, leader=null, voted=s0, raftlog=Memoized:s0@group-E610FDAD83BB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null
2023-10-31 16:09:01,128 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s0@group-E610FDAD83BB: receive requestVote(PRE_VOTE, s2, group-E610FDAD83BB, 0, (t:0, i:0))
2023-10-31 16:09:01,129 [grpc-default-executor-4] INFO  impl.VoteContext (VoteContext.java:log(49)) - s0@group-E610FDAD83BB-CANDIDATE: accept PRE_VOTE from s2: our priority 0 <= candidate's priority 0
2023-10-31 16:09:01,129 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s0@group-E610FDAD83BB replies to PRE_VOTE vote request: s2<-s0#0:OK-t1. Peer's state: s0@group-E610FDAD83BB:t1, leader=null, voted=s0, raftlog=Memoized:s0@group-E610FDAD83BB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null
2023-10-31 16:09:01,131 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s1@group-E610FDAD83BB: receive requestVote(ELECTION, s2, group-E610FDAD83BB, 1, (t:0, i:0))
2023-10-31 16:09:01,131 [grpc-default-executor-6] INFO  impl.VoteContext (VoteContext.java:log(49)) - s1@group-E610FDAD83BB-CANDIDATE: reject ELECTION from s2: already has voted for s1 at current term 1
2023-10-31 16:09:01,131 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s1@group-E610FDAD83BB replies to ELECTION vote request: s2<-s1#0:FAIL-t1. Peer's state: s1@group-E610FDAD83BB:t1, leader=null, voted=s1, raftlog=Memoized:s1@group-E610FDAD83BB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null
2023-10-31 16:09:01,132 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s2@group-E610FDAD83BB: receive requestVote(ELECTION, s1, group-E610FDAD83BB, 1, (t:0, i:0))
2023-10-31 16:09:01,132 [grpc-default-executor-0] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-E610FDAD83BB-CANDIDATE: reject ELECTION from s1: already has voted for s2 at current term 1
2023-10-31 16:09:01,132 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s2@group-E610FDAD83BB replies to ELECTION vote request: s1<-s2#0:FAIL-t1. Peer's state: s2@group-E610FDAD83BB:t1, leader=null, voted=s2, raftlog=Memoized:s2@group-E610FDAD83BB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null
2023-10-31 16:09:01,132 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s2@group-E610FDAD83BB: receive requestVote(ELECTION, s0, group-E610FDAD83BB, 1, (t:0, i:0))
2023-10-31 16:09:01,132 [grpc-default-executor-6] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-E610FDAD83BB-CANDIDATE: reject ELECTION from s0: already has voted for s2 at current term 1
2023-10-31 16:09:01,133 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s2@group-E610FDAD83BB replies to ELECTION vote request: s0<-s2#0:FAIL-t1. Peer's state: s2@group-E610FDAD83BB:t1, leader=null, voted=s2, raftlog=Memoized:s2@group-E610FDAD83BB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null
2023-10-31 16:09:01,134 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s0@group-E610FDAD83BB: receive requestVote(ELECTION, s2, group-E610FDAD83BB, 1, (t:0, i:0))
2023-10-31 16:09:01,135 [grpc-default-executor-0] INFO  impl.VoteContext (VoteContext.java:log(49)) - s0@group-E610FDAD83BB-CANDIDATE: reject ELECTION from s2: already has voted for s0 at current term 1
2023-10-31 16:09:01,135 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s0@group-E610FDAD83BB replies to ELECTION vote request: s2<-s0#0:FAIL-t1. Peer's state: s0@group-E610FDAD83BB:t1, leader=null, voted=s0, raftlog=Memoized:s0@group-E610FDAD83BB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null
2023-10-31 16:09:01,140 [s1@group-E610FDAD83BB-LeaderElection1] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s1@group-E610FDAD83BB-LeaderElection1: ELECTION REJECTED received 2 response(s) and 0 exception(s):
2023-10-31 16:09:01,140 [s1@group-E610FDAD83BB-LeaderElection1] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s1<-s0#0:FAIL-t1
2023-10-31 16:09:01,140 [s1@group-E610FDAD83BB-LeaderElection1] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 1: s1<-s2#0:FAIL-t1
2023-10-31 16:09:01,140 [s1@group-E610FDAD83BB-LeaderElection1] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(325)) - s1@group-E610FDAD83BB-LeaderElection1 ELECTION round 1: result REJECTED
2023-10-31 16:09:01,146 [s2@group-E610FDAD83BB-LeaderElection3] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s2@group-E610FDAD83BB-LeaderElection3: ELECTION REJECTED received 2 response(s) and 0 exception(s):
2023-10-31 16:09:01,147 [s2@group-E610FDAD83BB-LeaderElection3] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s2<-s0#0:FAIL-t1
2023-10-31 16:09:01,147 [s2@group-E610FDAD83BB-LeaderElection3] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 1: s2<-s1#0:FAIL-t1
2023-10-31 16:09:01,147 [s2@group-E610FDAD83BB-LeaderElection3] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(325)) - s2@group-E610FDAD83BB-LeaderElection3 ELECTION round 1: result REJECTED
2023-10-31 16:09:01,151 [s1@group-E610FDAD83BB-LeaderElection1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s1@group-E610FDAD83BB: changes role from CANDIDATE to FOLLOWER at term 1 for REJECTED
2023-10-31 16:09:01,151 [s1@group-E610FDAD83BB-LeaderElection1] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(129)) - s1: shutdown s1@group-E610FDAD83BB-LeaderElection1
2023-10-31 16:09:01,151 [s2@group-E610FDAD83BB-LeaderElection3] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s2@group-E610FDAD83BB: changes role from CANDIDATE to FOLLOWER at term 1 for REJECTED
2023-10-31 16:09:01,151 [s2@group-E610FDAD83BB-LeaderElection3] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(129)) - s2: shutdown s2@group-E610FDAD83BB-LeaderElection3
2023-10-31 16:09:01,151 [s1@group-E610FDAD83BB-LeaderElection1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s1: start s1@group-E610FDAD83BB-FollowerState
2023-10-31 16:09:01,151 [s2@group-E610FDAD83BB-LeaderElection3] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s2: start s2@group-E610FDAD83BB-FollowerState
2023-10-31 16:09:01,154 [s1@group-E610FDAD83BB-LeaderElection1] INFO  server.RaftServer$Division (RaftServerImpl.java:setFirstElection(562)) - s1@group-E610FDAD83BB: set firstElectionSinceStartup to false for REJECTED
2023-10-31 16:09:01,157 [s2@group-E610FDAD83BB-LeaderElection3] INFO  server.RaftServer$Division (RaftServerImpl.java:setFirstElection(562)) - s2@group-E610FDAD83BB: set firstElectionSinceStartup to false for REJECTED
2023-10-31 16:09:01,157 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s1@group-E610FDAD83BB: receive requestVote(ELECTION, s0, group-E610FDAD83BB, 1, (t:0, i:0))
2023-10-31 16:09:01,157 [grpc-default-executor-6] INFO  impl.VoteContext (VoteContext.java:log(49)) - s1@group-E610FDAD83BB-FOLLOWER: reject ELECTION from s0: already has voted for s1 at current term 1
2023-10-31 16:09:01,158 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s1@group-E610FDAD83BB replies to ELECTION vote request: s0<-s1#0:FAIL-t1. Peer's state: s1@group-E610FDAD83BB:t1, leader=null, voted=s1, raftlog=Memoized:s1@group-E610FDAD83BB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null
2023-10-31 16:09:01,167 [s0@group-E610FDAD83BB-LeaderElection2] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s0@group-E610FDAD83BB-LeaderElection2: ELECTION REJECTED received 2 response(s) and 0 exception(s):
2023-10-31 16:09:01,167 [s0@group-E610FDAD83BB-LeaderElection2] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s0<-s1#0:FAIL-t1
2023-10-31 16:09:01,167 [s0@group-E610FDAD83BB-LeaderElection2] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 1: s0<-s2#0:FAIL-t1
2023-10-31 16:09:01,167 [s0@group-E610FDAD83BB-LeaderElection2] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(325)) - s0@group-E610FDAD83BB-LeaderElection2 ELECTION round 1: result REJECTED
2023-10-31 16:09:01,167 [s0@group-E610FDAD83BB-LeaderElection2] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s0@group-E610FDAD83BB: changes role from CANDIDATE to FOLLOWER at term 1 for REJECTED
2023-10-31 16:09:01,167 [s0@group-E610FDAD83BB-LeaderElection2] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(129)) - s0: shutdown s0@group-E610FDAD83BB-LeaderElection2
2023-10-31 16:09:01,167 [s0@group-E610FDAD83BB-LeaderElection2] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s0: start s0@group-E610FDAD83BB-FollowerState
2023-10-31 16:09:01,168 [s0@group-E610FDAD83BB-LeaderElection2] INFO  server.RaftServer$Division (RaftServerImpl.java:setFirstElection(562)) - s0@group-E610FDAD83BB: set firstElectionSinceStartup to false for REJECTED
2023-10-31 16:09:01,333 [s2@group-E610FDAD83BB-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s2@group-E610FDAD83BB-FollowerState: change to CANDIDATE, lastRpcElapsedTime:181935948ns, electionTimeout:167ms
2023-10-31 16:09:01,333 [s2@group-E610FDAD83BB-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(109)) - s2: shutdown s2@group-E610FDAD83BB-FollowerState
2023-10-31 16:09:01,333 [s2@group-E610FDAD83BB-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s2@group-E610FDAD83BB: changes role from  FOLLOWER to CANDIDATE at term 1 for changeToCandidate
2023-10-31 16:09:01,334 [s2@group-E610FDAD83BB-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2023-10-31 16:09:01,334 [s2@group-E610FDAD83BB-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s2: start s2@group-E610FDAD83BB-LeaderElection4
2023-10-31 16:09:01,338 [s2@group-E610FDAD83BB-LeaderElection4] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(323)) - s2@group-E610FDAD83BB-LeaderElection4 PRE_VOTE round 0: submit vote requests at term 1 for -1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null
2023-10-31 16:09:01,347 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s0@group-E610FDAD83BB: receive requestVote(PRE_VOTE, s2, group-E610FDAD83BB, 1, (t:0, i:0))
2023-10-31 16:09:01,347 [grpc-default-executor-6] INFO  impl.VoteContext (VoteContext.java:log(49)) - s0@group-E610FDAD83BB-FOLLOWER: accept PRE_VOTE from s2: our priority 0 <= candidate's priority 0
2023-10-31 16:09:01,348 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s0@group-E610FDAD83BB replies to PRE_VOTE vote request: s2<-s0#0:OK-t1. Peer's state: s0@group-E610FDAD83BB:t1, leader=null, voted=s0, raftlog=Memoized:s0@group-E610FDAD83BB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null
2023-10-31 16:09:01,351 [s2@group-E610FDAD83BB-LeaderElection4] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s2@group-E610FDAD83BB-LeaderElection4: PRE_VOTE PASSED received 1 response(s) and 0 exception(s):
2023-10-31 16:09:01,351 [s2@group-E610FDAD83BB-LeaderElection4] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s2<-s0#0:OK-t1
2023-10-31 16:09:01,351 [s2@group-E610FDAD83BB-LeaderElection4] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(325)) - s2@group-E610FDAD83BB-LeaderElection4 PRE_VOTE round 0: result PASSED
2023-10-31 16:09:01,351 [s2@group-E610FDAD83BB-LeaderElection4] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s2/0993f678-55cd-451f-8458-e610fdad83bb/current/raft-meta.tmp with options [CREATE, WRITE]: sun.nio.ch.FileChannelImpl@3dc7e16f
2023-10-31 16:09:01,356 [s2@group-E610FDAD83BB-LeaderElection4] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s2/0993f678-55cd-451f-8458-e610fdad83bb/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s2/0993f678-55cd-451f-8458-e610fdad83bb/current/raft-meta with options [REPLACE_EXISTING]
2023-10-31 16:09:01,356 [s2@group-E610FDAD83BB-LeaderElection4] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(323)) - s2@group-E610FDAD83BB-LeaderElection4 ELECTION round 0: submit vote requests at term 2 for -1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null
2023-10-31 16:09:01,359 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s1@group-E610FDAD83BB: receive requestVote(PRE_VOTE, s2, group-E610FDAD83BB, 1, (t:0, i:0))
2023-10-31 16:09:01,359 [grpc-default-executor-6] INFO  impl.VoteContext (VoteContext.java:log(49)) - s1@group-E610FDAD83BB-FOLLOWER: accept PRE_VOTE from s2: our priority 0 <= candidate's priority 0
2023-10-31 16:09:01,359 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s1@group-E610FDAD83BB replies to PRE_VOTE vote request: s2<-s1#0:OK-t1. Peer's state: s1@group-E610FDAD83BB:t1, leader=null, voted=s1, raftlog=Memoized:s1@group-E610FDAD83BB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null
2023-10-31 16:09:01,364 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s0@group-E610FDAD83BB: receive requestVote(ELECTION, s2, group-E610FDAD83BB, 2, (t:0, i:0))
2023-10-31 16:09:01,364 [grpc-default-executor-0] INFO  impl.VoteContext (VoteContext.java:log(49)) - s0@group-E610FDAD83BB-FOLLOWER: accept ELECTION from s2: our priority 0 <= candidate's priority 0
2023-10-31 16:09:01,365 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s0@group-E610FDAD83BB: changes role from  FOLLOWER to FOLLOWER at term 2 for candidate:s2
2023-10-31 16:09:01,365 [grpc-default-executor-0] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(109)) - s0: shutdown s0@group-E610FDAD83BB-FollowerState
2023-10-31 16:09:01,365 [grpc-default-executor-0] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s0: start s0@group-E610FDAD83BB-FollowerState
2023-10-31 16:09:01,365 [s0@group-E610FDAD83BB-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(152)) - s0@group-E610FDAD83BB-FollowerState was interrupted
2023-10-31 16:09:01,372 [grpc-default-executor-0] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s0/0993f678-55cd-451f-8458-e610fdad83bb/current/raft-meta.tmp with options [CREATE, WRITE]: sun.nio.ch.FileChannelImpl@360717b2
2023-10-31 16:09:01,376 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s1@group-E610FDAD83BB: receive requestVote(ELECTION, s2, group-E610FDAD83BB, 2, (t:0, i:0))
2023-10-31 16:09:01,376 [grpc-default-executor-6] INFO  impl.VoteContext (VoteContext.java:log(49)) - s1@group-E610FDAD83BB-FOLLOWER: accept ELECTION from s2: our priority 0 <= candidate's priority 0
2023-10-31 16:09:01,376 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s1@group-E610FDAD83BB: changes role from  FOLLOWER to FOLLOWER at term 2 for candidate:s2
2023-10-31 16:09:01,376 [grpc-default-executor-6] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(109)) - s1: shutdown s1@group-E610FDAD83BB-FollowerState
2023-10-31 16:09:01,376 [grpc-default-executor-6] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s1: start s1@group-E610FDAD83BB-FollowerState
2023-10-31 16:09:01,376 [s1@group-E610FDAD83BB-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(152)) - s1@group-E610FDAD83BB-FollowerState was interrupted
2023-10-31 16:09:01,377 [grpc-default-executor-6] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s1/0993f678-55cd-451f-8458-e610fdad83bb/current/raft-meta.tmp with options [CREATE, WRITE]: sun.nio.ch.FileChannelImpl@1df26d1b
2023-10-31 16:09:01,378 [grpc-default-executor-0] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s0/0993f678-55cd-451f-8458-e610fdad83bb/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s0/0993f678-55cd-451f-8458-e610fdad83bb/current/raft-meta with options [REPLACE_EXISTING]
2023-10-31 16:09:01,378 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s0@group-E610FDAD83BB replies to ELECTION vote request: s2<-s0#0:OK-t2. Peer's state: s0@group-E610FDAD83BB:t2, leader=null, voted=s2, raftlog=Memoized:s0@group-E610FDAD83BB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null
2023-10-31 16:09:01,380 [s2@group-E610FDAD83BB-LeaderElection4] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s2@group-E610FDAD83BB-LeaderElection4: ELECTION PASSED received 1 response(s) and 0 exception(s):
2023-10-31 16:09:01,383 [s2@group-E610FDAD83BB-LeaderElection4] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s2<-s0#0:OK-t2
2023-10-31 16:09:01,383 [s2@group-E610FDAD83BB-LeaderElection4] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(325)) - s2@group-E610FDAD83BB-LeaderElection4 ELECTION round 0: result PASSED
2023-10-31 16:09:01,383 [s2@group-E610FDAD83BB-LeaderElection4] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(129)) - s2: shutdown s2@group-E610FDAD83BB-LeaderElection4
2023-10-31 16:09:01,383 [s2@group-E610FDAD83BB-LeaderElection4] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s2@group-E610FDAD83BB: changes role from CANDIDATE to LEADER at term 2 for changeToLeader
2023-10-31 16:09:01,384 [grpc-default-executor-6] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s1/0993f678-55cd-451f-8458-e610fdad83bb/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s1/0993f678-55cd-451f-8458-e610fdad83bb/current/raft-meta with options [REPLACE_EXISTING]
2023-10-31 16:09:01,385 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s1@group-E610FDAD83BB replies to ELECTION vote request: s2<-s1#0:OK-t2. Peer's state: s1@group-E610FDAD83BB:t2, leader=null, voted=s2, raftlog=Memoized:s1@group-E610FDAD83BB-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null
2023-10-31 16:09:01,388 [s2@group-E610FDAD83BB-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.staging.catchup.gap = 1000 (default)
2023-10-31 16:09:01,395 [s2@group-E610FDAD83BB-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.element-limit = 1 (custom)
2023-10-31 16:09:01,395 [s2@group-E610FDAD83BB-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.byte-limit = 64MB (=67108864) (default)
2023-10-31 16:09:01,398 [s2@group-E610FDAD83BB-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.timeout = 10s (default)
2023-10-31 16:09:01,398 [s2@group-E610FDAD83BB-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.timeout.denomination = 1s (default)
2023-10-31 16:09:01,398 [s2@group-E610FDAD83BB-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.element-limit = 65536 (default)
2023-10-31 16:09:01,407 [s2@group-E610FDAD83BB-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.leader.lease.enabled = false (default)
2023-10-31 16:09:01,410 [s2@group-E610FDAD83BB-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.leader.lease.timeout.ratio = 0.9 (default)
2023-10-31 16:09:01,410 [s2@group-E610FDAD83BB-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.min = 150ms (default)
2023-10-31 16:09:01,410 [s2@group-E610FDAD83BB-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.element-limit = 1 (custom)
2023-10-31 16:09:01,411 [s2@group-E610FDAD83BB-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.follower.gap.ratio.max = -1.0 (default)
2023-10-31 16:09:01,421 [s2@group-E610FDAD83BB-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:01,421 [s2@group-E610FDAD83BB-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:01,422 [s2@group-E610FDAD83BB-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:01,423 [s2@group-E610FDAD83BB-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:01,424 [s2@group-E610FDAD83BB-LeaderElection4] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:01,424 [s2@group-E610FDAD83BB-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:01,425 [s2@group-E610FDAD83BB-LeaderElection4] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:01,425 [s2@group-E610FDAD83BB-LeaderElection4] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:01,426 [s2@group-E610FDAD83BB-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:01,426 [s2@group-E610FDAD83BB-LeaderElection4] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:01,437 [s2@group-E610FDAD83BB-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:01,437 [s2@group-E610FDAD83BB-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:01,438 [s2@group-E610FDAD83BB-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:01,438 [s2@group-E610FDAD83BB-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:01,438 [s2@group-E610FDAD83BB-LeaderElection4] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:01,438 [s2@group-E610FDAD83BB-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:01,438 [s2@group-E610FDAD83BB-LeaderElection4] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:01,438 [s2@group-E610FDAD83BB-LeaderElection4] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:01,438 [s2@group-E610FDAD83BB-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:01,438 [s2@group-E610FDAD83BB-LeaderElection4] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:01,440 [s2@group-E610FDAD83BB-LeaderElection4] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s2: start s2@group-E610FDAD83BB-LeaderStateImpl
2023-10-31 16:09:01,440 [s2@group-E610FDAD83BB-LeaderElection4] INFO  server.RaftServer$Division (ServerState.java:setLeader(265)) - s2@group-E610FDAD83BB: change Leader from null to s2 at term 2 for becomeLeader, leader elected after 1259ms
2023-10-31 16:09:01,466 [s2@group-E610FDAD83BB-LeaderElection4] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(428)) - s2@group-E610FDAD83BB-SegmentedRaftLogWorker: Starting segment from index:0
2023-10-31 16:09:01,485 [Time-limited test] WARN  ratis.RaftTestUtil (JavaUtils.java:attempt(223)) - FAILED "waitForLeader-null-(expectLeader? true)", attempt #3/100: java.lang.IllegalStateException: Leader: s2@group-E610FDAD83BB not ready, sleep 450ms and then retry.
java.lang.IllegalStateException: Leader: s2@group-E610FDAD83BB not ready
	at org.apache.ratis.RaftTestUtil.lambda$waitForLeader$3(RaftTestUtil.java:114)
	at org.apache.ratis.util.JavaUtils.attempt(JavaUtils.java:217)
	at org.apache.ratis.util.JavaUtils.attemptRepeatedly(JavaUtils.java:203)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:111)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:92)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:87)
	at org.apache.ratis.grpc.TestRetryCacheWithGrpc.testRetryOnResourceUnavailableException(TestRetryCacheWithGrpc.java:173)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:01,498 [s2@group-E610FDAD83BB-LeaderElection4] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(382)) - s2@group-E610FDAD83BB: set configuration 0: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null
2023-10-31 16:09:01,556 [s1-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setLeader(265)) - s1@group-E610FDAD83BB: change Leader from null to s2 at term 2 for appendEntries, leader elected after 1380ms
2023-10-31 16:09:01,574 [s0-server-thread2] INFO  server.RaftServer$Division (ServerState.java:setLeader(265)) - s0@group-E610FDAD83BB: change Leader from null to s2 at term 2 for appendEntries, leader elected after 1398ms
2023-10-31 16:09:01,596 [s2@group-E610FDAD83BB-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(632)) - s2@group-E610FDAD83BB-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s2/0993f678-55cd-451f-8458-e610fdad83bb/current/log_inprogress_0
2023-10-31 16:09:01,656 [s1-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s1@group-E610FDAD83BB: receive appendEntries(s2, 2, null, -1, true, commits:[s2:c-1, s0:c-1, s1:c-1], cId:1, entries: [(t:2, i:0), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:33069"
dataStreamAddress: "localhost:43133"
clientAddress: "localhost:38937"
adminAddress: "localhost:45897"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43557"
dataStreamAddress: "localhost:45671"
clientAddress: "localhost:35351"
adminAddress: "localhost:40839"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:44705"
dataStreamAddress: "localhost:32919"
clientAddress: "localhost:43097"
adminAddress: "localhost:37569"
startupRole: FOLLOWER
, old:)]
2023-10-31 16:09:01,656 [s0-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s0@group-E610FDAD83BB: receive appendEntries(s2, 2, null, -1, true, commits:[s2:c-1, s0:c-1, s1:c-1], cId:1, entries: [(t:2, i:0), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:33069"
dataStreamAddress: "localhost:43133"
clientAddress: "localhost:38937"
adminAddress: "localhost:45897"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:43557"
dataStreamAddress: "localhost:45671"
clientAddress: "localhost:35351"
adminAddress: "localhost:40839"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:44705"
dataStreamAddress: "localhost:32919"
clientAddress: "localhost:43097"
adminAddress: "localhost:37569"
startupRole: FOLLOWER
, old:)]
2023-10-31 16:09:01,659 [s1-server-thread3] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(382)) - s1@group-E610FDAD83BB: set configuration 0: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null
2023-10-31 16:09:01,659 [s0-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(382)) - s0@group-E610FDAD83BB: set configuration 0: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null
2023-10-31 16:09:01,661 [s0-server-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(428)) - s0@group-E610FDAD83BB-SegmentedRaftLogWorker: Starting segment from index:0
2023-10-31 16:09:01,666 [s1-server-thread3] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(428)) - s1@group-E610FDAD83BB-SegmentedRaftLogWorker: Starting segment from index:0
2023-10-31 16:09:01,677 [s0@group-E610FDAD83BB-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(632)) - s0@group-E610FDAD83BB-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s0/0993f678-55cd-451f-8458-e610fdad83bb/current/log_inprogress_0
2023-10-31 16:09:01,677 [s1@group-E610FDAD83BB-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(632)) - s1@group-E610FDAD83BB-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcf2abe16a/s1/0993f678-55cd-451f-8458-e610fdad83bb/current/log_inprogress_0
2023-10-31 16:09:01,678 [s0-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s0@group-E610FDAD83BB: succeeded to handle AppendEntries. Reply: s2<-s0#1:OK-t2,SUCCESS,nextIndex=1,followerCommit=-1,matchIndex=0
2023-10-31 16:09:01,680 [s1-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s1@group-E610FDAD83BB: succeeded to handle AppendEntries. Reply: s2<-s1#1:OK-t2,SUCCESS,nextIndex=1,followerCommit=-1,matchIndex=0
2023-10-31 16:09:01,683 [s2@group-E610FDAD83BB-StateMachineUpdater] INFO  server.RaftServer$Division (LeaderStateImpl.java:isApplied(308)) - leader is ready since appliedIndex == 0 >= startIndex == 0
2023-10-31 16:09:01,936 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(119)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-E610FDAD83BB:t2, leader=s2, voted=s2, raftlog=Memoized:s0@group-E610FDAD83BB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-E610FDAD83BB:t2, leader=s2, voted=s2, raftlog=Memoized:s1@group-E610FDAD83BB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null RUNNING
  s2:  RUNNING    LEADER s2@group-E610FDAD83BB:t2, leader=s2, voted=s2, raftlog=Memoized:s2@group-E610FDAD83BB-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null RUNNING
2023-10-31 16:09:01,937 [Time-limited test] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:block(135)) - block WRITE_STATE_MACHINE_DATA
2023-10-31 16:09:01,937 [Time-limited test] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:block(135)) - block WRITE_STATE_MACHINE_DATA
2023-10-31 16:09:01,947 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(891)) - s2@group-E610FDAD83BB: receive client request(RaftClientRequest:client-7A329096387B->s2@group-E610FDAD83BB, cid=1, seq=null, RW, message)
2023-10-31 16:09:01,960 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(508)) - s2@group-E610FDAD83BB-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-7A329096387B->s2@group-E610FDAD83BB, cid=1, seq=null, RW, message, entry=(t:2, i:1), STATEMACHINELOGENTRY, 1@client-7A329096387B
2023-10-31 16:09:01,965 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s1@group-E610FDAD83BB: receive appendEntries(s2, 2, (t:2, i:0), 0, true, commits:[s2:c0, s0:c0, s1:c0], cId:10, entries: [(t:2, i:1), STATEMACHINELOGENTRY, 1@client-7A329096387B]
2023-10-31 16:09:01,967 [s0-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s0@group-E610FDAD83BB: receive appendEntries(s2, 2, (t:2, i:0), 0, true, commits:[s2:c0, s0:c0, s1:c0], cId:9, entries: [(t:2, i:1), STATEMACHINELOGENTRY, 1@client-7A329096387B]
2023-10-31 16:09:01,968 [s2-client-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(891)) - s2@group-E610FDAD83BB: receive client request(RaftClientRequest:client-7A329096387B->s2@group-E610FDAD83BB, cid=2, seq=null, RW, message)
2023-10-31 16:09:01,970 [Time-limited test] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:unblock(142)) - unblock WRITE_STATE_MACHINE_DATA
2023-10-31 16:09:01,971 [Time-limited test] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:unblock(142)) - unblock WRITE_STATE_MACHINE_DATA
2023-10-31 16:09:01,971 [s0-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s0@group-E610FDAD83BB: succeeded to handle AppendEntries. Reply: s2<-s0#9:OK-t2,SUCCESS,nextIndex=2,followerCommit=0,matchIndex=1
2023-10-31 16:09:01,972 [s2-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(891)) - s2@group-E610FDAD83BB: receive client request(RaftClientRequest:client-7A329096387B->s2@group-E610FDAD83BB, cid=2, seq=null, RW, message)
2023-10-31 16:09:01,972 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s1@group-E610FDAD83BB: succeeded to handle AppendEntries. Reply: s2<-s1#10:OK-t2,SUCCESS,nextIndex=2,followerCommit=0,matchIndex=1
2023-10-31 16:09:01,975 [s2@group-E610FDAD83BB-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:applyTransaction(248)) - applyTransaction for log index 1
2023-10-31 16:09:01,976 [s2@group-E610FDAD83BB-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(205)) - s2: put 1, message -> (t:2, i:1), STATEMACHINELOGENTRY, 1@client-7A329096387B
2023-10-31 16:09:01,984 [s2-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(508)) - s2@group-E610FDAD83BB-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-7A329096387B->s2@group-E610FDAD83BB, cid=2, seq=null, RW, message, entry=(t:2, i:3), STATEMACHINELOGENTRY, 2@client-7A329096387B
2023-10-31 16:09:01,987 [s0-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s0@group-E610FDAD83BB: receive appendEntries(s2, 2, (t:2, i:1), 1, true, commits:[s2:c1, s0:c0, s1:c0], cId:10, entries: [(t:2, i:2), METADATAENTRY(c:1), (t:2, i:3), STATEMACHINELOGENTRY, 2@client-7A329096387B]
2023-10-31 16:09:01,988 [s0-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s0@group-E610FDAD83BB: succeeded to handle AppendEntries. Reply: s2<-s0#10:OK-t2,SUCCESS,nextIndex=4,followerCommit=1,matchIndex=3
2023-10-31 16:09:01,988 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s1@group-E610FDAD83BB: receive appendEntries(s2, 2, (t:2, i:1), 1, true, commits:[s2:c1, s0:c0, s1:c0], cId:11, entries: [(t:2, i:2), METADATAENTRY(c:1), (t:2, i:3), STATEMACHINELOGENTRY, 2@client-7A329096387B]
2023-10-31 16:09:01,989 [s0@group-E610FDAD83BB-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:applyTransaction(248)) - applyTransaction for log index 1
2023-10-31 16:09:01,989 [s0@group-E610FDAD83BB-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(205)) - s0: put 1, message -> (t:2, i:1), STATEMACHINELOGENTRY, 1@client-7A329096387B
2023-10-31 16:09:01,991 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s1@group-E610FDAD83BB: succeeded to handle AppendEntries. Reply: s2<-s1#11:OK-t2,SUCCESS,nextIndex=4,followerCommit=1,matchIndex=3
2023-10-31 16:09:01,992 [s1@group-E610FDAD83BB-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:applyTransaction(248)) - applyTransaction for log index 1
2023-10-31 16:09:01,992 [s1@group-E610FDAD83BB-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(205)) - s1: put 1, message -> (t:2, i:1), STATEMACHINELOGENTRY, 1@client-7A329096387B
2023-10-31 16:09:01,992 [s2@group-E610FDAD83BB-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:applyTransaction(248)) - applyTransaction for log index 3
2023-10-31 16:09:01,992 [s2@group-E610FDAD83BB-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(205)) - s2: put 3, message -> (t:2, i:3), STATEMACHINELOGENTRY, 2@client-7A329096387B
2023-10-31 16:09:01,992 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(831)) - ************************************************************** 
2023-10-31 16:09:01,992 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(832)) - *** 
2023-10-31 16:09:01,992 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(833)) - ***     Stopping MiniRaftClusterWithGrpc
2023-10-31 16:09:01,992 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(834)) - *** 
2023-10-31 16:09:01,992 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(835)) - ************************************************************** 
2023-10-31 16:09:01,993 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(836)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-E610FDAD83BB:t2, leader=s2, voted=s2, raftlog=Memoized:s0@group-E610FDAD83BB-SegmentedRaftLog:OPENED:c1, conf=0: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-E610FDAD83BB:t2, leader=s2, voted=s2, raftlog=Memoized:s1@group-E610FDAD83BB-SegmentedRaftLog:OPENED:c1, conf=0: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null RUNNING
  s2:  RUNNING    LEADER s2@group-E610FDAD83BB:t2, leader=s2, voted=s2, raftlog=Memoized:s2@group-E610FDAD83BB-SegmentedRaftLog:OPENED:c3, conf=0: peers:[s0|localhost:33069, s1|localhost:43557, s2|localhost:44705]|listeners:[], old=null RUNNING
2023-10-31 16:09:01,995 [s0-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s0@group-E610FDAD83BB: receive appendEntries(s2, 2, (t:2, i:3), 3, true, commits:[s2:c3, s0:c1, s1:c1], cId:11, entries: [(t:2, i:4), METADATAENTRY(c:3)]
2023-10-31 16:09:01,996 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s1@group-E610FDAD83BB: receive appendEntries(s2, 2, (t:2, i:3), 3, true, commits:[s2:c3, s0:c1, s1:c1], cId:13, entries: [(t:2, i:4), METADATAENTRY(c:3)]
2023-10-31 16:09:01,997 [s0@group-E610FDAD83BB-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:applyTransaction(248)) - applyTransaction for log index 3
2023-10-31 16:09:01,998 [s0@group-E610FDAD83BB-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(205)) - s0: put 3, message -> (t:2, i:3), STATEMACHINELOGENTRY, 2@client-7A329096387B
2023-10-31 16:09:01,996 [s0-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s0@group-E610FDAD83BB: succeeded to handle AppendEntries. Reply: s2<-s0#11:OK-t2,SUCCESS,nextIndex=5,followerCommit=3,matchIndex=4
2023-10-31 16:09:02,000 [s1-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s1@group-E610FDAD83BB: succeeded to handle AppendEntries. Reply: s2<-s1#13:OK-t2,SUCCESS,nextIndex=5,followerCommit=3,matchIndex=4
2023-10-31 16:09:02,000 [s1@group-E610FDAD83BB-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:applyTransaction(248)) - applyTransaction for log index 3
2023-10-31 16:09:02,000 [s1@group-E610FDAD83BB-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(205)) - s1: put 3, message -> (t:2, i:3), STATEMACHINELOGENTRY, 2@client-7A329096387B
2023-10-31 16:09:02,003 [MiniRaftCluster-2] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$9(416)) - s1: close
2023-10-31 16:09:02,007 [MiniRaftCluster-1] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$9(416)) - s0: close
2023-10-31 16:09:02,008 [s0-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$3(514)) - s0@group-E610FDAD83BB: shutdown
2023-10-31 16:09:02,008 [MiniRaftCluster-3] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$9(416)) - s2: close
2023-10-31 16:09:02,008 [s0-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-E610FDAD83BB,id=s0
2023-10-31 16:09:02,008 [s0-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(109)) - s0: shutdown s0@group-E610FDAD83BB-FollowerState
2023-10-31 16:09:02,008 [MiniRaftCluster-1] INFO  server.GrpcService (GrpcService.java:closeImpl(311)) - s0: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService now
2023-10-31 16:09:02,008 [s0-impl-thread1] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(157)) - s0@group-E610FDAD83BB-StateMachineUpdater: set stopIndex = 3
2023-10-31 16:09:02,008 [s0@group-E610FDAD83BB-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(152)) - s0@group-E610FDAD83BB-FollowerState was interrupted
2023-10-31 16:09:02,010 [s0-impl-thread1] INFO  server.RaftServer$Division (ServerState.java:close(423)) - s0@group-E610FDAD83BB: applyIndex: 3
2023-10-31 16:09:02,010 [s0@group-E610FDAD83BB-cacheEviction-AwaitToRun] INFO  util.AwaitToRun (AwaitToRun.java:run(49)) - s0@group-E610FDAD83BB-cacheEviction-AwaitToRun-AwaitForSignal is interrupted
2023-10-31 16:09:02,012 [s2-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$3(514)) - s2@group-E610FDAD83BB: shutdown
2023-10-31 16:09:02,012 [s2-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-E610FDAD83BB,id=s2
2023-10-31 16:09:02,012 [s2-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(92)) - s2: shutdown s2@group-E610FDAD83BB-LeaderStateImpl
2023-10-31 16:09:02,012 [s2-impl-thread1] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(289)) - s2@group-E610FDAD83BB-PendingRequests: sendNotLeaderResponses
2023-10-31 16:09:02,012 [s1-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$3(514)) - s1@group-E610FDAD83BB: shutdown
2023-10-31 16:09:02,012 [s2@group-E610FDAD83BB->s0-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(211)) - s2@group-E610FDAD83BB->s0-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2023-10-31 16:09:02,013 [s1-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-E610FDAD83BB,id=s1
2023-10-31 16:09:02,013 [s1-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(109)) - s1: shutdown s1@group-E610FDAD83BB-FollowerState
2023-10-31 16:09:02,013 [s1@group-E610FDAD83BB-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(152)) - s1@group-E610FDAD83BB-FollowerState was interrupted
2023-10-31 16:09:02,013 [s1-impl-thread1] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(157)) - s1@group-E610FDAD83BB-StateMachineUpdater: set stopIndex = 3
2023-10-31 16:09:02,014 [s1-impl-thread1] INFO  server.RaftServer$Division (ServerState.java:close(423)) - s1@group-E610FDAD83BB: applyIndex: 3
2023-10-31 16:09:02,014 [s1@group-E610FDAD83BB-cacheEviction-AwaitToRun] INFO  util.AwaitToRun (AwaitToRun.java:run(49)) - s1@group-E610FDAD83BB-cacheEviction-AwaitToRun-AwaitForSignal is interrupted
2023-10-31 16:09:02,015 [s2@group-E610FDAD83BB->s1-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(211)) - s2@group-E610FDAD83BB->s1-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2023-10-31 16:09:02,015 [MiniRaftCluster-2] INFO  server.GrpcService (GrpcService.java:closeImpl(311)) - s1: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService now
2023-10-31 16:09:02,017 [grpc-default-executor-0] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(157)) - s0: Completed APPEND_ENTRIES, lastRequest: s2->s0#11-t2,previous=(t:2, i:3),leaderCommit=3,initializing? true,entries: size=1, first=(t:2, i:4), METADATAENTRY(c:3)
2023-10-31 16:09:02,017 [grpc-default-executor-0] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:lambda$onCompleted$5(159)) - s0: Completed APPEND_ENTRIES, lastReply: null
2023-10-31 16:09:02,017 [MiniRaftCluster-3] INFO  server.GrpcService (GrpcService.java:closeImpl(311)) - s2: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService now
2023-10-31 16:09:02,017 [grpc-default-executor-6] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(157)) - s1: Completed APPEND_ENTRIES, lastRequest: s2->s1#13-t2,previous=(t:2, i:3),leaderCommit=3,initializing? true,entries: size=1, first=(t:2, i:4), METADATAENTRY(c:3)
2023-10-31 16:09:02,020 [grpc-default-executor-6] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:lambda$onCompleted$5(159)) - s1: Completed APPEND_ENTRIES, lastReply: null
2023-10-31 16:09:02,017 [grpc-default-executor-2] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(157)) - s0: Completed APPEND_ENTRIES, lastRequest: null
2023-10-31 16:09:02,022 [grpc-default-executor-2] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:lambda$onCompleted$5(159)) - s0: Completed APPEND_ENTRIES, lastReply: serverReply {
  requestorId: "s2"
  replyId: "s0"
  raftGroupId {
    id: "\t\223\366xU\315E\037\204X\346\020\375\255\203\273"
  }
  callId: 8
  success: true
}
term: 2
nextIndex: 1
matchIndex: 18446744073709551615
isHearbeat: true

2023-10-31 16:09:02,017 [grpc-default-executor-4] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(157)) - s1: Completed APPEND_ENTRIES, lastRequest: null
2023-10-31 16:09:02,022 [grpc-default-executor-4] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:lambda$onCompleted$5(159)) - s1: Completed APPEND_ENTRIES, lastReply: serverReply {
  requestorId: "s2"
  replyId: "s1"
  raftGroupId {
    id: "\t\223\366xU\315E\037\204X\346\020\375\255\203\273"
  }
  callId: 9
  success: true
}
term: 2
nextIndex: 1
matchIndex: 18446744073709551615
isHearbeat: true

2023-10-31 16:09:02,025 [grpc-default-executor-6] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(468)) - s2@group-E610FDAD83BB->s0-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2023-10-31 16:09:02,018 [grpc-default-executor-3] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(468)) - s2@group-E610FDAD83BB->s0-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2023-10-31 16:09:02,027 [grpc-default-executor-0] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(468)) - s2@group-E610FDAD83BB->s1-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2023-10-31 16:09:02,028 [grpc-default-executor-0] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(468)) - s2@group-E610FDAD83BB->s1-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2023-10-31 16:09:02,023 [s2-impl-thread1] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(157)) - s2@group-E610FDAD83BB-StateMachineUpdater: set stopIndex = 4
2023-10-31 16:09:02,029 [s2-impl-thread1] INFO  server.RaftServer$Division (ServerState.java:close(423)) - s2@group-E610FDAD83BB: applyIndex: 4
2023-10-31 16:09:02,029 [s2@group-E610FDAD83BB-cacheEviction-AwaitToRun] INFO  util.AwaitToRun (AwaitToRun.java:run(49)) - s2@group-E610FDAD83BB-cacheEviction-AwaitToRun-AwaitForSignal is interrupted
2023-10-31 16:09:02,030 [Thread-80] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:close(103)) - s0 Close channels
2023-10-31 16:09:02,034 [Thread-82] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:close(103)) - s0 Close channels
2023-10-31 16:09:02,035 [Thread-83] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:close(103)) - s1 Close channels
2023-10-31 16:09:02,036 [Thread-86] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:close(103)) - s2 Close channels
2023-10-31 16:09:02,039 [Thread-87] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:close(103)) - s1 Close channels
2023-10-31 16:09:02,042 [Thread-88] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:close(103)) - s2 Close channels
2023-10-31 16:09:02,043 [MiniRaftCluster-2] INFO  server.GrpcService (GrpcService.java:closeImpl(320)) - s1: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService successfully
2023-10-31 16:09:02,043 [MiniRaftCluster-2] INFO  server.GrpcService (GrpcService.java:closeImpl(311)) - s1: shutdown server GrpcServerProtocolService now
2023-10-31 16:09:02,046 [MiniRaftCluster-3] INFO  server.GrpcService (GrpcService.java:closeImpl(320)) - s2: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService successfully
2023-10-31 16:09:02,046 [MiniRaftCluster-3] INFO  server.GrpcService (GrpcService.java:closeImpl(311)) - s2: shutdown server GrpcServerProtocolService now
2023-10-31 16:09:02,058 [MiniRaftCluster-1] INFO  server.GrpcService (GrpcService.java:closeImpl(320)) - s0: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService successfully
2023-10-31 16:09:02,058 [MiniRaftCluster-1] INFO  server.GrpcService (GrpcService.java:closeImpl(311)) - s0: shutdown server GrpcServerProtocolService now
2023-10-31 16:09:02,058 [MiniRaftCluster-2] INFO  server.GrpcService (GrpcService.java:closeImpl(320)) - s1: shutdown server GrpcServerProtocolService successfully
2023-10-31 16:09:02,058 [MiniRaftCluster-2] INFO  server.GrpcService (GrpcService.java:closeImpl(311)) - s1: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService now
2023-10-31 16:09:02,071 [MiniRaftCluster-3] INFO  server.GrpcService (GrpcService.java:closeImpl(320)) - s2: shutdown server GrpcServerProtocolService successfully
2023-10-31 16:09:02,071 [MiniRaftCluster-3] INFO  server.GrpcService (GrpcService.java:closeImpl(311)) - s2: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService now
2023-10-31 16:09:02,074 [MiniRaftCluster-1] INFO  server.GrpcService (GrpcService.java:closeImpl(320)) - s0: shutdown server GrpcServerProtocolService successfully
2023-10-31 16:09:02,074 [MiniRaftCluster-1] INFO  server.GrpcService (GrpcService.java:closeImpl(311)) - s0: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService now
2023-10-31 16:09:02,074 [MiniRaftCluster-2] INFO  server.GrpcService (GrpcService.java:closeImpl(320)) - s1: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService successfully
2023-10-31 16:09:02,082 [MiniRaftCluster-3] INFO  server.GrpcService (GrpcService.java:closeImpl(320)) - s2: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService successfully
2023-10-31 16:09:02,086 [MiniRaftCluster-1] INFO  server.GrpcService (GrpcService.java:closeImpl(320)) - s0: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService successfully
2023-10-31 16:09:02,995 [s2-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(243)) - s2@group-E610FDAD83BB-SegmentedRaftLogWorker close()
2023-10-31 16:09:02,998 [s0-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(243)) - s0@group-E610FDAD83BB-SegmentedRaftLogWorker close()
2023-10-31 16:09:02,999 [JvmPauseMonitor0] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(152)) - JvmPauseMonitor-s0: Stopped
2023-10-31 16:09:03,000 [JvmPauseMonitor2] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(152)) - JvmPauseMonitor-s2: Stopped
2023-10-31 16:09:03,001 [s1-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(243)) - s1@group-E610FDAD83BB-SegmentedRaftLogWorker close()
2023-10-31 16:09:03,002 [JvmPauseMonitor1] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(152)) - JvmPauseMonitor-s1: Stopped
2023-10-31 16:09:03,003 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(855)) - MiniRaftClusterWithGrpc shutdown completed
2023-10-31 16:09:03,004 [main] INFO  util.LogUtils (Slf4jUtils.java:setLogLevel(38)) - Successfully set org.apache.ratis.conf.ConfUtils log level to WARN
2023-10-31 16:09:03,004 [main] INFO  util.LogUtils (Slf4jUtils.java:setLogLevel(38)) - Successfully set org.apache.ratis.util.FileUtils log level to TRACE
2023-10-31 16:09:03,004 [main] INFO  util.LogUtils (Slf4jUtils.java:setLogLevel(38)) - Successfully set org.apache.ratis.server.RetryCache log level to TRACE
2023-10-31 16:09:03,011 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:runWithNewCluster(135)) - Running runWithNewCluster
2023-10-31 16:09:03,012 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:<init>(306)) - new MiniRaftClusterWithGrpc with group-4D7A7540CAE6:[s0|localhost:35653, s1|localhost:45465, s2|localhost:37497]
2023-10-31 16:09:03,012 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(339)) - .............................................................. 
2023-10-31 16:09:03,012 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(340)) - ... 
2023-10-31 16:09:03,012 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(341)) - ...     Starting MiniRaftClusterWithGrpc
2023-10-31 16:09:03,012 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(342)) - ... 
2023-10-31 16:09:03,012 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(343)) - .............................................................. 
2023-10-31 16:09:03,012 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:initServers(318)) - servers = {}
2023-10-31 16:09:03,012 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(382)) - newRaftServer: s0, group-4D7A7540CAE6:[s0|localhost:35653, s1|localhost:45465, s2|localhost:37497], format? true
2023-10-31 16:09:03,012 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(305)) - deleteFully target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s0
2023-10-31 16:09:03,013 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(318)) - deleteFully: target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s0 does not exist.
2023-10-31 16:09:03,013 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(387)) - Formatted directory target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s0
2023-10-31 16:09:03,013 [Time-limited test] INFO  server.RaftServer (ConfUtils.java:logGet(46)) - raft.rpc.type = GRPC (default)
2023-10-31 16:09:03,013 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.admin.host = null (fallback to raft.grpc.server.host)
2023-10-31 16:09:03,013 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.admin.port = 39797 (custom)
2023-10-31 16:09:03,013 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.client.host = null (fallback to raft.grpc.server.host)
2023-10-31 16:09:03,013 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.client.port = 37937 (custom)
2023-10-31 16:09:03,013 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.host = null (default)
2023-10-31 16:09:03,013 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.port = 35653 (custom)
2023-10-31 16:09:03,013 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.message.size.max = 64MB (=67108864) (default)
2023-10-31 16:09:03,014 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:03,014 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2023-10-31 16:09:03,014 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:03,014 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:03,014 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.cached = true (default)
2023-10-31 16:09:03,014 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.size = 32 (default)
2023-10-31 16:09:03,015 [Time-limited test] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(46)) - raft.datastream.type = DISABLED (default)
2023-10-31 16:09:03,015 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.sleep.deviation.threshold = 300ms (default)
2023-10-31 16:09:03,015 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.close.threshold = 60s (default)
2023-10-31 16:09:03,016 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2023-10-31 16:09:03,016 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s0] (custom)
2023-10-31 16:09:03,016 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.cached = true (default)
2023-10-31 16:09:03,016 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.size = 0 (default)
2023-10-31 16:09:03,018 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:addNew(100)) - s0: addNew group-4D7A7540CAE6:[s0|localhost:35653, s1|localhost:45465, s2|localhost:37497] returns group-4D7A7540CAE6:java.util.concurrent.CompletableFuture@72c6ede9[Not completed]
2023-10-31 16:09:03,018 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(382)) - newRaftServer: s1, group-4D7A7540CAE6:[s0|localhost:35653, s1|localhost:45465, s2|localhost:37497], format? true
2023-10-31 16:09:03,018 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(305)) - deleteFully target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s1
2023-10-31 16:09:03,018 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(318)) - deleteFully: target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s1 does not exist.
2023-10-31 16:09:03,018 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(387)) - Formatted directory target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s1
2023-10-31 16:09:03,018 [Time-limited test] INFO  server.RaftServer (ConfUtils.java:logGet(46)) - raft.rpc.type = GRPC (default)
2023-10-31 16:09:03,018 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.admin.host = null (fallback to raft.grpc.server.host)
2023-10-31 16:09:03,018 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.admin.port = 35667 (custom)
2023-10-31 16:09:03,019 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.client.host = null (fallback to raft.grpc.server.host)
2023-10-31 16:09:03,019 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.client.port = 37189 (custom)
2023-10-31 16:09:03,019 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.host = null (default)
2023-10-31 16:09:03,019 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.port = 45465 (custom)
2023-10-31 16:09:03,019 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.message.size.max = 64MB (=67108864) (default)
2023-10-31 16:09:03,019 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:03,019 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2023-10-31 16:09:03,019 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:03,019 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:03,019 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.cached = true (default)
2023-10-31 16:09:03,019 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.size = 32 (default)
2023-10-31 16:09:03,020 [Time-limited test] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(46)) - raft.datastream.type = DISABLED (default)
2023-10-31 16:09:03,020 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.sleep.deviation.threshold = 300ms (default)
2023-10-31 16:09:03,020 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.close.threshold = 60s (default)
2023-10-31 16:09:03,020 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2023-10-31 16:09:03,020 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s1] (custom)
2023-10-31 16:09:03,021 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.cached = true (default)
2023-10-31 16:09:03,021 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.size = 0 (default)
2023-10-31 16:09:03,022 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 32MB (=33554432) (default)
2023-10-31 16:09:03,022 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2023-10-31 16:09:03,022 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2023-10-31 16:09:03,022 [s0-groupManagement] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(255)) - s0: new RaftServerImpl for group-4D7A7540CAE6:[s0|localhost:35653, s1|localhost:45465, s2|localhost:37497] with SimpleStateMachine4Testing:uninitialized
2023-10-31 16:09:03,022 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.min = 150ms (default)
2023-10-31 16:09:03,022 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2023-10-31 16:09:03,022 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.sleep.time = 25ms (default)
2023-10-31 16:09:03,022 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2023-10-31 16:09:03,022 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2023-10-31 16:09:03,022 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.sleep.deviation.threshold = 300ms (default)
2023-10-31 16:09:03,023 [s0-groupManagement] INFO  server.RaftServer$Division (ServerState.java:<init>(113)) - s0@group-4D7A7540CAE6: ConfigurationManager, init=-1: peers:[s0|localhost:35653, s1|localhost:45465, s2|localhost:37497]|listeners:[], old=null, confs=<EMPTY_MAP>
2023-10-31 16:09:03,023 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.notification.no-leader.timeout = 60s (default)
2023-10-31 16:09:03,023 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.timeout = 10s (default)
2023-10-31 16:09:03,023 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.expirytime = 60s (default)
2023-10-31 16:09:03,023 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2023-10-31 16:09:03,024 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.option = DEFAULT (default)
2023-10-31 16:09:03,024 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.read-after-write-consistent.write-index-cache.expiry-time = 60s (default)
2023-10-31 16:09:03,033 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:03,033 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:03,033 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.cached = true (default)
2023-10-31 16:09:03,033 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.size = 0 (default)
2023-10-31 16:09:03,033 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.cached = true (default)
2023-10-31 16:09:03,033 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.size = 0 (default)
2023-10-31 16:09:03,034 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:addNew(100)) - s1: addNew group-4D7A7540CAE6:[s0|localhost:35653, s1|localhost:45465, s2|localhost:37497] returns group-4D7A7540CAE6:java.util.concurrent.CompletableFuture@5785041a[Not completed]
2023-10-31 16:09:03,034 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(382)) - newRaftServer: s2, group-4D7A7540CAE6:[s0|localhost:35653, s1|localhost:45465, s2|localhost:37497], format? true
2023-10-31 16:09:03,034 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(305)) - deleteFully target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s2
2023-10-31 16:09:03,034 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(318)) - deleteFully: target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s2 does not exist.
2023-10-31 16:09:03,034 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(387)) - Formatted directory target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s2
2023-10-31 16:09:03,035 [Time-limited test] INFO  server.RaftServer (ConfUtils.java:logGet(46)) - raft.rpc.type = GRPC (default)
2023-10-31 16:09:03,035 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.admin.host = null (fallback to raft.grpc.server.host)
2023-10-31 16:09:03,035 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.admin.port = 42563 (custom)
2023-10-31 16:09:03,035 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.client.host = null (fallback to raft.grpc.server.host)
2023-10-31 16:09:03,035 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.client.port = 42947 (custom)
2023-10-31 16:09:03,035 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.host = null (default)
2023-10-31 16:09:03,035 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.port = 37497 (custom)
2023-10-31 16:09:03,035 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.message.size.max = 64MB (=67108864) (default)
2023-10-31 16:09:03,035 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:03,035 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2023-10-31 16:09:03,035 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:03,035 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:03,035 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.cached = true (default)
2023-10-31 16:09:03,035 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.size = 32 (default)
2023-10-31 16:09:03,036 [Time-limited test] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(46)) - raft.datastream.type = DISABLED (default)
2023-10-31 16:09:03,037 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.sleep.deviation.threshold = 300ms (default)
2023-10-31 16:09:03,037 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.close.threshold = 60s (default)
2023-10-31 16:09:03,037 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2023-10-31 16:09:03,037 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s2] (custom)
2023-10-31 16:09:03,037 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.cached = true (default)
2023-10-31 16:09:03,037 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.size = 0 (default)
2023-10-31 16:09:03,038 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 32MB (=33554432) (default)
2023-10-31 16:09:03,038 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2023-10-31 16:09:03,038 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2023-10-31 16:09:03,038 [s1-groupManagement] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(255)) - s1: new RaftServerImpl for group-4D7A7540CAE6:[s0|localhost:35653, s1|localhost:45465, s2|localhost:37497] with SimpleStateMachine4Testing:uninitialized
2023-10-31 16:09:03,038 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.min = 150ms (default)
2023-10-31 16:09:03,038 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2023-10-31 16:09:03,038 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.sleep.time = 25ms (default)
2023-10-31 16:09:03,038 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2023-10-31 16:09:03,038 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2023-10-31 16:09:03,039 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.sleep.deviation.threshold = 300ms (default)
2023-10-31 16:09:03,039 [s1-groupManagement] INFO  server.RaftServer$Division (ServerState.java:<init>(113)) - s1@group-4D7A7540CAE6: ConfigurationManager, init=-1: peers:[s0|localhost:35653, s1|localhost:45465, s2|localhost:37497]|listeners:[], old=null, confs=<EMPTY_MAP>
2023-10-31 16:09:03,039 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.notification.no-leader.timeout = 60s (default)
2023-10-31 16:09:03,039 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.timeout = 10s (default)
2023-10-31 16:09:03,039 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.expirytime = 60s (default)
2023-10-31 16:09:03,039 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2023-10-31 16:09:03,039 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.option = DEFAULT (default)
2023-10-31 16:09:03,039 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.read-after-write-consistent.write-index-cache.expiry-time = 60s (default)
2023-10-31 16:09:03,040 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:03,040 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:03,040 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.cached = true (default)
2023-10-31 16:09:03,040 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.size = 0 (default)
2023-10-31 16:09:03,040 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.cached = true (default)
2023-10-31 16:09:03,041 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.size = 0 (default)
2023-10-31 16:09:03,041 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:addNew(100)) - s2: addNew group-4D7A7540CAE6:[s0|localhost:35653, s1|localhost:45465, s2|localhost:37497] returns group-4D7A7540CAE6:java.util.concurrent.CompletableFuture@33db5c57[Not completed]
2023-10-31 16:09:03,042 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2023-10-31 16:09:03,042 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.corruption.policy = EXCEPTION (default)
2023-10-31 16:09:03,042 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s0] (custom)
2023-10-31 16:09:03,042 [s0-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(138)) - The storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s0/0f60c322-de48-4f3c-a8b9-4d7a7540cae6 does not exist. Creating ...
2023-10-31 16:09:03,043 [s0-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s0/0f60c322-de48-4f3c-a8b9-4d7a7540cae6
2023-10-31 16:09:03,045 [s0-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(232)) - Lock on /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s0/0f60c322-de48-4f3c-a8b9-4d7a7540cae6/in_use.lock acquired by nodename 15111@fv-az220-516
2023-10-31 16:09:03,045 [s0-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s0/0f60c322-de48-4f3c-a8b9-4d7a7540cae6/current
2023-10-31 16:09:03,045 [s0-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s0/0f60c322-de48-4f3c-a8b9-4d7a7540cae6/sm
2023-10-31 16:09:03,045 [s0-impl-thread1] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s0/0f60c322-de48-4f3c-a8b9-4d7a7540cae6/current/raft-meta.tmp with options [CREATE, WRITE]: sun.nio.ch.FileChannelImpl@3889b095
2023-10-31 16:09:03,046 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 32MB (=33554432) (default)
2023-10-31 16:09:03,046 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2023-10-31 16:09:03,046 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2023-10-31 16:09:03,046 [s2-groupManagement] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(255)) - s2: new RaftServerImpl for group-4D7A7540CAE6:[s0|localhost:35653, s1|localhost:45465, s2|localhost:37497] with SimpleStateMachine4Testing:uninitialized
2023-10-31 16:09:03,047 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.min = 150ms (default)
2023-10-31 16:09:03,047 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2023-10-31 16:09:03,047 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.sleep.time = 25ms (default)
2023-10-31 16:09:03,047 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2023-10-31 16:09:03,047 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2023-10-31 16:09:03,047 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.sleep.deviation.threshold = 300ms (default)
2023-10-31 16:09:03,047 [s0-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s0/0f60c322-de48-4f3c-a8b9-4d7a7540cae6/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s0/0f60c322-de48-4f3c-a8b9-4d7a7540cae6/current/raft-meta with options [REPLACE_EXISTING]
2023-10-31 16:09:03,047 [s0-impl-thread1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(97)) - Storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s0/0f60c322-de48-4f3c-a8b9-4d7a7540cae6 has been successfully formatted.
2023-10-31 16:09:03,047 [s0-impl-thread1] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:initialize(213)) - Initializing SimpleStateMachine4Testing:uninitialized
2023-10-31 16:09:03,047 [s0-impl-thread1] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:loadSnapshot(296)) - Loading snapshot null
2023-10-31 16:09:03,048 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.use.memory = false (default)
2023-10-31 16:09:03,048 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.gap = 1024 (default)
2023-10-31 16:09:03,048 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:03,048 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.read.timeout = 1000ms (default)
2023-10-31 16:09:03,048 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.preservation.log.num = 0 (default)
2023-10-31 16:09:03,048 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 32MB (=33554432) (default)
2023-10-31 16:09:03,049 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.num.max = 6 (default)
2023-10-31 16:09:03,049 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2023-10-31 16:09:03,049 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:03,052 [s2-groupManagement] INFO  server.RaftServer$Division (ServerState.java:<init>(113)) - s2@group-4D7A7540CAE6: ConfigurationManager, init=-1: peers:[s0|localhost:35653, s1|localhost:45465, s2|localhost:37497]|listeners:[], old=null, confs=<EMPTY_MAP>
2023-10-31 16:09:03,052 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.notification.no-leader.timeout = 60s (default)
2023-10-31 16:09:03,052 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.timeout = 10s (default)
2023-10-31 16:09:03,052 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.expirytime = 60s (default)
2023-10-31 16:09:03,052 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2023-10-31 16:09:03,052 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.option = DEFAULT (default)
2023-10-31 16:09:03,052 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.read-after-write-consistent.write-index-cache.expiry-time = 60s (default)
2023-10-31 16:09:03,053 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:03,054 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:03,054 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.cached = true (default)
2023-10-31 16:09:03,054 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.size = 0 (default)
2023-10-31 16:09:03,054 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.cached = true (default)
2023-10-31 16:09:03,054 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.size = 0 (default)
2023-10-31 16:09:03,058 [s0-impl-thread1] INFO  util.AwaitToRun (AwaitToRun.java:start(81)) - Thread[s0@group-4D7A7540CAE6-cacheEviction-AwaitToRun,5,main] started
2023-10-31 16:09:03,058 [s0-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(184)) - new s0@group-4D7A7540CAE6-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s0/0f60c322-de48-4f3c-a8b9-4d7a7540cae6
2023-10-31 16:09:03,058 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2023-10-31 16:09:03,058 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.element-limit = 4096 (default)
2023-10-31 16:09:03,058 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 32MB (=33554432) (default)
2023-10-31 16:09:03,058 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2023-10-31 16:09:03,058 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.force.sync.num = 128 (default)
2023-10-31 16:09:03,058 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync = true (default)
2023-10-31 16:09:03,058 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2023-10-31 16:09:03,058 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2023-10-31 16:09:03,059 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2023-10-31 16:09:03,059 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:03,059 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.unsafe-flush.enabled = false (default)
2023-10-31 16:09:03,059 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.async-flush.enabled = false (default)
2023-10-31 16:09:03,059 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.caching.enabled = false (default)
2023-10-31 16:09:03,060 [s0-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(135)) - s0@group-4D7A7540CAE6-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2023-10-31 16:09:03,060 [s0-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(135)) - s0@group-4D7A7540CAE6-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2023-10-31 16:09:03,062 [s0-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(390)) - s0@group-4D7A7540CAE6: start as a follower, conf=-1: peers:[s0|localhost:35653, s1|localhost:45465, s2|localhost:37497]|listeners:[], old=null
2023-10-31 16:09:03,062 [s0-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s0@group-4D7A7540CAE6: changes role from      null to FOLLOWER at term 0 for startAsFollower
2023-10-31 16:09:03,062 [s0-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s0: start s0@group-4D7A7540CAE6-FollowerState
2023-10-31 16:09:03,064 [s0-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-4D7A7540CAE6,id=s0
2023-10-31 16:09:03,064 [s0@group-4D7A7540CAE6-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2023-10-31 16:09:03,064 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.trigger-when-stop.enabled = true (default)
2023-10-31 16:09:03,064 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.auto.trigger.enabled = false (default)
2023-10-31 16:09:03,064 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.retention.file.num = -1 (default)
2023-10-31 16:09:03,064 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.upto.snapshot.index = false (default)
2023-10-31 16:09:03,066 [s0@group-4D7A7540CAE6-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2023-10-31 16:09:03,066 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:startImpl(406)) - s0: start RPC server
2023-10-31 16:09:03,067 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s0: GrpcService started, listening on 37937
2023-10-31 16:09:03,068 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s0: GrpcService started, listening on 35653
2023-10-31 16:09:03,068 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s0: GrpcService started, listening on 39797
2023-10-31 16:09:03,068 [JvmPauseMonitor3] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(146)) - JvmPauseMonitor-s0: Started
2023-10-31 16:09:03,068 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2023-10-31 16:09:03,069 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.corruption.policy = EXCEPTION (default)
2023-10-31 16:09:03,069 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s1] (custom)
2023-10-31 16:09:03,069 [s1-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(138)) - The storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s1/0f60c322-de48-4f3c-a8b9-4d7a7540cae6 does not exist. Creating ...
2023-10-31 16:09:03,069 [s1-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s1/0f60c322-de48-4f3c-a8b9-4d7a7540cae6
2023-10-31 16:09:03,071 [s1-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(232)) - Lock on /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s1/0f60c322-de48-4f3c-a8b9-4d7a7540cae6/in_use.lock acquired by nodename 15111@fv-az220-516
2023-10-31 16:09:03,072 [s1-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s1/0f60c322-de48-4f3c-a8b9-4d7a7540cae6/current
2023-10-31 16:09:03,072 [s1-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s1/0f60c322-de48-4f3c-a8b9-4d7a7540cae6/sm
2023-10-31 16:09:03,072 [s1-impl-thread1] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s1/0f60c322-de48-4f3c-a8b9-4d7a7540cae6/current/raft-meta.tmp with options [CREATE, WRITE]: sun.nio.ch.FileChannelImpl@60575c6d
2023-10-31 16:09:03,074 [s1-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s1/0f60c322-de48-4f3c-a8b9-4d7a7540cae6/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s1/0f60c322-de48-4f3c-a8b9-4d7a7540cae6/current/raft-meta with options [REPLACE_EXISTING]
2023-10-31 16:09:03,074 [s1-impl-thread1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(97)) - Storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s1/0f60c322-de48-4f3c-a8b9-4d7a7540cae6 has been successfully formatted.
2023-10-31 16:09:03,075 [s1-impl-thread1] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:initialize(213)) - Initializing SimpleStateMachine4Testing:uninitialized
2023-10-31 16:09:03,075 [s1-impl-thread1] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:loadSnapshot(296)) - Loading snapshot null
2023-10-31 16:09:03,075 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.use.memory = false (default)
2023-10-31 16:09:03,075 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.gap = 1024 (default)
2023-10-31 16:09:03,075 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:03,075 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.read.timeout = 1000ms (default)
2023-10-31 16:09:03,075 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.preservation.log.num = 0 (default)
2023-10-31 16:09:03,076 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 32MB (=33554432) (default)
2023-10-31 16:09:03,076 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.num.max = 6 (default)
2023-10-31 16:09:03,076 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2023-10-31 16:09:03,076 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:03,078 [s1-impl-thread1] INFO  util.AwaitToRun (AwaitToRun.java:start(81)) - Thread[s1@group-4D7A7540CAE6-cacheEviction-AwaitToRun,5,main] started
2023-10-31 16:09:03,078 [s1-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(184)) - new s1@group-4D7A7540CAE6-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s1/0f60c322-de48-4f3c-a8b9-4d7a7540cae6
2023-10-31 16:09:03,078 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2023-10-31 16:09:03,078 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.element-limit = 4096 (default)
2023-10-31 16:09:03,078 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 32MB (=33554432) (default)
2023-10-31 16:09:03,078 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2023-10-31 16:09:03,078 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.force.sync.num = 128 (default)
2023-10-31 16:09:03,078 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync = true (default)
2023-10-31 16:09:03,078 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2023-10-31 16:09:03,078 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2023-10-31 16:09:03,078 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2023-10-31 16:09:03,078 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:03,079 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.unsafe-flush.enabled = false (default)
2023-10-31 16:09:03,079 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.async-flush.enabled = false (default)
2023-10-31 16:09:03,079 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.caching.enabled = false (default)
2023-10-31 16:09:03,079 [s1-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(135)) - s1@group-4D7A7540CAE6-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2023-10-31 16:09:03,079 [s1-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(135)) - s1@group-4D7A7540CAE6-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2023-10-31 16:09:03,082 [s1-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(390)) - s1@group-4D7A7540CAE6: start as a follower, conf=-1: peers:[s0|localhost:35653, s1|localhost:45465, s2|localhost:37497]|listeners:[], old=null
2023-10-31 16:09:03,083 [s1-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s1@group-4D7A7540CAE6: changes role from      null to FOLLOWER at term 0 for startAsFollower
2023-10-31 16:09:03,083 [s1-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s1: start s1@group-4D7A7540CAE6-FollowerState
2023-10-31 16:09:03,083 [s1@group-4D7A7540CAE6-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2023-10-31 16:09:03,083 [s1@group-4D7A7540CAE6-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2023-10-31 16:09:03,083 [s1-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-4D7A7540CAE6,id=s1
2023-10-31 16:09:03,084 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.trigger-when-stop.enabled = true (default)
2023-10-31 16:09:03,084 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.auto.trigger.enabled = false (default)
2023-10-31 16:09:03,084 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.retention.file.num = -1 (default)
2023-10-31 16:09:03,084 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.upto.snapshot.index = false (default)
2023-10-31 16:09:03,086 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:startImpl(406)) - s1: start RPC server
2023-10-31 16:09:03,087 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s1: GrpcService started, listening on 37189
2023-10-31 16:09:03,088 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s1: GrpcService started, listening on 45465
2023-10-31 16:09:03,088 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s1: GrpcService started, listening on 35667
2023-10-31 16:09:03,089 [JvmPauseMonitor4] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(146)) - JvmPauseMonitor-s1: Started
2023-10-31 16:09:03,089 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2023-10-31 16:09:03,089 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.corruption.policy = EXCEPTION (default)
2023-10-31 16:09:03,089 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s2] (custom)
2023-10-31 16:09:03,089 [s2-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(138)) - The storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s2/0f60c322-de48-4f3c-a8b9-4d7a7540cae6 does not exist. Creating ...
2023-10-31 16:09:03,090 [s2-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s2/0f60c322-de48-4f3c-a8b9-4d7a7540cae6
2023-10-31 16:09:03,093 [s2-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(232)) - Lock on /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s2/0f60c322-de48-4f3c-a8b9-4d7a7540cae6/in_use.lock acquired by nodename 15111@fv-az220-516
2023-10-31 16:09:03,093 [s2-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s2/0f60c322-de48-4f3c-a8b9-4d7a7540cae6/current
2023-10-31 16:09:03,093 [s2-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s2/0f60c322-de48-4f3c-a8b9-4d7a7540cae6/sm
2023-10-31 16:09:03,093 [s2-impl-thread1] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s2/0f60c322-de48-4f3c-a8b9-4d7a7540cae6/current/raft-meta.tmp with options [CREATE, WRITE]: sun.nio.ch.FileChannelImpl@57d27bcd
2023-10-31 16:09:03,095 [s2-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s2/0f60c322-de48-4f3c-a8b9-4d7a7540cae6/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s2/0f60c322-de48-4f3c-a8b9-4d7a7540cae6/current/raft-meta with options [REPLACE_EXISTING]
2023-10-31 16:09:03,095 [s2-impl-thread1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(97)) - Storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s2/0f60c322-de48-4f3c-a8b9-4d7a7540cae6 has been successfully formatted.
2023-10-31 16:09:03,095 [s2-impl-thread1] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:initialize(213)) - Initializing SimpleStateMachine4Testing:uninitialized
2023-10-31 16:09:03,095 [s2-impl-thread1] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:loadSnapshot(296)) - Loading snapshot null
2023-10-31 16:09:03,095 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.use.memory = false (default)
2023-10-31 16:09:03,095 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.gap = 1024 (default)
2023-10-31 16:09:03,095 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:03,095 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.read.timeout = 1000ms (default)
2023-10-31 16:09:03,095 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.preservation.log.num = 0 (default)
2023-10-31 16:09:03,096 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 32MB (=33554432) (default)
2023-10-31 16:09:03,096 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.num.max = 6 (default)
2023-10-31 16:09:03,096 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2023-10-31 16:09:03,096 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:03,101 [s2-impl-thread1] INFO  util.AwaitToRun (AwaitToRun.java:start(81)) - Thread[s2@group-4D7A7540CAE6-cacheEviction-AwaitToRun,5,main] started
2023-10-31 16:09:03,101 [s2-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(184)) - new s2@group-4D7A7540CAE6-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s2/0f60c322-de48-4f3c-a8b9-4d7a7540cae6
2023-10-31 16:09:03,101 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2023-10-31 16:09:03,101 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.element-limit = 4096 (default)
2023-10-31 16:09:03,101 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 32MB (=33554432) (default)
2023-10-31 16:09:03,101 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2023-10-31 16:09:03,101 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.force.sync.num = 128 (default)
2023-10-31 16:09:03,101 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync = true (default)
2023-10-31 16:09:03,101 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2023-10-31 16:09:03,101 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2023-10-31 16:09:03,102 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2023-10-31 16:09:03,102 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:03,102 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.unsafe-flush.enabled = false (default)
2023-10-31 16:09:03,102 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.async-flush.enabled = false (default)
2023-10-31 16:09:03,102 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.caching.enabled = false (default)
2023-10-31 16:09:03,103 [s2-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(135)) - s2@group-4D7A7540CAE6-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2023-10-31 16:09:03,103 [s2-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(135)) - s2@group-4D7A7540CAE6-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2023-10-31 16:09:03,103 [s2-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(390)) - s2@group-4D7A7540CAE6: start as a follower, conf=-1: peers:[s0|localhost:35653, s1|localhost:45465, s2|localhost:37497]|listeners:[], old=null
2023-10-31 16:09:03,103 [s2-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s2@group-4D7A7540CAE6: changes role from      null to FOLLOWER at term 0 for startAsFollower
2023-10-31 16:09:03,103 [s2-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s2: start s2@group-4D7A7540CAE6-FollowerState
2023-10-31 16:09:03,103 [s2@group-4D7A7540CAE6-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2023-10-31 16:09:03,103 [s2-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-4D7A7540CAE6,id=s2
2023-10-31 16:09:03,103 [s2@group-4D7A7540CAE6-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2023-10-31 16:09:03,104 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.trigger-when-stop.enabled = true (default)
2023-10-31 16:09:03,104 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.auto.trigger.enabled = false (default)
2023-10-31 16:09:03,104 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.retention.file.num = -1 (default)
2023-10-31 16:09:03,104 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.upto.snapshot.index = false (default)
2023-10-31 16:09:03,106 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:startImpl(406)) - s2: start RPC server
2023-10-31 16:09:03,107 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s2: GrpcService started, listening on 42947
2023-10-31 16:09:03,108 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s2: GrpcService started, listening on 37497
2023-10-31 16:09:03,109 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s2: GrpcService started, listening on 42563
2023-10-31 16:09:03,109 [JvmPauseMonitor5] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(146)) - JvmPauseMonitor-s2: Started
2023-10-31 16:09:03,110 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2023-10-31 16:09:03,110 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(100)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-4D7A7540CAE6:t0, leader=null, voted=, raftlog=Memoized:s0@group-4D7A7540CAE6-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:35653, s1|localhost:45465, s2|localhost:37497]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4D7A7540CAE6:t0, leader=null, voted=, raftlog=Memoized:s1@group-4D7A7540CAE6-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:35653, s1|localhost:45465, s2|localhost:37497]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-4D7A7540CAE6:t0, leader=null, voted=, raftlog=Memoized:s2@group-4D7A7540CAE6-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:35653, s1|localhost:45465, s2|localhost:37497]|listeners:[], old=null RUNNING
2023-10-31 16:09:03,111 [Time-limited test] WARN  ratis.RaftTestUtil (JavaUtils.java:attempt(223)) - FAILED "waitForLeader-null-(expectLeader? true)", attempt #1/100: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-4D7A7540CAE6:t0, leader=null, voted=, raftlog=Memoized:s0@group-4D7A7540CAE6-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:35653, s1|localhost:45465, s2|localhost:37497]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4D7A7540CAE6:t0, leader=null, voted=, raftlog=Memoized:s1@group-4D7A7540CAE6-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:35653, s1|localhost:45465, s2|localhost:37497]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-4D7A7540CAE6:t0, leader=null, voted=, raftlog=Memoized:s2@group-4D7A7540CAE6-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:35653, s1|localhost:45465, s2|localhost:37497]|listeners:[], old=null RUNNING, sleep 450ms and then retry.
java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-4D7A7540CAE6:t0, leader=null, voted=, raftlog=Memoized:s0@group-4D7A7540CAE6-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:35653, s1|localhost:45465, s2|localhost:37497]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4D7A7540CAE6:t0, leader=null, voted=, raftlog=Memoized:s1@group-4D7A7540CAE6-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:35653, s1|localhost:45465, s2|localhost:37497]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-4D7A7540CAE6:t0, leader=null, voted=, raftlog=Memoized:s2@group-4D7A7540CAE6-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:35653, s1|localhost:45465, s2|localhost:37497]|listeners:[], old=null RUNNING
	at org.apache.ratis.server.impl.MiniRaftCluster.newIllegalStateExceptionForNoLeaders(MiniRaftCluster.java:581)
	at org.apache.ratis.RaftTestUtil.lambda$waitForLeader$1(RaftTestUtil.java:104)
	at org.apache.ratis.server.impl.MiniRaftCluster.getLeader(MiniRaftCluster.java:615)
	at org.apache.ratis.server.impl.MiniRaftCluster.getLeader(MiniRaftCluster.java:608)
	at org.apache.ratis.RaftTestUtil.lambda$waitForLeader$3(RaftTestUtil.java:112)
	at org.apache.ratis.util.JavaUtils.attempt(JavaUtils.java:217)
	at org.apache.ratis.util.JavaUtils.attemptRepeatedly(JavaUtils.java:203)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:111)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:92)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:87)
	at org.apache.ratis.grpc.TestRetryCacheWithGrpc$InvalidateRepliedCallsTest.<init>(TestRetryCacheWithGrpc.java:76)
	at org.apache.ratis.grpc.TestRetryCacheWithGrpc.lambda$testInvalidateRepliedCalls$0(TestRetryCacheWithGrpc.java:61)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:141)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:121)
	at org.apache.ratis.grpc.TestRetryCacheWithGrpc.testInvalidateRepliedCalls(TestRetryCacheWithGrpc.java:61)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:03,269 [s1@group-4D7A7540CAE6-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s1@group-4D7A7540CAE6-FollowerState: change to CANDIDATE, lastRpcElapsedTime:186055729ns, electionTimeout:185ms
2023-10-31 16:09:03,269 [s1@group-4D7A7540CAE6-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(109)) - s1: shutdown s1@group-4D7A7540CAE6-FollowerState
2023-10-31 16:09:03,269 [s1@group-4D7A7540CAE6-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s1@group-4D7A7540CAE6: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2023-10-31 16:09:03,270 [s1@group-4D7A7540CAE6-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2023-10-31 16:09:03,270 [s1@group-4D7A7540CAE6-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s1: start s1@group-4D7A7540CAE6-LeaderElection5
2023-10-31 16:09:03,274 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(323)) - s1@group-4D7A7540CAE6-LeaderElection5 PRE_VOTE round 0: submit vote requests at term 0 for -1: peers:[s0|localhost:35653, s1|localhost:45465, s2|localhost:37497]|listeners:[], old=null
2023-10-31 16:09:03,274 [s0@group-4D7A7540CAE6-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s0@group-4D7A7540CAE6-FollowerState: change to CANDIDATE, lastRpcElapsedTime:211716329ns, electionTimeout:208ms
2023-10-31 16:09:03,274 [s0@group-4D7A7540CAE6-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(109)) - s0: shutdown s0@group-4D7A7540CAE6-FollowerState
2023-10-31 16:09:03,274 [s0@group-4D7A7540CAE6-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s0@group-4D7A7540CAE6: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2023-10-31 16:09:03,275 [s0@group-4D7A7540CAE6-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2023-10-31 16:09:03,275 [s0@group-4D7A7540CAE6-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s0: start s0@group-4D7A7540CAE6-LeaderElection6
2023-10-31 16:09:03,275 [s1@group-4D7A7540CAE6-LeaderElection5-1] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(65)) - Build channel for s0
2023-10-31 16:09:03,278 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2023-10-31 16:09:03,278 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2023-10-31 16:09:03,278 [s1@group-4D7A7540CAE6-LeaderElection5-2] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(65)) - Build channel for s2
2023-10-31 16:09:03,280 [s0@group-4D7A7540CAE6-LeaderElection6] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(323)) - s0@group-4D7A7540CAE6-LeaderElection6 PRE_VOTE round 0: submit vote requests at term 0 for -1: peers:[s0|localhost:35653, s1|localhost:45465, s2|localhost:37497]|listeners:[], old=null
2023-10-31 16:09:03,284 [s0@group-4D7A7540CAE6-LeaderElection6-1] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(65)) - Build channel for s1
2023-10-31 16:09:03,289 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s0@group-4D7A7540CAE6: receive requestVote(PRE_VOTE, s1, group-4D7A7540CAE6, 0, (t:0, i:0))
2023-10-31 16:09:03,290 [grpc-default-executor-4] INFO  impl.VoteContext (VoteContext.java:log(49)) - s0@group-4D7A7540CAE6-CANDIDATE: accept PRE_VOTE from s1: our priority 0 <= candidate's priority 0
2023-10-31 16:09:03,290 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s0@group-4D7A7540CAE6 replies to PRE_VOTE vote request: s1<-s0#0:OK-t0. Peer's state: s0@group-4D7A7540CAE6:t0, leader=null, voted=, raftlog=Memoized:s0@group-4D7A7540CAE6-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:35653, s1|localhost:45465, s2|localhost:37497]|listeners:[], old=null
2023-10-31 16:09:03,290 [s0@group-4D7A7540CAE6-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2023-10-31 16:09:03,290 [s0@group-4D7A7540CAE6-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2023-10-31 16:09:03,293 [s0@group-4D7A7540CAE6-LeaderElection6-2] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(65)) - Build channel for s2
2023-10-31 16:09:03,297 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s1@group-4D7A7540CAE6-LeaderElection5: PRE_VOTE PASSED received 1 response(s) and 0 exception(s):
2023-10-31 16:09:03,297 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s1<-s0#0:OK-t0
2023-10-31 16:09:03,297 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(325)) - s1@group-4D7A7540CAE6-LeaderElection5 PRE_VOTE round 0: result PASSED
2023-10-31 16:09:03,297 [s1@group-4D7A7540CAE6-LeaderElection5] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s1/0f60c322-de48-4f3c-a8b9-4d7a7540cae6/current/raft-meta.tmp with options [CREATE, WRITE]: sun.nio.ch.FileChannelImpl@50484000
2023-10-31 16:09:03,301 [s1@group-4D7A7540CAE6-LeaderElection5] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s1/0f60c322-de48-4f3c-a8b9-4d7a7540cae6/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s1/0f60c322-de48-4f3c-a8b9-4d7a7540cae6/current/raft-meta with options [REPLACE_EXISTING]
2023-10-31 16:09:03,301 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(323)) - s1@group-4D7A7540CAE6-LeaderElection5 ELECTION round 0: submit vote requests at term 1 for -1: peers:[s0|localhost:35653, s1|localhost:45465, s2|localhost:37497]|listeners:[], old=null
2023-10-31 16:09:03,306 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2023-10-31 16:09:03,306 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2023-10-31 16:09:03,318 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s2@group-4D7A7540CAE6: receive requestVote(PRE_VOTE, s1, group-4D7A7540CAE6, 0, (t:0, i:0))
2023-10-31 16:09:03,318 [grpc-default-executor-4] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-4D7A7540CAE6-FOLLOWER: accept PRE_VOTE from s1: our priority 0 <= candidate's priority 0
2023-10-31 16:09:03,318 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s2@group-4D7A7540CAE6 replies to PRE_VOTE vote request: s1<-s2#0:OK-t0. Peer's state: s2@group-4D7A7540CAE6:t0, leader=null, voted=, raftlog=Memoized:s2@group-4D7A7540CAE6-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:35653, s1|localhost:45465, s2|localhost:37497]|listeners:[], old=null
2023-10-31 16:09:03,319 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s0@group-4D7A7540CAE6: receive requestVote(ELECTION, s1, group-4D7A7540CAE6, 1, (t:0, i:0))
2023-10-31 16:09:03,319 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s1@group-4D7A7540CAE6: receive requestVote(PRE_VOTE, s0, group-4D7A7540CAE6, 0, (t:0, i:0))
2023-10-31 16:09:03,319 [grpc-default-executor-2] INFO  impl.VoteContext (VoteContext.java:log(49)) - s0@group-4D7A7540CAE6-CANDIDATE: accept ELECTION from s1: our priority 0 <= candidate's priority 0
2023-10-31 16:09:03,319 [grpc-default-executor-6] INFO  impl.VoteContext (VoteContext.java:log(49)) - s1@group-4D7A7540CAE6-CANDIDATE: accept PRE_VOTE from s0: our priority 0 <= candidate's priority 0
2023-10-31 16:09:03,319 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s0@group-4D7A7540CAE6: changes role from CANDIDATE to FOLLOWER at term 1 for candidate:s1
2023-10-31 16:09:03,319 [grpc-default-executor-2] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(129)) - s0: shutdown s0@group-4D7A7540CAE6-LeaderElection6
2023-10-31 16:09:03,319 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s1@group-4D7A7540CAE6 replies to PRE_VOTE vote request: s0<-s1#0:OK-t1. Peer's state: s1@group-4D7A7540CAE6:t1, leader=null, voted=s1, raftlog=Memoized:s1@group-4D7A7540CAE6-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:35653, s1|localhost:45465, s2|localhost:37497]|listeners:[], old=null
2023-10-31 16:09:03,319 [grpc-default-executor-2] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s0: start s0@group-4D7A7540CAE6-FollowerState
2023-10-31 16:09:03,320 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s2@group-4D7A7540CAE6: receive requestVote(ELECTION, s1, group-4D7A7540CAE6, 1, (t:0, i:0))
2023-10-31 16:09:03,320 [grpc-default-executor-4] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-4D7A7540CAE6-FOLLOWER: accept ELECTION from s1: our priority 0 <= candidate's priority 0
2023-10-31 16:09:03,320 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s2@group-4D7A7540CAE6: changes role from  FOLLOWER to FOLLOWER at term 1 for candidate:s1
2023-10-31 16:09:03,320 [grpc-default-executor-4] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(109)) - s2: shutdown s2@group-4D7A7540CAE6-FollowerState
2023-10-31 16:09:03,320 [s2@group-4D7A7540CAE6-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(152)) - s2@group-4D7A7540CAE6-FollowerState was interrupted
2023-10-31 16:09:03,321 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:setFirstElection(562)) - s0@group-4D7A7540CAE6: set firstElectionSinceStartup to false for candidate:s1
2023-10-31 16:09:03,322 [grpc-default-executor-2] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s0/0f60c322-de48-4f3c-a8b9-4d7a7540cae6/current/raft-meta.tmp with options [CREATE, WRITE]: sun.nio.ch.FileChannelImpl@58af03bc
2023-10-31 16:09:03,322 [grpc-default-executor-4] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s2: start s2@group-4D7A7540CAE6-FollowerState
2023-10-31 16:09:03,322 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:setFirstElection(562)) - s2@group-4D7A7540CAE6: set firstElectionSinceStartup to false for candidate:s1
2023-10-31 16:09:03,322 [grpc-default-executor-4] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s2/0f60c322-de48-4f3c-a8b9-4d7a7540cae6/current/raft-meta.tmp with options [CREATE, WRITE]: sun.nio.ch.FileChannelImpl@35766618
2023-10-31 16:09:03,329 [grpc-default-executor-2] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s0/0f60c322-de48-4f3c-a8b9-4d7a7540cae6/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s0/0f60c322-de48-4f3c-a8b9-4d7a7540cae6/current/raft-meta with options [REPLACE_EXISTING]
2023-10-31 16:09:03,329 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s0@group-4D7A7540CAE6 replies to ELECTION vote request: s1<-s0#0:OK-t1. Peer's state: s0@group-4D7A7540CAE6:t1, leader=null, voted=s1, raftlog=Memoized:s0@group-4D7A7540CAE6-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:35653, s1|localhost:45465, s2|localhost:37497]|listeners:[], old=null
2023-10-31 16:09:03,331 [grpc-default-executor-4] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s2/0f60c322-de48-4f3c-a8b9-4d7a7540cae6/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s2/0f60c322-de48-4f3c-a8b9-4d7a7540cae6/current/raft-meta with options [REPLACE_EXISTING]
2023-10-31 16:09:03,331 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s2@group-4D7A7540CAE6 replies to ELECTION vote request: s1<-s2#0:OK-t1. Peer's state: s2@group-4D7A7540CAE6:t1, leader=null, voted=s1, raftlog=Memoized:s2@group-4D7A7540CAE6-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:35653, s1|localhost:45465, s2|localhost:37497]|listeners:[], old=null
2023-10-31 16:09:03,334 [s0@group-4D7A7540CAE6-LeaderElection6] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s0@group-4D7A7540CAE6-LeaderElection6: PRE_VOTE DISCOVERED_A_NEW_TERM (term=1) received 1 response(s) and 0 exception(s):
2023-10-31 16:09:03,334 [s0@group-4D7A7540CAE6-LeaderElection6] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s0<-s1#0:OK-t1
2023-10-31 16:09:03,334 [s0@group-4D7A7540CAE6-LeaderElection6] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(325)) - s0@group-4D7A7540CAE6-LeaderElection6 PRE_VOTE round 0: result DISCOVERED_A_NEW_TERM (term=1)
2023-10-31 16:09:03,337 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s2@group-4D7A7540CAE6: receive requestVote(PRE_VOTE, s0, group-4D7A7540CAE6, 0, (t:0, i:0))
2023-10-31 16:09:03,337 [grpc-default-executor-6] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-4D7A7540CAE6-FOLLOWER: accept PRE_VOTE from s0: our priority 0 <= candidate's priority 0
2023-10-31 16:09:03,337 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s2@group-4D7A7540CAE6 replies to PRE_VOTE vote request: s0<-s2#0:OK-t1. Peer's state: s2@group-4D7A7540CAE6:t1, leader=null, voted=s1, raftlog=Memoized:s2@group-4D7A7540CAE6-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:35653, s1|localhost:45465, s2|localhost:37497]|listeners:[], old=null
2023-10-31 16:09:03,338 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s1@group-4D7A7540CAE6-LeaderElection5: ELECTION PASSED received 1 response(s) and 0 exception(s):
2023-10-31 16:09:03,338 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s1<-s2#0:OK-t1
2023-10-31 16:09:03,338 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(325)) - s1@group-4D7A7540CAE6-LeaderElection5 ELECTION round 0: result PASSED
2023-10-31 16:09:03,338 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(129)) - s1: shutdown s1@group-4D7A7540CAE6-LeaderElection5
2023-10-31 16:09:03,338 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s1@group-4D7A7540CAE6: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2023-10-31 16:09:03,339 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.staging.catchup.gap = 1000 (default)
2023-10-31 16:09:03,339 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.element-limit = 4096 (default)
2023-10-31 16:09:03,339 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.byte-limit = 64MB (=67108864) (default)
2023-10-31 16:09:03,339 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.timeout = 10s (default)
2023-10-31 16:09:03,339 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.timeout.denomination = 1s (default)
2023-10-31 16:09:03,339 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.element-limit = 65536 (default)
2023-10-31 16:09:03,339 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.leader.lease.enabled = false (default)
2023-10-31 16:09:03,339 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.leader.lease.timeout.ratio = 0.9 (default)
2023-10-31 16:09:03,339 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.min = 150ms (default)
2023-10-31 16:09:03,339 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.element-limit = 4096 (default)
2023-10-31 16:09:03,339 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.follower.gap.ratio.max = -1.0 (default)
2023-10-31 16:09:03,340 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:03,340 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:03,340 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:03,340 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:03,340 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:03,340 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:03,340 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:03,340 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:03,340 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:03,340 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:03,341 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:03,341 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:03,341 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:03,341 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:03,341 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:03,341 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:03,341 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:03,341 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:03,341 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:03,341 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:03,341 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s1: start s1@group-4D7A7540CAE6-LeaderStateImpl
2023-10-31 16:09:03,341 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  server.RaftServer$Division (RaftServerImpl.java:setFirstElection(562)) - s1@group-4D7A7540CAE6: set firstElectionSinceStartup to false for becomeLeader
2023-10-31 16:09:03,341 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  server.RaftServer$Division (ServerState.java:setLeader(265)) - s1@group-4D7A7540CAE6: change Leader from null to s1 at term 1 for becomeLeader, leader elected after 302ms
2023-10-31 16:09:03,341 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(428)) - s1@group-4D7A7540CAE6-SegmentedRaftLogWorker: Starting segment from index:0
2023-10-31 16:09:03,342 [s1@group-4D7A7540CAE6-LeaderElection5] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(382)) - s1@group-4D7A7540CAE6: set configuration 0: peers:[s0|localhost:35653, s1|localhost:45465, s2|localhost:37497]|listeners:[], old=null
2023-10-31 16:09:03,363 [s0-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setLeader(265)) - s0@group-4D7A7540CAE6: change Leader from null to s1 at term 1 for appendEntries, leader elected after 340ms
2023-10-31 16:09:03,366 [s1@group-4D7A7540CAE6-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(632)) - s1@group-4D7A7540CAE6-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s1/0f60c322-de48-4f3c-a8b9-4d7a7540cae6/current/log_inprogress_0
2023-10-31 16:09:03,370 [s2-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setLeader(265)) - s2@group-4D7A7540CAE6: change Leader from null to s1 at term 1 for appendEntries, leader elected after 317ms
2023-10-31 16:09:03,377 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s0@group-4D7A7540CAE6: receive appendEntries(s1, 1, null, -1, true, commits:[s1:c-1, s0:c-1, s2:c-1], cId:1, entries: [(t:1, i:0), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:35653"
dataStreamAddress: "localhost:42067"
clientAddress: "localhost:37937"
adminAddress: "localhost:39797"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:45465"
dataStreamAddress: "localhost:36987"
clientAddress: "localhost:37189"
adminAddress: "localhost:35667"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:37497"
dataStreamAddress: "localhost:40265"
clientAddress: "localhost:42947"
adminAddress: "localhost:42563"
startupRole: FOLLOWER
, old:)]
2023-10-31 16:09:03,377 [s0-server-thread2] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(382)) - s0@group-4D7A7540CAE6: set configuration 0: peers:[s0|localhost:35653, s1|localhost:45465, s2|localhost:37497]|listeners:[], old=null
2023-10-31 16:09:03,377 [s0-server-thread2] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(428)) - s0@group-4D7A7540CAE6-SegmentedRaftLogWorker: Starting segment from index:0
2023-10-31 16:09:03,380 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-4D7A7540CAE6: receive appendEntries(s1, 1, null, -1, true, commits:[s1:c-1, s0:c-1, s2:c-1], cId:1, entries: [(t:1, i:0), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:35653"
dataStreamAddress: "localhost:42067"
clientAddress: "localhost:37937"
adminAddress: "localhost:39797"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:45465"
dataStreamAddress: "localhost:36987"
clientAddress: "localhost:37189"
adminAddress: "localhost:35667"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:37497"
dataStreamAddress: "localhost:40265"
clientAddress: "localhost:42947"
adminAddress: "localhost:42563"
startupRole: FOLLOWER
, old:)]
2023-10-31 16:09:03,382 [s2-server-thread2] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(382)) - s2@group-4D7A7540CAE6: set configuration 0: peers:[s0|localhost:35653, s1|localhost:45465, s2|localhost:37497]|listeners:[], old=null
2023-10-31 16:09:03,382 [s2-server-thread2] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(428)) - s2@group-4D7A7540CAE6-SegmentedRaftLogWorker: Starting segment from index:0
2023-10-31 16:09:03,393 [s0@group-4D7A7540CAE6-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(632)) - s0@group-4D7A7540CAE6-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s0/0f60c322-de48-4f3c-a8b9-4d7a7540cae6/current/log_inprogress_0
2023-10-31 16:09:03,393 [s2@group-4D7A7540CAE6-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(632)) - s2@group-4D7A7540CAE6-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcb6f2f39d/s2/0f60c322-de48-4f3c-a8b9-4d7a7540cae6/current/log_inprogress_0
2023-10-31 16:09:03,395 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s0@group-4D7A7540CAE6: succeeded to handle AppendEntries. Reply: s1<-s0#1:OK-t1,SUCCESS,nextIndex=1,followerCommit=-1,matchIndex=0
2023-10-31 16:09:03,395 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-4D7A7540CAE6: succeeded to handle AppendEntries. Reply: s1<-s2#1:OK-t1,SUCCESS,nextIndex=1,followerCommit=-1,matchIndex=0
2023-10-31 16:09:03,397 [s1@group-4D7A7540CAE6-StateMachineUpdater] INFO  server.RaftServer$Division (LeaderStateImpl.java:isApplied(308)) - leader is ready since appliedIndex == 0 >= startIndex == 0
2023-10-31 16:09:03,561 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(119)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-4D7A7540CAE6:t1, leader=s1, voted=s1, raftlog=Memoized:s0@group-4D7A7540CAE6-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|localhost:35653, s1|localhost:45465, s2|localhost:37497]|listeners:[], old=null RUNNING
  s1:  RUNNING    LEADER s1@group-4D7A7540CAE6:t1, leader=s1, voted=s1, raftlog=Memoized:s1@group-4D7A7540CAE6-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|localhost:35653, s1|localhost:45465, s2|localhost:37497]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-4D7A7540CAE6:t1, leader=s1, voted=s1, raftlog=Memoized:s2@group-4D7A7540CAE6-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|localhost:35653, s1|localhost:45465, s2|localhost:37497]|listeners:[], old=null RUNNING
2023-10-31 16:09:03,592 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(891)) - s0@group-4D7A7540CAE6: receive client request(RaftClientRequest:client-FD2E1031AE34->s0@group-4D7A7540CAE6, cid=1, seq=null, RW, Message:6d31)
2023-10-31 16:09:03,594 [null-request--thread1] INFO  server.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(284)) - Failed RaftClientRequest:client-FD2E1031AE34->s0@group-4D7A7540CAE6, cid=1, seq=null, RW, Message:6d31, reply=RaftClientReply:client-FD2E1031AE34->s0@group-4D7A7540CAE6, cid=1, FAILED org.apache.ratis.protocol.exceptions.NotLeaderException: Server s0@group-4D7A7540CAE6 is not the leader s1|localhost:45465, logIndex=0, commits[s0:c0, s1:c0, s2:c0]
2023-10-31 16:09:03,724 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(891)) - s1@group-4D7A7540CAE6: receive client request(RaftClientRequest:client-FD2E1031AE34->s1@group-4D7A7540CAE6, cid=1, seq=null, RW, Message:6d31)
2023-10-31 16:09:03,725 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(508)) - s1@group-4D7A7540CAE6-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-FD2E1031AE34->s1@group-4D7A7540CAE6, cid=1, seq=null, RW, Message:6d31, entry=(t:1, i:1), STATEMACHINELOGENTRY, 1@client-FD2E1031AE34
2023-10-31 16:09:03,727 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s0@group-4D7A7540CAE6: receive appendEntries(s1, 1, (t:1, i:0), 0, true, commits:[s1:c0, s0:c0, s2:c0], cId:8, entries: [(t:1, i:1), STATEMACHINELOGENTRY, 1@client-FD2E1031AE34]
2023-10-31 16:09:03,728 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-4D7A7540CAE6: receive appendEntries(s1, 1, (t:1, i:0), 0, true, commits:[s1:c0, s0:c0, s2:c0], cId:8, entries: [(t:1, i:1), STATEMACHINELOGENTRY, 1@client-FD2E1031AE34]
2023-10-31 16:09:03,728 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s0@group-4D7A7540CAE6: succeeded to handle AppendEntries. Reply: s1<-s0#8:OK-t1,SUCCESS,nextIndex=2,followerCommit=0,matchIndex=1
2023-10-31 16:09:03,729 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-4D7A7540CAE6: succeeded to handle AppendEntries. Reply: s1<-s2#8:OK-t1,SUCCESS,nextIndex=2,followerCommit=0,matchIndex=1
2023-10-31 16:09:03,729 [s1@group-4D7A7540CAE6-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:applyTransaction(248)) - applyTransaction for log index 1
2023-10-31 16:09:03,730 [s1@group-4D7A7540CAE6-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(205)) - s1: put 1, m1 -> (t:1, i:1), STATEMACHINELOGENTRY, 1@client-FD2E1031AE34
2023-10-31 16:09:03,731 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s0@group-4D7A7540CAE6: receive appendEntries(s1, 1, (t:1, i:1), 1, true, commits:[s1:c1, s0:c0, s2:c0], cId:9, entries: [(t:1, i:2), METADATAENTRY(c:1)]
2023-10-31 16:09:03,731 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-4D7A7540CAE6: receive appendEntries(s1, 1, (t:1, i:1), 1, true, commits:[s1:c1, s0:c0, s2:c0], cId:9, entries: [(t:1, i:2), METADATAENTRY(c:1)]
2023-10-31 16:09:03,732 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-4D7A7540CAE6: succeeded to handle AppendEntries. Reply: s1<-s2#9:OK-t1,SUCCESS,nextIndex=3,followerCommit=1,matchIndex=2
2023-10-31 16:09:03,733 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s0@group-4D7A7540CAE6: succeeded to handle AppendEntries. Reply: s1<-s0#9:OK-t1,SUCCESS,nextIndex=3,followerCommit=1,matchIndex=2
2023-10-31 16:09:03,733 [s2@group-4D7A7540CAE6-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:applyTransaction(248)) - applyTransaction for log index 1
2023-10-31 16:09:03,733 [s0@group-4D7A7540CAE6-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:applyTransaction(248)) - applyTransaction for log index 1
2023-10-31 16:09:03,733 [s2@group-4D7A7540CAE6-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(205)) - s2: put 1, m1 -> (t:1, i:1), STATEMACHINELOGENTRY, 1@client-FD2E1031AE34
2023-10-31 16:09:03,733 [s0@group-4D7A7540CAE6-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(205)) - s0: put 1, m1 -> (t:1, i:1), STATEMACHINELOGENTRY, 1@client-FD2E1031AE34
2023-10-31 16:09:03,745 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(891)) - s1@group-4D7A7540CAE6: receive client request(RaftClientRequest:client-FD2E1031AE34->s1@group-4D7A7540CAE6, cid=2, seq=null, RW, Message:6d32)
2023-10-31 16:09:03,745 [s1-client-thread1] DEBUG server.RetryCache (RetryCacheImpl.java:invalidateRepliedRequests(240)) - invalidateRepliedRequests callIds [1] for client-FD2E1031AE34
2023-10-31 16:09:03,750 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(508)) - s1@group-4D7A7540CAE6-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-FD2E1031AE34->s1@group-4D7A7540CAE6, cid=2, seq=null, RW, Message:6d32, entry=(t:1, i:3), STATEMACHINELOGENTRY, 2@client-FD2E1031AE34
2023-10-31 16:09:03,751 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s0@group-4D7A7540CAE6: receive appendEntries(s1, 1, (t:1, i:2), 2, true, commits:[s1:c2, s0:c1, s2:c1], cId:11, entries: [(t:1, i:3), STATEMACHINELOGENTRY, 2@client-FD2E1031AE34]
2023-10-31 16:09:03,752 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-4D7A7540CAE6: receive appendEntries(s1, 1, (t:1, i:2), 2, true, commits:[s1:c2, s0:c1, s2:c1], cId:11, entries: [(t:1, i:3), STATEMACHINELOGENTRY, 2@client-FD2E1031AE34]
2023-10-31 16:09:03,752 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s0@group-4D7A7540CAE6: succeeded to handle AppendEntries. Reply: s1<-s0#11:OK-t1,SUCCESS,nextIndex=4,followerCommit=2,matchIndex=3
2023-10-31 16:09:03,753 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-4D7A7540CAE6: succeeded to handle AppendEntries. Reply: s1<-s2#11:OK-t1,SUCCESS,nextIndex=4,followerCommit=2,matchIndex=3
2023-10-31 16:09:03,754 [s1@group-4D7A7540CAE6-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:applyTransaction(248)) - applyTransaction for log index 3
2023-10-31 16:09:03,754 [s1@group-4D7A7540CAE6-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(205)) - s1: put 3, m2 -> (t:1, i:3), STATEMACHINELOGENTRY, 2@client-FD2E1031AE34
2023-10-31 16:09:03,756 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s0@group-4D7A7540CAE6: receive appendEntries(s1, 1, (t:1, i:3), 3, true, commits:[s1:c3, s0:c2, s2:c2], cId:12, entries: [(t:1, i:4), METADATAENTRY(c:3)]
2023-10-31 16:09:03,757 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s0@group-4D7A7540CAE6: succeeded to handle AppendEntries. Reply: s1<-s0#12:OK-t1,SUCCESS,nextIndex=5,followerCommit=3,matchIndex=4
2023-10-31 16:09:03,757 [s0@group-4D7A7540CAE6-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:applyTransaction(248)) - applyTransaction for log index 3
2023-10-31 16:09:03,758 [s0@group-4D7A7540CAE6-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(205)) - s0: put 3, m2 -> (t:1, i:3), STATEMACHINELOGENTRY, 2@client-FD2E1031AE34
2023-10-31 16:09:03,759 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-4D7A7540CAE6: receive appendEntries(s1, 1, (t:1, i:3), 3, true, commits:[s1:c3, s0:c2, s2:c2], cId:12, entries: [(t:1, i:4), METADATAENTRY(c:3)]
2023-10-31 16:09:03,760 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-4D7A7540CAE6: succeeded to handle AppendEntries. Reply: s1<-s2#12:OK-t1,SUCCESS,nextIndex=5,followerCommit=3,matchIndex=4
2023-10-31 16:09:03,760 [s2@group-4D7A7540CAE6-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:applyTransaction(248)) - applyTransaction for log index 3
2023-10-31 16:09:03,760 [s2@group-4D7A7540CAE6-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(205)) - s2: put 3, m2 -> (t:1, i:3), STATEMACHINELOGENTRY, 2@client-FD2E1031AE34
2023-10-31 16:09:03,762 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(891)) - s1@group-4D7A7540CAE6: receive client request(RaftClientRequest:client-FD2E1031AE34->s1@group-4D7A7540CAE6, cid=3, seq=null, RW, Message:6d33)
2023-10-31 16:09:03,762 [s1-client-thread1] DEBUG server.RetryCache (RetryCacheImpl.java:invalidateRepliedRequests(240)) - invalidateRepliedRequests callIds [2] for client-FD2E1031AE34
2023-10-31 16:09:03,762 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(508)) - s1@group-4D7A7540CAE6-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-FD2E1031AE34->s1@group-4D7A7540CAE6, cid=3, seq=null, RW, Message:6d33, entry=(t:1, i:5), STATEMACHINELOGENTRY, 3@client-FD2E1031AE34
2023-10-31 16:09:03,764 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-4D7A7540CAE6: receive appendEntries(s1, 1, (t:1, i:4), 4, true, commits:[s1:c4, s0:c3, s2:c3], cId:16, entries: [(t:1, i:5), STATEMACHINELOGENTRY, 3@client-FD2E1031AE34]
2023-10-31 16:09:03,764 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s0@group-4D7A7540CAE6: receive appendEntries(s1, 1, (t:1, i:4), 4, true, commits:[s1:c4, s0:c3, s2:c3], cId:16, entries: [(t:1, i:5), STATEMACHINELOGENTRY, 3@client-FD2E1031AE34]
2023-10-31 16:09:03,765 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-4D7A7540CAE6: succeeded to handle AppendEntries. Reply: s1<-s2#16:OK-t1,SUCCESS,nextIndex=6,followerCommit=4,matchIndex=5
2023-10-31 16:09:03,766 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s0@group-4D7A7540CAE6: succeeded to handle AppendEntries. Reply: s1<-s0#16:OK-t1,SUCCESS,nextIndex=6,followerCommit=4,matchIndex=5
2023-10-31 16:09:03,767 [s1@group-4D7A7540CAE6-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:applyTransaction(248)) - applyTransaction for log index 5
2023-10-31 16:09:03,767 [s1@group-4D7A7540CAE6-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(205)) - s1: put 5, m3 -> (t:1, i:5), STATEMACHINELOGENTRY, 3@client-FD2E1031AE34
2023-10-31 16:09:03,769 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-4D7A7540CAE6: receive appendEntries(s1, 1, (t:1, i:5), 5, true, commits:[s1:c5, s0:c4, s2:c4], cId:17, entries: [(t:1, i:6), METADATAENTRY(c:5)]
2023-10-31 16:09:03,769 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s0@group-4D7A7540CAE6: receive appendEntries(s1, 1, (t:1, i:5), 5, true, commits:[s1:c5, s0:c4, s2:c4], cId:18, entries: [(t:1, i:6), METADATAENTRY(c:5)]
2023-10-31 16:09:03,770 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s0@group-4D7A7540CAE6: succeeded to handle AppendEntries. Reply: s1<-s0#18:OK-t1,SUCCESS,nextIndex=7,followerCommit=5,matchIndex=6
2023-10-31 16:09:03,770 [s0@group-4D7A7540CAE6-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:applyTransaction(248)) - applyTransaction for log index 5
2023-10-31 16:09:03,771 [s0@group-4D7A7540CAE6-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(205)) - s0: put 5, m3 -> (t:1, i:5), STATEMACHINELOGENTRY, 3@client-FD2E1031AE34
2023-10-31 16:09:03,771 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-4D7A7540CAE6: succeeded to handle AppendEntries. Reply: s1<-s2#17:OK-t1,SUCCESS,nextIndex=7,followerCommit=5,matchIndex=6
2023-10-31 16:09:03,771 [s2@group-4D7A7540CAE6-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:applyTransaction(248)) - applyTransaction for log index 5
2023-10-31 16:09:03,771 [s2@group-4D7A7540CAE6-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(205)) - s2: put 5, m3 -> (t:1, i:5), STATEMACHINELOGENTRY, 3@client-FD2E1031AE34
2023-10-31 16:09:03,778 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(891)) - s1@group-4D7A7540CAE6: receive client request(RaftClientRequest:client-FD2E1031AE34->s1@group-4D7A7540CAE6, cid=4, seq=null, RW, Message:6d34)
2023-10-31 16:09:03,778 [s1-client-thread1] DEBUG server.RetryCache (RetryCacheImpl.java:invalidateRepliedRequests(240)) - invalidateRepliedRequests callIds [3] for client-FD2E1031AE34
2023-10-31 16:09:03,778 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(508)) - s1@group-4D7A7540CAE6-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-FD2E1031AE34->s1@group-4D7A7540CAE6, cid=4, seq=null, RW, Message:6d34, entry=(t:1, i:7), STATEMACHINELOGENTRY, 4@client-FD2E1031AE34
2023-10-31 16:09:03,780 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-4D7A7540CAE6: receive appendEntries(s1, 1, (t:1, i:6), 6, true, commits:[s1:c6, s0:c5, s2:c5], cId:20, entries: [(t:1, i:7), STATEMACHINELOGENTRY, 4@client-FD2E1031AE34]
2023-10-31 16:09:03,781 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s0@group-4D7A7540CAE6: receive appendEntries(s1, 1, (t:1, i:6), 6, true, commits:[s1:c6, s0:c5, s2:c5], cId:20, entries: [(t:1, i:7), STATEMACHINELOGENTRY, 4@client-FD2E1031AE34]
2023-10-31 16:09:03,782 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s0@group-4D7A7540CAE6: succeeded to handle AppendEntries. Reply: s1<-s0#20:OK-t1,SUCCESS,nextIndex=8,followerCommit=6,matchIndex=7
2023-10-31 16:09:03,782 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-4D7A7540CAE6: succeeded to handle AppendEntries. Reply: s1<-s2#20:OK-t1,SUCCESS,nextIndex=8,followerCommit=6,matchIndex=7
2023-10-31 16:09:03,787 [s1@group-4D7A7540CAE6-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:applyTransaction(248)) - applyTransaction for log index 7
2023-10-31 16:09:03,787 [s1@group-4D7A7540CAE6-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(205)) - s1: put 7, m4 -> (t:1, i:7), STATEMACHINELOGENTRY, 4@client-FD2E1031AE34
2023-10-31 16:09:03,793 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-4D7A7540CAE6: receive appendEntries(s1, 1, (t:1, i:7), 7, true, commits:[s1:c7, s0:c5, s2:c6], cId:21, entries: [(t:1, i:8), METADATAENTRY(c:7)]
2023-10-31 16:09:03,794 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s0@group-4D7A7540CAE6: receive appendEntries(s1, 1, (t:1, i:7), 7, true, commits:[s1:c7, s0:c5, s2:c6], cId:22, entries: [(t:1, i:8), METADATAENTRY(c:7)]
2023-10-31 16:09:03,794 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-4D7A7540CAE6: succeeded to handle AppendEntries. Reply: s1<-s2#21:OK-t1,SUCCESS,nextIndex=9,followerCommit=7,matchIndex=8
2023-10-31 16:09:03,794 [s2@group-4D7A7540CAE6-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:applyTransaction(248)) - applyTransaction for log index 7
2023-10-31 16:09:03,795 [s2@group-4D7A7540CAE6-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(205)) - s2: put 7, m4 -> (t:1, i:7), STATEMACHINELOGENTRY, 4@client-FD2E1031AE34
2023-10-31 16:09:03,795 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s0@group-4D7A7540CAE6: succeeded to handle AppendEntries. Reply: s1<-s0#22:OK-t1,SUCCESS,nextIndex=9,followerCommit=7,matchIndex=8
2023-10-31 16:09:03,795 [s0@group-4D7A7540CAE6-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:applyTransaction(248)) - applyTransaction for log index 7
2023-10-31 16:09:03,795 [s0@group-4D7A7540CAE6-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(205)) - s0: put 7, m4 -> (t:1, i:7), STATEMACHINELOGENTRY, 4@client-FD2E1031AE34
2023-10-31 16:09:03,800 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(891)) - s1@group-4D7A7540CAE6: receive client request(RaftClientRequest:client-FD2E1031AE34->s1@group-4D7A7540CAE6, cid=5, seq=null, RW, Message:6d35)
2023-10-31 16:09:03,800 [s1-client-thread1] DEBUG server.RetryCache (RetryCacheImpl.java:invalidateRepliedRequests(240)) - invalidateRepliedRequests callIds [4] for client-FD2E1031AE34
2023-10-31 16:09:03,800 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(508)) - s1@group-4D7A7540CAE6-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-FD2E1031AE34->s1@group-4D7A7540CAE6, cid=5, seq=null, RW, Message:6d35, entry=(t:1, i:9), STATEMACHINELOGENTRY, 5@client-FD2E1031AE34
2023-10-31 16:09:03,802 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-4D7A7540CAE6: receive appendEntries(s1, 1, (t:1, i:8), 8, true, commits:[s1:c8, s0:c7, s2:c7], cId:25, entries: [(t:1, i:9), STATEMACHINELOGENTRY, 5@client-FD2E1031AE34]
2023-10-31 16:09:03,803 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-4D7A7540CAE6: succeeded to handle AppendEntries. Reply: s1<-s2#25:OK-t1,SUCCESS,nextIndex=10,followerCommit=8,matchIndex=9
2023-10-31 16:09:03,804 [s1@group-4D7A7540CAE6-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:applyTransaction(248)) - applyTransaction for log index 9
2023-10-31 16:09:03,804 [s1@group-4D7A7540CAE6-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(205)) - s1: put 9, m5 -> (t:1, i:9), STATEMACHINELOGENTRY, 5@client-FD2E1031AE34
2023-10-31 16:09:03,807 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s0@group-4D7A7540CAE6: receive appendEntries(s1, 1, (t:1, i:8), 8, true, commits:[s1:c8, s0:c7, s2:c7], cId:27, entries: [(t:1, i:9), STATEMACHINELOGENTRY, 5@client-FD2E1031AE34]
2023-10-31 16:09:03,808 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-4D7A7540CAE6: receive appendEntries(s1, 1, (t:1, i:9), 9, true, commits:[s1:c9, s0:c7, s2:c8], cId:26, entries: [(t:1, i:10), METADATAENTRY(c:9)]
2023-10-31 16:09:03,808 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s0@group-4D7A7540CAE6: succeeded to handle AppendEntries. Reply: s1<-s0#27:OK-t1,SUCCESS,nextIndex=10,followerCommit=8,matchIndex=9
2023-10-31 16:09:03,809 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-4D7A7540CAE6: succeeded to handle AppendEntries. Reply: s1<-s2#26:OK-t1,SUCCESS,nextIndex=11,followerCommit=9,matchIndex=10
2023-10-31 16:09:03,809 [s2@group-4D7A7540CAE6-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:applyTransaction(248)) - applyTransaction for log index 9
2023-10-31 16:09:03,809 [s2@group-4D7A7540CAE6-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(205)) - s2: put 9, m5 -> (t:1, i:9), STATEMACHINELOGENTRY, 5@client-FD2E1031AE34
2023-10-31 16:09:03,810 [Time-limited test] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:block(135)) - block APPLY_TRANSACTION
2023-10-31 16:09:03,819 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s0@group-4D7A7540CAE6: receive appendEntries(s1, 1, (t:1, i:9), 9, true, commits:[s1:c9, s0:c7, s2:c8], cId:28, entries: [(t:1, i:10), METADATAENTRY(c:9)]
2023-10-31 16:09:03,821 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s0@group-4D7A7540CAE6: succeeded to handle AppendEntries. Reply: s1<-s0#28:OK-t1,SUCCESS,nextIndex=11,followerCommit=9,matchIndex=10
2023-10-31 16:09:03,821 [s0@group-4D7A7540CAE6-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:applyTransaction(248)) - applyTransaction for log index 9
2023-10-31 16:09:03,821 [s0@group-4D7A7540CAE6-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(205)) - s0: put 9, m5 -> (t:1, i:9), STATEMACHINELOGENTRY, 5@client-FD2E1031AE34
2023-10-31 16:09:03,832 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(891)) - s1@group-4D7A7540CAE6: receive client request(RaftClientRequest:client-FD2E1031AE34->s1@group-4D7A7540CAE6, cid=6, seq=1*, Watch(0), Message:<EMPTY>)
2023-10-31 16:09:03,832 [s1-client-thread1] DEBUG server.RetryCache (RetryCacheImpl.java:invalidateRepliedRequests(240)) - invalidateRepliedRequests callIds [5] for client-FD2E1031AE34
2023-10-31 16:09:03,833 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addWatchReqeust(526)) - s1@group-4D7A7540CAE6-LeaderStateImpl: addWatchRequest RaftClientRequest:client-FD2E1031AE34->s1@group-4D7A7540CAE6, cid=6, seq=1*, Watch(0), Message:<EMPTY>
2023-10-31 16:09:03,851 [grpc-default-executor-4] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s1@group-4D7A7540CAE6, cid=7, seq=2, RW, m6
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-FD2E1031AE34 is already CLOSED
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.uniApplyNow(CompletableFuture.java:670)
	at java.base/java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:658)
	at java.base/java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:2094)
	at org.apache.ratis.client.impl.OrderedAsync.sendRequest(OrderedAsync.java:239)
	at org.apache.ratis.client.impl.OrderedAsync.sendRequestWithRetry(OrderedAsync.java:203)
	at org.apache.ratis.util.SlidingWindow$Client.lambda$trySendDelayed$2(SlidingWindow.java:362)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.apache.ratis.util.SlidingWindow$Client.trySendDelayed(SlidingWindow.java:361)
	at org.apache.ratis.util.SlidingWindow$Client.receiveReply(SlidingWindow.java:355)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$8(OrderedAsync.java:243)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:642)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2073)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.lambda$onNext$0(GrpcClientProtocolClient.java:322)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$100(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:322)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:305)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:662)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:647)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-FD2E1031AE34 is already CLOSED
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:61)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequestAsync(GrpcClientRpc.java:69)
	... 25 more
2023-10-31 16:09:03,852 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(831)) - ************************************************************** 
2023-10-31 16:09:03,852 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(832)) - *** 
2023-10-31 16:09:03,852 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(833)) - ***     Stopping MiniRaftClusterWithGrpc
2023-10-31 16:09:03,852 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(834)) - *** 
2023-10-31 16:09:03,852 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(835)) - ************************************************************** 
2023-10-31 16:09:03,852 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(836)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-4D7A7540CAE6:t1, leader=s1, voted=s1, raftlog=Memoized:s0@group-4D7A7540CAE6-SegmentedRaftLog:OPENED:c9, conf=0: peers:[s0|localhost:35653, s1|localhost:45465, s2|localhost:37497]|listeners:[], old=null RUNNING
  s1:  RUNNING    LEADER s1@group-4D7A7540CAE6:t1, leader=s1, voted=s1, raftlog=Memoized:s1@group-4D7A7540CAE6-SegmentedRaftLog:OPENED:c10, conf=0: peers:[s0|localhost:35653, s1|localhost:45465, s2|localhost:37497]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-4D7A7540CAE6:t1, leader=s1, voted=s1, raftlog=Memoized:s2@group-4D7A7540CAE6-SegmentedRaftLog:OPENED:c9, conf=0: peers:[s0|localhost:35653, s1|localhost:45465, s2|localhost:37497]|listeners:[], old=null RUNNING
2023-10-31 16:09:03,852 [MiniRaftCluster-4] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$9(416)) - s0: close
2023-10-31 16:09:03,853 [MiniRaftCluster-5] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$9(416)) - s1: close
2023-10-31 16:09:03,854 [MiniRaftCluster-4] INFO  server.GrpcService (GrpcService.java:closeImpl(311)) - s0: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService now
2023-10-31 16:09:03,854 [s0-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$3(514)) - s0@group-4D7A7540CAE6: shutdown
2023-10-31 16:09:03,856 [s0-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-4D7A7540CAE6,id=s0
2023-10-31 16:09:03,856 [s0-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(109)) - s0: shutdown s0@group-4D7A7540CAE6-FollowerState
2023-10-31 16:09:03,856 [s0-impl-thread1] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(157)) - s0@group-4D7A7540CAE6-StateMachineUpdater: set stopIndex = 9
2023-10-31 16:09:03,856 [s0@group-4D7A7540CAE6-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(152)) - s0@group-4D7A7540CAE6-FollowerState was interrupted
2023-10-31 16:09:03,854 [MiniRaftCluster-6] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$9(416)) - s2: close
2023-10-31 16:09:03,854 [MiniRaftCluster-5] INFO  server.GrpcService (GrpcService.java:closeImpl(311)) - s1: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService now
2023-10-31 16:09:03,854 [s1-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$3(514)) - s1@group-4D7A7540CAE6: shutdown
2023-10-31 16:09:03,858 [s1-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-4D7A7540CAE6,id=s1
2023-10-31 16:09:03,858 [s1-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(92)) - s1: shutdown s1@group-4D7A7540CAE6-LeaderStateImpl
2023-10-31 16:09:03,858 [s1-impl-thread1] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(289)) - s1@group-4D7A7540CAE6-PendingRequests: sendNotLeaderResponses
2023-10-31 16:09:03,858 [s1@group-4D7A7540CAE6->s0-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(211)) - s1@group-4D7A7540CAE6->s0-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2023-10-31 16:09:03,858 [s1@group-4D7A7540CAE6->s2-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(211)) - s1@group-4D7A7540CAE6->s2-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2023-10-31 16:09:03,859 [grpc-default-executor-2] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(157)) - s0: Completed APPEND_ENTRIES, lastRequest: s1->s0#28-t1,previous=(t:1, i:9),leaderCommit=9,initializing? true,entries: size=1, first=(t:1, i:10), METADATAENTRY(c:9)
2023-10-31 16:09:03,859 [grpc-default-executor-2] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:lambda$onCompleted$5(159)) - s0: Completed APPEND_ENTRIES, lastReply: null
2023-10-31 16:09:03,860 [grpc-default-executor-0] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(157)) - s0: Completed APPEND_ENTRIES, lastRequest: null
2023-10-31 16:09:03,860 [grpc-default-executor-0] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:lambda$onCompleted$5(159)) - s0: Completed APPEND_ENTRIES, lastReply: serverReply {
  requestorId: "s1"
  replyId: "s0"
  raftGroupId {
    id: "\017`\303\"\336HO<\250\271Mzu@\312\346"
  }
  callId: 7
  success: true
}
term: 1
nextIndex: 1
matchIndex: 18446744073709551615
isHearbeat: true

2023-10-31 16:09:03,861 [s0-impl-thread1] INFO  server.RaftServer$Division (ServerState.java:close(423)) - s0@group-4D7A7540CAE6: applyIndex: 9
2023-10-31 16:09:03,861 [grpc-default-executor-6] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(157)) - s2: Completed APPEND_ENTRIES, lastRequest: null
2023-10-31 16:09:03,861 [grpc-default-executor-6] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:lambda$onCompleted$5(159)) - s2: Completed APPEND_ENTRIES, lastReply: serverReply {
  requestorId: "s1"
  replyId: "s2"
  raftGroupId {
    id: "\017`\303\"\336HO<\250\271Mzu@\312\346"
  }
  callId: 7
  success: true
}
term: 1
nextIndex: 1
matchIndex: 18446744073709551615
isHearbeat: true

2023-10-31 16:09:03,862 [s0@group-4D7A7540CAE6-cacheEviction-AwaitToRun] INFO  util.AwaitToRun (AwaitToRun.java:run(49)) - s0@group-4D7A7540CAE6-cacheEviction-AwaitToRun-AwaitForSignal is interrupted
2023-10-31 16:09:03,862 [grpc-default-executor-3] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(468)) - s1@group-4D7A7540CAE6->s0-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2023-10-31 16:09:03,862 [grpc-default-executor-5] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(468)) - s1@group-4D7A7540CAE6->s0-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2023-10-31 16:09:03,862 [grpc-default-executor-2] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(157)) - s2: Completed APPEND_ENTRIES, lastRequest: s1->s2#26-t1,previous=(t:1, i:9),leaderCommit=9,initializing? true,entries: size=1, first=(t:1, i:10), METADATAENTRY(c:9)
2023-10-31 16:09:03,862 [grpc-default-executor-2] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:lambda$onCompleted$5(159)) - s2: Completed APPEND_ENTRIES, lastReply: null
2023-10-31 16:09:03,863 [grpc-default-executor-3] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(468)) - s1@group-4D7A7540CAE6->s2-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2023-10-31 16:09:03,872 [MiniRaftCluster-6] INFO  server.GrpcService (GrpcService.java:closeImpl(311)) - s2: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService now
2023-10-31 16:09:03,872 [s2-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$3(514)) - s2@group-4D7A7540CAE6: shutdown
2023-10-31 16:09:03,872 [s2-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-4D7A7540CAE6,id=s2
2023-10-31 16:09:03,872 [s2-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(109)) - s2: shutdown s2@group-4D7A7540CAE6-FollowerState
2023-10-31 16:09:03,872 [s2-impl-thread1] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(157)) - s2@group-4D7A7540CAE6-StateMachineUpdater: set stopIndex = 9
2023-10-31 16:09:03,872 [grpc-default-executor-4] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s0@group-4D7A7540CAE6, cid=8, seq=3, RW, m7
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-FD2E1031AE34 is already CLOSED
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.uniApplyNow(CompletableFuture.java:670)
	at java.base/java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:658)
	at java.base/java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:2094)
	at org.apache.ratis.client.impl.OrderedAsync.sendRequest(OrderedAsync.java:239)
	at org.apache.ratis.client.impl.OrderedAsync.sendRequestWithRetry(OrderedAsync.java:203)
	at org.apache.ratis.util.SlidingWindow$Client.lambda$trySendDelayed$2(SlidingWindow.java:362)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
	at org.apache.ratis.util.SlidingWindow$Client.trySendDelayed(SlidingWindow.java:361)
	at org.apache.ratis.util.SlidingWindow$Client.receiveReply(SlidingWindow.java:355)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$8(OrderedAsync.java:243)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:642)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2073)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.lambda$onNext$0(GrpcClientProtocolClient.java:322)
	at java.base/java.util.Optional.ifPresent(Optional.java:183)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.handleReplyFuture(GrpcClientProtocolClient.java:378)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$100(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:322)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onNext(GrpcClientProtocolClient.java:305)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:474)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onMessage(ForwardingClientCallListener.java:33)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:662)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:647)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-FD2E1031AE34 is already CLOSED
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:61)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequestAsync(GrpcClientRpc.java:69)
	... 25 more
2023-10-31 16:09:03,872 [s2@group-4D7A7540CAE6-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(152)) - s2@group-4D7A7540CAE6-FollowerState was interrupted
2023-10-31 16:09:03,873 [s2-impl-thread1] INFO  server.RaftServer$Division (ServerState.java:close(423)) - s2@group-4D7A7540CAE6: applyIndex: 9
2023-10-31 16:09:03,873 [s2@group-4D7A7540CAE6-cacheEviction-AwaitToRun] INFO  util.AwaitToRun (AwaitToRun.java:run(49)) - s2@group-4D7A7540CAE6-cacheEviction-AwaitToRun-AwaitForSignal is interrupted
2023-10-31 16:09:03,873 [MiniRaftCluster-6] INFO  server.GrpcService (GrpcService.java:closeImpl(320)) - s2: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService successfully
2023-10-31 16:09:03,873 [MiniRaftCluster-6] INFO  server.GrpcService (GrpcService.java:closeImpl(311)) - s2: shutdown server GrpcServerProtocolService now
2023-10-31 16:09:03,874 [grpc-default-executor-5] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(468)) - s1@group-4D7A7540CAE6->s2-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2023-10-31 16:09:03,875 [Thread-162] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:close(103)) - s2 Close channels
2023-10-31 16:09:03,875 [Thread-163] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:close(103)) - s0 Close channels
2023-10-31 16:09:03,875 [Thread-161] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:close(103)) - s1 Close channels
2023-10-31 16:09:03,877 [Thread-165] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:close(103)) - s2 Close channels
2023-10-31 16:09:03,878 [s1-impl-thread1] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(157)) - s1@group-4D7A7540CAE6-StateMachineUpdater: set stopIndex = 10
2023-10-31 16:09:03,879 [s1-impl-thread1] INFO  server.RaftServer$Division (ServerState.java:close(423)) - s1@group-4D7A7540CAE6: applyIndex: 10
2023-10-31 16:09:03,879 [s1@group-4D7A7540CAE6-cacheEviction-AwaitToRun] INFO  util.AwaitToRun (AwaitToRun.java:run(49)) - s1@group-4D7A7540CAE6-cacheEviction-AwaitToRun-AwaitForSignal is interrupted
2023-10-31 16:09:03,881 [MiniRaftCluster-4] INFO  server.GrpcService (GrpcService.java:closeImpl(320)) - s0: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService successfully
2023-10-31 16:09:03,881 [MiniRaftCluster-4] INFO  server.GrpcService (GrpcService.java:closeImpl(311)) - s0: shutdown server GrpcServerProtocolService now
2023-10-31 16:09:03,886 [MiniRaftCluster-6] INFO  server.GrpcService (GrpcService.java:closeImpl(320)) - s2: shutdown server GrpcServerProtocolService successfully
2023-10-31 16:09:03,886 [MiniRaftCluster-6] INFO  server.GrpcService (GrpcService.java:closeImpl(311)) - s2: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService now
2023-10-31 16:09:03,887 [MiniRaftCluster-4] INFO  server.GrpcService (GrpcService.java:closeImpl(320)) - s0: shutdown server GrpcServerProtocolService successfully
2023-10-31 16:09:03,887 [MiniRaftCluster-4] INFO  server.GrpcService (GrpcService.java:closeImpl(311)) - s0: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService now
2023-10-31 16:09:03,888 [MiniRaftCluster-6] INFO  server.GrpcService (GrpcService.java:closeImpl(320)) - s2: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService successfully
2023-10-31 16:09:03,890 [MiniRaftCluster-4] INFO  server.GrpcService (GrpcService.java:closeImpl(320)) - s0: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService successfully
2023-10-31 16:09:03,890 [MiniRaftCluster-5] INFO  server.GrpcService (GrpcService.java:closeImpl(320)) - s1: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService successfully
2023-10-31 16:09:03,890 [MiniRaftCluster-5] INFO  server.GrpcService (GrpcService.java:closeImpl(311)) - s1: shutdown server GrpcServerProtocolService now
2023-10-31 16:09:03,893 [MiniRaftCluster-5] INFO  server.GrpcService (GrpcService.java:closeImpl(320)) - s1: shutdown server GrpcServerProtocolService successfully
2023-10-31 16:09:03,893 [MiniRaftCluster-5] INFO  server.GrpcService (GrpcService.java:closeImpl(311)) - s1: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService now
2023-10-31 16:09:03,894 [grpc-default-executor-2] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s1@group-4D7A7540CAE6, cid=9, seq=4, RW, m8
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:37189
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:03,901 [grpc-default-executor-2] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s1@group-4D7A7540CAE6, cid=10, seq=5, RW, m9
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:37189
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:03,902 [grpc-default-executor-2] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s1@group-4D7A7540CAE6, cid=11, seq=6, RW, m10
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:37189
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:03,904 [MiniRaftCluster-5] INFO  server.GrpcService (GrpcService.java:closeImpl(320)) - s1: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService successfully
2023-10-31 16:09:03,961 [grpc-default-executor-4] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s0@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:37937
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:04,067 [grpc-default-executor-2] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s1@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:37189
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:04,173 [grpc-default-executor-2] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s0@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:37937
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:04,276 [timer3] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s2@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-FD2E1031AE34 is already CLOSED
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.uniApplyNow(CompletableFuture.java:670)
	at java.base/java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:658)
	at java.base/java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:2094)
	at org.apache.ratis.client.impl.OrderedAsync.sendRequest(OrderedAsync.java:239)
	at org.apache.ratis.client.impl.OrderedAsync.sendRequestWithRetry(OrderedAsync.java:203)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:312)
	at org.apache.ratis.util.SlidingWindow$Client.retry(SlidingWindow.java:328)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$scheduleWithTimeout$6(OrderedAsync.java:227)
	at org.apache.ratis.util.TimeoutTimer.lambda$onTimeout$2(TimeoutTimer.java:101)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:78)
	at org.apache.ratis.util.TimeoutTimer$Task.run(TimeoutTimer.java:55)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
Caused by: org.apache.ratis.protocol.exceptions.AlreadyClosedException: client-FD2E1031AE34 is already CLOSED
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:61)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequestAsync(GrpcClientRpc.java:69)
	... 11 more
2023-10-31 16:09:04,381 [grpc-default-executor-4] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s0@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:37937
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:04,488 [grpc-default-executor-2] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s2@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 13 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:42947
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:04,595 [grpc-default-executor-4] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s0@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:37937
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:04,701 [grpc-default-executor-5] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s2@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:42947
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:04,806 [grpc-default-executor-2] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s1@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:37189
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:04,807 [s1-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(243)) - s1@group-4D7A7540CAE6-SegmentedRaftLogWorker close()
2023-10-31 16:09:04,808 [JvmPauseMonitor4] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(152)) - JvmPauseMonitor-s1: Stopped
2023-10-31 16:09:04,810 [s2-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(243)) - s2@group-4D7A7540CAE6-SegmentedRaftLogWorker close()
2023-10-31 16:09:04,811 [JvmPauseMonitor5] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(152)) - JvmPauseMonitor-s2: Stopped
2023-10-31 16:09:04,821 [s0-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(243)) - s0@group-4D7A7540CAE6-SegmentedRaftLogWorker close()
2023-10-31 16:09:04,822 [JvmPauseMonitor3] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(152)) - JvmPauseMonitor-s0: Stopped
2023-10-31 16:09:04,822 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(855)) - MiniRaftClusterWithGrpc shutdown completed
2023-10-31 16:09:04,829 [main] INFO  util.LogUtils (Slf4jUtils.java:setLogLevel(38)) - Successfully set org.apache.ratis.conf.ConfUtils log level to WARN
2023-10-31 16:09:04,829 [main] INFO  util.LogUtils (Slf4jUtils.java:setLogLevel(38)) - Successfully set org.apache.ratis.util.FileUtils log level to TRACE
2023-10-31 16:09:04,829 [main] INFO  util.LogUtils (Slf4jUtils.java:setLogLevel(38)) - Successfully set org.apache.ratis.server.RetryCache log level to TRACE
2023-10-31 16:09:04,831 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:runWithNewCluster(135)) - Running runWithNewCluster
2023-10-31 16:09:04,833 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:<init>(306)) - new MiniRaftClusterWithGrpc with group-270C659D1A89:[s0|localhost:38679, s1|localhost:42371, s2|localhost:39707]
2023-10-31 16:09:04,833 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(339)) - .............................................................. 
2023-10-31 16:09:04,833 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(340)) - ... 
2023-10-31 16:09:04,833 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(341)) - ...     Starting MiniRaftClusterWithGrpc
2023-10-31 16:09:04,833 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(342)) - ... 
2023-10-31 16:09:04,833 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(343)) - .............................................................. 
2023-10-31 16:09:04,833 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:initServers(318)) - servers = {}
2023-10-31 16:09:04,833 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(382)) - newRaftServer: s0, group-270C659D1A89:[s0|localhost:38679, s1|localhost:42371, s2|localhost:39707], format? true
2023-10-31 16:09:04,833 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(305)) - deleteFully target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s0
2023-10-31 16:09:04,833 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(318)) - deleteFully: target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s0 does not exist.
2023-10-31 16:09:04,833 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(387)) - Formatted directory target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s0
2023-10-31 16:09:04,834 [Time-limited test] INFO  server.RaftServer (ConfUtils.java:logGet(46)) - raft.rpc.type = GRPC (default)
2023-10-31 16:09:04,834 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.admin.host = null (fallback to raft.grpc.server.host)
2023-10-31 16:09:04,834 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.admin.port = 36077 (custom)
2023-10-31 16:09:04,834 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.client.host = null (fallback to raft.grpc.server.host)
2023-10-31 16:09:04,834 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.client.port = 35195 (custom)
2023-10-31 16:09:04,834 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.host = null (default)
2023-10-31 16:09:04,834 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.port = 38679 (custom)
2023-10-31 16:09:04,834 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.message.size.max = 64MB (=67108864) (default)
2023-10-31 16:09:04,834 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:04,834 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2023-10-31 16:09:04,834 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:04,835 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:04,835 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.cached = true (default)
2023-10-31 16:09:04,835 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.size = 32 (default)
2023-10-31 16:09:04,837 [Time-limited test] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(46)) - raft.datastream.type = DISABLED (default)
2023-10-31 16:09:04,837 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.sleep.deviation.threshold = 300ms (default)
2023-10-31 16:09:04,837 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.close.threshold = 60s (default)
2023-10-31 16:09:04,838 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2023-10-31 16:09:04,838 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s0] (custom)
2023-10-31 16:09:04,838 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.cached = true (default)
2023-10-31 16:09:04,838 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.size = 0 (default)
2023-10-31 16:09:04,838 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:addNew(100)) - s0: addNew group-270C659D1A89:[s0|localhost:38679, s1|localhost:42371, s2|localhost:39707] returns group-270C659D1A89:java.util.concurrent.CompletableFuture@428f7768[Not completed]
2023-10-31 16:09:04,838 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(382)) - newRaftServer: s1, group-270C659D1A89:[s0|localhost:38679, s1|localhost:42371, s2|localhost:39707], format? true
2023-10-31 16:09:04,839 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(305)) - deleteFully target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s1
2023-10-31 16:09:04,839 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(318)) - deleteFully: target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s1 does not exist.
2023-10-31 16:09:04,839 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(387)) - Formatted directory target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s1
2023-10-31 16:09:04,839 [Time-limited test] INFO  server.RaftServer (ConfUtils.java:logGet(46)) - raft.rpc.type = GRPC (default)
2023-10-31 16:09:04,839 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.admin.host = null (fallback to raft.grpc.server.host)
2023-10-31 16:09:04,839 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.admin.port = 38439 (custom)
2023-10-31 16:09:04,839 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.client.host = null (fallback to raft.grpc.server.host)
2023-10-31 16:09:04,839 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.client.port = 41917 (custom)
2023-10-31 16:09:04,839 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.host = null (default)
2023-10-31 16:09:04,839 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.port = 42371 (custom)
2023-10-31 16:09:04,839 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.message.size.max = 64MB (=67108864) (default)
2023-10-31 16:09:04,839 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:04,839 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2023-10-31 16:09:04,839 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:04,839 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:04,840 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.cached = true (default)
2023-10-31 16:09:04,840 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.size = 32 (default)
2023-10-31 16:09:04,840 [Time-limited test] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(46)) - raft.datastream.type = DISABLED (default)
2023-10-31 16:09:04,841 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.sleep.deviation.threshold = 300ms (default)
2023-10-31 16:09:04,841 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.close.threshold = 60s (default)
2023-10-31 16:09:04,841 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2023-10-31 16:09:04,841 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s1] (custom)
2023-10-31 16:09:04,841 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.cached = true (default)
2023-10-31 16:09:04,841 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.size = 0 (default)
2023-10-31 16:09:04,842 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 32MB (=33554432) (default)
2023-10-31 16:09:04,842 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2023-10-31 16:09:04,842 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2023-10-31 16:09:04,842 [s0-groupManagement] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(255)) - s0: new RaftServerImpl for group-270C659D1A89:[s0|localhost:38679, s1|localhost:42371, s2|localhost:39707] with SimpleStateMachine4Testing:uninitialized
2023-10-31 16:09:04,842 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.min = 150ms (default)
2023-10-31 16:09:04,842 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2023-10-31 16:09:04,842 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.sleep.time = 25ms (default)
2023-10-31 16:09:04,842 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2023-10-31 16:09:04,842 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2023-10-31 16:09:04,842 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.sleep.deviation.threshold = 300ms (default)
2023-10-31 16:09:04,842 [s0-groupManagement] INFO  server.RaftServer$Division (ServerState.java:<init>(113)) - s0@group-270C659D1A89: ConfigurationManager, init=-1: peers:[s0|localhost:38679, s1|localhost:42371, s2|localhost:39707]|listeners:[], old=null, confs=<EMPTY_MAP>
2023-10-31 16:09:04,842 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.notification.no-leader.timeout = 60s (default)
2023-10-31 16:09:04,842 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.timeout = 10s (default)
2023-10-31 16:09:04,843 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.expirytime = 60s (default)
2023-10-31 16:09:04,843 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2023-10-31 16:09:04,843 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.option = DEFAULT (default)
2023-10-31 16:09:04,843 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.read-after-write-consistent.write-index-cache.expiry-time = 60s (default)
2023-10-31 16:09:04,846 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:addNew(100)) - s1: addNew group-270C659D1A89:[s0|localhost:38679, s1|localhost:42371, s2|localhost:39707] returns group-270C659D1A89:java.util.concurrent.CompletableFuture@1bad980d[Not completed]
2023-10-31 16:09:04,846 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(382)) - newRaftServer: s2, group-270C659D1A89:[s0|localhost:38679, s1|localhost:42371, s2|localhost:39707], format? true
2023-10-31 16:09:04,846 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(305)) - deleteFully target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s2
2023-10-31 16:09:04,846 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(318)) - deleteFully: target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s2 does not exist.
2023-10-31 16:09:04,846 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(387)) - Formatted directory target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s2
2023-10-31 16:09:04,846 [Time-limited test] INFO  server.RaftServer (ConfUtils.java:logGet(46)) - raft.rpc.type = GRPC (default)
2023-10-31 16:09:04,847 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.admin.host = null (fallback to raft.grpc.server.host)
2023-10-31 16:09:04,847 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.admin.port = 35913 (custom)
2023-10-31 16:09:04,847 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.client.host = null (fallback to raft.grpc.server.host)
2023-10-31 16:09:04,847 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.client.port = 45593 (custom)
2023-10-31 16:09:04,847 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.host = null (default)
2023-10-31 16:09:04,847 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.port = 39707 (custom)
2023-10-31 16:09:04,847 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.message.size.max = 64MB (=67108864) (default)
2023-10-31 16:09:04,847 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:04,847 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2023-10-31 16:09:04,847 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:04,847 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:04,847 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.cached = true (default)
2023-10-31 16:09:04,847 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.size = 32 (default)
2023-10-31 16:09:04,848 [Time-limited test] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(46)) - raft.datastream.type = DISABLED (default)
2023-10-31 16:09:04,848 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.sleep.deviation.threshold = 300ms (default)
2023-10-31 16:09:04,848 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.close.threshold = 60s (default)
2023-10-31 16:09:04,848 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2023-10-31 16:09:04,848 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s2] (custom)
2023-10-31 16:09:04,848 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.cached = true (default)
2023-10-31 16:09:04,849 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.size = 0 (default)
2023-10-31 16:09:04,849 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 32MB (=33554432) (default)
2023-10-31 16:09:04,849 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2023-10-31 16:09:04,849 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2023-10-31 16:09:04,849 [s1-groupManagement] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(255)) - s1: new RaftServerImpl for group-270C659D1A89:[s0|localhost:38679, s1|localhost:42371, s2|localhost:39707] with SimpleStateMachine4Testing:uninitialized
2023-10-31 16:09:04,849 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.min = 150ms (default)
2023-10-31 16:09:04,849 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2023-10-31 16:09:04,849 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.sleep.time = 25ms (default)
2023-10-31 16:09:04,849 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2023-10-31 16:09:04,849 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2023-10-31 16:09:04,849 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.sleep.deviation.threshold = 300ms (default)
2023-10-31 16:09:04,849 [s1-groupManagement] INFO  server.RaftServer$Division (ServerState.java:<init>(113)) - s1@group-270C659D1A89: ConfigurationManager, init=-1: peers:[s0|localhost:38679, s1|localhost:42371, s2|localhost:39707]|listeners:[], old=null, confs=<EMPTY_MAP>
2023-10-31 16:09:04,849 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.notification.no-leader.timeout = 60s (default)
2023-10-31 16:09:04,849 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.timeout = 10s (default)
2023-10-31 16:09:04,849 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.expirytime = 60s (default)
2023-10-31 16:09:04,850 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2023-10-31 16:09:04,850 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.option = DEFAULT (default)
2023-10-31 16:09:04,850 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.read-after-write-consistent.write-index-cache.expiry-time = 60s (default)
2023-10-31 16:09:04,850 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:04,851 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:04,851 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.cached = true (default)
2023-10-31 16:09:04,851 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.size = 0 (default)
2023-10-31 16:09:04,851 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.cached = true (default)
2023-10-31 16:09:04,851 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.size = 0 (default)
2023-10-31 16:09:04,851 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:addNew(100)) - s2: addNew group-270C659D1A89:[s0|localhost:38679, s1|localhost:42371, s2|localhost:39707] returns group-270C659D1A89:java.util.concurrent.CompletableFuture@773384bf[Not completed]
2023-10-31 16:09:04,851 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2023-10-31 16:09:04,851 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.corruption.policy = EXCEPTION (default)
2023-10-31 16:09:04,851 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s0] (custom)
2023-10-31 16:09:04,851 [s0-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(138)) - The storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s0/85c15198-1537-4b5b-995b-270c659d1a89 does not exist. Creating ...
2023-10-31 16:09:04,851 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:04,851 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:04,852 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.cached = true (default)
2023-10-31 16:09:04,852 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.size = 0 (default)
2023-10-31 16:09:04,852 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.cached = true (default)
2023-10-31 16:09:04,852 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.size = 0 (default)
2023-10-31 16:09:04,852 [s0-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s0/85c15198-1537-4b5b-995b-270c659d1a89
2023-10-31 16:09:04,852 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 32MB (=33554432) (default)
2023-10-31 16:09:04,852 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2023-10-31 16:09:04,852 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2023-10-31 16:09:04,852 [s2-groupManagement] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(255)) - s2: new RaftServerImpl for group-270C659D1A89:[s0|localhost:38679, s1|localhost:42371, s2|localhost:39707] with SimpleStateMachine4Testing:uninitialized
2023-10-31 16:09:04,852 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.min = 150ms (default)
2023-10-31 16:09:04,852 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2023-10-31 16:09:04,852 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.sleep.time = 25ms (default)
2023-10-31 16:09:04,852 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2023-10-31 16:09:04,852 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2023-10-31 16:09:04,852 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.sleep.deviation.threshold = 300ms (default)
2023-10-31 16:09:04,852 [s2-groupManagement] INFO  server.RaftServer$Division (ServerState.java:<init>(113)) - s2@group-270C659D1A89: ConfigurationManager, init=-1: peers:[s0|localhost:38679, s1|localhost:42371, s2|localhost:39707]|listeners:[], old=null, confs=<EMPTY_MAP>
2023-10-31 16:09:04,852 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.notification.no-leader.timeout = 60s (default)
2023-10-31 16:09:04,852 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.timeout = 10s (default)
2023-10-31 16:09:04,852 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.expirytime = 60s (default)
2023-10-31 16:09:04,852 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2023-10-31 16:09:04,853 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.option = DEFAULT (default)
2023-10-31 16:09:04,853 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.read-after-write-consistent.write-index-cache.expiry-time = 60s (default)
2023-10-31 16:09:04,853 [s0-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(232)) - Lock on /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s0/85c15198-1537-4b5b-995b-270c659d1a89/in_use.lock acquired by nodename 15111@fv-az220-516
2023-10-31 16:09:04,853 [s0-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s0/85c15198-1537-4b5b-995b-270c659d1a89/current
2023-10-31 16:09:04,853 [s0-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s0/85c15198-1537-4b5b-995b-270c659d1a89/sm
2023-10-31 16:09:04,853 [s0-impl-thread1] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s0/85c15198-1537-4b5b-995b-270c659d1a89/current/raft-meta.tmp with options [CREATE, WRITE]: sun.nio.ch.FileChannelImpl@2959919d
2023-10-31 16:09:04,854 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:04,854 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:04,854 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.cached = true (default)
2023-10-31 16:09:04,854 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.size = 0 (default)
2023-10-31 16:09:04,854 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.cached = true (default)
2023-10-31 16:09:04,854 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.size = 0 (default)
2023-10-31 16:09:04,855 [s0-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s0/85c15198-1537-4b5b-995b-270c659d1a89/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s0/85c15198-1537-4b5b-995b-270c659d1a89/current/raft-meta with options [REPLACE_EXISTING]
2023-10-31 16:09:04,855 [s0-impl-thread1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(97)) - Storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s0/85c15198-1537-4b5b-995b-270c659d1a89 has been successfully formatted.
2023-10-31 16:09:04,855 [s0-impl-thread1] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:initialize(213)) - Initializing SimpleStateMachine4Testing:uninitialized
2023-10-31 16:09:04,855 [s0-impl-thread1] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:loadSnapshot(296)) - Loading snapshot null
2023-10-31 16:09:04,855 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.use.memory = false (default)
2023-10-31 16:09:04,855 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.gap = 1024 (default)
2023-10-31 16:09:04,856 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:04,856 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.read.timeout = 1000ms (default)
2023-10-31 16:09:04,856 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.preservation.log.num = 0 (default)
2023-10-31 16:09:04,856 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 32MB (=33554432) (default)
2023-10-31 16:09:04,856 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.num.max = 6 (default)
2023-10-31 16:09:04,856 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2023-10-31 16:09:04,856 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:04,856 [s0-impl-thread1] INFO  util.AwaitToRun (AwaitToRun.java:start(81)) - Thread[s0@group-270C659D1A89-cacheEviction-AwaitToRun,5,main] started
2023-10-31 16:09:04,856 [s0-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(184)) - new s0@group-270C659D1A89-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s0/85c15198-1537-4b5b-995b-270c659d1a89
2023-10-31 16:09:04,856 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2023-10-31 16:09:04,857 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.element-limit = 4096 (default)
2023-10-31 16:09:04,857 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 32MB (=33554432) (default)
2023-10-31 16:09:04,857 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2023-10-31 16:09:04,857 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.force.sync.num = 128 (default)
2023-10-31 16:09:04,857 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync = true (default)
2023-10-31 16:09:04,857 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2023-10-31 16:09:04,857 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2023-10-31 16:09:04,857 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2023-10-31 16:09:04,857 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:04,859 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.unsafe-flush.enabled = false (default)
2023-10-31 16:09:04,859 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.async-flush.enabled = false (default)
2023-10-31 16:09:04,859 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.caching.enabled = false (default)
2023-10-31 16:09:04,859 [s0-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(135)) - s0@group-270C659D1A89-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2023-10-31 16:09:04,859 [s0-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(135)) - s0@group-270C659D1A89-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2023-10-31 16:09:04,859 [s0-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(390)) - s0@group-270C659D1A89: start as a follower, conf=-1: peers:[s0|localhost:38679, s1|localhost:42371, s2|localhost:39707]|listeners:[], old=null
2023-10-31 16:09:04,859 [s0-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s0@group-270C659D1A89: changes role from      null to FOLLOWER at term 0 for startAsFollower
2023-10-31 16:09:04,859 [s0-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s0: start s0@group-270C659D1A89-FollowerState
2023-10-31 16:09:04,860 [s0-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-270C659D1A89,id=s0
2023-10-31 16:09:04,860 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.trigger-when-stop.enabled = true (default)
2023-10-31 16:09:04,860 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.auto.trigger.enabled = false (default)
2023-10-31 16:09:04,860 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.retention.file.num = -1 (default)
2023-10-31 16:09:04,860 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.upto.snapshot.index = false (default)
2023-10-31 16:09:04,860 [s0@group-270C659D1A89-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2023-10-31 16:09:04,860 [s0@group-270C659D1A89-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2023-10-31 16:09:04,862 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:startImpl(406)) - s0: start RPC server
2023-10-31 16:09:04,863 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s0: GrpcService started, listening on 35195
2023-10-31 16:09:04,864 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s0: GrpcService started, listening on 38679
2023-10-31 16:09:04,864 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s0: GrpcService started, listening on 36077
2023-10-31 16:09:04,865 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2023-10-31 16:09:04,865 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.corruption.policy = EXCEPTION (default)
2023-10-31 16:09:04,865 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s1] (custom)
2023-10-31 16:09:04,865 [s1-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(138)) - The storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s1/85c15198-1537-4b5b-995b-270c659d1a89 does not exist. Creating ...
2023-10-31 16:09:04,866 [s1-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s1/85c15198-1537-4b5b-995b-270c659d1a89
2023-10-31 16:09:04,866 [JvmPauseMonitor6] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(146)) - JvmPauseMonitor-s0: Started
2023-10-31 16:09:04,867 [s1-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(232)) - Lock on /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s1/85c15198-1537-4b5b-995b-270c659d1a89/in_use.lock acquired by nodename 15111@fv-az220-516
2023-10-31 16:09:04,867 [s1-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s1/85c15198-1537-4b5b-995b-270c659d1a89/current
2023-10-31 16:09:04,867 [s1-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s1/85c15198-1537-4b5b-995b-270c659d1a89/sm
2023-10-31 16:09:04,867 [s1-impl-thread1] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s1/85c15198-1537-4b5b-995b-270c659d1a89/current/raft-meta.tmp with options [CREATE, WRITE]: sun.nio.ch.FileChannelImpl@32d8796e
2023-10-31 16:09:04,869 [s1-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s1/85c15198-1537-4b5b-995b-270c659d1a89/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s1/85c15198-1537-4b5b-995b-270c659d1a89/current/raft-meta with options [REPLACE_EXISTING]
2023-10-31 16:09:04,869 [s1-impl-thread1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(97)) - Storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s1/85c15198-1537-4b5b-995b-270c659d1a89 has been successfully formatted.
2023-10-31 16:09:04,869 [s1-impl-thread1] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:initialize(213)) - Initializing SimpleStateMachine4Testing:uninitialized
2023-10-31 16:09:04,869 [s1-impl-thread1] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:loadSnapshot(296)) - Loading snapshot null
2023-10-31 16:09:04,869 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.use.memory = false (default)
2023-10-31 16:09:04,869 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.gap = 1024 (default)
2023-10-31 16:09:04,869 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:04,869 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.read.timeout = 1000ms (default)
2023-10-31 16:09:04,869 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.preservation.log.num = 0 (default)
2023-10-31 16:09:04,870 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 32MB (=33554432) (default)
2023-10-31 16:09:04,870 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.num.max = 6 (default)
2023-10-31 16:09:04,870 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2023-10-31 16:09:04,870 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:04,870 [s1-impl-thread1] INFO  util.AwaitToRun (AwaitToRun.java:start(81)) - Thread[s1@group-270C659D1A89-cacheEviction-AwaitToRun,5,main] started
2023-10-31 16:09:04,870 [s1-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(184)) - new s1@group-270C659D1A89-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s1/85c15198-1537-4b5b-995b-270c659d1a89
2023-10-31 16:09:04,870 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2023-10-31 16:09:04,870 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.element-limit = 4096 (default)
2023-10-31 16:09:04,870 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 32MB (=33554432) (default)
2023-10-31 16:09:04,870 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2023-10-31 16:09:04,870 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.force.sync.num = 128 (default)
2023-10-31 16:09:04,870 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync = true (default)
2023-10-31 16:09:04,871 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2023-10-31 16:09:04,871 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2023-10-31 16:09:04,871 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2023-10-31 16:09:04,872 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:04,873 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.unsafe-flush.enabled = false (default)
2023-10-31 16:09:04,873 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.async-flush.enabled = false (default)
2023-10-31 16:09:04,873 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.caching.enabled = false (default)
2023-10-31 16:09:04,873 [s1-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(135)) - s1@group-270C659D1A89-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2023-10-31 16:09:04,873 [s1-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(135)) - s1@group-270C659D1A89-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2023-10-31 16:09:04,874 [s1-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(390)) - s1@group-270C659D1A89: start as a follower, conf=-1: peers:[s0|localhost:38679, s1|localhost:42371, s2|localhost:39707]|listeners:[], old=null
2023-10-31 16:09:04,874 [s1-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s1@group-270C659D1A89: changes role from      null to FOLLOWER at term 0 for startAsFollower
2023-10-31 16:09:04,875 [s1-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s1: start s1@group-270C659D1A89-FollowerState
2023-10-31 16:09:04,875 [s1@group-270C659D1A89-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2023-10-31 16:09:04,875 [s1-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-270C659D1A89,id=s1
2023-10-31 16:09:04,875 [s1@group-270C659D1A89-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2023-10-31 16:09:04,875 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.trigger-when-stop.enabled = true (default)
2023-10-31 16:09:04,875 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.auto.trigger.enabled = false (default)
2023-10-31 16:09:04,875 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.retention.file.num = -1 (default)
2023-10-31 16:09:04,875 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.upto.snapshot.index = false (default)
2023-10-31 16:09:04,880 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:startImpl(406)) - s1: start RPC server
2023-10-31 16:09:04,880 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s1: GrpcService started, listening on 41917
2023-10-31 16:09:04,881 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s1: GrpcService started, listening on 42371
2023-10-31 16:09:04,881 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s1: GrpcService started, listening on 38439
2023-10-31 16:09:04,882 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2023-10-31 16:09:04,882 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.corruption.policy = EXCEPTION (default)
2023-10-31 16:09:04,882 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s2] (custom)
2023-10-31 16:09:04,882 [s2-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(138)) - The storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s2/85c15198-1537-4b5b-995b-270c659d1a89 does not exist. Creating ...
2023-10-31 16:09:04,882 [s2-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s2/85c15198-1537-4b5b-995b-270c659d1a89
2023-10-31 16:09:04,883 [JvmPauseMonitor7] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(146)) - JvmPauseMonitor-s1: Started
2023-10-31 16:09:04,884 [s2-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(232)) - Lock on /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s2/85c15198-1537-4b5b-995b-270c659d1a89/in_use.lock acquired by nodename 15111@fv-az220-516
2023-10-31 16:09:04,884 [s2-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s2/85c15198-1537-4b5b-995b-270c659d1a89/current
2023-10-31 16:09:04,885 [s2-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s2/85c15198-1537-4b5b-995b-270c659d1a89/sm
2023-10-31 16:09:04,885 [s2-impl-thread1] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s2/85c15198-1537-4b5b-995b-270c659d1a89/current/raft-meta.tmp with options [CREATE, WRITE]: sun.nio.ch.FileChannelImpl@644856f0
2023-10-31 16:09:04,886 [s2-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s2/85c15198-1537-4b5b-995b-270c659d1a89/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s2/85c15198-1537-4b5b-995b-270c659d1a89/current/raft-meta with options [REPLACE_EXISTING]
2023-10-31 16:09:04,886 [s2-impl-thread1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(97)) - Storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s2/85c15198-1537-4b5b-995b-270c659d1a89 has been successfully formatted.
2023-10-31 16:09:04,886 [s2-impl-thread1] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:initialize(213)) - Initializing SimpleStateMachine4Testing:uninitialized
2023-10-31 16:09:04,886 [s2-impl-thread1] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:loadSnapshot(296)) - Loading snapshot null
2023-10-31 16:09:04,886 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.use.memory = false (default)
2023-10-31 16:09:04,886 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.gap = 1024 (default)
2023-10-31 16:09:04,886 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:04,886 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.read.timeout = 1000ms (default)
2023-10-31 16:09:04,886 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.preservation.log.num = 0 (default)
2023-10-31 16:09:04,888 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 32MB (=33554432) (default)
2023-10-31 16:09:04,888 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.num.max = 6 (default)
2023-10-31 16:09:04,888 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2023-10-31 16:09:04,888 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:04,888 [s2-impl-thread1] INFO  util.AwaitToRun (AwaitToRun.java:start(81)) - Thread[s2@group-270C659D1A89-cacheEviction-AwaitToRun,5,main] started
2023-10-31 16:09:04,888 [s2-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(184)) - new s2@group-270C659D1A89-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s2/85c15198-1537-4b5b-995b-270c659d1a89
2023-10-31 16:09:04,888 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2023-10-31 16:09:04,888 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.element-limit = 4096 (default)
2023-10-31 16:09:04,888 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 32MB (=33554432) (default)
2023-10-31 16:09:04,888 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2023-10-31 16:09:04,888 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.force.sync.num = 128 (default)
2023-10-31 16:09:04,888 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync = true (default)
2023-10-31 16:09:04,888 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2023-10-31 16:09:04,888 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2023-10-31 16:09:04,888 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2023-10-31 16:09:04,888 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:04,890 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.unsafe-flush.enabled = false (default)
2023-10-31 16:09:04,890 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.async-flush.enabled = false (default)
2023-10-31 16:09:04,890 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.caching.enabled = false (default)
2023-10-31 16:09:04,891 [s2-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(135)) - s2@group-270C659D1A89-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2023-10-31 16:09:04,891 [s2-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(135)) - s2@group-270C659D1A89-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2023-10-31 16:09:04,894 [s2-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(390)) - s2@group-270C659D1A89: start as a follower, conf=-1: peers:[s0|localhost:38679, s1|localhost:42371, s2|localhost:39707]|listeners:[], old=null
2023-10-31 16:09:04,894 [s2-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s2@group-270C659D1A89: changes role from      null to FOLLOWER at term 0 for startAsFollower
2023-10-31 16:09:04,894 [s2-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s2: start s2@group-270C659D1A89-FollowerState
2023-10-31 16:09:04,894 [s2-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-270C659D1A89,id=s2
2023-10-31 16:09:04,894 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.trigger-when-stop.enabled = true (default)
2023-10-31 16:09:04,894 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.auto.trigger.enabled = false (default)
2023-10-31 16:09:04,894 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.retention.file.num = -1 (default)
2023-10-31 16:09:04,894 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.upto.snapshot.index = false (default)
2023-10-31 16:09:04,895 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:startImpl(406)) - s2: start RPC server
2023-10-31 16:09:04,899 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s2: GrpcService started, listening on 45593
2023-10-31 16:09:04,899 [s2@group-270C659D1A89-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2023-10-31 16:09:04,902 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s2: GrpcService started, listening on 39707
2023-10-31 16:09:04,903 [s2@group-270C659D1A89-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2023-10-31 16:09:04,904 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s2: GrpcService started, listening on 35913
2023-10-31 16:09:04,904 [JvmPauseMonitor8] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(146)) - JvmPauseMonitor-s2: Started
2023-10-31 16:09:04,904 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2023-10-31 16:09:04,904 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(100)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-270C659D1A89:t0, leader=null, voted=, raftlog=Memoized:s0@group-270C659D1A89-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:38679, s1|localhost:42371, s2|localhost:39707]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-270C659D1A89:t0, leader=null, voted=, raftlog=Memoized:s1@group-270C659D1A89-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:38679, s1|localhost:42371, s2|localhost:39707]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-270C659D1A89:t0, leader=null, voted=, raftlog=Memoized:s2@group-270C659D1A89-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:38679, s1|localhost:42371, s2|localhost:39707]|listeners:[], old=null RUNNING
2023-10-31 16:09:04,904 [Time-limited test] WARN  ratis.RaftTestUtil (JavaUtils.java:attempt(223)) - FAILED "waitForLeader-null-(expectLeader? true)", attempt #1/100: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-270C659D1A89:t0, leader=null, voted=, raftlog=Memoized:s0@group-270C659D1A89-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:38679, s1|localhost:42371, s2|localhost:39707]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-270C659D1A89:t0, leader=null, voted=, raftlog=Memoized:s1@group-270C659D1A89-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:38679, s1|localhost:42371, s2|localhost:39707]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-270C659D1A89:t0, leader=null, voted=, raftlog=Memoized:s2@group-270C659D1A89-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:38679, s1|localhost:42371, s2|localhost:39707]|listeners:[], old=null RUNNING, sleep 450ms and then retry.
java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-270C659D1A89:t0, leader=null, voted=, raftlog=Memoized:s0@group-270C659D1A89-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:38679, s1|localhost:42371, s2|localhost:39707]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-270C659D1A89:t0, leader=null, voted=, raftlog=Memoized:s1@group-270C659D1A89-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:38679, s1|localhost:42371, s2|localhost:39707]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-270C659D1A89:t0, leader=null, voted=, raftlog=Memoized:s2@group-270C659D1A89-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:38679, s1|localhost:42371, s2|localhost:39707]|listeners:[], old=null RUNNING
	at org.apache.ratis.server.impl.MiniRaftCluster.newIllegalStateExceptionForNoLeaders(MiniRaftCluster.java:581)
	at org.apache.ratis.RaftTestUtil.lambda$waitForLeader$1(RaftTestUtil.java:104)
	at org.apache.ratis.server.impl.MiniRaftCluster.getLeader(MiniRaftCluster.java:615)
	at org.apache.ratis.server.impl.MiniRaftCluster.getLeader(MiniRaftCluster.java:608)
	at org.apache.ratis.RaftTestUtil.lambda$waitForLeader$3(RaftTestUtil.java:112)
	at org.apache.ratis.util.JavaUtils.attempt(JavaUtils.java:217)
	at org.apache.ratis.util.JavaUtils.attemptRepeatedly(JavaUtils.java:203)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:111)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:92)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:87)
	at org.apache.ratis.RetryCacheTests.runTestBasicRetry(RetryCacheTests.java:65)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:141)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:121)
	at org.apache.ratis.RetryCacheTests.testBasicRetry(RetryCacheTests.java:61)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:04,910 [grpc-default-executor-2] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s0@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:37937
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:05,016 [grpc-default-executor-5] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s2@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:42947
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:05,032 [s1@group-270C659D1A89-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s1@group-270C659D1A89-FollowerState: change to CANDIDATE, lastRpcElapsedTime:157660436ns, electionTimeout:157ms
2023-10-31 16:09:05,032 [s1@group-270C659D1A89-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(109)) - s1: shutdown s1@group-270C659D1A89-FollowerState
2023-10-31 16:09:05,033 [s1@group-270C659D1A89-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s1@group-270C659D1A89: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2023-10-31 16:09:05,033 [s1@group-270C659D1A89-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2023-10-31 16:09:05,033 [s1@group-270C659D1A89-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s1: start s1@group-270C659D1A89-LeaderElection7
2023-10-31 16:09:05,034 [s1@group-270C659D1A89-LeaderElection7] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(323)) - s1@group-270C659D1A89-LeaderElection7 PRE_VOTE round 0: submit vote requests at term 0 for -1: peers:[s0|localhost:38679, s1|localhost:42371, s2|localhost:39707]|listeners:[], old=null
2023-10-31 16:09:05,035 [s1@group-270C659D1A89-LeaderElection7-1] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(65)) - Build channel for s0
2023-10-31 16:09:05,036 [s1@group-270C659D1A89-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2023-10-31 16:09:05,036 [s1@group-270C659D1A89-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2023-10-31 16:09:05,037 [s1@group-270C659D1A89-LeaderElection7-2] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(65)) - Build channel for s2
2023-10-31 16:09:05,041 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s2@group-270C659D1A89: receive requestVote(PRE_VOTE, s1, group-270C659D1A89, 0, (t:0, i:0))
2023-10-31 16:09:05,042 [grpc-default-executor-5] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-270C659D1A89-FOLLOWER: accept PRE_VOTE from s1: our priority 0 <= candidate's priority 0
2023-10-31 16:09:05,042 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s2@group-270C659D1A89 replies to PRE_VOTE vote request: s1<-s2#0:OK-t0. Peer's state: s2@group-270C659D1A89:t0, leader=null, voted=, raftlog=Memoized:s2@group-270C659D1A89-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:38679, s1|localhost:42371, s2|localhost:39707]|listeners:[], old=null
2023-10-31 16:09:05,043 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s0@group-270C659D1A89: receive requestVote(PRE_VOTE, s1, group-270C659D1A89, 0, (t:0, i:0))
2023-10-31 16:09:05,043 [grpc-default-executor-2] INFO  impl.VoteContext (VoteContext.java:log(49)) - s0@group-270C659D1A89-FOLLOWER: accept PRE_VOTE from s1: our priority 0 <= candidate's priority 0
2023-10-31 16:09:05,043 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s0@group-270C659D1A89 replies to PRE_VOTE vote request: s1<-s0#0:OK-t0. Peer's state: s0@group-270C659D1A89:t0, leader=null, voted=, raftlog=Memoized:s0@group-270C659D1A89-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:38679, s1|localhost:42371, s2|localhost:39707]|listeners:[], old=null
2023-10-31 16:09:05,047 [s1@group-270C659D1A89-LeaderElection7] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s1@group-270C659D1A89-LeaderElection7: PRE_VOTE PASSED received 1 response(s) and 0 exception(s):
2023-10-31 16:09:05,047 [s1@group-270C659D1A89-LeaderElection7] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s1<-s2#0:OK-t0
2023-10-31 16:09:05,047 [s1@group-270C659D1A89-LeaderElection7] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(325)) - s1@group-270C659D1A89-LeaderElection7 PRE_VOTE round 0: result PASSED
2023-10-31 16:09:05,047 [s1@group-270C659D1A89-LeaderElection7] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s1/85c15198-1537-4b5b-995b-270c659d1a89/current/raft-meta.tmp with options [CREATE, WRITE]: sun.nio.ch.FileChannelImpl@5491c47c
2023-10-31 16:09:05,048 [s1@group-270C659D1A89-LeaderElection7] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s1/85c15198-1537-4b5b-995b-270c659d1a89/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s1/85c15198-1537-4b5b-995b-270c659d1a89/current/raft-meta with options [REPLACE_EXISTING]
2023-10-31 16:09:05,048 [s1@group-270C659D1A89-LeaderElection7] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(323)) - s1@group-270C659D1A89-LeaderElection7 ELECTION round 0: submit vote requests at term 1 for -1: peers:[s0|localhost:38679, s1|localhost:42371, s2|localhost:39707]|listeners:[], old=null
2023-10-31 16:09:05,049 [s1@group-270C659D1A89-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2023-10-31 16:09:05,049 [s1@group-270C659D1A89-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2023-10-31 16:09:05,051 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s2@group-270C659D1A89: receive requestVote(ELECTION, s1, group-270C659D1A89, 1, (t:0, i:0))
2023-10-31 16:09:05,051 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s0@group-270C659D1A89: receive requestVote(ELECTION, s1, group-270C659D1A89, 1, (t:0, i:0))
2023-10-31 16:09:05,052 [grpc-default-executor-2] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-270C659D1A89-FOLLOWER: accept ELECTION from s1: our priority 0 <= candidate's priority 0
2023-10-31 16:09:05,052 [grpc-default-executor-5] INFO  impl.VoteContext (VoteContext.java:log(49)) - s0@group-270C659D1A89-FOLLOWER: accept ELECTION from s1: our priority 0 <= candidate's priority 0
2023-10-31 16:09:05,052 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s2@group-270C659D1A89: changes role from  FOLLOWER to FOLLOWER at term 1 for candidate:s1
2023-10-31 16:09:05,052 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s0@group-270C659D1A89: changes role from  FOLLOWER to FOLLOWER at term 1 for candidate:s1
2023-10-31 16:09:05,052 [grpc-default-executor-2] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(109)) - s2: shutdown s2@group-270C659D1A89-FollowerState
2023-10-31 16:09:05,052 [grpc-default-executor-5] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(109)) - s0: shutdown s0@group-270C659D1A89-FollowerState
2023-10-31 16:09:05,052 [s2@group-270C659D1A89-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(152)) - s2@group-270C659D1A89-FollowerState was interrupted
2023-10-31 16:09:05,052 [s0@group-270C659D1A89-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(152)) - s0@group-270C659D1A89-FollowerState was interrupted
2023-10-31 16:09:05,052 [grpc-default-executor-2] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s2: start s2@group-270C659D1A89-FollowerState
2023-10-31 16:09:05,052 [grpc-default-executor-5] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s0: start s0@group-270C659D1A89-FollowerState
2023-10-31 16:09:05,053 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:setFirstElection(562)) - s2@group-270C659D1A89: set firstElectionSinceStartup to false for candidate:s1
2023-10-31 16:09:05,053 [grpc-default-executor-2] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s2/85c15198-1537-4b5b-995b-270c659d1a89/current/raft-meta.tmp with options [CREATE, WRITE]: sun.nio.ch.FileChannelImpl@59fa4e7
2023-10-31 16:09:05,054 [grpc-default-executor-2] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s2/85c15198-1537-4b5b-995b-270c659d1a89/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s2/85c15198-1537-4b5b-995b-270c659d1a89/current/raft-meta with options [REPLACE_EXISTING]
2023-10-31 16:09:05,054 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s2@group-270C659D1A89 replies to ELECTION vote request: s1<-s2#0:OK-t1. Peer's state: s2@group-270C659D1A89:t1, leader=null, voted=s1, raftlog=Memoized:s2@group-270C659D1A89-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:38679, s1|localhost:42371, s2|localhost:39707]|listeners:[], old=null
2023-10-31 16:09:05,055 [s1@group-270C659D1A89-LeaderElection7] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s1@group-270C659D1A89-LeaderElection7: ELECTION PASSED received 1 response(s) and 0 exception(s):
2023-10-31 16:09:05,055 [s1@group-270C659D1A89-LeaderElection7] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s1<-s2#0:OK-t1
2023-10-31 16:09:05,055 [s1@group-270C659D1A89-LeaderElection7] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(325)) - s1@group-270C659D1A89-LeaderElection7 ELECTION round 0: result PASSED
2023-10-31 16:09:05,055 [s1@group-270C659D1A89-LeaderElection7] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(129)) - s1: shutdown s1@group-270C659D1A89-LeaderElection7
2023-10-31 16:09:05,055 [s1@group-270C659D1A89-LeaderElection7] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s1@group-270C659D1A89: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2023-10-31 16:09:05,056 [s1@group-270C659D1A89-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.staging.catchup.gap = 1000 (default)
2023-10-31 16:09:05,056 [s1@group-270C659D1A89-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.element-limit = 4096 (default)
2023-10-31 16:09:05,056 [s1@group-270C659D1A89-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.byte-limit = 64MB (=67108864) (default)
2023-10-31 16:09:05,056 [s1@group-270C659D1A89-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.timeout = 10s (default)
2023-10-31 16:09:05,056 [s1@group-270C659D1A89-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.timeout.denomination = 1s (default)
2023-10-31 16:09:05,056 [s1@group-270C659D1A89-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.element-limit = 65536 (default)
2023-10-31 16:09:05,056 [s1@group-270C659D1A89-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.leader.lease.enabled = false (default)
2023-10-31 16:09:05,056 [s1@group-270C659D1A89-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.leader.lease.timeout.ratio = 0.9 (default)
2023-10-31 16:09:05,056 [s1@group-270C659D1A89-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.min = 150ms (default)
2023-10-31 16:09:05,056 [s1@group-270C659D1A89-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.element-limit = 4096 (default)
2023-10-31 16:09:05,056 [s1@group-270C659D1A89-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.follower.gap.ratio.max = -1.0 (default)
2023-10-31 16:09:05,056 [s1@group-270C659D1A89-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:05,057 [s1@group-270C659D1A89-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:05,057 [s1@group-270C659D1A89-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:05,057 [s1@group-270C659D1A89-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:05,057 [s1@group-270C659D1A89-LeaderElection7] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:05,057 [s1@group-270C659D1A89-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:05,057 [s1@group-270C659D1A89-LeaderElection7] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:05,057 [s1@group-270C659D1A89-LeaderElection7] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:05,057 [s1@group-270C659D1A89-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:05,057 [s1@group-270C659D1A89-LeaderElection7] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:05,057 [s1@group-270C659D1A89-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:05,057 [s1@group-270C659D1A89-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:05,057 [s1@group-270C659D1A89-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:05,057 [s1@group-270C659D1A89-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:05,057 [s1@group-270C659D1A89-LeaderElection7] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:05,057 [s1@group-270C659D1A89-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:05,057 [s1@group-270C659D1A89-LeaderElection7] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:05,058 [s1@group-270C659D1A89-LeaderElection7] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:05,058 [s1@group-270C659D1A89-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:05,058 [s1@group-270C659D1A89-LeaderElection7] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:05,058 [s1@group-270C659D1A89-LeaderElection7] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s1: start s1@group-270C659D1A89-LeaderStateImpl
2023-10-31 16:09:05,058 [s1@group-270C659D1A89-LeaderElection7] INFO  server.RaftServer$Division (RaftServerImpl.java:setFirstElection(562)) - s1@group-270C659D1A89: set firstElectionSinceStartup to false for becomeLeader
2023-10-31 16:09:05,058 [s1@group-270C659D1A89-LeaderElection7] INFO  server.RaftServer$Division (ServerState.java:setLeader(265)) - s1@group-270C659D1A89: change Leader from null to s1 at term 1 for becomeLeader, leader elected after 208ms
2023-10-31 16:09:05,058 [s1@group-270C659D1A89-LeaderElection7] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(428)) - s1@group-270C659D1A89-SegmentedRaftLogWorker: Starting segment from index:0
2023-10-31 16:09:05,058 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:setFirstElection(562)) - s0@group-270C659D1A89: set firstElectionSinceStartup to false for candidate:s1
2023-10-31 16:09:05,059 [grpc-default-executor-5] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s0/85c15198-1537-4b5b-995b-270c659d1a89/current/raft-meta.tmp with options [CREATE, WRITE]: sun.nio.ch.FileChannelImpl@4e6b547e
2023-10-31 16:09:05,060 [grpc-default-executor-5] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s0/85c15198-1537-4b5b-995b-270c659d1a89/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s0/85c15198-1537-4b5b-995b-270c659d1a89/current/raft-meta with options [REPLACE_EXISTING]
2023-10-31 16:09:05,060 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s0@group-270C659D1A89 replies to ELECTION vote request: s1<-s0#0:OK-t1. Peer's state: s0@group-270C659D1A89:t1, leader=null, voted=s1, raftlog=Memoized:s0@group-270C659D1A89-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:38679, s1|localhost:42371, s2|localhost:39707]|listeners:[], old=null
2023-10-31 16:09:05,064 [s1@group-270C659D1A89-LeaderElection7] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(382)) - s1@group-270C659D1A89: set configuration 0: peers:[s0|localhost:38679, s1|localhost:42371, s2|localhost:39707]|listeners:[], old=null
2023-10-31 16:09:05,070 [s1@group-270C659D1A89-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(632)) - s1@group-270C659D1A89-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s1/85c15198-1537-4b5b-995b-270c659d1a89/current/log_inprogress_0
2023-10-31 16:09:05,078 [s0-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setLeader(265)) - s0@group-270C659D1A89: change Leader from null to s1 at term 1 for appendEntries, leader elected after 235ms
2023-10-31 16:09:05,079 [s0-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s0@group-270C659D1A89: receive appendEntries(s1, 1, null, -1, true, commits:[s1:c-1, s0:c-1, s2:c-1], cId:1, entries: [(t:1, i:0), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:38679"
dataStreamAddress: "localhost:33191"
clientAddress: "localhost:35195"
adminAddress: "localhost:36077"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:42371"
dataStreamAddress: "localhost:41055"
clientAddress: "localhost:41917"
adminAddress: "localhost:38439"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:39707"
dataStreamAddress: "localhost:42823"
clientAddress: "localhost:45593"
adminAddress: "localhost:35913"
startupRole: FOLLOWER
, old:)]
2023-10-31 16:09:05,082 [s0-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(382)) - s0@group-270C659D1A89: set configuration 0: peers:[s0|localhost:38679, s1|localhost:42371, s2|localhost:39707]|listeners:[], old=null
2023-10-31 16:09:05,082 [s0-server-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(428)) - s0@group-270C659D1A89-SegmentedRaftLogWorker: Starting segment from index:0
2023-10-31 16:09:05,091 [s2-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setLeader(265)) - s2@group-270C659D1A89: change Leader from null to s1 at term 1 for appendEntries, leader elected after 239ms
2023-10-31 16:09:05,095 [s0@group-270C659D1A89-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(632)) - s0@group-270C659D1A89-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s0/85c15198-1537-4b5b-995b-270c659d1a89/current/log_inprogress_0
2023-10-31 16:09:05,096 [s0-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s0@group-270C659D1A89: succeeded to handle AppendEntries. Reply: s1<-s0#1:OK-t1,SUCCESS,nextIndex=1,followerCommit=-1,matchIndex=0
2023-10-31 16:09:05,097 [s1@group-270C659D1A89-StateMachineUpdater] INFO  server.RaftServer$Division (LeaderStateImpl.java:isApplied(308)) - leader is ready since appliedIndex == 0 >= startIndex == 0
2023-10-31 16:09:05,107 [s2-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-270C659D1A89: receive appendEntries(s1, 1, null, -1, true, commits:[s1:c-1, s0:c-1, s2:c-1], cId:1, entries: [(t:1, i:0), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:38679"
dataStreamAddress: "localhost:33191"
clientAddress: "localhost:35195"
adminAddress: "localhost:36077"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:42371"
dataStreamAddress: "localhost:41055"
clientAddress: "localhost:41917"
adminAddress: "localhost:38439"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:39707"
dataStreamAddress: "localhost:42823"
clientAddress: "localhost:45593"
adminAddress: "localhost:35913"
startupRole: FOLLOWER
, old:)]
2023-10-31 16:09:05,115 [s2-server-thread3] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(382)) - s2@group-270C659D1A89: set configuration 0: peers:[s0|localhost:38679, s1|localhost:42371, s2|localhost:39707]|listeners:[], old=null
2023-10-31 16:09:05,115 [s2-server-thread3] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(428)) - s2@group-270C659D1A89-SegmentedRaftLogWorker: Starting segment from index:0
2023-10-31 16:09:05,124 [grpc-default-executor-2] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s0@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:37937
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:05,131 [s2@group-270C659D1A89-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(632)) - s2@group-270C659D1A89-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpcec0cc2cc/s2/85c15198-1537-4b5b-995b-270c659d1a89/current/log_inprogress_0
2023-10-31 16:09:05,131 [s2-server-thread4] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-270C659D1A89: succeeded to handle AppendEntries. Reply: s1<-s2#1:OK-t1,SUCCESS,nextIndex=1,followerCommit=-1,matchIndex=0
2023-10-31 16:09:05,231 [grpc-default-executor-2] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s2@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:42947
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:05,337 [grpc-default-executor-4] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s1@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.drainPendingCallbacks(DelayedClientCall.java:510)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$1DrainListenerRunnable.runInContext(DelayedClientCall.java:299)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 11 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 11 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:37189
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:05,355 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(119)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-270C659D1A89:t1, leader=s1, voted=s1, raftlog=Memoized:s0@group-270C659D1A89-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|localhost:38679, s1|localhost:42371, s2|localhost:39707]|listeners:[], old=null RUNNING
  s1:  RUNNING    LEADER s1@group-270C659D1A89:t1, leader=s1, voted=s1, raftlog=Memoized:s1@group-270C659D1A89-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|localhost:38679, s1|localhost:42371, s2|localhost:39707]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-270C659D1A89:t1, leader=s1, voted=s1, raftlog=Memoized:s2@group-270C659D1A89-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|localhost:38679, s1|localhost:42371, s2|localhost:39707]|listeners:[], old=null RUNNING
2023-10-31 16:09:05,364 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(891)) - s1@group-270C659D1A89: receive client request(RaftClientRequest:client-3CDAB6349711->s1@group-270C659D1A89, cid=12, seq=null, RW, Message:6669727374206d736720...(size=30))
2023-10-31 16:09:05,365 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(508)) - s1@group-270C659D1A89-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-3CDAB6349711->s1@group-270C659D1A89, cid=12, seq=null, RW, Message:6669727374206d736720...(size=30), entry=(t:1, i:1), STATEMACHINELOGENTRY, 12@client-3CDAB6349711
2023-10-31 16:09:05,368 [s0-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s0@group-270C659D1A89: receive appendEntries(s1, 1, (t:1, i:0), 0, true, commits:[s1:c0, s0:c0, s2:c0], cId:7, entries: [(t:1, i:1), STATEMACHINELOGENTRY, 12@client-3CDAB6349711]
2023-10-31 16:09:05,369 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-270C659D1A89: receive appendEntries(s1, 1, (t:1, i:0), 0, true, commits:[s1:c0, s0:c0, s2:c0], cId:10, entries: [(t:1, i:1), STATEMACHINELOGENTRY, 12@client-3CDAB6349711]
2023-10-31 16:09:05,371 [s0-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s0@group-270C659D1A89: succeeded to handle AppendEntries. Reply: s1<-s0#7:OK-t1,SUCCESS,nextIndex=2,followerCommit=0,matchIndex=1
2023-10-31 16:09:05,371 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-270C659D1A89: succeeded to handle AppendEntries. Reply: s1<-s2#10:OK-t1,SUCCESS,nextIndex=2,followerCommit=0,matchIndex=1
2023-10-31 16:09:05,372 [s1@group-270C659D1A89-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:applyTransaction(248)) - applyTransaction for log index 1
2023-10-31 16:09:05,372 [s1@group-270C659D1A89-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(205)) - s1: put 1, first msg ... -> (t:1, i:1), STATEMACHINELOGENTRY, 12@client-3CDAB6349711
2023-10-31 16:09:05,374 [s0-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s0@group-270C659D1A89: receive appendEntries(s1, 1, (t:1, i:1), 1, true, commits:[s1:c1, s0:c0, s2:c0], cId:8, entries: [(t:1, i:2), METADATAENTRY(c:1)]
2023-10-31 16:09:05,375 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-270C659D1A89: receive appendEntries(s1, 1, (t:1, i:1), 1, true, commits:[s1:c1, s0:c0, s2:c0], cId:11, entries: [(t:1, i:2), METADATAENTRY(c:1)]
2023-10-31 16:09:05,375 [s0-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s0@group-270C659D1A89: succeeded to handle AppendEntries. Reply: s1<-s0#8:OK-t1,SUCCESS,nextIndex=3,followerCommit=1,matchIndex=2
2023-10-31 16:09:05,375 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-270C659D1A89: succeeded to handle AppendEntries. Reply: s1<-s2#11:OK-t1,SUCCESS,nextIndex=3,followerCommit=1,matchIndex=2
2023-10-31 16:09:05,375 [s0@group-270C659D1A89-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:applyTransaction(248)) - applyTransaction for log index 1
2023-10-31 16:09:05,376 [s0@group-270C659D1A89-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(205)) - s0: put 1, first msg ... -> (t:1, i:1), STATEMACHINELOGENTRY, 12@client-3CDAB6349711
2023-10-31 16:09:05,376 [s2@group-270C659D1A89-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:applyTransaction(248)) - applyTransaction for log index 1
2023-10-31 16:09:05,376 [s2@group-270C659D1A89-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(205)) - s2: put 1, first msg ... -> (t:1, i:1), STATEMACHINELOGENTRY, 12@client-3CDAB6349711
2023-10-31 16:09:05,399 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(891)) - s1@group-270C659D1A89: receive client request(RaftClientRequest:client-A8325481039A->s1@group-270C659D1A89, cid=999, seq=null, RW, Message:6d657373616765)
2023-10-31 16:09:05,400 [s1-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(508)) - s1@group-270C659D1A89-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-A8325481039A->s1@group-270C659D1A89, cid=999, seq=null, RW, Message:6d657373616765, entry=(t:1, i:3), STATEMACHINELOGENTRY, 999@client-A8325481039A
2023-10-31 16:09:05,402 [s0-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s0@group-270C659D1A89: receive appendEntries(s1, 1, (t:1, i:2), 2, true, commits:[s1:c2, s0:c1, s2:c1], cId:12, entries: [(t:1, i:3), STATEMACHINELOGENTRY, 999@client-A8325481039A]
2023-10-31 16:09:05,402 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-270C659D1A89: receive appendEntries(s1, 1, (t:1, i:2), 2, true, commits:[s1:c2, s0:c1, s2:c1], cId:13, entries: [(t:1, i:3), STATEMACHINELOGENTRY, 999@client-A8325481039A]
2023-10-31 16:09:05,403 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-270C659D1A89: succeeded to handle AppendEntries. Reply: s1<-s2#13:OK-t1,SUCCESS,nextIndex=4,followerCommit=2,matchIndex=3
2023-10-31 16:09:05,403 [s0-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s0@group-270C659D1A89: succeeded to handle AppendEntries. Reply: s1<-s0#12:OK-t1,SUCCESS,nextIndex=4,followerCommit=2,matchIndex=3
2023-10-31 16:09:05,405 [s1@group-270C659D1A89-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:applyTransaction(248)) - applyTransaction for log index 3
2023-10-31 16:09:05,405 [s1@group-270C659D1A89-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(205)) - s1: put 3, message -> (t:1, i:3), STATEMACHINELOGENTRY, 999@client-A8325481039A
2023-10-31 16:09:05,410 [s0-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s0@group-270C659D1A89: receive appendEntries(s1, 1, (t:1, i:3), 3, true, commits:[s1:c3, s0:c1, s2:c2], cId:13, entries: [(t:1, i:4), METADATAENTRY(c:3)]
2023-10-31 16:09:05,411 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-270C659D1A89: receive appendEntries(s1, 1, (t:1, i:3), 3, true, commits:[s1:c3, s0:c1, s2:c2], cId:14, entries: [(t:1, i:4), METADATAENTRY(c:3)]
2023-10-31 16:09:05,412 [s0-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s0@group-270C659D1A89: succeeded to handle AppendEntries. Reply: s1<-s0#13:OK-t1,SUCCESS,nextIndex=5,followerCommit=3,matchIndex=4
2023-10-31 16:09:05,412 [s0@group-270C659D1A89-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:applyTransaction(248)) - applyTransaction for log index 3
2023-10-31 16:09:05,412 [s0@group-270C659D1A89-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(205)) - s0: put 3, message -> (t:1, i:3), STATEMACHINELOGENTRY, 999@client-A8325481039A
2023-10-31 16:09:05,412 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-270C659D1A89: succeeded to handle AppendEntries. Reply: s1<-s2#14:OK-t1,SUCCESS,nextIndex=5,followerCommit=3,matchIndex=4
2023-10-31 16:09:05,413 [s2@group-270C659D1A89-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:applyTransaction(248)) - applyTransaction for log index 3
2023-10-31 16:09:05,413 [s2@group-270C659D1A89-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(205)) - s2: put 3, message -> (t:1, i:3), STATEMACHINELOGENTRY, 999@client-A8325481039A
2023-10-31 16:09:05,419 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(891)) - s1@group-270C659D1A89: receive client request(RaftClientRequest:client-A8325481039A->s1@group-270C659D1A89, cid=999, seq=null, RW, Message:6d657373616765)
2023-10-31 16:09:05,422 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(891)) - s1@group-270C659D1A89: receive client request(RaftClientRequest:client-A8325481039A->s1@group-270C659D1A89, cid=999, seq=null, RW, Message:6d657373616765)
2023-10-31 16:09:05,424 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(891)) - s1@group-270C659D1A89: receive client request(RaftClientRequest:client-A8325481039A->s1@group-270C659D1A89, cid=999, seq=null, RW, Message:6d657373616765)
2023-10-31 16:09:05,429 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(891)) - s1@group-270C659D1A89: receive client request(RaftClientRequest:client-A8325481039A->s1@group-270C659D1A89, cid=999, seq=null, RW, Message:6d657373616765)
2023-10-31 16:09:05,432 [s1-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(891)) - s1@group-270C659D1A89: receive client request(RaftClientRequest:client-A8325481039A->s1@group-270C659D1A89, cid=999, seq=null, RW, Message:6d657373616765)
2023-10-31 16:09:05,435 [Time-limited test] INFO  grpc.TestRetryCacheWithGrpc (RetryCacheTests.java:assertServer(95)) - check server s0
2023-10-31 16:09:05,443 [grpc-default-executor-4] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s2@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:42947
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:05,549 [grpc-default-executor-4] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s0@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:37937
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:05,658 [grpc-default-executor-1] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s2@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:42947
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:05,763 [grpc-default-executor-2] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s1@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:37189
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:05,869 [grpc-default-executor-1] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s0@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:37937
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:05,977 [grpc-default-executor-5] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s1@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:37189
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:06,083 [grpc-default-executor-1] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s2@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:42947
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:06,189 [grpc-default-executor-4] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s1@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:37189
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:06,293 [grpc-default-executor-1] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s0@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:37937
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:06,398 [grpc-default-executor-4] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s1@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:37189
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:06,437 [Time-limited test] INFO  grpc.TestRetryCacheWithGrpc (RetryCacheTests.java:assertServer(95)) - check server s1
2023-10-31 16:09:06,437 [Time-limited test] INFO  grpc.TestRetryCacheWithGrpc (RetryCacheTests.java:assertServer(95)) - check server s2
2023-10-31 16:09:06,439 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(831)) - ************************************************************** 
2023-10-31 16:09:06,439 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(832)) - *** 
2023-10-31 16:09:06,439 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(833)) - ***     Stopping MiniRaftClusterWithGrpc
2023-10-31 16:09:06,439 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(834)) - *** 
2023-10-31 16:09:06,439 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(835)) - ************************************************************** 
2023-10-31 16:09:06,439 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(836)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-270C659D1A89:t1, leader=s1, voted=s1, raftlog=Memoized:s0@group-270C659D1A89-SegmentedRaftLog:OPENED:c4, conf=0: peers:[s0|localhost:38679, s1|localhost:42371, s2|localhost:39707]|listeners:[], old=null RUNNING
  s1:  RUNNING    LEADER s1@group-270C659D1A89:t1, leader=s1, voted=s1, raftlog=Memoized:s1@group-270C659D1A89-SegmentedRaftLog:OPENED:c4, conf=0: peers:[s0|localhost:38679, s1|localhost:42371, s2|localhost:39707]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-270C659D1A89:t1, leader=s1, voted=s1, raftlog=Memoized:s2@group-270C659D1A89-SegmentedRaftLog:OPENED:c4, conf=0: peers:[s0|localhost:38679, s1|localhost:42371, s2|localhost:39707]|listeners:[], old=null RUNNING
2023-10-31 16:09:06,439 [MiniRaftCluster-7] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$9(416)) - s0: close
2023-10-31 16:09:06,442 [MiniRaftCluster-8] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$9(416)) - s1: close
2023-10-31 16:09:06,442 [MiniRaftCluster-7] INFO  server.GrpcService (GrpcService.java:closeImpl(311)) - s0: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService now
2023-10-31 16:09:06,443 [s1-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$3(514)) - s1@group-270C659D1A89: shutdown
2023-10-31 16:09:06,443 [s1-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-270C659D1A89,id=s1
2023-10-31 16:09:06,443 [s1-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(92)) - s1: shutdown s1@group-270C659D1A89-LeaderStateImpl
2023-10-31 16:09:06,442 [MiniRaftCluster-9] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$9(416)) - s2: close
2023-10-31 16:09:06,442 [s0-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$3(514)) - s0@group-270C659D1A89: shutdown
2023-10-31 16:09:06,445 [s0-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-270C659D1A89,id=s0
2023-10-31 16:09:06,445 [s0-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(109)) - s0: shutdown s0@group-270C659D1A89-FollowerState
2023-10-31 16:09:06,445 [s0-impl-thread1] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(157)) - s0@group-270C659D1A89-StateMachineUpdater: set stopIndex = 4
2023-10-31 16:09:06,445 [s0@group-270C659D1A89-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(152)) - s0@group-270C659D1A89-FollowerState was interrupted
2023-10-31 16:09:06,444 [s1@group-270C659D1A89->s2-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(211)) - s1@group-270C659D1A89->s2-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2023-10-31 16:09:06,445 [s0-impl-thread1] INFO  server.RaftServer$Division (ServerState.java:close(423)) - s0@group-270C659D1A89: applyIndex: 4
2023-10-31 16:09:06,445 [s0@group-270C659D1A89-cacheEviction-AwaitToRun] INFO  util.AwaitToRun (AwaitToRun.java:run(49)) - s0@group-270C659D1A89-cacheEviction-AwaitToRun-AwaitForSignal is interrupted
2023-10-31 16:09:06,446 [grpc-default-executor-4] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(157)) - s2: Completed APPEND_ENTRIES, lastRequest: s1->s2#14-t1,previous=(t:1, i:3),leaderCommit=3,initializing? true,entries: size=1, first=(t:1, i:4), METADATAENTRY(c:3)
2023-10-31 16:09:06,446 [grpc-default-executor-4] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:lambda$onCompleted$5(159)) - s2: Completed APPEND_ENTRIES, lastReply: null
2023-10-31 16:09:06,446 [grpc-default-executor-4] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(157)) - s2: Completed APPEND_ENTRIES, lastRequest: null
2023-10-31 16:09:06,446 [grpc-default-executor-4] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:lambda$onCompleted$5(159)) - s2: Completed APPEND_ENTRIES, lastReply: serverReply {
  requestorId: "s1"
  replyId: "s2"
  raftGroupId {
    id: "\205\301Q\230\0257K[\231[\'\fe\235\032\211"
  }
  callId: 30
  success: true
}
term: 1
nextIndex: 5
followerCommit: 4
matchIndex: 18446744073709551615
isHearbeat: true

2023-10-31 16:09:06,449 [MiniRaftCluster-8] INFO  server.GrpcService (GrpcService.java:closeImpl(311)) - s1: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService now
2023-10-31 16:09:06,444 [s1@group-270C659D1A89->s0-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(211)) - s1@group-270C659D1A89->s0-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2023-10-31 16:09:06,449 [grpc-default-executor-4] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(468)) - s1@group-270C659D1A89->s2-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2023-10-31 16:09:06,450 [grpc-default-executor-5] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(157)) - s0: Completed APPEND_ENTRIES, lastRequest: s1->s0#13-t1,previous=(t:1, i:3),leaderCommit=3,initializing? true,entries: size=1, first=(t:1, i:4), METADATAENTRY(c:3)
2023-10-31 16:09:06,450 [grpc-default-executor-5] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:lambda$onCompleted$5(159)) - s0: Completed APPEND_ENTRIES, lastReply: null
2023-10-31 16:09:06,450 [grpc-default-executor-2] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(157)) - s0: Completed APPEND_ENTRIES, lastRequest: null
2023-10-31 16:09:06,450 [grpc-default-executor-4] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(468)) - s1@group-270C659D1A89->s2-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2023-10-31 16:09:06,450 [grpc-default-executor-2] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:lambda$onCompleted$5(159)) - s0: Completed APPEND_ENTRIES, lastReply: serverReply {
  requestorId: "s1"
  replyId: "s0"
  raftGroupId {
    id: "\205\301Q\230\0257K[\231[\'\fe\235\032\211"
  }
  callId: 28
  success: true
}
term: 1
nextIndex: 5
followerCommit: 4
matchIndex: 18446744073709551615
isHearbeat: true

2023-10-31 16:09:06,452 [grpc-default-executor-2] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(468)) - s1@group-270C659D1A89->s0-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2023-10-31 16:09:06,452 [grpc-default-executor-2] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(468)) - s1@group-270C659D1A89->s0-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2023-10-31 16:09:06,454 [Thread-242] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:close(103)) - s0 Close channels
2023-10-31 16:09:06,444 [s1-impl-thread1] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(289)) - s1@group-270C659D1A89-PendingRequests: sendNotLeaderResponses
2023-10-31 16:09:06,459 [MiniRaftCluster-9] INFO  server.GrpcService (GrpcService.java:closeImpl(311)) - s2: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService now
2023-10-31 16:09:06,459 [s2-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$3(514)) - s2@group-270C659D1A89: shutdown
2023-10-31 16:09:06,461 [s2-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-270C659D1A89,id=s2
2023-10-31 16:09:06,461 [s2-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(109)) - s2: shutdown s2@group-270C659D1A89-FollowerState
2023-10-31 16:09:06,461 [s2-impl-thread1] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(157)) - s2@group-270C659D1A89-StateMachineUpdater: set stopIndex = 4
2023-10-31 16:09:06,461 [s1-impl-thread1] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(157)) - s1@group-270C659D1A89-StateMachineUpdater: set stopIndex = 4
2023-10-31 16:09:06,462 [s2@group-270C659D1A89-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(152)) - s2@group-270C659D1A89-FollowerState was interrupted
2023-10-31 16:09:06,462 [s1-impl-thread1] INFO  server.RaftServer$Division (ServerState.java:close(423)) - s1@group-270C659D1A89: applyIndex: 4
2023-10-31 16:09:06,462 [s1@group-270C659D1A89-cacheEviction-AwaitToRun] INFO  util.AwaitToRun (AwaitToRun.java:run(49)) - s1@group-270C659D1A89-cacheEviction-AwaitToRun-AwaitForSignal is interrupted
2023-10-31 16:09:06,462 [s2-impl-thread1] INFO  server.RaftServer$Division (ServerState.java:close(423)) - s2@group-270C659D1A89: applyIndex: 4
2023-10-31 16:09:06,462 [s2@group-270C659D1A89-cacheEviction-AwaitToRun] INFO  util.AwaitToRun (AwaitToRun.java:run(49)) - s2@group-270C659D1A89-cacheEviction-AwaitToRun-AwaitForSignal is interrupted
2023-10-31 16:09:06,464 [Thread-244] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:close(103)) - s2 Close channels
2023-10-31 16:09:06,468 [MiniRaftCluster-7] INFO  server.GrpcService (GrpcService.java:closeImpl(320)) - s0: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService successfully
2023-10-31 16:09:06,468 [MiniRaftCluster-7] INFO  server.GrpcService (GrpcService.java:closeImpl(311)) - s0: shutdown server GrpcServerProtocolService now
2023-10-31 16:09:06,468 [MiniRaftCluster-8] INFO  server.GrpcService (GrpcService.java:closeImpl(320)) - s1: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService successfully
2023-10-31 16:09:06,468 [MiniRaftCluster-8] INFO  server.GrpcService (GrpcService.java:closeImpl(311)) - s1: shutdown server GrpcServerProtocolService now
2023-10-31 16:09:06,470 [MiniRaftCluster-9] INFO  server.GrpcService (GrpcService.java:closeImpl(320)) - s2: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService successfully
2023-10-31 16:09:06,470 [MiniRaftCluster-9] INFO  server.GrpcService (GrpcService.java:closeImpl(311)) - s2: shutdown server GrpcServerProtocolService now
2023-10-31 16:09:06,474 [MiniRaftCluster-7] INFO  server.GrpcService (GrpcService.java:closeImpl(320)) - s0: shutdown server GrpcServerProtocolService successfully
2023-10-31 16:09:06,474 [MiniRaftCluster-7] INFO  server.GrpcService (GrpcService.java:closeImpl(311)) - s0: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService now
2023-10-31 16:09:06,475 [MiniRaftCluster-8] INFO  server.GrpcService (GrpcService.java:closeImpl(320)) - s1: shutdown server GrpcServerProtocolService successfully
2023-10-31 16:09:06,475 [MiniRaftCluster-8] INFO  server.GrpcService (GrpcService.java:closeImpl(311)) - s1: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService now
2023-10-31 16:09:06,476 [MiniRaftCluster-7] INFO  server.GrpcService (GrpcService.java:closeImpl(320)) - s0: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService successfully
2023-10-31 16:09:06,477 [MiniRaftCluster-9] INFO  server.GrpcService (GrpcService.java:closeImpl(320)) - s2: shutdown server GrpcServerProtocolService successfully
2023-10-31 16:09:06,477 [MiniRaftCluster-9] INFO  server.GrpcService (GrpcService.java:closeImpl(311)) - s2: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService now
2023-10-31 16:09:06,482 [MiniRaftCluster-8] INFO  server.GrpcService (GrpcService.java:closeImpl(320)) - s1: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService successfully
2023-10-31 16:09:06,484 [MiniRaftCluster-9] INFO  server.GrpcService (GrpcService.java:closeImpl(320)) - s2: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService successfully
2023-10-31 16:09:06,503 [grpc-default-executor-5] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s2@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.drainPendingCallbacks(DelayedClientCall.java:510)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$1DrainListenerRunnable.runInContext(DelayedClientCall.java:299)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 11 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 11 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:42947
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:06,608 [grpc-default-executor-4] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s0@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:37937
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:06,713 [grpc-default-executor-2] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s1@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:37189
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:06,818 [grpc-default-executor-4] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s2@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:42947
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:06,924 [grpc-default-executor-4] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s1@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:37189
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:07,029 [grpc-default-executor-2] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s0@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:37937
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:07,134 [grpc-default-executor-5] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s2@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:42947
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:07,242 [grpc-default-executor-2] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s0@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:37937
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:07,347 [grpc-default-executor-4] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s2@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:42947
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:07,411 [s1-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(243)) - s1@group-270C659D1A89-SegmentedRaftLogWorker close()
2023-10-31 16:09:07,412 [JvmPauseMonitor7] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(152)) - JvmPauseMonitor-s1: Stopped
2023-10-31 16:09:07,412 [s0-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(243)) - s0@group-270C659D1A89-SegmentedRaftLogWorker close()
2023-10-31 16:09:07,413 [s2-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(243)) - s2@group-270C659D1A89-SegmentedRaftLogWorker close()
2023-10-31 16:09:07,415 [JvmPauseMonitor8] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(152)) - JvmPauseMonitor-s2: Stopped
2023-10-31 16:09:07,415 [JvmPauseMonitor6] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(152)) - JvmPauseMonitor-s0: Stopped
2023-10-31 16:09:07,415 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(855)) - MiniRaftClusterWithGrpc shutdown completed
2023-10-31 16:09:07,416 [main] INFO  util.LogUtils (Slf4jUtils.java:setLogLevel(38)) - Successfully set org.apache.ratis.conf.ConfUtils log level to WARN
2023-10-31 16:09:07,416 [main] INFO  util.LogUtils (Slf4jUtils.java:setLogLevel(38)) - Successfully set org.apache.ratis.util.FileUtils log level to TRACE
2023-10-31 16:09:07,416 [main] INFO  util.LogUtils (Slf4jUtils.java:setLogLevel(38)) - Successfully set org.apache.ratis.server.RetryCache log level to TRACE
2023-10-31 16:09:07,417 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:runWithNewCluster(135)) - Running runWithNewCluster
2023-10-31 16:09:07,417 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:<init>(306)) - new MiniRaftClusterWithGrpc with group-54E8E36963C5:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]
2023-10-31 16:09:07,417 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(339)) - .............................................................. 
2023-10-31 16:09:07,417 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(340)) - ... 
2023-10-31 16:09:07,417 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(341)) - ...     Starting MiniRaftClusterWithGrpc
2023-10-31 16:09:07,417 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(342)) - ... 
2023-10-31 16:09:07,417 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(343)) - .............................................................. 
2023-10-31 16:09:07,418 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:initServers(318)) - servers = {}
2023-10-31 16:09:07,418 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(382)) - newRaftServer: s0, group-54E8E36963C5:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689], format? true
2023-10-31 16:09:07,418 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(305)) - deleteFully target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s0
2023-10-31 16:09:07,418 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(318)) - deleteFully: target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s0 does not exist.
2023-10-31 16:09:07,418 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(387)) - Formatted directory target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s0
2023-10-31 16:09:07,418 [Time-limited test] INFO  server.RaftServer (ConfUtils.java:logGet(46)) - raft.rpc.type = GRPC (default)
2023-10-31 16:09:07,418 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.admin.host = null (fallback to raft.grpc.server.host)
2023-10-31 16:09:07,418 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.admin.port = 43529 (custom)
2023-10-31 16:09:07,418 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.client.host = null (fallback to raft.grpc.server.host)
2023-10-31 16:09:07,418 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.client.port = 44585 (custom)
2023-10-31 16:09:07,418 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.host = null (default)
2023-10-31 16:09:07,418 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.port = 38037 (custom)
2023-10-31 16:09:07,419 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.message.size.max = 64MB (=67108864) (default)
2023-10-31 16:09:07,419 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:07,419 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2023-10-31 16:09:07,419 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:07,419 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:07,419 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.cached = true (default)
2023-10-31 16:09:07,419 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.size = 32 (default)
2023-10-31 16:09:07,420 [Time-limited test] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(46)) - raft.datastream.type = DISABLED (default)
2023-10-31 16:09:07,420 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.sleep.deviation.threshold = 300ms (default)
2023-10-31 16:09:07,420 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.close.threshold = 60s (default)
2023-10-31 16:09:07,420 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2023-10-31 16:09:07,420 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s0] (custom)
2023-10-31 16:09:07,420 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.cached = true (default)
2023-10-31 16:09:07,420 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.size = 0 (default)
2023-10-31 16:09:07,421 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:addNew(100)) - s0: addNew group-54E8E36963C5:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689] returns group-54E8E36963C5:java.util.concurrent.CompletableFuture@59f6650d[Not completed]
2023-10-31 16:09:07,421 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(382)) - newRaftServer: s1, group-54E8E36963C5:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689], format? true
2023-10-31 16:09:07,421 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(305)) - deleteFully target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s1
2023-10-31 16:09:07,421 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(318)) - deleteFully: target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s1 does not exist.
2023-10-31 16:09:07,421 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(387)) - Formatted directory target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s1
2023-10-31 16:09:07,421 [Time-limited test] INFO  server.RaftServer (ConfUtils.java:logGet(46)) - raft.rpc.type = GRPC (default)
2023-10-31 16:09:07,421 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.admin.host = null (fallback to raft.grpc.server.host)
2023-10-31 16:09:07,422 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.admin.port = 46337 (custom)
2023-10-31 16:09:07,422 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.client.host = null (fallback to raft.grpc.server.host)
2023-10-31 16:09:07,422 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.client.port = 34575 (custom)
2023-10-31 16:09:07,422 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.host = null (default)
2023-10-31 16:09:07,422 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.port = 45329 (custom)
2023-10-31 16:09:07,422 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.message.size.max = 64MB (=67108864) (default)
2023-10-31 16:09:07,422 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:07,422 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2023-10-31 16:09:07,422 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:07,422 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:07,422 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.cached = true (default)
2023-10-31 16:09:07,422 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.size = 32 (default)
2023-10-31 16:09:07,423 [Time-limited test] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(46)) - raft.datastream.type = DISABLED (default)
2023-10-31 16:09:07,423 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.sleep.deviation.threshold = 300ms (default)
2023-10-31 16:09:07,423 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.close.threshold = 60s (default)
2023-10-31 16:09:07,423 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2023-10-31 16:09:07,423 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s1] (custom)
2023-10-31 16:09:07,423 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.cached = true (default)
2023-10-31 16:09:07,423 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.size = 0 (default)
2023-10-31 16:09:07,424 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 32MB (=33554432) (default)
2023-10-31 16:09:07,424 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2023-10-31 16:09:07,424 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2023-10-31 16:09:07,424 [s0-groupManagement] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(255)) - s0: new RaftServerImpl for group-54E8E36963C5:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689] with SimpleStateMachine4Testing:uninitialized
2023-10-31 16:09:07,424 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.min = 150ms (default)
2023-10-31 16:09:07,424 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2023-10-31 16:09:07,424 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.sleep.time = 25ms (default)
2023-10-31 16:09:07,424 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2023-10-31 16:09:07,424 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2023-10-31 16:09:07,424 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.sleep.deviation.threshold = 300ms (default)
2023-10-31 16:09:07,424 [s0-groupManagement] INFO  server.RaftServer$Division (ServerState.java:<init>(113)) - s0@group-54E8E36963C5: ConfigurationManager, init=-1: peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null, confs=<EMPTY_MAP>
2023-10-31 16:09:07,424 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.notification.no-leader.timeout = 60s (default)
2023-10-31 16:09:07,424 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.timeout = 10s (default)
2023-10-31 16:09:07,424 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.expirytime = 60s (default)
2023-10-31 16:09:07,424 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2023-10-31 16:09:07,424 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.option = DEFAULT (default)
2023-10-31 16:09:07,424 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.read-after-write-consistent.write-index-cache.expiry-time = 60s (default)
2023-10-31 16:09:07,425 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:07,425 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:07,425 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.cached = true (default)
2023-10-31 16:09:07,425 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.size = 0 (default)
2023-10-31 16:09:07,425 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.cached = true (default)
2023-10-31 16:09:07,425 [s0-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.size = 0 (default)
2023-10-31 16:09:07,427 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:addNew(100)) - s1: addNew group-54E8E36963C5:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689] returns group-54E8E36963C5:java.util.concurrent.CompletableFuture@536d432f[Not completed]
2023-10-31 16:09:07,427 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(382)) - newRaftServer: s2, group-54E8E36963C5:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689], format? true
2023-10-31 16:09:07,427 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(305)) - deleteFully target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s2
2023-10-31 16:09:07,427 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(318)) - deleteFully: target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s2 does not exist.
2023-10-31 16:09:07,427 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(387)) - Formatted directory target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s2
2023-10-31 16:09:07,427 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 32MB (=33554432) (default)
2023-10-31 16:09:07,427 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2023-10-31 16:09:07,427 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2023-10-31 16:09:07,427 [Time-limited test] INFO  server.RaftServer (ConfUtils.java:logGet(46)) - raft.rpc.type = GRPC (default)
2023-10-31 16:09:07,428 [s1-groupManagement] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(255)) - s1: new RaftServerImpl for group-54E8E36963C5:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689] with SimpleStateMachine4Testing:uninitialized
2023-10-31 16:09:07,428 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.min = 150ms (default)
2023-10-31 16:09:07,428 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.admin.host = null (fallback to raft.grpc.server.host)
2023-10-31 16:09:07,428 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2023-10-31 16:09:07,428 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.admin.port = 33809 (custom)
2023-10-31 16:09:07,428 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.sleep.time = 25ms (default)
2023-10-31 16:09:07,428 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.client.host = null (fallback to raft.grpc.server.host)
2023-10-31 16:09:07,428 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2023-10-31 16:09:07,428 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.client.port = 40999 (custom)
2023-10-31 16:09:07,428 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2023-10-31 16:09:07,428 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.host = null (default)
2023-10-31 16:09:07,428 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.port = 44689 (custom)
2023-10-31 16:09:07,428 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.message.size.max = 64MB (=67108864) (default)
2023-10-31 16:09:07,428 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:07,428 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2023-10-31 16:09:07,428 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.sleep.deviation.threshold = 300ms (default)
2023-10-31 16:09:07,428 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:07,428 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:07,428 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.cached = true (default)
2023-10-31 16:09:07,428 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.size = 32 (default)
2023-10-31 16:09:07,429 [Time-limited test] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(46)) - raft.datastream.type = DISABLED (default)
2023-10-31 16:09:07,429 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.sleep.deviation.threshold = 300ms (default)
2023-10-31 16:09:07,429 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.close.threshold = 60s (default)
2023-10-31 16:09:07,429 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2023-10-31 16:09:07,430 [s1-groupManagement] INFO  server.RaftServer$Division (ServerState.java:<init>(113)) - s1@group-54E8E36963C5: ConfigurationManager, init=-1: peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null, confs=<EMPTY_MAP>
2023-10-31 16:09:07,430 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s2] (custom)
2023-10-31 16:09:07,430 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.notification.no-leader.timeout = 60s (default)
2023-10-31 16:09:07,430 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.cached = true (default)
2023-10-31 16:09:07,430 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.timeout = 10s (default)
2023-10-31 16:09:07,430 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.size = 0 (default)
2023-10-31 16:09:07,430 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.expirytime = 60s (default)
2023-10-31 16:09:07,430 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2023-10-31 16:09:07,430 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.option = DEFAULT (default)
2023-10-31 16:09:07,430 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.read-after-write-consistent.write-index-cache.expiry-time = 60s (default)
2023-10-31 16:09:07,431 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:07,431 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:07,431 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.cached = true (default)
2023-10-31 16:09:07,431 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.size = 0 (default)
2023-10-31 16:09:07,431 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.cached = true (default)
2023-10-31 16:09:07,431 [s1-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.size = 0 (default)
2023-10-31 16:09:07,434 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:addNew(100)) - s2: addNew group-54E8E36963C5:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689] returns group-54E8E36963C5:java.util.concurrent.CompletableFuture@71240ecf[Not completed]
2023-10-31 16:09:07,434 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 32MB (=33554432) (default)
2023-10-31 16:09:07,434 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2023-10-31 16:09:07,434 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2023-10-31 16:09:07,434 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2023-10-31 16:09:07,434 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.corruption.policy = EXCEPTION (default)
2023-10-31 16:09:07,434 [s2-groupManagement] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(255)) - s2: new RaftServerImpl for group-54E8E36963C5:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689] with SimpleStateMachine4Testing:uninitialized
2023-10-31 16:09:07,434 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.min = 150ms (default)
2023-10-31 16:09:07,434 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s0] (custom)
2023-10-31 16:09:07,434 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2023-10-31 16:09:07,434 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.sleep.time = 25ms (default)
2023-10-31 16:09:07,434 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2023-10-31 16:09:07,434 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2023-10-31 16:09:07,435 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.sleep.deviation.threshold = 300ms (default)
2023-10-31 16:09:07,435 [s0-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(138)) - The storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s0/a979c418-0a1f-47d8-9ffe-54e8e36963c5 does not exist. Creating ...
2023-10-31 16:09:07,435 [s2-groupManagement] INFO  server.RaftServer$Division (ServerState.java:<init>(113)) - s2@group-54E8E36963C5: ConfigurationManager, init=-1: peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null, confs=<EMPTY_MAP>
2023-10-31 16:09:07,435 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.notification.no-leader.timeout = 60s (default)
2023-10-31 16:09:07,435 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.timeout = 10s (default)
2023-10-31 16:09:07,435 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.expirytime = 60s (default)
2023-10-31 16:09:07,435 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2023-10-31 16:09:07,435 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.option = DEFAULT (default)
2023-10-31 16:09:07,435 [s0-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s0/a979c418-0a1f-47d8-9ffe-54e8e36963c5
2023-10-31 16:09:07,435 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.read-after-write-consistent.write-index-cache.expiry-time = 60s (default)
2023-10-31 16:09:07,436 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:07,436 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:07,436 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.cached = true (default)
2023-10-31 16:09:07,436 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.size = 0 (default)
2023-10-31 16:09:07,436 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.cached = true (default)
2023-10-31 16:09:07,436 [s2-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.size = 0 (default)
2023-10-31 16:09:07,436 [s0-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(232)) - Lock on /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s0/a979c418-0a1f-47d8-9ffe-54e8e36963c5/in_use.lock acquired by nodename 15111@fv-az220-516
2023-10-31 16:09:07,437 [s0-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s0/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current
2023-10-31 16:09:07,437 [s0-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s0/a979c418-0a1f-47d8-9ffe-54e8e36963c5/sm
2023-10-31 16:09:07,437 [s0-impl-thread1] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s0/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/raft-meta.tmp with options [CREATE, WRITE]: sun.nio.ch.FileChannelImpl@7f5cd299
2023-10-31 16:09:07,438 [s0-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s0/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s0/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/raft-meta with options [REPLACE_EXISTING]
2023-10-31 16:09:07,438 [s0-impl-thread1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(97)) - Storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s0/a979c418-0a1f-47d8-9ffe-54e8e36963c5 has been successfully formatted.
2023-10-31 16:09:07,438 [s0-impl-thread1] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:initialize(213)) - Initializing SimpleStateMachine4Testing:uninitialized
2023-10-31 16:09:07,438 [s0-impl-thread1] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:loadSnapshot(296)) - Loading snapshot null
2023-10-31 16:09:07,438 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.use.memory = false (default)
2023-10-31 16:09:07,438 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.gap = 1024 (default)
2023-10-31 16:09:07,438 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:07,438 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.read.timeout = 1000ms (default)
2023-10-31 16:09:07,439 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.preservation.log.num = 0 (default)
2023-10-31 16:09:07,439 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 32MB (=33554432) (default)
2023-10-31 16:09:07,439 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.num.max = 6 (default)
2023-10-31 16:09:07,439 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2023-10-31 16:09:07,439 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:07,440 [s0-impl-thread1] INFO  util.AwaitToRun (AwaitToRun.java:start(81)) - Thread[s0@group-54E8E36963C5-cacheEviction-AwaitToRun,5,main] started
2023-10-31 16:09:07,440 [s0-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(184)) - new s0@group-54E8E36963C5-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s0/a979c418-0a1f-47d8-9ffe-54e8e36963c5
2023-10-31 16:09:07,440 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2023-10-31 16:09:07,440 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.element-limit = 4096 (default)
2023-10-31 16:09:07,440 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 32MB (=33554432) (default)
2023-10-31 16:09:07,440 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2023-10-31 16:09:07,440 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.force.sync.num = 128 (default)
2023-10-31 16:09:07,440 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync = true (default)
2023-10-31 16:09:07,440 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2023-10-31 16:09:07,440 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2023-10-31 16:09:07,440 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2023-10-31 16:09:07,440 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:07,442 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.unsafe-flush.enabled = false (default)
2023-10-31 16:09:07,442 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.async-flush.enabled = false (default)
2023-10-31 16:09:07,442 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.caching.enabled = false (default)
2023-10-31 16:09:07,442 [s0-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(135)) - s0@group-54E8E36963C5-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2023-10-31 16:09:07,442 [s0-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(135)) - s0@group-54E8E36963C5-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2023-10-31 16:09:07,446 [s0-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(390)) - s0@group-54E8E36963C5: start as a follower, conf=-1: peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:07,446 [s0-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s0@group-54E8E36963C5: changes role from      null to FOLLOWER at term 0 for startAsFollower
2023-10-31 16:09:07,446 [s0-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s0: start s0@group-54E8E36963C5-FollowerState
2023-10-31 16:09:07,448 [s0-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-54E8E36963C5,id=s0
2023-10-31 16:09:07,448 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.trigger-when-stop.enabled = true (default)
2023-10-31 16:09:07,448 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.auto.trigger.enabled = false (default)
2023-10-31 16:09:07,448 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.retention.file.num = -1 (default)
2023-10-31 16:09:07,448 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.upto.snapshot.index = false (default)
2023-10-31 16:09:07,448 [s0@group-54E8E36963C5-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2023-10-31 16:09:07,448 [s0@group-54E8E36963C5-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2023-10-31 16:09:07,451 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:startImpl(406)) - s0: start RPC server
2023-10-31 16:09:07,453 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s0: GrpcService started, listening on 44585
2023-10-31 16:09:07,453 [grpc-default-executor-2] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s1@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:37189
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:07,454 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s0: GrpcService started, listening on 38037
2023-10-31 16:09:07,454 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s0: GrpcService started, listening on 43529
2023-10-31 16:09:07,454 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2023-10-31 16:09:07,454 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.corruption.policy = EXCEPTION (default)
2023-10-31 16:09:07,455 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s1] (custom)
2023-10-31 16:09:07,455 [s1-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(138)) - The storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s1/a979c418-0a1f-47d8-9ffe-54e8e36963c5 does not exist. Creating ...
2023-10-31 16:09:07,455 [s1-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s1/a979c418-0a1f-47d8-9ffe-54e8e36963c5
2023-10-31 16:09:07,457 [JvmPauseMonitor9] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(146)) - JvmPauseMonitor-s0: Started
2023-10-31 16:09:07,457 [s1-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(232)) - Lock on /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s1/a979c418-0a1f-47d8-9ffe-54e8e36963c5/in_use.lock acquired by nodename 15111@fv-az220-516
2023-10-31 16:09:07,457 [s1-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s1/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current
2023-10-31 16:09:07,457 [s1-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s1/a979c418-0a1f-47d8-9ffe-54e8e36963c5/sm
2023-10-31 16:09:07,457 [s1-impl-thread1] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s1/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/raft-meta.tmp with options [CREATE, WRITE]: sun.nio.ch.FileChannelImpl@48951912
2023-10-31 16:09:07,459 [s1-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s1/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s1/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/raft-meta with options [REPLACE_EXISTING]
2023-10-31 16:09:07,459 [s1-impl-thread1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(97)) - Storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s1/a979c418-0a1f-47d8-9ffe-54e8e36963c5 has been successfully formatted.
2023-10-31 16:09:07,459 [s1-impl-thread1] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:initialize(213)) - Initializing SimpleStateMachine4Testing:uninitialized
2023-10-31 16:09:07,459 [s1-impl-thread1] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:loadSnapshot(296)) - Loading snapshot null
2023-10-31 16:09:07,459 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.use.memory = false (default)
2023-10-31 16:09:07,459 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.gap = 1024 (default)
2023-10-31 16:09:07,459 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:07,459 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.read.timeout = 1000ms (default)
2023-10-31 16:09:07,459 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.preservation.log.num = 0 (default)
2023-10-31 16:09:07,460 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 32MB (=33554432) (default)
2023-10-31 16:09:07,460 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.num.max = 6 (default)
2023-10-31 16:09:07,460 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2023-10-31 16:09:07,460 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:07,460 [s1-impl-thread1] INFO  util.AwaitToRun (AwaitToRun.java:start(81)) - Thread[s1@group-54E8E36963C5-cacheEviction-AwaitToRun,5,main] started
2023-10-31 16:09:07,460 [s1-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(184)) - new s1@group-54E8E36963C5-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s1/a979c418-0a1f-47d8-9ffe-54e8e36963c5
2023-10-31 16:09:07,460 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2023-10-31 16:09:07,460 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.element-limit = 4096 (default)
2023-10-31 16:09:07,460 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 32MB (=33554432) (default)
2023-10-31 16:09:07,460 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2023-10-31 16:09:07,460 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.force.sync.num = 128 (default)
2023-10-31 16:09:07,460 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync = true (default)
2023-10-31 16:09:07,460 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2023-10-31 16:09:07,460 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2023-10-31 16:09:07,461 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2023-10-31 16:09:07,461 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:07,462 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.unsafe-flush.enabled = false (default)
2023-10-31 16:09:07,462 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.async-flush.enabled = false (default)
2023-10-31 16:09:07,462 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.caching.enabled = false (default)
2023-10-31 16:09:07,463 [s1-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(135)) - s1@group-54E8E36963C5-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2023-10-31 16:09:07,463 [s1-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(135)) - s1@group-54E8E36963C5-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2023-10-31 16:09:07,464 [s1-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(390)) - s1@group-54E8E36963C5: start as a follower, conf=-1: peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:07,464 [s1-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s1@group-54E8E36963C5: changes role from      null to FOLLOWER at term 0 for startAsFollower
2023-10-31 16:09:07,464 [s1-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s1: start s1@group-54E8E36963C5-FollowerState
2023-10-31 16:09:07,469 [s1-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-54E8E36963C5,id=s1
2023-10-31 16:09:07,469 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.trigger-when-stop.enabled = true (default)
2023-10-31 16:09:07,469 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.auto.trigger.enabled = false (default)
2023-10-31 16:09:07,469 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.retention.file.num = -1 (default)
2023-10-31 16:09:07,469 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.upto.snapshot.index = false (default)
2023-10-31 16:09:07,470 [s1@group-54E8E36963C5-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2023-10-31 16:09:07,470 [s1@group-54E8E36963C5-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2023-10-31 16:09:07,474 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:startImpl(406)) - s1: start RPC server
2023-10-31 16:09:07,475 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s1: GrpcService started, listening on 34575
2023-10-31 16:09:07,475 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s1: GrpcService started, listening on 45329
2023-10-31 16:09:07,476 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s1: GrpcService started, listening on 46337
2023-10-31 16:09:07,477 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2023-10-31 16:09:07,477 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.corruption.policy = EXCEPTION (default)
2023-10-31 16:09:07,477 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s2] (custom)
2023-10-31 16:09:07,478 [s2-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(138)) - The storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s2/a979c418-0a1f-47d8-9ffe-54e8e36963c5 does not exist. Creating ...
2023-10-31 16:09:07,478 [s2-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s2/a979c418-0a1f-47d8-9ffe-54e8e36963c5
2023-10-31 16:09:07,478 [JvmPauseMonitor10] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(146)) - JvmPauseMonitor-s1: Started
2023-10-31 16:09:07,479 [s2-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(232)) - Lock on /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s2/a979c418-0a1f-47d8-9ffe-54e8e36963c5/in_use.lock acquired by nodename 15111@fv-az220-516
2023-10-31 16:09:07,479 [s2-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s2/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current
2023-10-31 16:09:07,480 [s2-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s2/a979c418-0a1f-47d8-9ffe-54e8e36963c5/sm
2023-10-31 16:09:07,480 [s2-impl-thread1] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s2/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/raft-meta.tmp with options [CREATE, WRITE]: sun.nio.ch.FileChannelImpl@6eedfb8b
2023-10-31 16:09:07,481 [s2-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s2/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s2/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/raft-meta with options [REPLACE_EXISTING]
2023-10-31 16:09:07,481 [s2-impl-thread1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(97)) - Storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s2/a979c418-0a1f-47d8-9ffe-54e8e36963c5 has been successfully formatted.
2023-10-31 16:09:07,481 [s2-impl-thread1] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:initialize(213)) - Initializing SimpleStateMachine4Testing:uninitialized
2023-10-31 16:09:07,481 [s2-impl-thread1] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:loadSnapshot(296)) - Loading snapshot null
2023-10-31 16:09:07,481 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.use.memory = false (default)
2023-10-31 16:09:07,481 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.gap = 1024 (default)
2023-10-31 16:09:07,481 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:07,481 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.read.timeout = 1000ms (default)
2023-10-31 16:09:07,481 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.preservation.log.num = 0 (default)
2023-10-31 16:09:07,482 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 32MB (=33554432) (default)
2023-10-31 16:09:07,482 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.num.max = 6 (default)
2023-10-31 16:09:07,482 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2023-10-31 16:09:07,482 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:07,483 [s2-impl-thread1] INFO  util.AwaitToRun (AwaitToRun.java:start(81)) - Thread[s2@group-54E8E36963C5-cacheEviction-AwaitToRun,5,main] started
2023-10-31 16:09:07,484 [s2-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(184)) - new s2@group-54E8E36963C5-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s2/a979c418-0a1f-47d8-9ffe-54e8e36963c5
2023-10-31 16:09:07,484 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2023-10-31 16:09:07,484 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.element-limit = 4096 (default)
2023-10-31 16:09:07,484 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 32MB (=33554432) (default)
2023-10-31 16:09:07,484 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2023-10-31 16:09:07,484 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.force.sync.num = 128 (default)
2023-10-31 16:09:07,484 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync = true (default)
2023-10-31 16:09:07,484 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2023-10-31 16:09:07,484 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2023-10-31 16:09:07,484 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2023-10-31 16:09:07,484 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:07,485 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.unsafe-flush.enabled = false (default)
2023-10-31 16:09:07,485 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.async-flush.enabled = false (default)
2023-10-31 16:09:07,485 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.caching.enabled = false (default)
2023-10-31 16:09:07,486 [s2-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(135)) - s2@group-54E8E36963C5-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2023-10-31 16:09:07,486 [s2-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(135)) - s2@group-54E8E36963C5-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2023-10-31 16:09:07,486 [s2-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(390)) - s2@group-54E8E36963C5: start as a follower, conf=-1: peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:07,486 [s2-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s2@group-54E8E36963C5: changes role from      null to FOLLOWER at term 0 for startAsFollower
2023-10-31 16:09:07,486 [s2-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s2: start s2@group-54E8E36963C5-FollowerState
2023-10-31 16:09:07,486 [s2@group-54E8E36963C5-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2023-10-31 16:09:07,486 [s2@group-54E8E36963C5-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2023-10-31 16:09:07,488 [s2-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-54E8E36963C5,id=s2
2023-10-31 16:09:07,488 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.trigger-when-stop.enabled = true (default)
2023-10-31 16:09:07,488 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.auto.trigger.enabled = false (default)
2023-10-31 16:09:07,488 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.retention.file.num = -1 (default)
2023-10-31 16:09:07,488 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.upto.snapshot.index = false (default)
2023-10-31 16:09:07,488 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:startImpl(406)) - s2: start RPC server
2023-10-31 16:09:07,489 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s2: GrpcService started, listening on 40999
2023-10-31 16:09:07,490 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s2: GrpcService started, listening on 44689
2023-10-31 16:09:07,490 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s2: GrpcService started, listening on 33809
2023-10-31 16:09:07,491 [JvmPauseMonitor11] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(146)) - JvmPauseMonitor-s2: Started
2023-10-31 16:09:07,491 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2023-10-31 16:09:07,491 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(100)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-54E8E36963C5:t0, leader=null, voted=, raftlog=Memoized:s0@group-54E8E36963C5-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-54E8E36963C5:t0, leader=null, voted=, raftlog=Memoized:s1@group-54E8E36963C5-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-54E8E36963C5:t0, leader=null, voted=, raftlog=Memoized:s2@group-54E8E36963C5-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null RUNNING
2023-10-31 16:09:07,491 [Time-limited test] WARN  ratis.RaftTestUtil (JavaUtils.java:attempt(223)) - FAILED "waitForLeader-null-(expectLeader? true)", attempt #1/100: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-54E8E36963C5:t0, leader=null, voted=, raftlog=Memoized:s0@group-54E8E36963C5-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-54E8E36963C5:t0, leader=null, voted=, raftlog=Memoized:s1@group-54E8E36963C5-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-54E8E36963C5:t0, leader=null, voted=, raftlog=Memoized:s2@group-54E8E36963C5-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null RUNNING, sleep 450ms and then retry.
java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-54E8E36963C5:t0, leader=null, voted=, raftlog=Memoized:s0@group-54E8E36963C5-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-54E8E36963C5:t0, leader=null, voted=, raftlog=Memoized:s1@group-54E8E36963C5-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-54E8E36963C5:t0, leader=null, voted=, raftlog=Memoized:s2@group-54E8E36963C5-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null RUNNING
	at org.apache.ratis.server.impl.MiniRaftCluster.newIllegalStateExceptionForNoLeaders(MiniRaftCluster.java:581)
	at org.apache.ratis.RaftTestUtil.lambda$waitForLeader$1(RaftTestUtil.java:104)
	at org.apache.ratis.server.impl.MiniRaftCluster.getLeader(MiniRaftCluster.java:615)
	at org.apache.ratis.server.impl.MiniRaftCluster.getLeader(MiniRaftCluster.java:608)
	at org.apache.ratis.RaftTestUtil.lambda$waitForLeader$3(RaftTestUtil.java:112)
	at org.apache.ratis.util.JavaUtils.attempt(JavaUtils.java:217)
	at org.apache.ratis.util.JavaUtils.attemptRepeatedly(JavaUtils.java:203)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:111)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:92)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:87)
	at org.apache.ratis.RetryCacheTests.runTestRetryOnNewLeader(RetryCacheTests.java:126)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:141)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:121)
	at org.apache.ratis.RetryCacheTests.testRetryOnNewLeader(RetryCacheTests.java:122)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:07,558 [grpc-default-executor-4] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s2@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:42947
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:07,655 [s2@group-54E8E36963C5-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s2@group-54E8E36963C5-FollowerState: change to CANDIDATE, lastRpcElapsedTime:168588433ns, electionTimeout:168ms
2023-10-31 16:09:07,655 [s2@group-54E8E36963C5-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(109)) - s2: shutdown s2@group-54E8E36963C5-FollowerState
2023-10-31 16:09:07,655 [s2@group-54E8E36963C5-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s2@group-54E8E36963C5: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2023-10-31 16:09:07,655 [s2@group-54E8E36963C5-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2023-10-31 16:09:07,655 [s2@group-54E8E36963C5-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s2: start s2@group-54E8E36963C5-LeaderElection8
2023-10-31 16:09:07,659 [s0@group-54E8E36963C5-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s0@group-54E8E36963C5-FollowerState: change to CANDIDATE, lastRpcElapsedTime:212945830ns, electionTimeout:210ms
2023-10-31 16:09:07,659 [s0@group-54E8E36963C5-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(109)) - s0: shutdown s0@group-54E8E36963C5-FollowerState
2023-10-31 16:09:07,659 [s0@group-54E8E36963C5-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s0@group-54E8E36963C5: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2023-10-31 16:09:07,662 [s0@group-54E8E36963C5-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2023-10-31 16:09:07,662 [s0@group-54E8E36963C5-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s0: start s0@group-54E8E36963C5-LeaderElection9
2023-10-31 16:09:07,663 [grpc-default-executor-5] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s1@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:37189
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:07,664 [s2@group-54E8E36963C5-LeaderElection8] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(323)) - s2@group-54E8E36963C5-LeaderElection8 PRE_VOTE round 0: submit vote requests at term 0 for -1: peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:07,664 [s0@group-54E8E36963C5-LeaderElection9] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(323)) - s0@group-54E8E36963C5-LeaderElection9 PRE_VOTE round 0: submit vote requests at term 0 for -1: peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:07,664 [s0@group-54E8E36963C5-LeaderElection9-1] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(65)) - Build channel for s1
2023-10-31 16:09:07,664 [s2@group-54E8E36963C5-LeaderElection8-1] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(65)) - Build channel for s0
2023-10-31 16:09:07,665 [s2@group-54E8E36963C5-LeaderElection8] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2023-10-31 16:09:07,665 [s2@group-54E8E36963C5-LeaderElection8] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2023-10-31 16:09:07,666 [s2@group-54E8E36963C5-LeaderElection8-2] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(65)) - Build channel for s1
2023-10-31 16:09:07,668 [s0@group-54E8E36963C5-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2023-10-31 16:09:07,668 [s0@group-54E8E36963C5-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2023-10-31 16:09:07,688 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s0@group-54E8E36963C5: receive requestVote(PRE_VOTE, s2, group-54E8E36963C5, 0, (t:0, i:0))
2023-10-31 16:09:07,688 [grpc-default-executor-5] INFO  impl.VoteContext (VoteContext.java:log(49)) - s0@group-54E8E36963C5-CANDIDATE: accept PRE_VOTE from s2: our priority 0 <= candidate's priority 0
2023-10-31 16:09:07,688 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s0@group-54E8E36963C5 replies to PRE_VOTE vote request: s2<-s0#0:OK-t0. Peer's state: s0@group-54E8E36963C5:t0, leader=null, voted=, raftlog=Memoized:s0@group-54E8E36963C5-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:07,690 [s2@group-54E8E36963C5-LeaderElection8] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s2@group-54E8E36963C5-LeaderElection8: PRE_VOTE PASSED received 1 response(s) and 0 exception(s):
2023-10-31 16:09:07,690 [s2@group-54E8E36963C5-LeaderElection8] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s2<-s0#0:OK-t0
2023-10-31 16:09:07,690 [s2@group-54E8E36963C5-LeaderElection8] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(325)) - s2@group-54E8E36963C5-LeaderElection8 PRE_VOTE round 0: result PASSED
2023-10-31 16:09:07,690 [s2@group-54E8E36963C5-LeaderElection8] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s2/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/raft-meta.tmp with options [CREATE, WRITE]: sun.nio.ch.FileChannelImpl@de22dc
2023-10-31 16:09:07,691 [s2@group-54E8E36963C5-LeaderElection8] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s2/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s2/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/raft-meta with options [REPLACE_EXISTING]
2023-10-31 16:09:07,692 [s2@group-54E8E36963C5-LeaderElection8] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(323)) - s2@group-54E8E36963C5-LeaderElection8 ELECTION round 0: submit vote requests at term 1 for -1: peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:07,692 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s1@group-54E8E36963C5: receive requestVote(PRE_VOTE, s0, group-54E8E36963C5, 0, (t:0, i:0))
2023-10-31 16:09:07,692 [grpc-default-executor-5] INFO  impl.VoteContext (VoteContext.java:log(49)) - s1@group-54E8E36963C5-FOLLOWER: accept PRE_VOTE from s0: our priority 0 <= candidate's priority 0
2023-10-31 16:09:07,692 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s1@group-54E8E36963C5 replies to PRE_VOTE vote request: s0<-s1#0:OK-t0. Peer's state: s1@group-54E8E36963C5:t0, leader=null, voted=, raftlog=Memoized:s1@group-54E8E36963C5-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:07,693 [s0@group-54E8E36963C5-LeaderElection9] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s0@group-54E8E36963C5-LeaderElection9: PRE_VOTE PASSED received 1 response(s) and 0 exception(s):
2023-10-31 16:09:07,693 [s0@group-54E8E36963C5-LeaderElection9] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s0<-s1#0:OK-t0
2023-10-31 16:09:07,693 [s0@group-54E8E36963C5-LeaderElection9] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(325)) - s0@group-54E8E36963C5-LeaderElection9 PRE_VOTE round 0: result PASSED
2023-10-31 16:09:07,693 [s0@group-54E8E36963C5-LeaderElection9] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s0/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/raft-meta.tmp with options [CREATE, WRITE]: sun.nio.ch.FileChannelImpl@31e1811
2023-10-31 16:09:07,694 [s0@group-54E8E36963C5-LeaderElection9-2] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(65)) - Build channel for s2
2023-10-31 16:09:07,695 [s0@group-54E8E36963C5-LeaderElection9] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s0/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s0/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/raft-meta with options [REPLACE_EXISTING]
2023-10-31 16:09:07,695 [s0@group-54E8E36963C5-LeaderElection9] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(323)) - s0@group-54E8E36963C5-LeaderElection9 ELECTION round 0: submit vote requests at term 1 for -1: peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:07,699 [s0@group-54E8E36963C5-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2023-10-31 16:09:07,699 [s0@group-54E8E36963C5-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2023-10-31 16:09:07,700 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s1@group-54E8E36963C5: receive requestVote(ELECTION, s0, group-54E8E36963C5, 1, (t:0, i:0))
2023-10-31 16:09:07,700 [grpc-default-executor-5] INFO  impl.VoteContext (VoteContext.java:log(49)) - s1@group-54E8E36963C5-FOLLOWER: accept ELECTION from s0: our priority 0 <= candidate's priority 0
2023-10-31 16:09:07,700 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s1@group-54E8E36963C5: changes role from  FOLLOWER to FOLLOWER at term 1 for candidate:s0
2023-10-31 16:09:07,700 [grpc-default-executor-5] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(109)) - s1: shutdown s1@group-54E8E36963C5-FollowerState
2023-10-31 16:09:07,701 [s1@group-54E8E36963C5-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(152)) - s1@group-54E8E36963C5-FollowerState was interrupted
2023-10-31 16:09:07,703 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s0@group-54E8E36963C5: receive requestVote(ELECTION, s2, group-54E8E36963C5, 1, (t:0, i:0))
2023-10-31 16:09:07,703 [grpc-default-executor-4] INFO  impl.VoteContext (VoteContext.java:log(49)) - s0@group-54E8E36963C5-CANDIDATE: reject ELECTION from s2: already has voted for s0 at current term 1
2023-10-31 16:09:07,703 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s0@group-54E8E36963C5 replies to ELECTION vote request: s2<-s0#0:FAIL-t1. Peer's state: s0@group-54E8E36963C5:t1, leader=null, voted=s0, raftlog=Memoized:s0@group-54E8E36963C5-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:07,704 [s2@group-54E8E36963C5-LeaderElection8] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2023-10-31 16:09:07,704 [s2@group-54E8E36963C5-LeaderElection8] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2023-10-31 16:09:07,705 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s1@group-54E8E36963C5: receive requestVote(PRE_VOTE, s2, group-54E8E36963C5, 0, (t:0, i:0))
2023-10-31 16:09:07,705 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s1@group-54E8E36963C5: receive requestVote(ELECTION, s2, group-54E8E36963C5, 1, (t:0, i:0))
2023-10-31 16:09:07,710 [grpc-default-executor-5] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s1: start s1@group-54E8E36963C5-FollowerState
2023-10-31 16:09:07,710 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:setFirstElection(562)) - s1@group-54E8E36963C5: set firstElectionSinceStartup to false for candidate:s0
2023-10-31 16:09:07,710 [grpc-default-executor-5] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s1/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/raft-meta.tmp with options [CREATE, WRITE]: sun.nio.ch.FileChannelImpl@83b90e0
2023-10-31 16:09:07,712 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s2@group-54E8E36963C5: receive requestVote(ELECTION, s0, group-54E8E36963C5, 1, (t:0, i:0))
2023-10-31 16:09:07,712 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s2@group-54E8E36963C5: receive requestVote(PRE_VOTE, s0, group-54E8E36963C5, 0, (t:0, i:0))
2023-10-31 16:09:07,712 [grpc-default-executor-6] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-54E8E36963C5-CANDIDATE: reject ELECTION from s0: already has voted for s2 at current term 1
2023-10-31 16:09:07,712 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s2@group-54E8E36963C5 replies to ELECTION vote request: s0<-s2#0:FAIL-t1. Peer's state: s2@group-54E8E36963C5:t1, leader=null, voted=s2, raftlog=Memoized:s2@group-54E8E36963C5-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:07,712 [grpc-default-executor-1] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-54E8E36963C5-CANDIDATE: accept PRE_VOTE from s0: our priority 0 <= candidate's priority 0
2023-10-31 16:09:07,713 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s2@group-54E8E36963C5 replies to PRE_VOTE vote request: s0<-s2#0:OK-t1. Peer's state: s2@group-54E8E36963C5:t1, leader=null, voted=s2, raftlog=Memoized:s2@group-54E8E36963C5-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:07,713 [grpc-default-executor-5] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s1/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s1/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/raft-meta with options [REPLACE_EXISTING]
2023-10-31 16:09:07,713 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s1@group-54E8E36963C5 replies to ELECTION vote request: s0<-s1#0:OK-t1. Peer's state: s1@group-54E8E36963C5:t1, leader=null, voted=s0, raftlog=Memoized:s1@group-54E8E36963C5-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:07,713 [grpc-default-executor-4] INFO  impl.VoteContext (VoteContext.java:log(49)) - s1@group-54E8E36963C5-FOLLOWER: reject ELECTION from s2: already has voted for s0 at current term 1
2023-10-31 16:09:07,713 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s1@group-54E8E36963C5 replies to ELECTION vote request: s2<-s1#0:FAIL-t1. Peer's state: s1@group-54E8E36963C5:t1, leader=null, voted=s0, raftlog=Memoized:s1@group-54E8E36963C5-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:07,713 [grpc-default-executor-2] INFO  impl.VoteContext (VoteContext.java:log(49)) - s1@group-54E8E36963C5-FOLLOWER: accept PRE_VOTE from s2: our priority 0 <= candidate's priority 0
2023-10-31 16:09:07,713 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s1@group-54E8E36963C5 replies to PRE_VOTE vote request: s2<-s1#0:OK-t1. Peer's state: s1@group-54E8E36963C5:t1, leader=null, voted=s0, raftlog=Memoized:s1@group-54E8E36963C5-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:07,715 [s0@group-54E8E36963C5-LeaderElection9] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s0@group-54E8E36963C5-LeaderElection9: ELECTION PASSED received 2 response(s) and 0 exception(s):
2023-10-31 16:09:07,715 [s0@group-54E8E36963C5-LeaderElection9] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s0<-s1#0:OK-t1
2023-10-31 16:09:07,715 [s0@group-54E8E36963C5-LeaderElection9] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 1: s0<-s2#0:FAIL-t1
2023-10-31 16:09:07,715 [s0@group-54E8E36963C5-LeaderElection9] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(325)) - s0@group-54E8E36963C5-LeaderElection9 ELECTION round 0: result PASSED
2023-10-31 16:09:07,715 [s0@group-54E8E36963C5-LeaderElection9] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(129)) - s0: shutdown s0@group-54E8E36963C5-LeaderElection9
2023-10-31 16:09:07,715 [s0@group-54E8E36963C5-LeaderElection9] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s0@group-54E8E36963C5: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2023-10-31 16:09:07,716 [s0@group-54E8E36963C5-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.staging.catchup.gap = 1000 (default)
2023-10-31 16:09:07,716 [s0@group-54E8E36963C5-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.element-limit = 4096 (default)
2023-10-31 16:09:07,716 [s0@group-54E8E36963C5-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.byte-limit = 64MB (=67108864) (default)
2023-10-31 16:09:07,716 [s0@group-54E8E36963C5-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.timeout = 10s (default)
2023-10-31 16:09:07,716 [s0@group-54E8E36963C5-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.timeout.denomination = 1s (default)
2023-10-31 16:09:07,716 [s0@group-54E8E36963C5-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.element-limit = 65536 (default)
2023-10-31 16:09:07,716 [s0@group-54E8E36963C5-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.leader.lease.enabled = false (default)
2023-10-31 16:09:07,716 [s0@group-54E8E36963C5-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.leader.lease.timeout.ratio = 0.9 (default)
2023-10-31 16:09:07,716 [s0@group-54E8E36963C5-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.min = 150ms (default)
2023-10-31 16:09:07,716 [s0@group-54E8E36963C5-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.element-limit = 4096 (default)
2023-10-31 16:09:07,716 [s0@group-54E8E36963C5-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.follower.gap.ratio.max = -1.0 (default)
2023-10-31 16:09:07,716 [s0@group-54E8E36963C5-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:07,716 [s0@group-54E8E36963C5-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:07,716 [s0@group-54E8E36963C5-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:07,717 [s0@group-54E8E36963C5-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:07,717 [s0@group-54E8E36963C5-LeaderElection9] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:07,717 [s0@group-54E8E36963C5-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:07,717 [s0@group-54E8E36963C5-LeaderElection9] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:07,717 [s0@group-54E8E36963C5-LeaderElection9] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:07,717 [s0@group-54E8E36963C5-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:07,717 [s0@group-54E8E36963C5-LeaderElection9] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:07,717 [s0@group-54E8E36963C5-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:07,717 [s0@group-54E8E36963C5-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:07,717 [s0@group-54E8E36963C5-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:07,717 [s0@group-54E8E36963C5-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:07,717 [s0@group-54E8E36963C5-LeaderElection9] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:07,717 [s0@group-54E8E36963C5-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:07,717 [s0@group-54E8E36963C5-LeaderElection9] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:07,717 [s0@group-54E8E36963C5-LeaderElection9] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:07,717 [s0@group-54E8E36963C5-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:07,717 [s0@group-54E8E36963C5-LeaderElection9] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:07,718 [s0@group-54E8E36963C5-LeaderElection9] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s0: start s0@group-54E8E36963C5-LeaderStateImpl
2023-10-31 16:09:07,718 [s0@group-54E8E36963C5-LeaderElection9] INFO  server.RaftServer$Division (RaftServerImpl.java:setFirstElection(562)) - s0@group-54E8E36963C5: set firstElectionSinceStartup to false for becomeLeader
2023-10-31 16:09:07,718 [s0@group-54E8E36963C5-LeaderElection9] INFO  server.RaftServer$Division (ServerState.java:setLeader(265)) - s0@group-54E8E36963C5: change Leader from null to s0 at term 1 for becomeLeader, leader elected after 293ms
2023-10-31 16:09:07,718 [s2@group-54E8E36963C5-LeaderElection8] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s2@group-54E8E36963C5-LeaderElection8: ELECTION REJECTED received 2 response(s) and 0 exception(s):
2023-10-31 16:09:07,718 [s2@group-54E8E36963C5-LeaderElection8] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s2<-s0#0:FAIL-t1
2023-10-31 16:09:07,718 [s2@group-54E8E36963C5-LeaderElection8] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 1: s2<-s1#0:FAIL-t1
2023-10-31 16:09:07,718 [s2@group-54E8E36963C5-LeaderElection8] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(325)) - s2@group-54E8E36963C5-LeaderElection8 ELECTION round 0: result REJECTED
2023-10-31 16:09:07,718 [s2@group-54E8E36963C5-LeaderElection8] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s2@group-54E8E36963C5: changes role from CANDIDATE to FOLLOWER at term 1 for REJECTED
2023-10-31 16:09:07,718 [s2@group-54E8E36963C5-LeaderElection8] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(129)) - s2: shutdown s2@group-54E8E36963C5-LeaderElection8
2023-10-31 16:09:07,718 [s2@group-54E8E36963C5-LeaderElection8] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s2: start s2@group-54E8E36963C5-FollowerState
2023-10-31 16:09:07,718 [s0@group-54E8E36963C5-LeaderElection9] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(428)) - s0@group-54E8E36963C5-SegmentedRaftLogWorker: Starting segment from index:0
2023-10-31 16:09:07,719 [s2@group-54E8E36963C5-LeaderElection8] INFO  server.RaftServer$Division (RaftServerImpl.java:setFirstElection(562)) - s2@group-54E8E36963C5: set firstElectionSinceStartup to false for REJECTED
2023-10-31 16:09:07,720 [s0@group-54E8E36963C5-LeaderElection9] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(382)) - s0@group-54E8E36963C5: set configuration 0: peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:07,737 [s0@group-54E8E36963C5-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(632)) - s0@group-54E8E36963C5-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s0/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/log_inprogress_0
2023-10-31 16:09:07,742 [s1-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setLeader(265)) - s1@group-54E8E36963C5: change Leader from null to s0 at term 1 for appendEntries, leader elected after 312ms
2023-10-31 16:09:07,742 [s2-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setLeader(265)) - s2@group-54E8E36963C5: change Leader from null to s0 at term 1 for appendEntries, leader elected after 307ms
2023-10-31 16:09:07,743 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-54E8E36963C5: receive appendEntries(s0, 1, null, -1, true, commits:[s0:c-1, s1:c-1, s2:c-1], cId:1, entries: [(t:1, i:0), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:38037"
dataStreamAddress: "localhost:45555"
clientAddress: "localhost:44585"
adminAddress: "localhost:43529"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:45329"
dataStreamAddress: "localhost:33099"
clientAddress: "localhost:34575"
adminAddress: "localhost:46337"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:44689"
dataStreamAddress: "localhost:46185"
clientAddress: "localhost:40999"
adminAddress: "localhost:33809"
startupRole: FOLLOWER
, old:)]
2023-10-31 16:09:07,744 [s2-server-thread2] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(382)) - s2@group-54E8E36963C5: set configuration 0: peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:07,744 [s2-server-thread2] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(428)) - s2@group-54E8E36963C5-SegmentedRaftLogWorker: Starting segment from index:0
2023-10-31 16:09:07,747 [s1-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s1@group-54E8E36963C5: receive appendEntries(s0, 1, null, -1, true, commits:[s0:c-1, s1:c-1, s2:c-1], cId:1, entries: [(t:1, i:0), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:38037"
dataStreamAddress: "localhost:45555"
clientAddress: "localhost:44585"
adminAddress: "localhost:43529"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:45329"
dataStreamAddress: "localhost:33099"
clientAddress: "localhost:34575"
adminAddress: "localhost:46337"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:44689"
dataStreamAddress: "localhost:46185"
clientAddress: "localhost:40999"
adminAddress: "localhost:33809"
startupRole: FOLLOWER
, old:)]
2023-10-31 16:09:07,748 [s1-server-thread2] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(382)) - s1@group-54E8E36963C5: set configuration 0: peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:07,748 [s1-server-thread2] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(428)) - s1@group-54E8E36963C5-SegmentedRaftLogWorker: Starting segment from index:0
2023-10-31 16:09:07,759 [s2@group-54E8E36963C5-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(632)) - s2@group-54E8E36963C5-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s2/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/log_inprogress_0
2023-10-31 16:09:07,759 [s1@group-54E8E36963C5-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(632)) - s1@group-54E8E36963C5-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s1/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/log_inprogress_0
2023-10-31 16:09:07,760 [s1-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s1@group-54E8E36963C5: succeeded to handle AppendEntries. Reply: s0<-s1#1:OK-t1,SUCCESS,nextIndex=1,followerCommit=-1,matchIndex=0
2023-10-31 16:09:07,761 [s2-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-54E8E36963C5: succeeded to handle AppendEntries. Reply: s0<-s2#1:OK-t1,SUCCESS,nextIndex=1,followerCommit=-1,matchIndex=0
2023-10-31 16:09:07,764 [s0@group-54E8E36963C5-StateMachineUpdater] INFO  server.RaftServer$Division (LeaderStateImpl.java:isApplied(308)) - leader is ready since appliedIndex == 0 >= startIndex == 0
2023-10-31 16:09:07,767 [grpc-default-executor-5] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s2@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:42947
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:07,874 [grpc-default-executor-4] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s0@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:37937
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:07,942 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(119)) - printing ALL groups
  s0:  RUNNING    LEADER s0@group-54E8E36963C5:t1, leader=s0, voted=s0, raftlog=Memoized:s0@group-54E8E36963C5-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-54E8E36963C5:t1, leader=s0, voted=s0, raftlog=Memoized:s1@group-54E8E36963C5-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-54E8E36963C5:t1, leader=s0, voted=s2, raftlog=Memoized:s2@group-54E8E36963C5-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null RUNNING
2023-10-31 16:09:07,949 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(891)) - s0@group-54E8E36963C5: receive client request(RaftClientRequest:client-DEBE6D008837->s0@group-54E8E36963C5, cid=13, seq=null, RW, Message:6669727374206d736720...(size=30))
2023-10-31 16:09:07,950 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(508)) - s0@group-54E8E36963C5-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-DEBE6D008837->s0@group-54E8E36963C5, cid=13, seq=null, RW, Message:6669727374206d736720...(size=30), entry=(t:1, i:1), STATEMACHINELOGENTRY, 13@client-DEBE6D008837
2023-10-31 16:09:07,951 [s1-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s1@group-54E8E36963C5: receive appendEntries(s0, 1, (t:1, i:0), 0, true, commits:[s0:c0, s1:c0, s2:c0], cId:7, entries: [(t:1, i:1), STATEMACHINELOGENTRY, 13@client-DEBE6D008837]
2023-10-31 16:09:07,952 [s2-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-54E8E36963C5: receive appendEntries(s0, 1, (t:1, i:0), 0, true, commits:[s0:c0, s1:c0, s2:c0], cId:5, entries: [(t:1, i:1), STATEMACHINELOGENTRY, 13@client-DEBE6D008837]
2023-10-31 16:09:07,953 [s1-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s1@group-54E8E36963C5: succeeded to handle AppendEntries. Reply: s0<-s1#7:OK-t1,SUCCESS,nextIndex=2,followerCommit=0,matchIndex=1
2023-10-31 16:09:07,954 [s0@group-54E8E36963C5-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:applyTransaction(248)) - applyTransaction for log index 1
2023-10-31 16:09:07,954 [s0@group-54E8E36963C5-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(205)) - s0: put 1, first msg ... -> (t:1, i:1), STATEMACHINELOGENTRY, 13@client-DEBE6D008837
2023-10-31 16:09:07,955 [s2-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-54E8E36963C5: succeeded to handle AppendEntries. Reply: s0<-s2#5:OK-t1,SUCCESS,nextIndex=2,followerCommit=0,matchIndex=1
2023-10-31 16:09:07,956 [s2-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-54E8E36963C5: receive appendEntries(s0, 1, (t:1, i:1), 1, true, commits:[s0:c1, s1:c0, s2:c0], cId:6, entries: [(t:1, i:2), METADATAENTRY(c:1)]
2023-10-31 16:09:07,957 [s1-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s1@group-54E8E36963C5: receive appendEntries(s0, 1, (t:1, i:1), 1, true, commits:[s0:c1, s1:c0, s2:c0], cId:8, entries: [(t:1, i:2), METADATAENTRY(c:1)]
2023-10-31 16:09:07,957 [s2-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-54E8E36963C5: succeeded to handle AppendEntries. Reply: s0<-s2#6:OK-t1,SUCCESS,nextIndex=3,followerCommit=1,matchIndex=2
2023-10-31 16:09:07,958 [s2@group-54E8E36963C5-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:applyTransaction(248)) - applyTransaction for log index 1
2023-10-31 16:09:07,958 [s2@group-54E8E36963C5-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(205)) - s2: put 1, first msg ... -> (t:1, i:1), STATEMACHINELOGENTRY, 13@client-DEBE6D008837
2023-10-31 16:09:07,958 [s1-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s1@group-54E8E36963C5: succeeded to handle AppendEntries. Reply: s0<-s1#8:OK-t1,SUCCESS,nextIndex=3,followerCommit=1,matchIndex=2
2023-10-31 16:09:07,958 [s1@group-54E8E36963C5-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:applyTransaction(248)) - applyTransaction for log index 1
2023-10-31 16:09:07,958 [s1@group-54E8E36963C5-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(205)) - s1: put 1, first msg ... -> (t:1, i:1), STATEMACHINELOGENTRY, 13@client-DEBE6D008837
2023-10-31 16:09:07,975 [s0-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(891)) - s0@group-54E8E36963C5: receive client request(RaftClientRequest:client-97CC9EBF2E25->s0@group-54E8E36963C5, cid=999, seq=null, RW, Message:6d657373616765)
2023-10-31 16:09:07,976 [s0-client-thread1] DEBUG server.RaftServer$Division (LeaderStateImpl.java:addPendingRequest(508)) - s0@group-54E8E36963C5-LeaderStateImpl: addPendingRequest at RaftClientRequest:client-97CC9EBF2E25->s0@group-54E8E36963C5, cid=999, seq=null, RW, Message:6d657373616765, entry=(t:1, i:3), STATEMACHINELOGENTRY, 999@client-97CC9EBF2E25
2023-10-31 16:09:07,977 [s1-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s1@group-54E8E36963C5: receive appendEntries(s0, 1, (t:1, i:2), 2, true, commits:[s0:c2, s1:c1, s2:c1], cId:10, entries: [(t:1, i:3), STATEMACHINELOGENTRY, 999@client-97CC9EBF2E25]
2023-10-31 16:09:07,978 [s1-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s1@group-54E8E36963C5: succeeded to handle AppendEntries. Reply: s0<-s1#10:OK-t1,SUCCESS,nextIndex=4,followerCommit=2,matchIndex=3
2023-10-31 16:09:07,980 [s0@group-54E8E36963C5-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:applyTransaction(248)) - applyTransaction for log index 3
2023-10-31 16:09:07,980 [s0@group-54E8E36963C5-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(205)) - s0: put 3, message -> (t:1, i:3), STATEMACHINELOGENTRY, 999@client-97CC9EBF2E25
2023-10-31 16:09:07,983 [grpc-default-executor-2] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s1@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:37189
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:07,984 [s2-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-54E8E36963C5: receive appendEntries(s0, 1, (t:1, i:2), 2, true, commits:[s0:c2, s1:c1, s2:c1], cId:9, entries: [(t:1, i:3), STATEMACHINELOGENTRY, 999@client-97CC9EBF2E25]
2023-10-31 16:09:07,986 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:addNewPeers(464)) - Add new peers [s3, s4]
2023-10-31 16:09:07,987 [s1-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s1@group-54E8E36963C5: receive appendEntries(s0, 1, (t:1, i:3), 3, true, commits:[s0:c3, s1:c2, s2:c1], cId:11, entries: [(t:1, i:4), METADATAENTRY(c:3)]
2023-10-31 16:09:07,987 [s1-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s1@group-54E8E36963C5: succeeded to handle AppendEntries. Reply: s0<-s1#11:OK-t1,SUCCESS,nextIndex=5,followerCommit=3,matchIndex=4
2023-10-31 16:09:07,987 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-54E8E36963C5: receive appendEntries(s0, 1, (t:1, i:3), 3, true, commits:[s0:c3, s1:c2, s2:c1], cId:10, entries: [(t:1, i:4), METADATAENTRY(c:3)]
2023-10-31 16:09:07,988 [s1@group-54E8E36963C5-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:applyTransaction(248)) - applyTransaction for log index 3
2023-10-31 16:09:07,988 [s1@group-54E8E36963C5-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(205)) - s1: put 3, message -> (t:1, i:3), STATEMACHINELOGENTRY, 999@client-97CC9EBF2E25
2023-10-31 16:09:07,988 [s2-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-54E8E36963C5: succeeded to handle AppendEntries. Reply: s0<-s2#9:OK-t1,SUCCESS,nextIndex=4,followerCommit=2,matchIndex=3
2023-10-31 16:09:07,988 [s2-server-thread3] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-54E8E36963C5: succeeded to handle AppendEntries. Reply: s0<-s2#10:OK-t1,SUCCESS,nextIndex=5,followerCommit=3,matchIndex=4
2023-10-31 16:09:07,989 [s2@group-54E8E36963C5-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:applyTransaction(248)) - applyTransaction for log index 3
2023-10-31 16:09:07,989 [s2@group-54E8E36963C5-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(205)) - s2: put 3, message -> (t:1, i:3), STATEMACHINELOGENTRY, 999@client-97CC9EBF2E25
2023-10-31 16:09:07,989 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(382)) - newRaftServer: s3, group-54E8E36963C5:[s3, s4, s0|localhost:38037, s1|localhost:45329, s2|localhost:44689], format? true
2023-10-31 16:09:07,989 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(305)) - deleteFully target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s3
2023-10-31 16:09:07,989 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(318)) - deleteFully: target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s3 does not exist.
2023-10-31 16:09:07,989 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(387)) - Formatted directory target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s3
2023-10-31 16:09:07,990 [Time-limited test] INFO  server.RaftServer (ConfUtils.java:logGet(46)) - raft.rpc.type = GRPC (default)
2023-10-31 16:09:07,990 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.admin.host = null (fallback to raft.grpc.server.host)
2023-10-31 16:09:07,990 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.admin.port = 39449 (fallback to raft.grpc.server.port)
2023-10-31 16:09:07,990 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.client.host = null (fallback to raft.grpc.server.host)
2023-10-31 16:09:07,990 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.client.port = 39449 (fallback to raft.grpc.server.port)
2023-10-31 16:09:07,990 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.host = null (default)
2023-10-31 16:09:07,990 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.port = 39449 (custom)
2023-10-31 16:09:07,990 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.message.size.max = 64MB (=67108864) (default)
2023-10-31 16:09:07,990 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:07,990 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2023-10-31 16:09:07,990 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:07,990 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:07,990 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.cached = true (default)
2023-10-31 16:09:07,990 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.size = 32 (default)
2023-10-31 16:09:07,991 [Time-limited test] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(46)) - raft.datastream.type = DISABLED (default)
2023-10-31 16:09:07,991 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.sleep.deviation.threshold = 300ms (default)
2023-10-31 16:09:07,991 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.close.threshold = 60s (default)
2023-10-31 16:09:07,991 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2023-10-31 16:09:07,991 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s3] (custom)
2023-10-31 16:09:07,991 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.cached = true (default)
2023-10-31 16:09:07,991 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.size = 0 (default)
2023-10-31 16:09:07,998 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:addNew(100)) - s3: addNew group-54E8E36963C5:[s3, s4, s0|localhost:38037, s1|localhost:45329, s2|localhost:44689] returns group-54E8E36963C5:java.util.concurrent.CompletableFuture@1b114907[Not completed]
2023-10-31 16:09:07,998 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(382)) - newRaftServer: s4, group-54E8E36963C5:[s3, s4, s0|localhost:38037, s1|localhost:45329, s2|localhost:44689], format? true
2023-10-31 16:09:07,998 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(305)) - deleteFully target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s4
2023-10-31 16:09:07,999 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(318)) - deleteFully: target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s4 does not exist.
2023-10-31 16:09:07,999 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(387)) - Formatted directory target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s4
2023-10-31 16:09:07,999 [Time-limited test] INFO  server.RaftServer (ConfUtils.java:logGet(46)) - raft.rpc.type = GRPC (default)
2023-10-31 16:09:07,999 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.admin.host = null (fallback to raft.grpc.server.host)
2023-10-31 16:09:07,999 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.admin.port = 42259 (fallback to raft.grpc.server.port)
2023-10-31 16:09:07,999 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.client.host = null (fallback to raft.grpc.server.host)
2023-10-31 16:09:07,999 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.client.port = 42259 (fallback to raft.grpc.server.port)
2023-10-31 16:09:07,999 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.host = null (default)
2023-10-31 16:09:07,999 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.port = 42259 (custom)
2023-10-31 16:09:07,999 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.message.size.max = 64MB (=67108864) (default)
2023-10-31 16:09:08,000 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,000 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2023-10-31 16:09:08,000 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,000 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,000 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.cached = true (default)
2023-10-31 16:09:08,000 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.size = 32 (default)
2023-10-31 16:09:08,001 [Time-limited test] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(46)) - raft.datastream.type = DISABLED (default)
2023-10-31 16:09:08,001 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.sleep.deviation.threshold = 300ms (default)
2023-10-31 16:09:08,001 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.close.threshold = 60s (default)
2023-10-31 16:09:08,001 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2023-10-31 16:09:08,001 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s4] (custom)
2023-10-31 16:09:08,001 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.cached = true (default)
2023-10-31 16:09:08,001 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.size = 0 (default)
2023-10-31 16:09:08,002 [s3-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 32MB (=33554432) (default)
2023-10-31 16:09:08,002 [s3-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2023-10-31 16:09:08,002 [s3-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2023-10-31 16:09:08,002 [s3-groupManagement] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(255)) - s3: new RaftServerImpl for group-54E8E36963C5:[s3, s4, s0|localhost:38037, s1|localhost:45329, s2|localhost:44689] with SimpleStateMachine4Testing:uninitialized
2023-10-31 16:09:08,002 [s3-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.min = 150ms (default)
2023-10-31 16:09:08,002 [s3-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2023-10-31 16:09:08,002 [s3-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.sleep.time = 25ms (default)
2023-10-31 16:09:08,002 [s3-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2023-10-31 16:09:08,002 [s3-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2023-10-31 16:09:08,004 [s3-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.sleep.deviation.threshold = 300ms (default)
2023-10-31 16:09:08,004 [s3-groupManagement] INFO  server.RaftServer$Division (ServerState.java:<init>(113)) - s3@group-54E8E36963C5: ConfigurationManager, init=-1: peers:[s3, s4, s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null, confs=<EMPTY_MAP>
2023-10-31 16:09:08,004 [s3-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.notification.no-leader.timeout = 60s (default)
2023-10-31 16:09:08,004 [s3-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.timeout = 10s (default)
2023-10-31 16:09:08,004 [s3-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.expirytime = 60s (default)
2023-10-31 16:09:08,004 [s3-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2023-10-31 16:09:08,004 [s3-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.option = DEFAULT (default)
2023-10-31 16:09:08,005 [s3-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.read-after-write-consistent.write-index-cache.expiry-time = 60s (default)
2023-10-31 16:09:08,005 [s3-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,005 [s3-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,005 [s3-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.cached = true (default)
2023-10-31 16:09:08,005 [s3-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.size = 0 (default)
2023-10-31 16:09:08,005 [s3-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.cached = true (default)
2023-10-31 16:09:08,005 [s3-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.size = 0 (default)
2023-10-31 16:09:08,007 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:addNew(100)) - s4: addNew group-54E8E36963C5:[s3, s4, s0|localhost:38037, s1|localhost:45329, s2|localhost:44689] returns group-54E8E36963C5:java.util.concurrent.CompletableFuture@1a5b3658[Not completed]
2023-10-31 16:09:08,007 [s4-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 32MB (=33554432) (default)
2023-10-31 16:09:08,007 [s4-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2023-10-31 16:09:08,007 [s3-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2023-10-31 16:09:08,007 [s4-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2023-10-31 16:09:08,007 [s3-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.corruption.policy = EXCEPTION (default)
2023-10-31 16:09:08,007 [s4-groupManagement] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(255)) - s4: new RaftServerImpl for group-54E8E36963C5:[s3, s4, s0|localhost:38037, s1|localhost:45329, s2|localhost:44689] with SimpleStateMachine4Testing:uninitialized
2023-10-31 16:09:08,007 [s4-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.min = 150ms (default)
2023-10-31 16:09:08,007 [s4-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2023-10-31 16:09:08,007 [s3-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s3] (custom)
2023-10-31 16:09:08,007 [s4-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.sleep.time = 25ms (default)
2023-10-31 16:09:08,007 [s4-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2023-10-31 16:09:08,007 [s4-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2023-10-31 16:09:08,007 [s4-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.sleep.deviation.threshold = 300ms (default)
2023-10-31 16:09:08,007 [s3-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(138)) - The storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s3/a979c418-0a1f-47d8-9ffe-54e8e36963c5 does not exist. Creating ...
2023-10-31 16:09:08,007 [s4-groupManagement] INFO  server.RaftServer$Division (ServerState.java:<init>(113)) - s4@group-54E8E36963C5: ConfigurationManager, init=-1: peers:[s3, s4, s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null, confs=<EMPTY_MAP>
2023-10-31 16:09:08,007 [s4-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.notification.no-leader.timeout = 60s (default)
2023-10-31 16:09:08,007 [s4-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.timeout = 10s (default)
2023-10-31 16:09:08,007 [s4-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.expirytime = 60s (default)
2023-10-31 16:09:08,007 [s4-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2023-10-31 16:09:08,008 [s4-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.option = DEFAULT (default)
2023-10-31 16:09:08,008 [s4-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.read-after-write-consistent.write-index-cache.expiry-time = 60s (default)
2023-10-31 16:09:08,008 [s3-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s3/a979c418-0a1f-47d8-9ffe-54e8e36963c5
2023-10-31 16:09:08,008 [s4-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,008 [s4-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,008 [s4-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.cached = true (default)
2023-10-31 16:09:08,008 [s4-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.size = 0 (default)
2023-10-31 16:09:08,008 [s4-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.cached = true (default)
2023-10-31 16:09:08,008 [s4-groupManagement] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.size = 0 (default)
2023-10-31 16:09:08,010 [s3-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(232)) - Lock on /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s3/a979c418-0a1f-47d8-9ffe-54e8e36963c5/in_use.lock acquired by nodename 15111@fv-az220-516
2023-10-31 16:09:08,010 [s3-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s3/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current
2023-10-31 16:09:08,010 [s3-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s3/a979c418-0a1f-47d8-9ffe-54e8e36963c5/sm
2023-10-31 16:09:08,010 [s3-impl-thread1] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s3/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/raft-meta.tmp with options [CREATE, WRITE]: sun.nio.ch.FileChannelImpl@510c2b6
2023-10-31 16:09:08,011 [s3-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s3/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s3/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/raft-meta with options [REPLACE_EXISTING]
2023-10-31 16:09:08,011 [s3-impl-thread1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(97)) - Storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s3/a979c418-0a1f-47d8-9ffe-54e8e36963c5 has been successfully formatted.
2023-10-31 16:09:08,012 [s3-impl-thread1] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:initialize(213)) - Initializing SimpleStateMachine4Testing:uninitialized
2023-10-31 16:09:08,012 [s3-impl-thread1] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:loadSnapshot(296)) - Loading snapshot null
2023-10-31 16:09:08,012 [s3-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.use.memory = false (default)
2023-10-31 16:09:08,012 [s3-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.gap = 1024 (default)
2023-10-31 16:09:08,012 [s3-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,012 [s3-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.read.timeout = 1000ms (default)
2023-10-31 16:09:08,012 [s3-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.preservation.log.num = 0 (default)
2023-10-31 16:09:08,012 [s3-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 32MB (=33554432) (default)
2023-10-31 16:09:08,013 [s3-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.num.max = 6 (default)
2023-10-31 16:09:08,013 [s3-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2023-10-31 16:09:08,013 [s3-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,013 [s3-impl-thread1] INFO  util.AwaitToRun (AwaitToRun.java:start(81)) - Thread[s3@group-54E8E36963C5-cacheEviction-AwaitToRun,5,main] started
2023-10-31 16:09:08,014 [s3-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(184)) - new s3@group-54E8E36963C5-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s3/a979c418-0a1f-47d8-9ffe-54e8e36963c5
2023-10-31 16:09:08,014 [s3-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2023-10-31 16:09:08,014 [s3-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.element-limit = 4096 (default)
2023-10-31 16:09:08,014 [s3-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 32MB (=33554432) (default)
2023-10-31 16:09:08,014 [s3-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2023-10-31 16:09:08,014 [s3-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.force.sync.num = 128 (default)
2023-10-31 16:09:08,014 [s3-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync = true (default)
2023-10-31 16:09:08,014 [s3-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2023-10-31 16:09:08,014 [s3-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2023-10-31 16:09:08,014 [s3-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2023-10-31 16:09:08,014 [s3-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,015 [s3-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.unsafe-flush.enabled = false (default)
2023-10-31 16:09:08,015 [s3-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.async-flush.enabled = false (default)
2023-10-31 16:09:08,015 [s3-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.caching.enabled = false (default)
2023-10-31 16:09:08,015 [s3-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(135)) - s3@group-54E8E36963C5-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2023-10-31 16:09:08,015 [s3-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(135)) - s3@group-54E8E36963C5-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2023-10-31 16:09:08,017 [s3-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(390)) - s3@group-54E8E36963C5: start as a follower, conf=-1: peers:[s3, s4, s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:08,018 [s3-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s3@group-54E8E36963C5: changes role from      null to FOLLOWER at term 0 for startAsFollower
2023-10-31 16:09:08,018 [s3-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s3: start s3@group-54E8E36963C5-FollowerState
2023-10-31 16:09:08,018 [s3-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-54E8E36963C5,id=s3
2023-10-31 16:09:08,018 [s3-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.trigger-when-stop.enabled = true (default)
2023-10-31 16:09:08,018 [s3-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.auto.trigger.enabled = false (default)
2023-10-31 16:09:08,018 [s3-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.retention.file.num = -1 (default)
2023-10-31 16:09:08,018 [s3-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.upto.snapshot.index = false (default)
2023-10-31 16:09:08,019 [s3@group-54E8E36963C5-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2023-10-31 16:09:08,019 [s3@group-54E8E36963C5-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2023-10-31 16:09:08,019 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:startImpl(406)) - s3: start RPC server
2023-10-31 16:09:08,020 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s3: GrpcService started, listening on 39449
2023-10-31 16:09:08,022 [s4-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2023-10-31 16:09:08,022 [s4-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.corruption.policy = EXCEPTION (default)
2023-10-31 16:09:08,022 [s4-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s4] (custom)
2023-10-31 16:09:08,022 [s4-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(138)) - The storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s4/a979c418-0a1f-47d8-9ffe-54e8e36963c5 does not exist. Creating ...
2023-10-31 16:09:08,023 [JvmPauseMonitor12] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(146)) - JvmPauseMonitor-s3: Started
2023-10-31 16:09:08,023 [s4-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s4/a979c418-0a1f-47d8-9ffe-54e8e36963c5
2023-10-31 16:09:08,024 [s4-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(232)) - Lock on /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s4/a979c418-0a1f-47d8-9ffe-54e8e36963c5/in_use.lock acquired by nodename 15111@fv-az220-516
2023-10-31 16:09:08,024 [s4-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s4/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current
2023-10-31 16:09:08,024 [s4-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s4/a979c418-0a1f-47d8-9ffe-54e8e36963c5/sm
2023-10-31 16:09:08,024 [s4-impl-thread1] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s4/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/raft-meta.tmp with options [CREATE, WRITE]: sun.nio.ch.FileChannelImpl@440a39b0
2023-10-31 16:09:08,026 [s4-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s4/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s4/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/raft-meta with options [REPLACE_EXISTING]
2023-10-31 16:09:08,026 [s4-impl-thread1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(97)) - Storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s4/a979c418-0a1f-47d8-9ffe-54e8e36963c5 has been successfully formatted.
2023-10-31 16:09:08,026 [s4-impl-thread1] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:initialize(213)) - Initializing SimpleStateMachine4Testing:uninitialized
2023-10-31 16:09:08,026 [s4-impl-thread1] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:loadSnapshot(296)) - Loading snapshot null
2023-10-31 16:09:08,026 [s4-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.use.memory = false (default)
2023-10-31 16:09:08,026 [s4-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.gap = 1024 (default)
2023-10-31 16:09:08,026 [s4-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,026 [s4-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.read.timeout = 1000ms (default)
2023-10-31 16:09:08,026 [s4-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.preservation.log.num = 0 (default)
2023-10-31 16:09:08,027 [s4-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 32MB (=33554432) (default)
2023-10-31 16:09:08,027 [s4-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.num.max = 6 (default)
2023-10-31 16:09:08,027 [s4-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2023-10-31 16:09:08,027 [s4-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,027 [s4-impl-thread1] INFO  util.AwaitToRun (AwaitToRun.java:start(81)) - Thread[s4@group-54E8E36963C5-cacheEviction-AwaitToRun,5,main] started
2023-10-31 16:09:08,027 [s4-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(184)) - new s4@group-54E8E36963C5-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s4/a979c418-0a1f-47d8-9ffe-54e8e36963c5
2023-10-31 16:09:08,027 [s4-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2023-10-31 16:09:08,027 [s4-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.element-limit = 4096 (default)
2023-10-31 16:09:08,027 [s4-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 32MB (=33554432) (default)
2023-10-31 16:09:08,027 [s4-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2023-10-31 16:09:08,027 [s4-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.force.sync.num = 128 (default)
2023-10-31 16:09:08,027 [s4-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync = true (default)
2023-10-31 16:09:08,027 [s4-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2023-10-31 16:09:08,027 [s4-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2023-10-31 16:09:08,028 [s4-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2023-10-31 16:09:08,028 [s4-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,028 [s4-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.unsafe-flush.enabled = false (default)
2023-10-31 16:09:08,028 [s4-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.async-flush.enabled = false (default)
2023-10-31 16:09:08,028 [s4-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.caching.enabled = false (default)
2023-10-31 16:09:08,029 [s4-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(135)) - s4@group-54E8E36963C5-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2023-10-31 16:09:08,029 [s4-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(135)) - s4@group-54E8E36963C5-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2023-10-31 16:09:08,031 [s4-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(390)) - s4@group-54E8E36963C5: start as a follower, conf=-1: peers:[s3, s4, s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:08,032 [s4-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s4@group-54E8E36963C5: changes role from      null to FOLLOWER at term 0 for startAsFollower
2023-10-31 16:09:08,032 [s4-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s4: start s4@group-54E8E36963C5-FollowerState
2023-10-31 16:09:08,034 [s4-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-54E8E36963C5,id=s4
2023-10-31 16:09:08,034 [s4-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.trigger-when-stop.enabled = true (default)
2023-10-31 16:09:08,034 [s4-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.auto.trigger.enabled = false (default)
2023-10-31 16:09:08,034 [s4-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.retention.file.num = -1 (default)
2023-10-31 16:09:08,034 [s4-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.upto.snapshot.index = false (default)
2023-10-31 16:09:08,035 [s4@group-54E8E36963C5-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2023-10-31 16:09:08,035 [s4@group-54E8E36963C5-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2023-10-31 16:09:08,035 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:startImpl(406)) - s4: start RPC server
2023-10-31 16:09:08,040 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s4: GrpcService started, listening on 42259
2023-10-31 16:09:08,041 [JvmPauseMonitor13] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(146)) - JvmPauseMonitor-s4: Started
2023-10-31 16:09:08,042 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2023-10-31 16:09:08,043 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(100)) - printing ALL groups
  s3:  RUNNING  FOLLOWER s3@group-54E8E36963C5:t0, leader=null, voted=, raftlog=Memoized:s3@group-54E8E36963C5-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s3, s4, s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null RUNNING
  s4:  RUNNING  FOLLOWER s4@group-54E8E36963C5:t0, leader=null, voted=, raftlog=Memoized:s4@group-54E8E36963C5-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s3, s4, s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null RUNNING
  s0:  RUNNING    LEADER s0@group-54E8E36963C5:t1, leader=s0, voted=s0, raftlog=Memoized:s0@group-54E8E36963C5-SegmentedRaftLog:OPENED:c4, conf=0: peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-54E8E36963C5:t1, leader=s0, voted=s0, raftlog=Memoized:s1@group-54E8E36963C5-SegmentedRaftLog:OPENED:c3, conf=0: peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-54E8E36963C5:t1, leader=s0, voted=s2, raftlog=Memoized:s2@group-54E8E36963C5-SegmentedRaftLog:OPENED:c3, conf=0: peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null RUNNING
2023-10-31 16:09:08,043 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(119)) - printing ALL groups
  s3:  RUNNING  FOLLOWER s3@group-54E8E36963C5:t0, leader=null, voted=, raftlog=Memoized:s3@group-54E8E36963C5-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s3, s4, s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null RUNNING
  s4:  RUNNING  FOLLOWER s4@group-54E8E36963C5:t0, leader=null, voted=, raftlog=Memoized:s4@group-54E8E36963C5-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s3, s4, s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null RUNNING
  s0:  RUNNING    LEADER s0@group-54E8E36963C5:t1, leader=s0, voted=s0, raftlog=Memoized:s0@group-54E8E36963C5-SegmentedRaftLog:OPENED:c4, conf=0: peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-54E8E36963C5:t1, leader=s0, voted=s0, raftlog=Memoized:s1@group-54E8E36963C5-SegmentedRaftLog:OPENED:c3, conf=0: peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-54E8E36963C5:t1, leader=s0, voted=s2, raftlog=Memoized:s2@group-54E8E36963C5-SegmentedRaftLog:OPENED:c3, conf=0: peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null RUNNING
2023-10-31 16:09:08,043 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:setConfiguration(819)) - Start changing the configuration: [s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]
2023-10-31 16:09:08,070 [s3-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setConfigurationAsync(1262)) - s3@group-54E8E36963C5: receive setConfiguration SetConfigurationRequest:client-863D43DFC761->s3@group-54E8E36963C5, cid=14, seq=null, RW, null, SET_UNCONDITIONALLY, servers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689], listeners:[]
2023-10-31 16:09:08,090 [grpc-default-executor-4] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s2@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:42947
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,184 [s4-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setConfigurationAsync(1262)) - s4@group-54E8E36963C5: receive setConfiguration SetConfigurationRequest:client-863D43DFC761->s4@group-54E8E36963C5, cid=14, seq=null, RW, null, SET_UNCONDITIONALLY, servers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689], listeners:[]
2023-10-31 16:09:08,196 [grpc-default-executor-1] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s1@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:37189
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,207 [s3@group-54E8E36963C5-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s3@group-54E8E36963C5-FollowerState: change to CANDIDATE, lastRpcElapsedTime:189300905ns, electionTimeout:188ms
2023-10-31 16:09:08,207 [s3@group-54E8E36963C5-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(109)) - s3: shutdown s3@group-54E8E36963C5-FollowerState
2023-10-31 16:09:08,207 [s3@group-54E8E36963C5-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s3@group-54E8E36963C5: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2023-10-31 16:09:08,208 [s3@group-54E8E36963C5-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2023-10-31 16:09:08,208 [s3@group-54E8E36963C5-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s3: start s3@group-54E8E36963C5-LeaderElection10
2023-10-31 16:09:08,208 [s3@group-54E8E36963C5-LeaderElection10] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(323)) - s3@group-54E8E36963C5-LeaderElection10 PRE_VOTE round 0: submit vote requests at term 0 for -1: peers:[s3, s4, s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:08,209 [s3@group-54E8E36963C5-LeaderElection10-2] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(65)) - Build channel for s0
2023-10-31 16:09:08,209 [s3@group-54E8E36963C5-LeaderElection10-1] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(65)) - Build channel for s4
2023-10-31 16:09:08,211 [s3@group-54E8E36963C5-LeaderElection10-3] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(65)) - Build channel for s1
2023-10-31 16:09:08,218 [s3@group-54E8E36963C5-LeaderElection10] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2023-10-31 16:09:08,218 [s3@group-54E8E36963C5-LeaderElection10] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2023-10-31 16:09:08,219 [s3@group-54E8E36963C5-LeaderElection10] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(136)) - s3@group-54E8E36963C5-LeaderElection10 got exception when requesting votes: java.util.concurrent.ExecutionException: java.lang.NullPointerException: target
2023-10-31 16:09:08,219 [s3@group-54E8E36963C5-LeaderElection10-4] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(65)) - Build channel for s2
2023-10-31 16:09:08,222 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s1@group-54E8E36963C5: receive requestVote(PRE_VOTE, s3, group-54E8E36963C5, 0, (t:0, i:0))
2023-10-31 16:09:08,222 [grpc-default-executor-4] INFO  impl.VoteContext (VoteContext.java:log(49)) - s1@group-54E8E36963C5-FOLLOWER: reject PRE_VOTE from s3: s3 is not in current conf [s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]
2023-10-31 16:09:08,222 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s1@group-54E8E36963C5 replies to PRE_VOTE vote request: s3<-s1#0:FAIL-t1. Peer's state: s1@group-54E8E36963C5:t1, leader=s0, voted=s0, raftlog=Memoized:s1@group-54E8E36963C5-SegmentedRaftLog:OPENED:c4, conf=0: peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:08,226 [s3@group-54E8E36963C5-LeaderElection10] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s3@group-54E8E36963C5-LeaderElection10: PRE_VOTE DISCOVERED_A_NEW_TERM (term=1) received 1 response(s) and 1 exception(s):
2023-10-31 16:09:08,226 [s3@group-54E8E36963C5-LeaderElection10] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s3<-s1#0:FAIL-t1
2023-10-31 16:09:08,226 [s3@group-54E8E36963C5-LeaderElection10] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(136)) -   Exception 1: java.util.concurrent.ExecutionException: java.lang.NullPointerException: target
2023-10-31 16:09:08,226 [s3@group-54E8E36963C5-LeaderElection10] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(325)) - s3@group-54E8E36963C5-LeaderElection10 PRE_VOTE round 0: result DISCOVERED_A_NEW_TERM (term=1)
2023-10-31 16:09:08,226 [s3@group-54E8E36963C5-LeaderElection10] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s3@group-54E8E36963C5: changes role from CANDIDATE to FOLLOWER at term 1 for DISCOVERED_A_NEW_TERM (term=1)
2023-10-31 16:09:08,227 [s3@group-54E8E36963C5-LeaderElection10] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(129)) - s3: shutdown s3@group-54E8E36963C5-LeaderElection10
2023-10-31 16:09:08,227 [s3@group-54E8E36963C5-LeaderElection10] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s3: start s3@group-54E8E36963C5-FollowerState
2023-10-31 16:09:08,227 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s0@group-54E8E36963C5: receive requestVote(PRE_VOTE, s3, group-54E8E36963C5, 0, (t:0, i:0))
2023-10-31 16:09:08,227 [grpc-default-executor-4] INFO  impl.VoteContext (VoteContext.java:log(49)) - s0@group-54E8E36963C5-LEADER: reject PRE_VOTE from s3: s3 is not in current conf [s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]
2023-10-31 16:09:08,227 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s0@group-54E8E36963C5 replies to PRE_VOTE vote request: s3<-s0#0:FAIL-t1. Peer's state: s0@group-54E8E36963C5:t1, leader=s0, voted=s0, raftlog=Memoized:s0@group-54E8E36963C5-SegmentedRaftLog:OPENED:c4, conf=0: peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:08,229 [s3@group-54E8E36963C5-LeaderElection10] INFO  server.RaftServer$Division (RaftServerImpl.java:setFirstElection(562)) - s3@group-54E8E36963C5: set firstElectionSinceStartup to false for DISCOVERED_A_NEW_TERM (term=1)
2023-10-31 16:09:08,229 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s2@group-54E8E36963C5: receive requestVote(PRE_VOTE, s3, group-54E8E36963C5, 0, (t:0, i:0))
2023-10-31 16:09:08,230 [grpc-default-executor-4] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-54E8E36963C5-FOLLOWER: reject PRE_VOTE from s3: s3 is not in current conf [s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]
2023-10-31 16:09:08,230 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s2@group-54E8E36963C5 replies to PRE_VOTE vote request: s3<-s2#0:FAIL-t1. Peer's state: s2@group-54E8E36963C5:t1, leader=s0, voted=s2, raftlog=Memoized:s2@group-54E8E36963C5-SegmentedRaftLog:OPENED:c4, conf=0: peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:08,229 [s3@group-54E8E36963C5-LeaderElection10] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s3/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/raft-meta.tmp with options [CREATE, WRITE]: sun.nio.ch.FileChannelImpl@58a16bea
2023-10-31 16:09:08,231 [s3@group-54E8E36963C5-LeaderElection10] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s3/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s3/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/raft-meta with options [REPLACE_EXISTING]
2023-10-31 16:09:08,255 [s4@group-54E8E36963C5-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s4@group-54E8E36963C5-FollowerState: change to CANDIDATE, lastRpcElapsedTime:223044512ns, electionTimeout:220ms
2023-10-31 16:09:08,255 [s4@group-54E8E36963C5-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(109)) - s4: shutdown s4@group-54E8E36963C5-FollowerState
2023-10-31 16:09:08,255 [s4@group-54E8E36963C5-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s4@group-54E8E36963C5: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2023-10-31 16:09:08,256 [s4@group-54E8E36963C5-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2023-10-31 16:09:08,256 [s4@group-54E8E36963C5-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s4: start s4@group-54E8E36963C5-LeaderElection11
2023-10-31 16:09:08,258 [s4@group-54E8E36963C5-LeaderElection11] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(323)) - s4@group-54E8E36963C5-LeaderElection11 PRE_VOTE round 0: submit vote requests at term 0 for -1: peers:[s3, s4, s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:08,259 [s4@group-54E8E36963C5-LeaderElection11-1] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(65)) - Build channel for s3
2023-10-31 16:09:08,259 [s4@group-54E8E36963C5-LeaderElection11-2] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(65)) - Build channel for s0
2023-10-31 16:09:08,259 [s4@group-54E8E36963C5-LeaderElection11-3] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(65)) - Build channel for s1
2023-10-31 16:09:08,259 [s4@group-54E8E36963C5-LeaderElection11] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2023-10-31 16:09:08,259 [s4@group-54E8E36963C5-LeaderElection11-4] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(65)) - Build channel for s2
2023-10-31 16:09:08,259 [s4@group-54E8E36963C5-LeaderElection11] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2023-10-31 16:09:08,260 [s4@group-54E8E36963C5-LeaderElection11] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(136)) - s4@group-54E8E36963C5-LeaderElection11 got exception when requesting votes: java.util.concurrent.ExecutionException: java.lang.NullPointerException: target
2023-10-31 16:09:08,270 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s2@group-54E8E36963C5: receive requestVote(PRE_VOTE, s4, group-54E8E36963C5, 0, (t:0, i:0))
2023-10-31 16:09:08,271 [grpc-default-executor-2] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-54E8E36963C5-FOLLOWER: reject PRE_VOTE from s4: s4 is not in current conf [s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]
2023-10-31 16:09:08,271 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s2@group-54E8E36963C5 replies to PRE_VOTE vote request: s4<-s2#0:FAIL-t1. Peer's state: s2@group-54E8E36963C5:t1, leader=s0, voted=s2, raftlog=Memoized:s2@group-54E8E36963C5-SegmentedRaftLog:OPENED:c4, conf=0: peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:08,270 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s1@group-54E8E36963C5: receive requestVote(PRE_VOTE, s4, group-54E8E36963C5, 0, (t:0, i:0))
2023-10-31 16:09:08,271 [grpc-default-executor-4] INFO  impl.VoteContext (VoteContext.java:log(49)) - s1@group-54E8E36963C5-FOLLOWER: reject PRE_VOTE from s4: s4 is not in current conf [s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]
2023-10-31 16:09:08,271 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s1@group-54E8E36963C5 replies to PRE_VOTE vote request: s4<-s1#0:FAIL-t1. Peer's state: s1@group-54E8E36963C5:t1, leader=s0, voted=s0, raftlog=Memoized:s1@group-54E8E36963C5-SegmentedRaftLog:OPENED:c4, conf=0: peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:08,273 [s4@group-54E8E36963C5-LeaderElection11] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s4@group-54E8E36963C5-LeaderElection11: PRE_VOTE DISCOVERED_A_NEW_TERM (term=1) received 1 response(s) and 1 exception(s):
2023-10-31 16:09:08,273 [s4@group-54E8E36963C5-LeaderElection11] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s4<-s1#0:FAIL-t1
2023-10-31 16:09:08,273 [s4@group-54E8E36963C5-LeaderElection11] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(136)) -   Exception 1: java.util.concurrent.ExecutionException: java.lang.NullPointerException: target
2023-10-31 16:09:08,273 [s4@group-54E8E36963C5-LeaderElection11] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(325)) - s4@group-54E8E36963C5-LeaderElection11 PRE_VOTE round 0: result DISCOVERED_A_NEW_TERM (term=1)
2023-10-31 16:09:08,273 [s4@group-54E8E36963C5-LeaderElection11] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s4@group-54E8E36963C5: changes role from CANDIDATE to FOLLOWER at term 1 for DISCOVERED_A_NEW_TERM (term=1)
2023-10-31 16:09:08,273 [s4@group-54E8E36963C5-LeaderElection11] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(129)) - s4: shutdown s4@group-54E8E36963C5-LeaderElection11
2023-10-31 16:09:08,273 [s4@group-54E8E36963C5-LeaderElection11] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s4: start s4@group-54E8E36963C5-FollowerState
2023-10-31 16:09:08,273 [s4@group-54E8E36963C5-LeaderElection11] INFO  server.RaftServer$Division (RaftServerImpl.java:setFirstElection(562)) - s4@group-54E8E36963C5: set firstElectionSinceStartup to false for DISCOVERED_A_NEW_TERM (term=1)
2023-10-31 16:09:08,273 [s4@group-54E8E36963C5-LeaderElection11] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s4/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/raft-meta.tmp with options [CREATE, WRITE]: sun.nio.ch.FileChannelImpl@66caca29
2023-10-31 16:09:08,275 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s0@group-54E8E36963C5: receive requestVote(PRE_VOTE, s4, group-54E8E36963C5, 0, (t:0, i:0))
2023-10-31 16:09:08,275 [grpc-default-executor-4] INFO  impl.VoteContext (VoteContext.java:log(49)) - s0@group-54E8E36963C5-LEADER: reject PRE_VOTE from s4: s4 is not in current conf [s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]
2023-10-31 16:09:08,275 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s0@group-54E8E36963C5 replies to PRE_VOTE vote request: s4<-s0#0:FAIL-t1. Peer's state: s0@group-54E8E36963C5:t1, leader=s0, voted=s0, raftlog=Memoized:s0@group-54E8E36963C5-SegmentedRaftLog:OPENED:c4, conf=0: peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:08,276 [s4@group-54E8E36963C5-LeaderElection11] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s4/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s4/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/raft-meta with options [REPLACE_EXISTING]
2023-10-31 16:09:08,292 [s1-server-thread2] INFO  server.RaftServer$Division (RaftServerImpl.java:setConfigurationAsync(1262)) - s1@group-54E8E36963C5: receive setConfiguration SetConfigurationRequest:client-863D43DFC761->s1@group-54E8E36963C5, cid=14, seq=null, RW, null, SET_UNCONDITIONALLY, servers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689], listeners:[]
2023-10-31 16:09:08,298 [grpc-default-executor-1] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s2@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:42947
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,400 [s0-server-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setConfigurationAsync(1262)) - s0@group-54E8E36963C5: receive setConfiguration SetConfigurationRequest:client-863D43DFC761->s0@group-54E8E36963C5, cid=14, seq=null, RW, null, SET_UNCONDITIONALLY, servers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689], listeners:[]
2023-10-31 16:09:08,400 [s0-server-thread1] INFO  server.RaftServer$Division (LeaderStateImpl.java:startSetConfiguration(474)) - s0@group-54E8E36963C5-LeaderStateImpl: startSetConfiguration SetConfigurationRequest:client-863D43DFC761->s0@group-54E8E36963C5, cid=14, seq=null, RW, null, SET_UNCONDITIONALLY, servers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689], listeners:[]
2023-10-31 16:09:08,402 [grpc-default-executor-4] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s0@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:37937
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,402 [s0-server-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,403 [s0-server-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,403 [s0-server-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,403 [s0-server-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,403 [s0-server-thread1] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,403 [s0-server-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,403 [s0-server-thread1] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,403 [s0-server-thread1] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,403 [s0-server-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,403 [s0-server-thread1] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,403 [s0-server-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,404 [s0-server-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,405 [s0-server-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,405 [s0-server-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,405 [s0-server-thread1] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,405 [s0-server-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,405 [s0-server-thread1] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,405 [s0-server-thread1] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,405 [s0-server-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,405 [s0-server-thread1] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,406 [s0@group-54E8E36963C5->s3-GrpcLogAppender-LogAppenderDaemon] INFO  leader.FollowerInfo (FollowerInfoImpl.java:setAttemptedToInstallSnapshot(154)) - Follower s0@group-54E8E36963C5->s3 acknowledged installing snapshot
2023-10-31 16:09:08,406 [s0@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  leader.FollowerInfo (FollowerInfoImpl.java:setAttemptedToInstallSnapshot(154)) - Follower s0@group-54E8E36963C5->s4 acknowledged installing snapshot
2023-10-31 16:09:08,410 [s0@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(65)) - Build channel for s4
2023-10-31 16:09:08,410 [s0@group-54E8E36963C5->s3-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(65)) - Build channel for s3
2023-10-31 16:09:08,421 [s4-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setLeader(265)) - s4@group-54E8E36963C5: change Leader from null to s0 at term 1 for appendEntries, leader elected after 413ms
2023-10-31 16:09:08,422 [s4-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s4@group-54E8E36963C5: receive appendEntries(s0, 1, null, 4, false, commits:[s0:c4, s1:c4, s2:c4, s3:c-1, s4:c-1], cId:1, entries: [(t:1, i:0), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:38037"
dataStreamAddress: "localhost:45555"
clientAddress: "localhost:44585"
adminAddress: "localhost:43529"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:45329"
dataStreamAddress: "localhost:33099"
clientAddress: "localhost:34575"
adminAddress: "localhost:46337"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:44689"
dataStreamAddress: "localhost:46185"
clientAddress: "localhost:40999"
adminAddress: "localhost:33809"
startupRole: FOLLOWER
, old:), (t:1, i:1), STATEMACHINELOGENTRY, 13@client-DEBE6D008837, (t:1, i:2), METADATAENTRY(c:1), (t:1, i:3), STATEMACHINELOGENTRY, 999@client-97CC9EBF2E25, (t:1, i:4), METADATAENTRY(c:3)]
2023-10-31 16:09:08,422 [s3-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setLeader(265)) - s3@group-54E8E36963C5: change Leader from null to s0 at term 1 for appendEntries, leader elected after 418ms
2023-10-31 16:09:08,426 [s4-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(382)) - s4@group-54E8E36963C5: set configuration 0: peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:08,429 [s4-server-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(428)) - s4@group-54E8E36963C5-SegmentedRaftLogWorker: Starting segment from index:0
2023-10-31 16:09:08,430 [s3-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s3@group-54E8E36963C5: receive appendEntries(s0, 1, null, 4, false, commits:[s0:c4, s1:c4, s2:c4, s3:c-1, s4:c-1], cId:1, entries: [(t:1, i:0), CONFIGURATIONENTRY(current:id: "s0"
address: "localhost:38037"
dataStreamAddress: "localhost:45555"
clientAddress: "localhost:44585"
adminAddress: "localhost:43529"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:45329"
dataStreamAddress: "localhost:33099"
clientAddress: "localhost:34575"
adminAddress: "localhost:46337"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:44689"
dataStreamAddress: "localhost:46185"
clientAddress: "localhost:40999"
adminAddress: "localhost:33809"
startupRole: FOLLOWER
, old:), (t:1, i:1), STATEMACHINELOGENTRY, 13@client-DEBE6D008837, (t:1, i:2), METADATAENTRY(c:1), (t:1, i:3), STATEMACHINELOGENTRY, 999@client-97CC9EBF2E25, (t:1, i:4), METADATAENTRY(c:3)]
2023-10-31 16:09:08,435 [s3-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(382)) - s3@group-54E8E36963C5: set configuration 0: peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:08,435 [s3-server-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(428)) - s3@group-54E8E36963C5-SegmentedRaftLogWorker: Starting segment from index:0
2023-10-31 16:09:08,444 [s4@group-54E8E36963C5-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(632)) - s4@group-54E8E36963C5-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s4/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/log_inprogress_0
2023-10-31 16:09:08,445 [s3@group-54E8E36963C5-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(632)) - s3@group-54E8E36963C5-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s3/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/log_inprogress_0
2023-10-31 16:09:08,446 [s3-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s3@group-54E8E36963C5: succeeded to handle AppendEntries. Reply: s0<-s3#1:OK-t1,SUCCESS,nextIndex=5,followerCommit=4,matchIndex=4
2023-10-31 16:09:08,446 [s4-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s4@group-54E8E36963C5: succeeded to handle AppendEntries. Reply: s0<-s4#1:OK-t1,SUCCESS,nextIndex=5,followerCommit=4,matchIndex=4
2023-10-31 16:09:08,447 [s3@group-54E8E36963C5-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:applyTransaction(248)) - applyTransaction for log index 1
2023-10-31 16:09:08,447 [s3@group-54E8E36963C5-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(205)) - s3: put 1, first msg ... -> (t:1, i:1), STATEMACHINELOGENTRY, 13@client-DEBE6D008837
2023-10-31 16:09:08,447 [s3@group-54E8E36963C5-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:applyTransaction(248)) - applyTransaction for log index 3
2023-10-31 16:09:08,447 [s3@group-54E8E36963C5-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(205)) - s3: put 3, message -> (t:1, i:3), STATEMACHINELOGENTRY, 999@client-97CC9EBF2E25
2023-10-31 16:09:08,447 [s4@group-54E8E36963C5-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:applyTransaction(248)) - applyTransaction for log index 1
2023-10-31 16:09:08,448 [s4@group-54E8E36963C5-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(205)) - s4: put 1, first msg ... -> (t:1, i:1), STATEMACHINELOGENTRY, 13@client-DEBE6D008837
2023-10-31 16:09:08,448 [s4@group-54E8E36963C5-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:applyTransaction(248)) - applyTransaction for log index 3
2023-10-31 16:09:08,448 [s4@group-54E8E36963C5-StateMachineUpdater] INFO  impl.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(205)) - s4: put 3, message -> (t:1, i:3), STATEMACHINELOGENTRY, 999@client-97CC9EBF2E25
2023-10-31 16:09:08,451 [s0@group-54E8E36963C5-LeaderStateImpl] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(382)) - s0@group-54E8E36963C5: set configuration 5: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[]
2023-10-31 16:09:08,454 [s3-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s3@group-54E8E36963C5: receive appendEntries(s0, 1, (t:1, i:4), 4, true, commits:[s0:c4, s1:c4, s2:c4, s3:c4, s4:c4], cId:3, entries: [(t:1, i:5), CONFIGURATIONENTRY(current:id: "s3"
address: "0.0.0.0:39449"
clientAddress: "0.0.0.0:39449"
adminAddress: "0.0.0.0:39449"
startupRole: FOLLOWER
,id: "s4"
address: "0.0.0.0:42259"
clientAddress: "0.0.0.0:42259"
adminAddress: "0.0.0.0:42259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:44689"
dataStreamAddress: "localhost:46185"
clientAddress: "localhost:40999"
adminAddress: "localhost:33809"
startupRole: FOLLOWER
, old:id: "s0"
address: "localhost:38037"
dataStreamAddress: "localhost:45555"
clientAddress: "localhost:44585"
adminAddress: "localhost:43529"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:45329"
dataStreamAddress: "localhost:33099"
clientAddress: "localhost:34575"
adminAddress: "localhost:46337"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:44689"
dataStreamAddress: "localhost:46185"
clientAddress: "localhost:40999"
adminAddress: "localhost:33809"
startupRole: FOLLOWER
)]
2023-10-31 16:09:08,454 [s3-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(382)) - s3@group-54E8E36963C5: set configuration 5: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[]
2023-10-31 16:09:08,455 [s3-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s3@group-54E8E36963C5: succeeded to handle AppendEntries. Reply: s0<-s3#3:OK-t1,SUCCESS,nextIndex=6,followerCommit=4,matchIndex=5
2023-10-31 16:09:08,455 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-54E8E36963C5: receive appendEntries(s0, 1, (t:1, i:4), 4, true, commits:[s0:c4, s1:c4, s2:c4, s3:c4, s4:c4], cId:20, entries: [(t:1, i:5), CONFIGURATIONENTRY(current:id: "s3"
address: "0.0.0.0:39449"
clientAddress: "0.0.0.0:39449"
adminAddress: "0.0.0.0:39449"
startupRole: FOLLOWER
,id: "s4"
address: "0.0.0.0:42259"
clientAddress: "0.0.0.0:42259"
adminAddress: "0.0.0.0:42259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:44689"
dataStreamAddress: "localhost:46185"
clientAddress: "localhost:40999"
adminAddress: "localhost:33809"
startupRole: FOLLOWER
, old:id: "s0"
address: "localhost:38037"
dataStreamAddress: "localhost:45555"
clientAddress: "localhost:44585"
adminAddress: "localhost:43529"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:45329"
dataStreamAddress: "localhost:33099"
clientAddress: "localhost:34575"
adminAddress: "localhost:46337"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:44689"
dataStreamAddress: "localhost:46185"
clientAddress: "localhost:40999"
adminAddress: "localhost:33809"
startupRole: FOLLOWER
)]
2023-10-31 16:09:08,457 [s2-server-thread2] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(382)) - s2@group-54E8E36963C5: set configuration 5: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[]
2023-10-31 16:09:08,457 [s1-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s1@group-54E8E36963C5: receive appendEntries(s0, 1, (t:1, i:4), 4, true, commits:[s0:c4, s1:c4, s2:c4, s3:c4, s4:c4], cId:20, entries: [(t:1, i:5), CONFIGURATIONENTRY(current:id: "s3"
address: "0.0.0.0:39449"
clientAddress: "0.0.0.0:39449"
adminAddress: "0.0.0.0:39449"
startupRole: FOLLOWER
,id: "s4"
address: "0.0.0.0:42259"
clientAddress: "0.0.0.0:42259"
adminAddress: "0.0.0.0:42259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:44689"
dataStreamAddress: "localhost:46185"
clientAddress: "localhost:40999"
adminAddress: "localhost:33809"
startupRole: FOLLOWER
, old:id: "s0"
address: "localhost:38037"
dataStreamAddress: "localhost:45555"
clientAddress: "localhost:44585"
adminAddress: "localhost:43529"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:45329"
dataStreamAddress: "localhost:33099"
clientAddress: "localhost:34575"
adminAddress: "localhost:46337"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:44689"
dataStreamAddress: "localhost:46185"
clientAddress: "localhost:40999"
adminAddress: "localhost:33809"
startupRole: FOLLOWER
)]
2023-10-31 16:09:08,458 [s1-server-thread2] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(382)) - s1@group-54E8E36963C5: set configuration 5: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[]
2023-10-31 16:09:08,458 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-54E8E36963C5: succeeded to handle AppendEntries. Reply: s0<-s2#20:OK-t1,SUCCESS,nextIndex=6,followerCommit=4,matchIndex=5
2023-10-31 16:09:08,458 [s1-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s1@group-54E8E36963C5: succeeded to handle AppendEntries. Reply: s0<-s1#20:OK-t1,SUCCESS,nextIndex=6,followerCommit=4,matchIndex=5
2023-10-31 16:09:08,466 [s0@group-54E8E36963C5->s1-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(211)) - s0@group-54E8E36963C5->s1-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2023-10-31 16:09:08,467 [s1-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s1@group-54E8E36963C5: receive appendEntries(s0, 1, (t:1, i:5), 5, true, commits:[s0:c5, s1:c4, s2:c4, s3:c4, s4:c4], cId:21, entries: [(t:1, i:6), METADATAENTRY(c:5)]
2023-10-31 16:09:08,467 [s0@group-54E8E36963C5-LeaderStateImpl] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(382)) - s0@group-54E8E36963C5: set configuration 7: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:08,468 [s4-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s4@group-54E8E36963C5: receive appendEntries(s0, 1, (t:1, i:4), 4, true, commits:[s0:c4, s1:c4, s2:c4, s3:c4, s4:c4], cId:3, entries: [(t:1, i:5), CONFIGURATIONENTRY(current:id: "s3"
address: "0.0.0.0:39449"
clientAddress: "0.0.0.0:39449"
adminAddress: "0.0.0.0:39449"
startupRole: FOLLOWER
,id: "s4"
address: "0.0.0.0:42259"
clientAddress: "0.0.0.0:42259"
adminAddress: "0.0.0.0:42259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:44689"
dataStreamAddress: "localhost:46185"
clientAddress: "localhost:40999"
adminAddress: "localhost:33809"
startupRole: FOLLOWER
, old:id: "s0"
address: "localhost:38037"
dataStreamAddress: "localhost:45555"
clientAddress: "localhost:44585"
adminAddress: "localhost:43529"
startupRole: FOLLOWER
,id: "s1"
address: "localhost:45329"
dataStreamAddress: "localhost:33099"
clientAddress: "localhost:34575"
adminAddress: "localhost:46337"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:44689"
dataStreamAddress: "localhost:46185"
clientAddress: "localhost:40999"
adminAddress: "localhost:33809"
startupRole: FOLLOWER
)]
2023-10-31 16:09:08,468 [s4-server-thread2] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(382)) - s4@group-54E8E36963C5: set configuration 5: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[]
2023-10-31 16:09:08,468 [grpc-default-executor-1] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(157)) - s1: Completed APPEND_ENTRIES, lastRequest: null
2023-10-31 16:09:08,470 [grpc-default-executor-1] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:lambda$onCompleted$5(159)) - s1: Completed APPEND_ENTRIES, lastReply: serverReply {
  requestorId: "s0"
  replyId: "s1"
  raftGroupId {
    id: "\251y\304\030\n\037G\330\237\376T\350\343ic\305"
  }
  callId: 19
  success: true
}
term: 1
nextIndex: 5
followerCommit: 4
matchIndex: 18446744073709551615
isHearbeat: true

2023-10-31 16:09:08,470 [s1-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s1@group-54E8E36963C5: succeeded to handle AppendEntries. Reply: s0<-s1#21:OK-t1,SUCCESS,nextIndex=7,followerCommit=5,matchIndex=6
2023-10-31 16:09:08,469 [grpc-default-executor-5] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(157)) - s1: Completed APPEND_ENTRIES, lastRequest: s0->s1#21-t1,previous=(t:1, i:5),leaderCommit=5,initializing? true,entries: size=1, first=(t:1, i:6), METADATAENTRY(c:5)
2023-10-31 16:09:08,470 [grpc-default-executor-5] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:lambda$onCompleted$5(159)) - s1: Completed APPEND_ENTRIES, lastReply: null
2023-10-31 16:09:08,470 [s4-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s4@group-54E8E36963C5: succeeded to handle AppendEntries. Reply: s0<-s4#3:OK-t1,SUCCESS,nextIndex=6,followerCommit=4,matchIndex=5
2023-10-31 16:09:08,471 [s3-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s3@group-54E8E36963C5: receive appendEntries(s0, 1, (t:1, i:5), 5, true, commits:[s0:c5, s1:c4, s2:c4, s3:c4, s4:c4], cId:4, entries: [(t:1, i:6), METADATAENTRY(c:5)]
2023-10-31 16:09:08,472 [s3-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s3@group-54E8E36963C5: succeeded to handle AppendEntries. Reply: s0<-s3#4:OK-t1,SUCCESS,nextIndex=7,followerCommit=5,matchIndex=6
2023-10-31 16:09:08,472 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-54E8E36963C5: receive appendEntries(s0, 1, (t:1, i:5), 5, true, commits:[s0:c5, s1:c4, s2:c4, s3:c4, s4:c4], cId:21, entries: [(t:1, i:6), METADATAENTRY(c:5)]
2023-10-31 16:09:08,472 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-54E8E36963C5: succeeded to handle AppendEntries. Reply: s0<-s2#21:OK-t1,SUCCESS,nextIndex=7,followerCommit=5,matchIndex=6
2023-10-31 16:09:08,473 [s3-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s3@group-54E8E36963C5: receive appendEntries(s0, 1, (t:1, i:6), 5, true, commits:[s0:c5, s2:c4, s3:c4, s4:c4], cId:5, entries: [(t:1, i:7), CONFIGURATIONENTRY(current:id: "s3"
address: "0.0.0.0:39449"
clientAddress: "0.0.0.0:39449"
adminAddress: "0.0.0.0:39449"
startupRole: FOLLOWER
,id: "s4"
address: "0.0.0.0:42259"
clientAddress: "0.0.0.0:42259"
adminAddress: "0.0.0.0:42259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:44689"
dataStreamAddress: "localhost:46185"
clientAddress: "localhost:40999"
adminAddress: "localhost:33809"
startupRole: FOLLOWER
, old:)]
2023-10-31 16:09:08,473 [s3-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(382)) - s3@group-54E8E36963C5: set configuration 7: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:08,475 [grpc-default-executor-6] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(468)) - s0@group-54E8E36963C5->s1-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2023-10-31 16:09:08,475 [grpc-default-executor-6] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(213)) - Decrease nextIndex to 6
2023-10-31 16:09:08,475 [grpc-default-executor-6] INFO  leader.LogAppender (LogAppenderBase.java:lambda$getNextIndexForError$0(213)) - Decrease nextIndex to 6
2023-10-31 16:09:08,476 [grpc-default-executor-6] INFO  leader.FollowerInfo (FollowerInfoImpl.java:info(70)) - s0@group-54E8E36963C5->s1: computeNextIndex nextIndex: updateUnconditionally 7 -> 6
2023-10-31 16:09:08,475 [s4-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s4@group-54E8E36963C5: receive appendEntries(s0, 1, (t:1, i:5), 5, true, commits:[s0:c5, s1:c4, s2:c4, s3:c4, s4:c4], cId:4, entries: [(t:1, i:6), METADATAENTRY(c:5)]
2023-10-31 16:09:08,475 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-54E8E36963C5: receive appendEntries(s0, 1, (t:1, i:6), 5, true, commits:[s0:c5, s2:c4, s3:c4, s4:c4], cId:22, entries: [(t:1, i:7), CONFIGURATIONENTRY(current:id: "s3"
address: "0.0.0.0:39449"
clientAddress: "0.0.0.0:39449"
adminAddress: "0.0.0.0:39449"
startupRole: FOLLOWER
,id: "s4"
address: "0.0.0.0:42259"
clientAddress: "0.0.0.0:42259"
adminAddress: "0.0.0.0:42259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:44689"
dataStreamAddress: "localhost:46185"
clientAddress: "localhost:40999"
adminAddress: "localhost:33809"
startupRole: FOLLOWER
, old:)]
2023-10-31 16:09:08,476 [s2-server-thread2] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(382)) - s2@group-54E8E36963C5: set configuration 7: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:08,477 [s4-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s4@group-54E8E36963C5: succeeded to handle AppendEntries. Reply: s0<-s4#4:OK-t1,SUCCESS,nextIndex=7,followerCommit=5,matchIndex=6
2023-10-31 16:09:08,477 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-54E8E36963C5: succeeded to handle AppendEntries. Reply: s0<-s2#22:OK-t1,SUCCESS,nextIndex=8,followerCommit=5,matchIndex=7
2023-10-31 16:09:08,478 [s3-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s3@group-54E8E36963C5: succeeded to handle AppendEntries. Reply: s0<-s3#5:OK-t1,SUCCESS,nextIndex=8,followerCommit=5,matchIndex=7
2023-10-31 16:09:08,478 [grpc-default-executor-1] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(468)) - s0@group-54E8E36963C5->s1-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2023-10-31 16:09:08,479 [s4-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s4@group-54E8E36963C5: receive appendEntries(s0, 1, (t:1, i:6), 5, true, commits:[s0:c5, s2:c4, s3:c4, s4:c4], cId:6, entries: [(t:1, i:7), CONFIGURATIONENTRY(current:id: "s3"
address: "0.0.0.0:39449"
clientAddress: "0.0.0.0:39449"
adminAddress: "0.0.0.0:39449"
startupRole: FOLLOWER
,id: "s4"
address: "0.0.0.0:42259"
clientAddress: "0.0.0.0:42259"
adminAddress: "0.0.0.0:42259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:44689"
dataStreamAddress: "localhost:46185"
clientAddress: "localhost:40999"
adminAddress: "localhost:33809"
startupRole: FOLLOWER
, old:)]
2023-10-31 16:09:08,479 [s4-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(382)) - s4@group-54E8E36963C5: set configuration 7: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:08,480 [s0@group-54E8E36963C5-LeaderStateImpl] INFO  server.RaftServer$Division (LeaderStateImpl.java:checkAndUpdateConfiguration(959)) - s0@group-54E8E36963C5-LeaderStateImpl is not included in the new configuration 7: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null. Will shutdown server...
2023-10-31 16:09:08,481 [s4-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s4@group-54E8E36963C5: succeeded to handle AppendEntries. Reply: s0<-s4#6:OK-t1,SUCCESS,nextIndex=8,followerCommit=5,matchIndex=7
2023-10-31 16:09:08,482 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-54E8E36963C5: receive appendEntries(s0, 1, (t:1, i:7), 7, true, commits:[s0:c7, s2:c5, s3:c5, s4:c5], cId:25, entries: [(t:1, i:8), METADATAENTRY(c:7)]
2023-10-31 16:09:08,483 [s3-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s3@group-54E8E36963C5: receive appendEntries(s0, 1, (t:1, i:7), 7, true, commits:[s0:c7, s2:c5, s3:c5, s4:c5], cId:8, entries: [(t:1, i:8), METADATAENTRY(c:7)]
2023-10-31 16:09:08,483 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-54E8E36963C5: succeeded to handle AppendEntries. Reply: s0<-s2#25:OK-t1,SUCCESS,nextIndex=9,followerCommit=7,matchIndex=8
2023-10-31 16:09:08,484 [s3-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s3@group-54E8E36963C5: succeeded to handle AppendEntries. Reply: s0<-s3#8:OK-t1,SUCCESS,nextIndex=9,followerCommit=7,matchIndex=8
2023-10-31 16:09:08,484 [s4-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s4@group-54E8E36963C5: receive appendEntries(s0, 1, (t:1, i:7), 7, true, commits:[s0:c7, s2:c5, s3:c5, s4:c5], cId:11, entries: [(t:1, i:8), METADATAENTRY(c:7)]
2023-10-31 16:09:08,485 [s4-server-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s4@group-54E8E36963C5: succeeded to handle AppendEntries. Reply: s0<-s4#11:OK-t1,SUCCESS,nextIndex=9,followerCommit=7,matchIndex=8
2023-10-31 16:09:08,492 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2023-10-31 16:09:08,492 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(100)) - printing ALL groups
  s3:  RUNNING  FOLLOWER s3@group-54E8E36963C5:t1, leader=s0, voted=null, raftlog=Memoized:s3@group-54E8E36963C5-SegmentedRaftLog:OPENED:c7, conf=7: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null RUNNING
  s4:  RUNNING  FOLLOWER s4@group-54E8E36963C5:t1, leader=s0, voted=null, raftlog=Memoized:s4@group-54E8E36963C5-SegmentedRaftLog:OPENED:c7, conf=7: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null RUNNING
  s0:  RUNNING    LEADER s0@group-54E8E36963C5:t1, leader=s0, voted=s0, raftlog=Memoized:s0@group-54E8E36963C5-SegmentedRaftLog:OPENED:c7, conf=7: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-54E8E36963C5:t1, leader=s0, voted=s0, raftlog=Memoized:s1@group-54E8E36963C5-SegmentedRaftLog:OPENED:c5, conf=5: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[] RUNNING
  s2:  RUNNING  FOLLOWER s2@group-54E8E36963C5:t1, leader=s0, voted=s2, raftlog=Memoized:s2@group-54E8E36963C5-SegmentedRaftLog:OPENED:c7, conf=7: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null RUNNING
2023-10-31 16:09:08,492 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(119)) - printing ALL groups
  s3:  RUNNING  FOLLOWER s3@group-54E8E36963C5:t1, leader=s0, voted=null, raftlog=Memoized:s3@group-54E8E36963C5-SegmentedRaftLog:OPENED:c7, conf=7: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null RUNNING
  s4:  RUNNING  FOLLOWER s4@group-54E8E36963C5:t1, leader=s0, voted=null, raftlog=Memoized:s4@group-54E8E36963C5-SegmentedRaftLog:OPENED:c7, conf=7: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null RUNNING
  s0:  RUNNING    LEADER s0@group-54E8E36963C5:t1, leader=s0, voted=s0, raftlog=Memoized:s0@group-54E8E36963C5-SegmentedRaftLog:OPENED:c7, conf=7: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-54E8E36963C5:t1, leader=s0, voted=s0, raftlog=Memoized:s1@group-54E8E36963C5-SegmentedRaftLog:OPENED:c5, conf=5: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[] RUNNING
  s2:  RUNNING  FOLLOWER s2@group-54E8E36963C5:t1, leader=s0, voted=s2, raftlog=Memoized:s2@group-54E8E36963C5-SegmentedRaftLog:OPENED:c7, conf=7: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null RUNNING
2023-10-31 16:09:08,492 [Time-limited test] WARN  grpc.TestRetryCacheWithGrpc (JavaUtils.java:attempt(223)) - FAILED "wait for a leader different than s0", attempt #1/10: java.lang.AssertionError: Values should be different. Actual: s0, sleep 100ms and then retry.
java.lang.AssertionError: Values should be different. Actual: s0
	at org.junit.Assert.fail(Assert.java:89)
	at org.junit.Assert.failEquals(Assert.java:187)
	at org.junit.Assert.assertNotEquals(Assert.java:163)
	at org.junit.Assert.assertNotEquals(Assert.java:177)
	at org.apache.ratis.RetryCacheTests.lambda$runTestRetryOnNewLeader$0(RetryCacheTests.java:146)
	at org.apache.ratis.util.JavaUtils.attempt(JavaUtils.java:217)
	at org.apache.ratis.util.JavaUtils.attemptRepeatedly(JavaUtils.java:203)
	at org.apache.ratis.RetryCacheTests.runTestRetryOnNewLeader(RetryCacheTests.java:144)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:141)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:121)
	at org.apache.ratis.RetryCacheTests.testRetryOnNewLeader(RetryCacheTests.java:122)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,506 [grpc-default-executor-6] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s2@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:42947
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,593 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2023-10-31 16:09:08,593 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(100)) - printing ALL groups
  s3:  RUNNING  FOLLOWER s3@group-54E8E36963C5:t1, leader=s0, voted=null, raftlog=Memoized:s3@group-54E8E36963C5-SegmentedRaftLog:OPENED:c7, conf=7: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null RUNNING
  s4:  RUNNING  FOLLOWER s4@group-54E8E36963C5:t1, leader=s0, voted=null, raftlog=Memoized:s4@group-54E8E36963C5-SegmentedRaftLog:OPENED:c7, conf=7: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null RUNNING
  s0:  RUNNING    LEADER s0@group-54E8E36963C5:t1, leader=s0, voted=s0, raftlog=Memoized:s0@group-54E8E36963C5-SegmentedRaftLog:OPENED:c7, conf=7: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-54E8E36963C5:t1, leader=s0, voted=s0, raftlog=Memoized:s1@group-54E8E36963C5-SegmentedRaftLog:OPENED:c5, conf=5: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[] RUNNING
  s2:  RUNNING  FOLLOWER s2@group-54E8E36963C5:t1, leader=s0, voted=s2, raftlog=Memoized:s2@group-54E8E36963C5-SegmentedRaftLog:OPENED:c7, conf=7: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null RUNNING
2023-10-31 16:09:08,594 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(119)) - printing ALL groups
  s3:  RUNNING  FOLLOWER s3@group-54E8E36963C5:t1, leader=s0, voted=null, raftlog=Memoized:s3@group-54E8E36963C5-SegmentedRaftLog:OPENED:c7, conf=7: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null RUNNING
  s4:  RUNNING  FOLLOWER s4@group-54E8E36963C5:t1, leader=s0, voted=null, raftlog=Memoized:s4@group-54E8E36963C5-SegmentedRaftLog:OPENED:c7, conf=7: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null RUNNING
  s0:  RUNNING    LEADER s0@group-54E8E36963C5:t1, leader=s0, voted=s0, raftlog=Memoized:s0@group-54E8E36963C5-SegmentedRaftLog:OPENED:c7, conf=7: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-54E8E36963C5:t1, leader=s0, voted=s0, raftlog=Memoized:s1@group-54E8E36963C5-SegmentedRaftLog:OPENED:c5, conf=5: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[] RUNNING
  s2:  RUNNING  FOLLOWER s2@group-54E8E36963C5:t1, leader=s0, voted=s2, raftlog=Memoized:s2@group-54E8E36963C5-SegmentedRaftLog:OPENED:c7, conf=7: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null RUNNING
2023-10-31 16:09:08,594 [Time-limited test] WARN  grpc.TestRetryCacheWithGrpc (JavaUtils.java:attempt(223)) - FAILED "wait for a leader different than s0", attempt #2/10: java.lang.AssertionError: Values should be different. Actual: s0, sleep 100ms and then retry.
java.lang.AssertionError: Values should be different. Actual: s0
	at org.junit.Assert.fail(Assert.java:89)
	at org.junit.Assert.failEquals(Assert.java:187)
	at org.junit.Assert.assertNotEquals(Assert.java:163)
	at org.junit.Assert.assertNotEquals(Assert.java:177)
	at org.apache.ratis.RetryCacheTests.lambda$runTestRetryOnNewLeader$0(RetryCacheTests.java:146)
	at org.apache.ratis.util.JavaUtils.attempt(JavaUtils.java:217)
	at org.apache.ratis.util.JavaUtils.attemptRepeatedly(JavaUtils.java:203)
	at org.apache.ratis.RetryCacheTests.runTestRetryOnNewLeader(RetryCacheTests.java:144)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:141)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:121)
	at org.apache.ratis.RetryCacheTests.testRetryOnNewLeader(RetryCacheTests.java:122)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,614 [grpc-default-executor-1] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s1@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:37189
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,631 [s0@group-54E8E36963C5-LeaderStateImpl] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$3(514)) - s0@group-54E8E36963C5: shutdown
2023-10-31 16:09:08,632 [s0@group-54E8E36963C5-LeaderStateImpl] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-54E8E36963C5,id=s0
2023-10-31 16:09:08,632 [s0@group-54E8E36963C5-LeaderStateImpl] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(92)) - s0: shutdown s0@group-54E8E36963C5-LeaderStateImpl
2023-10-31 16:09:08,632 [s0@group-54E8E36963C5-LeaderStateImpl] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(289)) - s0@group-54E8E36963C5-PendingRequests: sendNotLeaderResponses
2023-10-31 16:09:08,632 [s0@group-54E8E36963C5->s2-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(211)) - s0@group-54E8E36963C5->s2-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2023-10-31 16:09:08,632 [s0@group-54E8E36963C5->s3-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(211)) - s0@group-54E8E36963C5->s3-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2023-10-31 16:09:08,632 [s0@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(211)) - s0@group-54E8E36963C5->s4-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2023-10-31 16:09:08,634 [grpc-default-executor-1] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(157)) - s4: Completed APPEND_ENTRIES, lastRequest: null
2023-10-31 16:09:08,634 [grpc-default-executor-5] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(157)) - s3: Completed APPEND_ENTRIES, lastRequest: s0->s3#8-t1,previous=(t:1, i:7),leaderCommit=7,initializing? true,entries: size=1, first=(t:1, i:8), METADATAENTRY(c:7)
2023-10-31 16:09:08,634 [grpc-default-executor-5] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:lambda$onCompleted$5(159)) - s3: Completed APPEND_ENTRIES, lastReply: null
2023-10-31 16:09:08,634 [grpc-default-executor-2] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(157)) - s4: Completed APPEND_ENTRIES, lastRequest: s0->s4#11-t1,previous=(t:1, i:7),leaderCommit=7,initializing? true,entries: size=1, first=(t:1, i:8), METADATAENTRY(c:7)
2023-10-31 16:09:08,634 [grpc-default-executor-2] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:lambda$onCompleted$5(159)) - s4: Completed APPEND_ENTRIES, lastReply: null
2023-10-31 16:09:08,634 [grpc-default-executor-5] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(157)) - s2: Completed APPEND_ENTRIES, lastRequest: s0->s2#25-t1,previous=(t:1, i:7),leaderCommit=7,initializing? true,entries: size=1, first=(t:1, i:8), METADATAENTRY(c:7)
2023-10-31 16:09:08,635 [grpc-default-executor-5] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:lambda$onCompleted$5(159)) - s2: Completed APPEND_ENTRIES, lastReply: null
2023-10-31 16:09:08,636 [grpc-default-executor-1] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:lambda$onCompleted$5(159)) - s4: Completed APPEND_ENTRIES, lastReply: serverReply {
  requestorId: "s0"
  replyId: "s4"
  raftGroupId {
    id: "\251y\304\030\n\037G\330\237\376T\350\343ic\305"
  }
  callId: 15
  success: true
}
term: 1
nextIndex: 9
followerCommit: 7
matchIndex: 18446744073709551615
isHearbeat: true

2023-10-31 16:09:08,636 [grpc-default-executor-6] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(157)) - s2: Completed APPEND_ENTRIES, lastRequest: null
2023-10-31 16:09:08,636 [grpc-default-executor-6] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:lambda$onCompleted$5(159)) - s2: Completed APPEND_ENTRIES, lastReply: serverReply {
  requestorId: "s0"
  replyId: "s2"
  raftGroupId {
    id: "\251y\304\030\n\037G\330\237\376T\350\343ic\305"
  }
  callId: 26
  success: true
}
term: 1
nextIndex: 9
followerCommit: 7
matchIndex: 18446744073709551615
isHearbeat: true

2023-10-31 16:09:08,636 [grpc-default-executor-4] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(157)) - s3: Completed APPEND_ENTRIES, lastRequest: null
2023-10-31 16:09:08,633 [s0@group-54E8E36963C5-LeaderStateImpl] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(157)) - s0@group-54E8E36963C5-StateMachineUpdater: set stopIndex = 7
2023-10-31 16:09:08,636 [s0@group-54E8E36963C5-LeaderStateImpl] INFO  server.RaftServer$Division (ServerState.java:close(423)) - s0@group-54E8E36963C5: applyIndex: 7
2023-10-31 16:09:08,637 [s0@group-54E8E36963C5-cacheEviction-AwaitToRun] INFO  util.AwaitToRun (AwaitToRun.java:run(49)) - s0@group-54E8E36963C5-cacheEviction-AwaitToRun-AwaitForSignal is interrupted
2023-10-31 16:09:08,637 [grpc-default-executor-5] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(468)) - s0@group-54E8E36963C5->s4-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2023-10-31 16:09:08,638 [grpc-default-executor-6] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(468)) - s0@group-54E8E36963C5->s4-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2023-10-31 16:09:08,638 [grpc-default-executor-1] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(468)) - s0@group-54E8E36963C5->s2-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2023-10-31 16:09:08,638 [grpc-default-executor-4] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:lambda$onCompleted$5(159)) - s3: Completed APPEND_ENTRIES, lastReply: serverReply {
  requestorId: "s0"
  replyId: "s3"
  raftGroupId {
    id: "\251y\304\030\n\037G\330\237\376T\350\343ic\305"
  }
  callId: 10
  success: true
}
term: 1
nextIndex: 9
followerCommit: 7
matchIndex: 18446744073709551615
isHearbeat: true

2023-10-31 16:09:08,638 [grpc-default-executor-4] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(468)) - s0@group-54E8E36963C5->s3-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2023-10-31 16:09:08,638 [grpc-default-executor-4] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(468)) - s0@group-54E8E36963C5->s2-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2023-10-31 16:09:08,639 [grpc-default-executor-4] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(468)) - s0@group-54E8E36963C5->s3-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2023-10-31 16:09:08,694 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2023-10-31 16:09:08,694 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(100)) - printing ALL groups
  s3:  RUNNING  FOLLOWER s3@group-54E8E36963C5:t1, leader=s0, voted=null, raftlog=Memoized:s3@group-54E8E36963C5-SegmentedRaftLog:OPENED:c7, conf=7: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null RUNNING
  s4:  RUNNING  FOLLOWER s4@group-54E8E36963C5:t1, leader=s0, voted=null, raftlog=Memoized:s4@group-54E8E36963C5-SegmentedRaftLog:OPENED:c7, conf=7: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null RUNNING
  s0:  RUNNING    LEADER s0@group-54E8E36963C5:t1, leader=s0, voted=s0, raftlog=Memoized:s0@group-54E8E36963C5-SegmentedRaftLog:CLOSED:c7, conf=7: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null CLOSING
  s1:  RUNNING  FOLLOWER s1@group-54E8E36963C5:t1, leader=s0, voted=s0, raftlog=Memoized:s1@group-54E8E36963C5-SegmentedRaftLog:OPENED:c5, conf=5: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[] RUNNING
  s2:  RUNNING  FOLLOWER s2@group-54E8E36963C5:t1, leader=s0, voted=s2, raftlog=Memoized:s2@group-54E8E36963C5-SegmentedRaftLog:OPENED:c7, conf=7: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null RUNNING
2023-10-31 16:09:08,695 [Time-limited test] WARN  ratis.RaftTestUtil (JavaUtils.java:attempt(223)) - FAILED "waitForLeader-null-(expectLeader? true)", attempt #1/100: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s3:  RUNNING  FOLLOWER s3@group-54E8E36963C5:t1, leader=s0, voted=null, raftlog=Memoized:s3@group-54E8E36963C5-SegmentedRaftLog:OPENED:c7, conf=7: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null RUNNING
  s4:  RUNNING  FOLLOWER s4@group-54E8E36963C5:t1, leader=s0, voted=null, raftlog=Memoized:s4@group-54E8E36963C5-SegmentedRaftLog:OPENED:c7, conf=7: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null RUNNING
  s0:  RUNNING    LEADER s0@group-54E8E36963C5:t1, leader=s0, voted=s0, raftlog=Memoized:s0@group-54E8E36963C5-SegmentedRaftLog:CLOSED:c7, conf=7: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null CLOSING
  s1:  RUNNING  FOLLOWER s1@group-54E8E36963C5:t1, leader=s0, voted=s0, raftlog=Memoized:s1@group-54E8E36963C5-SegmentedRaftLog:OPENED:c5, conf=5: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[] RUNNING
  s2:  RUNNING  FOLLOWER s2@group-54E8E36963C5:t1, leader=s0, voted=s2, raftlog=Memoized:s2@group-54E8E36963C5-SegmentedRaftLog:OPENED:c7, conf=7: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null RUNNING, sleep 450ms and then retry.
java.lang.IllegalStateException: No leader yet : printing ALL groups
  s3:  RUNNING  FOLLOWER s3@group-54E8E36963C5:t1, leader=s0, voted=null, raftlog=Memoized:s3@group-54E8E36963C5-SegmentedRaftLog:OPENED:c7, conf=7: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null RUNNING
  s4:  RUNNING  FOLLOWER s4@group-54E8E36963C5:t1, leader=s0, voted=null, raftlog=Memoized:s4@group-54E8E36963C5-SegmentedRaftLog:OPENED:c7, conf=7: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null RUNNING
  s0:  RUNNING    LEADER s0@group-54E8E36963C5:t1, leader=s0, voted=s0, raftlog=Memoized:s0@group-54E8E36963C5-SegmentedRaftLog:CLOSED:c7, conf=7: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null CLOSING
  s1:  RUNNING  FOLLOWER s1@group-54E8E36963C5:t1, leader=s0, voted=s0, raftlog=Memoized:s1@group-54E8E36963C5-SegmentedRaftLog:OPENED:c5, conf=5: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[] RUNNING
  s2:  RUNNING  FOLLOWER s2@group-54E8E36963C5:t1, leader=s0, voted=s2, raftlog=Memoized:s2@group-54E8E36963C5-SegmentedRaftLog:OPENED:c7, conf=7: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null RUNNING
	at org.apache.ratis.server.impl.MiniRaftCluster.newIllegalStateExceptionForNoLeaders(MiniRaftCluster.java:581)
	at org.apache.ratis.RaftTestUtil.lambda$waitForLeader$1(RaftTestUtil.java:104)
	at org.apache.ratis.server.impl.MiniRaftCluster.getLeader(MiniRaftCluster.java:615)
	at org.apache.ratis.server.impl.MiniRaftCluster.getLeader(MiniRaftCluster.java:608)
	at org.apache.ratis.RaftTestUtil.lambda$waitForLeader$3(RaftTestUtil.java:112)
	at org.apache.ratis.util.JavaUtils.attempt(JavaUtils.java:217)
	at org.apache.ratis.util.JavaUtils.attemptRepeatedly(JavaUtils.java:203)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:111)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:92)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:87)
	at org.apache.ratis.RetryCacheTests.lambda$runTestRetryOnNewLeader$0(RetryCacheTests.java:145)
	at org.apache.ratis.util.JavaUtils.attempt(JavaUtils.java:217)
	at org.apache.ratis.util.JavaUtils.attemptRepeatedly(JavaUtils.java:203)
	at org.apache.ratis.RetryCacheTests.runTestRetryOnNewLeader(RetryCacheTests.java:144)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:141)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:121)
	at org.apache.ratis.RetryCacheTests.testRetryOnNewLeader(RetryCacheTests.java:122)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,718 [grpc-default-executor-6] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s2@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:42947
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,723 [s1@group-54E8E36963C5-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s1@group-54E8E36963C5-FollowerState: change to CANDIDATE, lastRpcElapsedTime:253155653ns, electionTimeout:192ms
2023-10-31 16:09:08,724 [s1@group-54E8E36963C5-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(109)) - s1: shutdown s1@group-54E8E36963C5-FollowerState
2023-10-31 16:09:08,724 [s1@group-54E8E36963C5-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s1@group-54E8E36963C5: changes role from  FOLLOWER to CANDIDATE at term 1 for changeToCandidate
2023-10-31 16:09:08,724 [s1@group-54E8E36963C5-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2023-10-31 16:09:08,724 [s1@group-54E8E36963C5-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s1: start s1@group-54E8E36963C5-LeaderElection12
2023-10-31 16:09:08,724 [s1@group-54E8E36963C5-LeaderElection12] INFO  server.RaftServer$Division (ServerState.java:setLeader(265)) - s1@group-54E8E36963C5: change Leader from s0 to null at term 1 for PRE_VOTE
2023-10-31 16:09:08,724 [s1@group-54E8E36963C5-LeaderElection12] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(323)) - s1@group-54E8E36963C5-LeaderElection12 PRE_VOTE round 0: submit vote requests at term 1 for 5: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[]
2023-10-31 16:09:08,724 [s1@group-54E8E36963C5-LeaderElection12] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(325)) - s1@group-54E8E36963C5-LeaderElection12 PRE_VOTE round 0: result NOT_IN_CONF (term=1)
2023-10-31 16:09:08,724 [s1@group-54E8E36963C5-LeaderElection12] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$9(416)) - s1: close
2023-10-31 16:09:08,725 [s1-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$3(514)) - s1@group-54E8E36963C5: shutdown
2023-10-31 16:09:08,725 [s1-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-54E8E36963C5,id=s1
2023-10-31 16:09:08,725 [s1-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(129)) - s1: shutdown s1@group-54E8E36963C5-LeaderElection12
2023-10-31 16:09:08,725 [s1-impl-thread1] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(157)) - s1@group-54E8E36963C5-StateMachineUpdater: set stopIndex = 5
2023-10-31 16:09:08,725 [s1@group-54E8E36963C5-LeaderElection12] INFO  server.GrpcService (GrpcService.java:closeImpl(311)) - s1: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService now
2023-10-31 16:09:08,725 [s1-impl-thread1] INFO  server.RaftServer$Division (ServerState.java:close(423)) - s1@group-54E8E36963C5: applyIndex: 5
2023-10-31 16:09:08,725 [s1@group-54E8E36963C5-cacheEviction-AwaitToRun] INFO  util.AwaitToRun (AwaitToRun.java:run(49)) - s1@group-54E8E36963C5-cacheEviction-AwaitToRun-AwaitForSignal is interrupted
2023-10-31 16:09:08,727 [s1@group-54E8E36963C5-LeaderElection12] INFO  server.GrpcService (GrpcService.java:closeImpl(320)) - s1: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService successfully
2023-10-31 16:09:08,727 [s1@group-54E8E36963C5-LeaderElection12] INFO  server.GrpcService (GrpcService.java:closeImpl(311)) - s1: shutdown server GrpcServerProtocolService now
2023-10-31 16:09:08,733 [s1@group-54E8E36963C5-LeaderElection12] INFO  server.GrpcService (GrpcService.java:closeImpl(320)) - s1: shutdown server GrpcServerProtocolService successfully
2023-10-31 16:09:08,733 [s1@group-54E8E36963C5-LeaderElection12] INFO  server.GrpcService (GrpcService.java:closeImpl(311)) - s1: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService now
2023-10-31 16:09:08,734 [s1@group-54E8E36963C5-LeaderElection12] INFO  server.GrpcService (GrpcService.java:closeImpl(320)) - s1: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService successfully
2023-10-31 16:09:08,823 [grpc-default-executor-1] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s0@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:37937
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,834 [s3@group-54E8E36963C5-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s3@group-54E8E36963C5-FollowerState: change to CANDIDATE, lastRpcElapsedTime:270950174ns, electionTimeout:189ms
2023-10-31 16:09:08,834 [s3@group-54E8E36963C5-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(109)) - s3: shutdown s3@group-54E8E36963C5-FollowerState
2023-10-31 16:09:08,835 [s3@group-54E8E36963C5-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s3@group-54E8E36963C5: changes role from  FOLLOWER to CANDIDATE at term 1 for changeToCandidate
2023-10-31 16:09:08,835 [s3@group-54E8E36963C5-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2023-10-31 16:09:08,835 [s3@group-54E8E36963C5-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s3: start s3@group-54E8E36963C5-LeaderElection13
2023-10-31 16:09:08,835 [s3@group-54E8E36963C5-LeaderElection13] INFO  server.RaftServer$Division (ServerState.java:setLeader(265)) - s3@group-54E8E36963C5: change Leader from s0 to null at term 1 for PRE_VOTE
2023-10-31 16:09:08,835 [s3@group-54E8E36963C5-LeaderElection13] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(323)) - s3@group-54E8E36963C5-LeaderElection13 PRE_VOTE round 0: submit vote requests at term 1 for 7: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:08,836 [s3@group-54E8E36963C5-LeaderElection13] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(136)) - s3@group-54E8E36963C5-LeaderElection13 got exception when requesting votes: java.util.concurrent.ExecutionException: java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, EXCEPTION -> STARTING
2023-10-31 16:09:08,839 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s2@group-54E8E36963C5: receive requestVote(PRE_VOTE, s3, group-54E8E36963C5, 1, (t:1, i:8))
2023-10-31 16:09:08,839 [grpc-default-executor-1] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-54E8E36963C5-FOLLOWER: accept PRE_VOTE from s3: our priority 0 <= candidate's priority 0
2023-10-31 16:09:08,839 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s2@group-54E8E36963C5 replies to PRE_VOTE vote request: s3<-s2#0:OK-t1. Peer's state: s2@group-54E8E36963C5:t1, leader=s0, voted=s2, raftlog=Memoized:s2@group-54E8E36963C5-SegmentedRaftLog:OPENED:c7, conf=7: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:08,840 [s3@group-54E8E36963C5-LeaderElection13] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s3@group-54E8E36963C5-LeaderElection13: PRE_VOTE PASSED received 1 response(s) and 1 exception(s):
2023-10-31 16:09:08,840 [s3@group-54E8E36963C5-LeaderElection13] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s3<-s2#0:OK-t1
2023-10-31 16:09:08,840 [s3@group-54E8E36963C5-LeaderElection13] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(136)) -   Exception 1: java.util.concurrent.ExecutionException: java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, EXCEPTION -> STARTING
2023-10-31 16:09:08,840 [s3@group-54E8E36963C5-LeaderElection13] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(325)) - s3@group-54E8E36963C5-LeaderElection13 PRE_VOTE round 0: result PASSED
2023-10-31 16:09:08,841 [s3@group-54E8E36963C5-LeaderElection13] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s3/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/raft-meta.tmp with options [CREATE, WRITE]: sun.nio.ch.FileChannelImpl@c0aa177
2023-10-31 16:09:08,842 [s3@group-54E8E36963C5-LeaderElection13] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s3/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s3/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/raft-meta with options [REPLACE_EXISTING]
2023-10-31 16:09:08,842 [s3@group-54E8E36963C5-LeaderElection13] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(323)) - s3@group-54E8E36963C5-LeaderElection13 ELECTION round 0: submit vote requests at term 2 for 7: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:08,843 [s3@group-54E8E36963C5-LeaderElection13] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(136)) - s3@group-54E8E36963C5-LeaderElection13 got exception when requesting votes: java.util.concurrent.ExecutionException: java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
2023-10-31 16:09:08,844 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s2@group-54E8E36963C5: receive requestVote(ELECTION, s3, group-54E8E36963C5, 2, (t:1, i:8))
2023-10-31 16:09:08,844 [grpc-default-executor-1] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-54E8E36963C5-FOLLOWER: accept ELECTION from s3: our priority 0 <= candidate's priority 0
2023-10-31 16:09:08,844 [grpc-default-executor-1] INFO  server.RaftServer$Division (ServerState.java:setLeader(265)) - s2@group-54E8E36963C5: change Leader from s0 to null at term 2 for updateCurrentTerm
2023-10-31 16:09:08,844 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s2@group-54E8E36963C5: changes role from  FOLLOWER to FOLLOWER at term 2 for candidate:s3
2023-10-31 16:09:08,844 [grpc-default-executor-1] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(109)) - s2: shutdown s2@group-54E8E36963C5-FollowerState
2023-10-31 16:09:08,844 [grpc-default-executor-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s2: start s2@group-54E8E36963C5-FollowerState
2023-10-31 16:09:08,844 [s2@group-54E8E36963C5-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(152)) - s2@group-54E8E36963C5-FollowerState was interrupted
2023-10-31 16:09:08,845 [grpc-default-executor-1] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s2/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/raft-meta.tmp with options [CREATE, WRITE]: sun.nio.ch.FileChannelImpl@2b584f3c
2023-10-31 16:09:08,846 [grpc-default-executor-1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s2/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s2/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/raft-meta with options [REPLACE_EXISTING]
2023-10-31 16:09:08,846 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s2@group-54E8E36963C5 replies to ELECTION vote request: s3<-s2#0:OK-t2. Peer's state: s2@group-54E8E36963C5:t2, leader=null, voted=s3, raftlog=Memoized:s2@group-54E8E36963C5-SegmentedRaftLog:OPENED:c7, conf=7: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:08,850 [s3@group-54E8E36963C5-LeaderElection13] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s3@group-54E8E36963C5-LeaderElection13: ELECTION PASSED received 1 response(s) and 1 exception(s):
2023-10-31 16:09:08,850 [s3@group-54E8E36963C5-LeaderElection13] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s3<-s2#0:OK-t2
2023-10-31 16:09:08,850 [s3@group-54E8E36963C5-LeaderElection13] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(136)) -   Exception 1: java.util.concurrent.ExecutionException: java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
2023-10-31 16:09:08,850 [s3@group-54E8E36963C5-LeaderElection13] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(325)) - s3@group-54E8E36963C5-LeaderElection13 ELECTION round 0: result PASSED
2023-10-31 16:09:08,850 [s3@group-54E8E36963C5-LeaderElection13] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(129)) - s3: shutdown s3@group-54E8E36963C5-LeaderElection13
2023-10-31 16:09:08,850 [s3@group-54E8E36963C5-LeaderElection13] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s3@group-54E8E36963C5: changes role from CANDIDATE to LEADER at term 2 for changeToLeader
2023-10-31 16:09:08,850 [s3@group-54E8E36963C5-LeaderElection13] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.staging.catchup.gap = 1000 (default)
2023-10-31 16:09:08,850 [s3@group-54E8E36963C5-LeaderElection13] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.element-limit = 4096 (default)
2023-10-31 16:09:08,850 [s3@group-54E8E36963C5-LeaderElection13] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.byte-limit = 64MB (=67108864) (default)
2023-10-31 16:09:08,851 [s3@group-54E8E36963C5-LeaderElection13] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.timeout = 10s (default)
2023-10-31 16:09:08,851 [s3@group-54E8E36963C5-LeaderElection13] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.timeout.denomination = 1s (default)
2023-10-31 16:09:08,851 [s3@group-54E8E36963C5-LeaderElection13] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.element-limit = 65536 (default)
2023-10-31 16:09:08,851 [s3@group-54E8E36963C5-LeaderElection13] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.leader.lease.enabled = false (default)
2023-10-31 16:09:08,851 [s3@group-54E8E36963C5-LeaderElection13] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.leader.lease.timeout.ratio = 0.9 (default)
2023-10-31 16:09:08,851 [s3@group-54E8E36963C5-LeaderElection13] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.min = 150ms (default)
2023-10-31 16:09:08,851 [s3@group-54E8E36963C5-LeaderElection13] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.element-limit = 4096 (default)
2023-10-31 16:09:08,851 [s3@group-54E8E36963C5-LeaderElection13] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.follower.gap.ratio.max = -1.0 (default)
2023-10-31 16:09:08,851 [s3@group-54E8E36963C5-LeaderElection13] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,851 [s3@group-54E8E36963C5-LeaderElection13] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,851 [s3@group-54E8E36963C5-LeaderElection13] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,851 [s3@group-54E8E36963C5-LeaderElection13] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,851 [s3@group-54E8E36963C5-LeaderElection13] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,851 [s3@group-54E8E36963C5-LeaderElection13] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,851 [s3@group-54E8E36963C5-LeaderElection13] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,851 [s3@group-54E8E36963C5-LeaderElection13] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,851 [s3@group-54E8E36963C5-LeaderElection13] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,851 [s3@group-54E8E36963C5-LeaderElection13] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,852 [s3@group-54E8E36963C5-LeaderElection13] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,852 [s3@group-54E8E36963C5-LeaderElection13] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,852 [s3@group-54E8E36963C5-LeaderElection13] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,852 [s3@group-54E8E36963C5-LeaderElection13] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,852 [s3@group-54E8E36963C5-LeaderElection13] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,852 [s3@group-54E8E36963C5-LeaderElection13] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,852 [s3@group-54E8E36963C5-LeaderElection13] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,852 [s3@group-54E8E36963C5-LeaderElection13] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,852 [s3@group-54E8E36963C5-LeaderElection13] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,852 [s3@group-54E8E36963C5-LeaderElection13] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,852 [s3@group-54E8E36963C5-LeaderElection13] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s3: start s3@group-54E8E36963C5-LeaderStateImpl
2023-10-31 16:09:08,852 [s3@group-54E8E36963C5-LeaderElection13] INFO  server.RaftServer$Division (ServerState.java:setLeader(265)) - s3@group-54E8E36963C5: change Leader from null to s3 at term 2 for becomeLeader, leader elected after 17ms
2023-10-31 16:09:08,853 [s3@group-54E8E36963C5-LeaderElection13] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(433)) - s3@group-54E8E36963C5-SegmentedRaftLogWorker: Rolling segment log-0_8 to index:8
2023-10-31 16:09:08,854 [s3@group-54E8E36963C5-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s3/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/log_inprogress_0 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s3/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/log_0-8
2023-10-31 16:09:08,854 [s3@group-54E8E36963C5-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(589)) - s3@group-54E8E36963C5-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s3/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/log_inprogress_0 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s3/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/log_0-8
2023-10-31 16:09:08,859 [s3@group-54E8E36963C5-LeaderElection13] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(382)) - s3@group-54E8E36963C5: set configuration 9: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:08,860 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,860 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:08,860 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,861 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,861 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,861 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,861 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,861 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,861 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,861 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,861 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,861 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,863 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,863 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:08,864 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,864 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,864 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,864 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,864 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,864 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,864 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,864 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,864 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,864 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,865 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,865 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:08,865 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,865 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,865 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,865 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,865 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,866 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,866 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,866 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,866 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,866 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,866 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,866 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:08,867 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,867 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,867 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,868 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,868 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,868 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,868 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,868 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,868 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,868 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,868 [s3@group-54E8E36963C5-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(632)) - s3@group-54E8E36963C5-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s3/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/log_inprogress_9
2023-10-31 16:09:08,869 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,869 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:08,870 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,870 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,870 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,870 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,870 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,870 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,870 [s2-server-thread3] INFO  server.RaftServer$Division (ServerState.java:setLeader(265)) - s2@group-54E8E36963C5: change Leader from null to s3 at term 2 for appendEntries, leader elected after 26ms
2023-10-31 16:09:08,870 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,870 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,870 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,871 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,872 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,872 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:08,872 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,873 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,873 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-54E8E36963C5: receive appendEntries(s3, 2, (t:1, i:8), 7, true, commits:[s3:c7, s2:c7], cId:1, entries: [(t:2, i:9), CONFIGURATIONENTRY(current:id: "s3"
address: "0.0.0.0:39449"
clientAddress: "0.0.0.0:39449"
adminAddress: "0.0.0.0:39449"
startupRole: FOLLOWER
,id: "s4"
address: "0.0.0.0:42259"
clientAddress: "0.0.0.0:42259"
adminAddress: "0.0.0.0:42259"
startupRole: FOLLOWER
,id: "s2"
address: "localhost:44689"
dataStreamAddress: "localhost:46185"
clientAddress: "localhost:40999"
adminAddress: "localhost:33809"
startupRole: FOLLOWER
, old:)]
2023-10-31 16:09:08,873 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,873 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,873 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,873 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,873 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,873 [s2-server-thread2] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(382)) - s2@group-54E8E36963C5: set configuration 9: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:08,873 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,873 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,873 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,873 [s2-server-thread2] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(433)) - s2@group-54E8E36963C5-SegmentedRaftLogWorker: Rolling segment log-0_8 to index:8
2023-10-31 16:09:08,874 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,874 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:08,874 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,874 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,874 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,874 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,874 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,874 [s2@group-54E8E36963C5-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s2/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/log_inprogress_0 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s2/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/log_0-8
2023-10-31 16:09:08,874 [s2@group-54E8E36963C5-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(589)) - s2@group-54E8E36963C5-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s2/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/log_inprogress_0 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s2/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/log_0-8
2023-10-31 16:09:08,874 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,874 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,874 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,874 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,874 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,875 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,875 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:08,875 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,875 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,875 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,875 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,875 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,875 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,875 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,875 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,875 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,876 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,876 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,876 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:08,877 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,877 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,877 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,877 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,877 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,877 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,877 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,877 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,877 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,877 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,878 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,878 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:08,878 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,878 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,878 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,878 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,878 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,878 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,878 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,878 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,878 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,878 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,879 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,879 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:08,879 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,879 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,879 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,879 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,879 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,879 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,879 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,879 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,879 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,879 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,880 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,880 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:08,880 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,880 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,880 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,880 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,880 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,880 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,880 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,881 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,881 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,881 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,881 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,890 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:08,890 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,890 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,890 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,890 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,890 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,890 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,890 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,890 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,890 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,890 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,892 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,892 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:08,892 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,892 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,892 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,892 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,892 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,892 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,892 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,892 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,892 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,892 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,893 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,893 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:08,893 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,893 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,893 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,893 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,893 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,893 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,893 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,893 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,893 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,894 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,894 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,894 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:08,894 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,894 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,894 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,894 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,895 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,895 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,895 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,895 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,895 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,895 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,895 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,895 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:08,895 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,896 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,896 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,896 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,896 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,896 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,896 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,896 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,896 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,896 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,896 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,897 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:08,897 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,897 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,897 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,897 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,897 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,897 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,897 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,897 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,897 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,897 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,900 [s2@group-54E8E36963C5-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(632)) - s2@group-54E8E36963C5-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s2/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/log_inprogress_9
2023-10-31 16:09:08,900 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-54E8E36963C5: succeeded to handle AppendEntries. Reply: s3<-s2#1:OK-t2,SUCCESS,nextIndex=10,followerCommit=7,matchIndex=9
2023-10-31 16:09:08,906 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,907 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:08,908 [s3@group-54E8E36963C5-StateMachineUpdater] INFO  server.RaftServer$Division (LeaderStateImpl.java:isApplied(308)) - leader is ready since appliedIndex == 9 >= startIndex == 9
2023-10-31 16:09:08,909 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-54E8E36963C5: receive appendEntries(s3, 2, (t:2, i:9), 9, true, commits:[s3:c9, s2:c7], cId:2, entries: [(t:2, i:10), METADATAENTRY(c:9)]
2023-10-31 16:09:08,910 [s2-server-thread2] DEBUG server.RaftServer$Division (RaftServerImpl.java:logAppendEntries(1495)) - s2@group-54E8E36963C5: succeeded to handle AppendEntries. Reply: s3<-s2#2:OK-t2,SUCCESS,nextIndex=11,followerCommit=9,matchIndex=10
2023-10-31 16:09:08,910 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,910 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,910 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,910 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,911 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,911 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,911 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,911 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,911 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,911 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,918 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,918 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:08,918 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,918 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,919 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,919 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,919 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,919 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,919 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,919 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,919 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,919 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,926 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,927 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:08,927 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,927 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,927 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,927 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,927 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,927 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,927 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,927 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,927 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,927 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,934 [grpc-default-executor-6] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s1@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:37189
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,939 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,939 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:08,939 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,939 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,939 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,940 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,940 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,941 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,941 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,941 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,941 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,941 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,942 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,942 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:08,942 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,942 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,942 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,942 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,942 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,942 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,942 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,942 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,943 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,943 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,944 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,944 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:08,944 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,944 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,944 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,944 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,944 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,944 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,944 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,944 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,944 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,944 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,945 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,945 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:08,945 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,945 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,945 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,945 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,945 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,945 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,945 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,945 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,945 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,945 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,946 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,946 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:08,946 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,946 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,946 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,946 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,946 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,946 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,947 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,947 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,947 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,947 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,947 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,947 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:08,948 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,948 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,948 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,948 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,948 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,948 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,948 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,948 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,948 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,948 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,949 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,949 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:08,949 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,949 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,949 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,949 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,949 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,949 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,949 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,949 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,949 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,949 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,950 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,950 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:08,950 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,950 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,950 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,950 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,951 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,951 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,951 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,951 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,951 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,951 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,951 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,951 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:08,951 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,952 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,952 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,952 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,952 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,952 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,952 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,952 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,952 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,952 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,952 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,953 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:08,953 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,953 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,953 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,953 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,953 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,953 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,953 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,953 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,953 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,953 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,954 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,954 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:08,954 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,954 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,954 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,954 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,954 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,954 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,954 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,954 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,954 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,954 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,955 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,956 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:08,956 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,956 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,956 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,956 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,956 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,956 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,956 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,956 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,956 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,956 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,957 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,957 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:08,957 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,957 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,957 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,957 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,957 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,957 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,957 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,957 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,957 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,957 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,958 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,958 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:08,958 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,958 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,958 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,958 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,958 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,958 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,958 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,958 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,958 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,958 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,959 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,959 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:08,959 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,959 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,959 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,959 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,959 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,959 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,959 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,959 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,959 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,959 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,960 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,960 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:08,960 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,960 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,960 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,960 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,960 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,960 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,960 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,960 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,961 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,961 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,962 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,962 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:08,962 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,962 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,962 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,962 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,962 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,962 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,962 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,962 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,962 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,962 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,963 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,963 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:08,963 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,963 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,963 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,963 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,963 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,963 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,963 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,963 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,966 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,966 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,966 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,967 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:08,967 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,967 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,967 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,967 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,967 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,967 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,967 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,967 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,967 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,967 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,967 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,968 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:08,968 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,968 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,968 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,968 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,968 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,968 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,968 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,968 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,968 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,968 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,969 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,969 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:08,969 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,969 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,969 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,969 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,969 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,969 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,969 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,969 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,969 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,969 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,970 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,970 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:08,970 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,970 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,970 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,970 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,970 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,970 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,970 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,970 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,970 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,970 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,971 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,971 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:08,971 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,971 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,971 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,971 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,971 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,971 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,971 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,971 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,971 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,971 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,972 [s4@group-54E8E36963C5-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s4@group-54E8E36963C5-FollowerState: change to CANDIDATE, lastRpcElapsedTime:408636450ns, electionTimeout:296ms
2023-10-31 16:09:08,972 [s4@group-54E8E36963C5-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(109)) - s4: shutdown s4@group-54E8E36963C5-FollowerState
2023-10-31 16:09:08,972 [s4@group-54E8E36963C5-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s4@group-54E8E36963C5: changes role from  FOLLOWER to CANDIDATE at term 1 for changeToCandidate
2023-10-31 16:09:08,972 [s4@group-54E8E36963C5-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2023-10-31 16:09:08,972 [s4@group-54E8E36963C5-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s4: start s4@group-54E8E36963C5-LeaderElection14
2023-10-31 16:09:08,972 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,972 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:08,972 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,972 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,972 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,972 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,972 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,972 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,972 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,973 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,973 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,973 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,973 [s4@group-54E8E36963C5-LeaderElection14] INFO  server.RaftServer$Division (ServerState.java:setLeader(265)) - s4@group-54E8E36963C5: change Leader from s0 to null at term 1 for PRE_VOTE
2023-10-31 16:09:08,973 [s4@group-54E8E36963C5-LeaderElection14] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(323)) - s4@group-54E8E36963C5-LeaderElection14 PRE_VOTE round 0: submit vote requests at term 1 for 7: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:08,979 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,979 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:08,980 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,980 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,980 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,980 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,980 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,980 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,980 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,980 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,980 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,980 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,981 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,981 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:08,981 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,981 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,981 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,981 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,981 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,981 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,981 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,981 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,981 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,981 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:08,982 [s4@group-54E8E36963C5-LeaderElection14] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(136)) - s4@group-54E8E36963C5-LeaderElection14 got exception when requesting votes: java.util.concurrent.ExecutionException: java.lang.IllegalStateException: ILLEGAL TRANSITION: In s3, EXCEPTION -> STARTING
2023-10-31 16:09:08,985 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s2@group-54E8E36963C5: receive requestVote(PRE_VOTE, s4, group-54E8E36963C5, 1, (t:1, i:8))
2023-10-31 16:09:08,985 [grpc-default-executor-6] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-54E8E36963C5-FOLLOWER: reject PRE_VOTE from s4: this server is a follower and still has a valid leader s3
2023-10-31 16:09:08,985 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s2@group-54E8E36963C5 replies to PRE_VOTE vote request: s4<-s2#0:FAIL-t2. Peer's state: s2@group-54E8E36963C5:t2, leader=s3, voted=s3, raftlog=Memoized:s2@group-54E8E36963C5-SegmentedRaftLog:OPENED:c9, conf=9: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:08,986 [s4@group-54E8E36963C5-LeaderElection14] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s4@group-54E8E36963C5-LeaderElection14: PRE_VOTE DISCOVERED_A_NEW_TERM (term=2) received 1 response(s) and 1 exception(s):
2023-10-31 16:09:08,986 [s4@group-54E8E36963C5-LeaderElection14] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s4<-s2#0:FAIL-t2
2023-10-31 16:09:08,986 [s4@group-54E8E36963C5-LeaderElection14] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(136)) -   Exception 1: java.util.concurrent.ExecutionException: java.lang.IllegalStateException: ILLEGAL TRANSITION: In s3, EXCEPTION -> STARTING
2023-10-31 16:09:08,986 [s4@group-54E8E36963C5-LeaderElection14] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(325)) - s4@group-54E8E36963C5-LeaderElection14 PRE_VOTE round 0: result DISCOVERED_A_NEW_TERM (term=2)
2023-10-31 16:09:08,986 [s4@group-54E8E36963C5-LeaderElection14] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s4@group-54E8E36963C5: changes role from CANDIDATE to FOLLOWER at term 2 for DISCOVERED_A_NEW_TERM (term=2)
2023-10-31 16:09:08,986 [s4@group-54E8E36963C5-LeaderElection14] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(129)) - s4: shutdown s4@group-54E8E36963C5-LeaderElection14
2023-10-31 16:09:08,986 [s4@group-54E8E36963C5-LeaderElection14] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s4: start s4@group-54E8E36963C5-FollowerState
2023-10-31 16:09:08,994 [s4@group-54E8E36963C5-LeaderElection14] TRACE util.FileUtils (LogUtils.java:supplyAndLog(69)) - Successfully supplied FileChannel.open /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s4/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/raft-meta.tmp with options [CREATE, WRITE]: sun.nio.ch.FileChannelImpl@7b2a1642
2023-10-31 16:09:08,995 [s4@group-54E8E36963C5-LeaderElection14] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s4/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/raft-meta.tmp to /home/runner/work/ratis/ratis/ratis-test/target/test/data/63eba269/MiniRaftClusterWithGrpced5c86bd/s4/a979c418-0a1f-47d8-9ffe-54e8e36963c5/current/raft-meta with options [REPLACE_EXISTING]
2023-10-31 16:09:08,997 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:08,997 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:08,997 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:08,997 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:08,997 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:08,997 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:08,997 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:08,997 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:08,997 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:08,997 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:08,997 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:08,997 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,001 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,001 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,001 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,001 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,001 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,001 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,001 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,001 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,001 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,001 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,001 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,001 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,002 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,002 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,002 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,003 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,003 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,003 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,003 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,003 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,003 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,003 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,003 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,003 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,004 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,004 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,004 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,004 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,004 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,004 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,005 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,005 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,005 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,005 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,005 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,005 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,006 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,006 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,006 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,006 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,006 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,006 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,006 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,006 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,006 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,006 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,006 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,006 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,007 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,007 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,007 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,007 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,007 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,007 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,007 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,007 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,007 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,007 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,007 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,007 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,008 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,008 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,008 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,008 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,008 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,008 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,008 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,008 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,008 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,008 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,008 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,008 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,009 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,009 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,009 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,009 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,009 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,009 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,009 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,009 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,009 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,009 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,009 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,009 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,010 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,010 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,010 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,010 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,010 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,010 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,010 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,010 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,010 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,010 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,010 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,010 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,011 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,011 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,011 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,011 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,011 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,011 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,011 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,011 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,011 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,011 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,011 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,011 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,012 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,012 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,012 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,012 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,012 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,012 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,012 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,012 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,012 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,012 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,012 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,012 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,013 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,013 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,013 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,013 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,013 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,013 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,013 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,013 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,013 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,013 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,013 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,013 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,014 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,014 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,014 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,014 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,014 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,014 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,014 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,014 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,014 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,014 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,015 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,015 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,015 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,015 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,015 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,015 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,015 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,015 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,015 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,015 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,016 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,016 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,016 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,016 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,016 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,016 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,016 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,016 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,016 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,016 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,017 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,017 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,017 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,017 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,017 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,017 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,017 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,017 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,017 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,017 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,017 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,018 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,018 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,018 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,018 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,018 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,018 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,018 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,018 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,018 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,018 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,018 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,018 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,019 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,019 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,019 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,019 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,019 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,019 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,019 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,019 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,019 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,019 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,019 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,020 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,020 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,020 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,020 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,020 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,020 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,020 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,020 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,020 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,020 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,020 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,021 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,021 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,021 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,021 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,021 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,021 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,021 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,021 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,021 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,022 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,022 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,022 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,022 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,022 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,022 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,022 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,022 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,022 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,022 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,022 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,022 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,023 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,023 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,023 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,023 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,023 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,023 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,023 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,023 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,023 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,023 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,023 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,023 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,024 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,024 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,024 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,024 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,024 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,024 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,024 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,024 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,024 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,024 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,025 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,025 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,025 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,025 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,025 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,025 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,025 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,025 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,025 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,025 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,026 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,026 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,026 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,026 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,026 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,026 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,026 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,026 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,026 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,027 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,027 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,027 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,027 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,027 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,027 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,027 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,027 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,027 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,027 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,027 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,027 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,028 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,028 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,028 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,028 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,028 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,028 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,028 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,028 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,028 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,028 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,029 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,029 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,029 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,029 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,029 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,029 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,029 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,029 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,029 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,029 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,029 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,029 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,030 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,030 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,030 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,030 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,030 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,030 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,030 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,030 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,030 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,030 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,030 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,031 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,031 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,031 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,031 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,031 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,031 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,031 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,031 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,031 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,031 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,047 [grpc-default-executor-4] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s2@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:42947
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,048 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,048 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,049 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,049 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,049 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,049 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,049 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,049 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,049 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,049 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,049 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,049 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,050 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,050 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,050 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,050 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,050 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,050 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,050 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,050 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,050 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,050 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,050 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,050 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,051 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,051 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,051 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,051 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,051 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,051 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,051 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,051 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,051 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,051 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,051 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,051 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,053 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,054 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,054 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,054 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,054 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,054 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,054 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,054 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,054 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,054 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,054 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,054 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,055 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,055 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,055 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,055 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,055 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,055 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,055 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,062 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,062 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,068 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,068 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,068 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,069 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,069 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,070 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,070 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,070 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,070 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,070 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,070 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,070 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,070 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,070 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,070 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,073 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,074 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,074 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,074 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,074 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,074 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,074 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,074 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,074 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,074 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,074 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,074 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,075 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,075 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,075 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,075 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,075 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,075 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,075 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,075 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,075 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,075 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,075 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,075 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,076 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,076 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,076 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,076 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,076 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,076 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,076 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,076 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,076 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,076 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,076 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,077 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,077 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,077 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,078 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,078 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,078 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,078 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,079 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,079 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,079 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,079 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,079 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,079 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,080 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,080 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,080 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,080 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,080 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,080 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,080 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,080 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,080 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,080 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,080 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,080 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,081 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,081 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,081 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,081 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,081 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,081 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,081 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,081 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,081 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,082 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,082 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,082 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,082 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,083 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,083 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,083 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,083 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,083 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,083 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,083 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,083 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,083 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,083 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,083 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,084 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,084 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,084 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,084 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,084 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,084 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,084 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,084 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,084 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,084 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,084 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,084 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,085 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,085 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,085 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,085 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,085 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,085 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,085 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,085 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,085 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,085 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,085 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,085 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,086 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,086 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,086 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,086 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,086 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,086 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,086 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,086 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,086 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,086 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,086 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,086 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,088 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,088 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,088 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,088 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,088 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,088 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,088 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,088 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,088 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,088 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,088 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,088 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,092 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,092 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,092 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,092 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,092 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,092 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,092 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,092 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,092 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,092 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,092 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,092 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,099 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,099 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,099 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,099 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,099 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,100 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,100 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,100 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,100 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,100 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,100 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,100 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,101 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,101 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,101 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,102 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,102 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,102 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,102 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,102 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,102 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,102 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,102 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,102 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,103 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,103 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,103 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,103 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,103 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,103 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,103 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,103 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,103 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,103 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,103 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,104 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,106 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,106 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,109 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,109 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,109 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,109 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,110 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,110 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,110 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,110 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,110 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,110 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,110 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,111 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,111 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,111 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,111 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,111 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,111 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,111 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,111 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,111 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,111 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,111 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,112 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,112 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,112 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,112 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,112 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,112 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,112 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,112 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,112 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,112 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,112 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,112 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,117 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,118 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,118 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,118 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,118 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,118 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,118 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,118 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,118 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,118 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,118 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,118 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,119 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,119 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,119 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,119 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,119 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,121 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,121 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,121 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,121 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,121 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,121 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,121 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,122 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,122 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,122 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,122 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,122 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,122 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,122 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,122 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,122 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,122 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,122 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,122 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,123 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,123 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,123 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,123 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,123 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,123 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,123 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,123 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,123 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,123 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,124 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,124 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,124 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,124 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,124 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,124 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,124 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,124 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,124 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,124 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,124 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,125 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,125 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,125 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,126 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,126 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,126 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,126 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,126 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,126 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,126 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,126 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,126 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,126 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,127 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,127 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,128 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,128 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,128 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,128 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,128 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,128 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,128 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,128 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,128 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,128 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,128 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,128 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,138 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,138 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,138 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,138 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,138 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,138 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,138 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,138 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,138 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,138 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,138 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,138 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,145 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(119)) - printing ALL groups
  s3:  RUNNING    LEADER s3@group-54E8E36963C5:t2, leader=s3, voted=s3, raftlog=Memoized:s3@group-54E8E36963C5-SegmentedRaftLog:OPENED:c10, conf=9: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null RUNNING
  s4:  RUNNING  FOLLOWER s4@group-54E8E36963C5:t2, leader=null, voted=null, raftlog=Memoized:s4@group-54E8E36963C5-SegmentedRaftLog:OPENED:c7, conf=7: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null RUNNING
  s0:  RUNNING    LEADER s0@group-54E8E36963C5:t1, leader=s0, voted=s0, raftlog=Memoized:s0@group-54E8E36963C5-SegmentedRaftLog:CLOSED:c7, conf=7: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null CLOSING
  s1:  CLOSING CANDIDATE s1@group-54E8E36963C5:t1, leader=null, voted=s0, raftlog=Memoized:s1@group-54E8E36963C5-SegmentedRaftLog:CLOSED:c5, conf=5: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[] CLOSING
  s2:  RUNNING  FOLLOWER s2@group-54E8E36963C5:t2, leader=s3, voted=s3, raftlog=Memoized:s2@group-54E8E36963C5-SegmentedRaftLog:OPENED:c10, conf=9: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null RUNNING
2023-10-31 16:09:09,146 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,146 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,146 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,146 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,146 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,157 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,157 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,157 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,157 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,157 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,157 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,157 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,160 [s3-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(891)) - s3@group-54E8E36963C5: receive client request(RaftClientRequest:client-97CC9EBF2E25->s3@group-54E8E36963C5, cid=999, seq=null, RW, Message:6d657373616765)
2023-10-31 16:09:09,163 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,163 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,164 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,164 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,164 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,164 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,164 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,164 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,164 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,164 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,164 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,164 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,176 [grpc-default-executor-5] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s0@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:37937
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,177 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,177 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,178 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,178 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,178 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,178 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,178 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,178 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,178 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,178 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,178 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,178 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,179 [s4@group-54E8E36963C5-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s4@group-54E8E36963C5-FollowerState: change to CANDIDATE, lastRpcElapsedTime:192877469ns, electionTimeout:181ms
2023-10-31 16:09:09,179 [s4@group-54E8E36963C5-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(109)) - s4: shutdown s4@group-54E8E36963C5-FollowerState
2023-10-31 16:09:09,179 [s4@group-54E8E36963C5-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s4@group-54E8E36963C5: changes role from  FOLLOWER to CANDIDATE at term 2 for changeToCandidate
2023-10-31 16:09:09,179 [s4@group-54E8E36963C5-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2023-10-31 16:09:09,179 [s4@group-54E8E36963C5-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s4: start s4@group-54E8E36963C5-LeaderElection15
2023-10-31 16:09:09,189 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,189 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,189 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,189 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,189 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,189 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,189 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,189 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,189 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,189 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,189 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,189 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,190 [Time-limited test] INFO  grpc.TestRetryCacheWithGrpc (RetryCacheTests.java:runTestRetryOnNewLeader(157)) - successfully sent out the retry request_0
2023-10-31 16:09:09,194 [s4@group-54E8E36963C5-LeaderElection15] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(323)) - s4@group-54E8E36963C5-LeaderElection15 PRE_VOTE round 0: submit vote requests at term 2 for 7: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:09,194 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,195 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,195 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,195 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,195 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,195 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,195 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,195 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,195 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,195 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,195 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,195 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,198 [s4@group-54E8E36963C5-LeaderElection15] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(136)) - s4@group-54E8E36963C5-LeaderElection15 got exception when requesting votes: java.util.concurrent.ExecutionException: java.lang.IllegalStateException: ILLEGAL TRANSITION: In s3, STARTING -> STARTING
2023-10-31 16:09:09,199 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,199 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,199 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,199 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,199 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,199 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,199 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,200 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,200 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,200 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,200 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,200 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,210 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,210 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,210 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,210 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,210 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,210 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,211 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,211 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,211 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,211 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,211 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,211 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,213 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s2@group-54E8E36963C5: receive requestVote(PRE_VOTE, s4, group-54E8E36963C5, 2, (t:1, i:8))
2023-10-31 16:09:09,213 [grpc-default-executor-6] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-54E8E36963C5-FOLLOWER: reject PRE_VOTE from s4: this server is a follower and still has a valid leader s3
2023-10-31 16:09:09,213 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s2@group-54E8E36963C5 replies to PRE_VOTE vote request: s4<-s2#0:FAIL-t2. Peer's state: s2@group-54E8E36963C5:t2, leader=s3, voted=s3, raftlog=Memoized:s2@group-54E8E36963C5-SegmentedRaftLog:OPENED:c10, conf=9: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:09,214 [s4@group-54E8E36963C5-LeaderElection15] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s4@group-54E8E36963C5-LeaderElection15: PRE_VOTE REJECTED received 1 response(s) and 1 exception(s):
2023-10-31 16:09:09,214 [s4@group-54E8E36963C5-LeaderElection15] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s4<-s2#0:FAIL-t2
2023-10-31 16:09:09,214 [s4@group-54E8E36963C5-LeaderElection15] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(136)) -   Exception 1: java.util.concurrent.ExecutionException: java.lang.IllegalStateException: ILLEGAL TRANSITION: In s3, STARTING -> STARTING
2023-10-31 16:09:09,214 [s4@group-54E8E36963C5-LeaderElection15] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(325)) - s4@group-54E8E36963C5-LeaderElection15 PRE_VOTE round 0: result REJECTED
2023-10-31 16:09:09,214 [s4@group-54E8E36963C5-LeaderElection15] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s4@group-54E8E36963C5: changes role from CANDIDATE to FOLLOWER at term 2 for REJECTED
2023-10-31 16:09:09,214 [s4@group-54E8E36963C5-LeaderElection15] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(129)) - s4: shutdown s4@group-54E8E36963C5-LeaderElection15
2023-10-31 16:09:09,214 [s4@group-54E8E36963C5-LeaderElection15] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s4: start s4@group-54E8E36963C5-FollowerState
2023-10-31 16:09:09,215 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,215 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,215 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,215 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,215 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,215 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,215 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,215 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,215 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,215 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,215 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,215 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,218 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,218 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,218 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,219 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,219 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,219 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,219 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,219 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,219 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,219 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,219 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,219 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,221 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,221 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,221 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,221 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,221 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,221 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,221 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,221 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,221 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,221 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,221 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,221 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,222 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,222 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,223 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,223 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,223 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,223 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,223 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,223 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,223 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,223 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,223 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,223 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,223 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,224 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,224 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,224 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,224 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,224 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,224 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,224 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,224 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,224 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,224 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,224 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,225 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,225 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,225 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,225 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,225 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,225 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,225 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,225 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,225 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,225 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,225 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,225 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,226 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,226 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,226 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,226 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,226 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,226 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,226 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,226 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,226 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,226 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,226 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,226 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,227 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,227 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,227 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,227 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,227 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,227 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,227 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,227 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,227 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,240 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,240 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,240 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,246 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,247 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,247 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,247 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,247 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,247 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,248 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,248 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,248 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,248 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,248 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,248 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,258 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,258 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,258 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,259 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,259 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,259 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,259 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,259 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,259 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,259 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,259 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,259 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,265 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,266 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,266 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,266 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,266 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,266 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,266 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,267 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,267 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,267 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,267 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,267 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,268 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,268 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,268 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,268 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,268 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,268 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,268 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,268 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,268 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,268 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,268 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,268 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,273 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,273 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,273 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,273 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,273 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,273 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,273 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,273 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,273 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,273 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,273 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,274 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,274 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,274 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,274 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,274 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,274 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,275 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,275 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,275 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,275 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,275 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,275 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,275 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,283 [grpc-default-executor-6] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s2@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.drainPendingCallbacks(DelayedClientCall.java:510)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$1DrainListenerRunnable.runInContext(DelayedClientCall.java:299)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 11 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 11 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:42947
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,285 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,285 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,285 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,285 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,285 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,285 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,285 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,285 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,286 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,286 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,286 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,286 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,297 [s3-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(891)) - s3@group-54E8E36963C5: receive client request(RaftClientRequest:client-97CC9EBF2E25->s3@group-54E8E36963C5, cid=999, seq=null, RW, Message:6d657373616765)
2023-10-31 16:09:09,303 [Time-limited test] INFO  grpc.TestRetryCacheWithGrpc (RetryCacheTests.java:runTestRetryOnNewLeader(157)) - successfully sent out the retry request_1
2023-10-31 16:09:09,303 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,304 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,304 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,304 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,304 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,304 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,304 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,304 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,304 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,304 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,304 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,304 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,307 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,307 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,307 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,307 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,308 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,308 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,308 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,308 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,308 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,308 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,308 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,308 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,311 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,311 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,312 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,312 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,312 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,312 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,312 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,312 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,312 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,312 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,312 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,312 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,313 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,313 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,313 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,313 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,313 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,314 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,314 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,314 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,314 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,314 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,314 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,314 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,316 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,316 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,317 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,317 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,317 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,317 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,317 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,317 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,317 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,317 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,317 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,317 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,321 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,321 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,321 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,321 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,321 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,321 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,321 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,321 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,321 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,321 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,321 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,321 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,322 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,322 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,322 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,322 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,322 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,322 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,322 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,322 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,322 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,324 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,324 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,324 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,324 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,324 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,324 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,324 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,325 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,325 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,325 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,325 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,325 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,325 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,325 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,325 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,325 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,325 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,326 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,326 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,326 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,326 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,326 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,326 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,326 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,326 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,326 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,326 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,327 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,327 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,334 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,334 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,334 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,334 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,334 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,334 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,334 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,334 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,334 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,334 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,336 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,336 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,336 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,336 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,336 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,336 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,336 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,337 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,337 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,337 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,337 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,337 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,337 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,337 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,338 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,338 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,338 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,338 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,338 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,338 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,338 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,338 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,338 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,338 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,338 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,339 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,339 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,339 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,339 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,339 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,339 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,339 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,339 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,339 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,339 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,339 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,339 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,340 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,340 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,340 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,340 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,340 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,340 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,340 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,340 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,340 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,340 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,340 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,349 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,350 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,350 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,350 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,350 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,350 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,350 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,350 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,350 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,350 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,350 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,350 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,355 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,355 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,357 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,357 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,357 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,357 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,357 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,357 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,357 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,357 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,357 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,357 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,358 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,358 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,358 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,358 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,358 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,358 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,358 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,358 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,358 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,358 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,358 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,358 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,359 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,359 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,366 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,366 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,366 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,366 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,366 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,366 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,366 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,366 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,366 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,366 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,373 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,373 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,374 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,374 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,374 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,374 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,374 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,374 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,374 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,374 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,374 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,374 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,377 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,377 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,388 [grpc-default-executor-6] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s0@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.drainPendingCallbacks(DelayedClientCall.java:510)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$1DrainListenerRunnable.runInContext(DelayedClientCall.java:299)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 11 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 11 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:37937
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,389 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,389 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,389 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,389 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,389 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,389 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,389 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,389 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,389 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,389 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,391 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,391 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,391 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,391 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,391 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,391 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,391 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,391 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,391 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,391 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,391 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,392 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,394 [s4@group-54E8E36963C5-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s4@group-54E8E36963C5-FollowerState: change to CANDIDATE, lastRpcElapsedTime:179988637ns, electionTimeout:176ms
2023-10-31 16:09:09,394 [s4@group-54E8E36963C5-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(109)) - s4: shutdown s4@group-54E8E36963C5-FollowerState
2023-10-31 16:09:09,394 [s4@group-54E8E36963C5-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s4@group-54E8E36963C5: changes role from  FOLLOWER to CANDIDATE at term 2 for changeToCandidate
2023-10-31 16:09:09,394 [s4@group-54E8E36963C5-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2023-10-31 16:09:09,394 [s4@group-54E8E36963C5-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s4: start s4@group-54E8E36963C5-LeaderElection16
2023-10-31 16:09:09,398 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,398 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,399 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,399 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,399 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,399 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,399 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,399 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,399 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,399 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,399 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,399 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,407 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,407 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,407 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,407 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,407 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,407 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,407 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,407 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,407 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,407 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,407 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,407 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,408 [s3-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(891)) - s3@group-54E8E36963C5: receive client request(RaftClientRequest:client-97CC9EBF2E25->s3@group-54E8E36963C5, cid=999, seq=null, RW, Message:6d657373616765)
2023-10-31 16:09:09,419 [Time-limited test] INFO  grpc.TestRetryCacheWithGrpc (RetryCacheTests.java:runTestRetryOnNewLeader(157)) - successfully sent out the retry request_2
2023-10-31 16:09:09,426 [s4@group-54E8E36963C5-LeaderElection16] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(323)) - s4@group-54E8E36963C5-LeaderElection16 PRE_VOTE round 0: submit vote requests at term 2 for 7: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:09,431 [s4@group-54E8E36963C5-LeaderElection16] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(136)) - s4@group-54E8E36963C5-LeaderElection16 got exception when requesting votes: java.util.concurrent.ExecutionException: java.lang.IllegalStateException: ILLEGAL TRANSITION: In s3, STARTING -> STARTING
2023-10-31 16:09:09,431 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,432 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,432 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,432 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,432 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,432 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,432 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,432 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,432 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,432 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,432 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,432 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,435 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s2@group-54E8E36963C5: receive requestVote(PRE_VOTE, s4, group-54E8E36963C5, 2, (t:1, i:8))
2023-10-31 16:09:09,435 [grpc-default-executor-6] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-54E8E36963C5-FOLLOWER: reject PRE_VOTE from s4: this server is a follower and still has a valid leader s3
2023-10-31 16:09:09,435 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s2@group-54E8E36963C5 replies to PRE_VOTE vote request: s4<-s2#0:FAIL-t2. Peer's state: s2@group-54E8E36963C5:t2, leader=s3, voted=s3, raftlog=Memoized:s2@group-54E8E36963C5-SegmentedRaftLog:OPENED:c10, conf=9: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:09,437 [s4@group-54E8E36963C5-LeaderElection16] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s4@group-54E8E36963C5-LeaderElection16: PRE_VOTE REJECTED received 1 response(s) and 1 exception(s):
2023-10-31 16:09:09,437 [s4@group-54E8E36963C5-LeaderElection16] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s4<-s2#0:FAIL-t2
2023-10-31 16:09:09,437 [s4@group-54E8E36963C5-LeaderElection16] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(136)) -   Exception 1: java.util.concurrent.ExecutionException: java.lang.IllegalStateException: ILLEGAL TRANSITION: In s3, STARTING -> STARTING
2023-10-31 16:09:09,437 [s4@group-54E8E36963C5-LeaderElection16] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(325)) - s4@group-54E8E36963C5-LeaderElection16 PRE_VOTE round 0: result REJECTED
2023-10-31 16:09:09,437 [s4@group-54E8E36963C5-LeaderElection16] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s4@group-54E8E36963C5: changes role from CANDIDATE to FOLLOWER at term 2 for REJECTED
2023-10-31 16:09:09,437 [s4@group-54E8E36963C5-LeaderElection16] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(129)) - s4: shutdown s4@group-54E8E36963C5-LeaderElection16
2023-10-31 16:09:09,437 [s4@group-54E8E36963C5-LeaderElection16] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s4: start s4@group-54E8E36963C5-FollowerState
2023-10-31 16:09:09,439 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,439 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,439 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,439 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,439 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,439 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,439 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,439 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,439 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,439 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,440 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,440 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,450 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,450 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,451 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,451 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,451 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,451 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,451 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,451 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,451 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,451 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,451 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,451 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,454 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,454 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,455 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,455 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,455 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,455 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,455 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,455 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,455 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,455 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,455 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,455 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,462 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,462 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,463 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,463 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,463 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,463 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,463 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,463 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,463 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,463 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,463 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,463 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,466 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,466 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,466 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,466 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,467 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,467 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,467 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,467 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,467 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,467 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,467 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,467 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,475 [s1-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(243)) - s1@group-54E8E36963C5-SegmentedRaftLogWorker close()
2023-10-31 16:09:09,476 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,476 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,476 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,476 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,476 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,476 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,476 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,477 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,477 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,477 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,477 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,477 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,483 [s0@group-54E8E36963C5-LeaderStateImpl] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(243)) - s0@group-54E8E36963C5-SegmentedRaftLogWorker close()
2023-10-31 16:09:09,484 [JvmPauseMonitor10] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(152)) - JvmPauseMonitor-s1: Stopped
2023-10-31 16:09:09,496 [grpc-default-executor-6] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s1@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.drainPendingCallbacks(DelayedClientCall.java:510)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$1DrainListenerRunnable.runInContext(DelayedClientCall.java:299)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 11 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 11 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:37189
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,501 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,501 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,502 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,502 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,502 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,502 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,502 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,502 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,502 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,502 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,502 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,502 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,504 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,504 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,504 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,504 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,505 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,506 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,506 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,506 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,506 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,506 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,506 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,506 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,513 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,514 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,514 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,514 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,514 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,514 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,514 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,514 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,514 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,514 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,514 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,514 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,522 [s3-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(891)) - s3@group-54E8E36963C5: receive client request(RaftClientRequest:client-97CC9EBF2E25->s3@group-54E8E36963C5, cid=999, seq=null, RW, Message:6d657373616765)
2023-10-31 16:09:09,532 [Time-limited test] INFO  grpc.TestRetryCacheWithGrpc (RetryCacheTests.java:runTestRetryOnNewLeader(157)) - successfully sent out the retry request_3
2023-10-31 16:09:09,535 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,535 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,535 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,535 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,535 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,535 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,535 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,535 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,535 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,536 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,536 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,536 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,557 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,558 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,558 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,558 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,558 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,558 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,558 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,558 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,558 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,558 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,558 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,558 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,562 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,564 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,564 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,564 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,564 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,564 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,564 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,564 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,564 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,564 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,564 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,564 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,566 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,566 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,566 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,566 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,566 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,566 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,566 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,566 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,566 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,567 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,567 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,567 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,575 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,575 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,575 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,575 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,575 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,576 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,576 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,576 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,576 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,576 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,576 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,576 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,577 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,577 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,577 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,577 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,577 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,577 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,577 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,577 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,577 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,577 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,577 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,577 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,578 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,578 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,578 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,578 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,578 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,578 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,578 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,578 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,578 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,578 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,578 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,578 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,579 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,579 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,579 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,579 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,579 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,579 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,579 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,579 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,579 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,579 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,579 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,579 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,580 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,580 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,580 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,580 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,580 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,580 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,580 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,580 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,580 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,580 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,580 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,580 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,581 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,581 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,581 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,581 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,581 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,581 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,581 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,581 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,581 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,581 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,581 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,581 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,598 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,598 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,598 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,598 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,598 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,599 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,599 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,599 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,599 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,599 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,599 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,599 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,603 [grpc-default-executor-5] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s0@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:37937
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,606 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,606 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,607 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,607 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,607 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,607 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,607 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,607 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,607 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,607 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,607 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,607 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,620 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,620 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,620 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,620 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,620 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,620 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,620 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,620 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,620 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,620 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,620 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,620 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,628 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,629 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,629 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,629 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,629 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,629 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,629 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,629 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,629 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,629 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,629 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,629 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,634 [s3-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(891)) - s3@group-54E8E36963C5: receive client request(RaftClientRequest:client-97CC9EBF2E25->s3@group-54E8E36963C5, cid=999, seq=null, RW, Message:6d657373616765)
2023-10-31 16:09:09,641 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,642 [s4@group-54E8E36963C5-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s4@group-54E8E36963C5-FollowerState: change to CANDIDATE, lastRpcElapsedTime:204094171ns, electionTimeout:201ms
2023-10-31 16:09:09,655 [s4@group-54E8E36963C5-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(109)) - s4: shutdown s4@group-54E8E36963C5-FollowerState
2023-10-31 16:09:09,655 [s4@group-54E8E36963C5-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s4@group-54E8E36963C5: changes role from  FOLLOWER to CANDIDATE at term 2 for changeToCandidate
2023-10-31 16:09:09,655 [s4@group-54E8E36963C5-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2023-10-31 16:09:09,655 [s4@group-54E8E36963C5-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s4: start s4@group-54E8E36963C5-LeaderElection17
2023-10-31 16:09:09,654 [Time-limited test] INFO  grpc.TestRetryCacheWithGrpc (RetryCacheTests.java:runTestRetryOnNewLeader(157)) - successfully sent out the retry request_4
2023-10-31 16:09:09,643 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,656 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,656 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,656 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,656 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,656 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,656 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,656 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,656 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,656 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,656 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,661 [s4@group-54E8E36963C5-LeaderElection17] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(323)) - s4@group-54E8E36963C5-LeaderElection17 PRE_VOTE round 0: submit vote requests at term 2 for 7: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:09,662 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,662 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,663 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,663 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,663 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,663 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,663 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,663 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,663 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,663 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,663 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,663 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,674 [s4@group-54E8E36963C5-LeaderElection17] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(136)) - s4@group-54E8E36963C5-LeaderElection17 got exception when requesting votes: java.util.concurrent.ExecutionException: java.lang.IllegalStateException: ILLEGAL TRANSITION: In s3, STARTING -> STARTING
2023-10-31 16:09:09,679 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s2@group-54E8E36963C5: receive requestVote(PRE_VOTE, s4, group-54E8E36963C5, 2, (t:1, i:8))
2023-10-31 16:09:09,679 [grpc-default-executor-5] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-54E8E36963C5-FOLLOWER: reject PRE_VOTE from s4: this server is a follower and still has a valid leader s3
2023-10-31 16:09:09,679 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s2@group-54E8E36963C5 replies to PRE_VOTE vote request: s4<-s2#0:FAIL-t2. Peer's state: s2@group-54E8E36963C5:t2, leader=s3, voted=s3, raftlog=Memoized:s2@group-54E8E36963C5-SegmentedRaftLog:OPENED:c10, conf=9: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:09,681 [s4@group-54E8E36963C5-LeaderElection17] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s4@group-54E8E36963C5-LeaderElection17: PRE_VOTE REJECTED received 1 response(s) and 1 exception(s):
2023-10-31 16:09:09,681 [s4@group-54E8E36963C5-LeaderElection17] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s4<-s2#0:FAIL-t2
2023-10-31 16:09:09,681 [s4@group-54E8E36963C5-LeaderElection17] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(136)) -   Exception 1: java.util.concurrent.ExecutionException: java.lang.IllegalStateException: ILLEGAL TRANSITION: In s3, STARTING -> STARTING
2023-10-31 16:09:09,681 [s4@group-54E8E36963C5-LeaderElection17] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(325)) - s4@group-54E8E36963C5-LeaderElection17 PRE_VOTE round 0: result REJECTED
2023-10-31 16:09:09,681 [s4@group-54E8E36963C5-LeaderElection17] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s4@group-54E8E36963C5: changes role from CANDIDATE to FOLLOWER at term 2 for REJECTED
2023-10-31 16:09:09,681 [s4@group-54E8E36963C5-LeaderElection17] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(129)) - s4: shutdown s4@group-54E8E36963C5-LeaderElection17
2023-10-31 16:09:09,681 [s4@group-54E8E36963C5-LeaderElection17] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s4: start s4@group-54E8E36963C5-FollowerState
2023-10-31 16:09:09,686 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,686 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,687 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,687 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,687 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,687 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,687 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,687 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,687 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,687 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,687 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,687 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,696 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,696 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,696 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,696 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,696 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,697 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,697 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,697 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,697 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,697 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,697 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,697 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,710 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,710 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,711 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,711 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,711 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,711 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,711 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,711 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,711 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,711 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,711 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,711 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,711 [grpc-default-executor-6] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s1@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:37189
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,718 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,718 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,719 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,719 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,719 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,719 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,719 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,719 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,719 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,719 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,719 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,719 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,722 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,722 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,723 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,723 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,723 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,723 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,723 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,723 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,723 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,723 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,723 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,723 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,732 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,733 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,733 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,733 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,733 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,733 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,733 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,733 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,733 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,733 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,733 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,733 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,740 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,740 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,740 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,740 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,740 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,741 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,741 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,741 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,741 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,741 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,741 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,741 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,752 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,752 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,752 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,753 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,753 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,753 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,753 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,753 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,753 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,753 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,753 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,753 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,755 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,755 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,755 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,755 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,755 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,755 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,756 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,756 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,756 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,756 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,756 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,756 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,758 [s3-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(891)) - s3@group-54E8E36963C5: receive client request(RaftClientRequest:client-97CC9EBF2E25->s3@group-54E8E36963C5, cid=999, seq=null, RW, Message:6d657373616765)
2023-10-31 16:09:09,765 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,765 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,765 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,766 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,766 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,766 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,766 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,766 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,766 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,766 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,766 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,766 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,767 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,767 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,767 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,767 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,767 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,767 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,767 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,767 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,767 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,767 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,767 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,767 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,767 [Time-limited test] INFO  grpc.TestRetryCacheWithGrpc (RetryCacheTests.java:runTestRetryOnNewLeader(157)) - successfully sent out the retry request_5
2023-10-31 16:09:09,770 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,771 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,771 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,771 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,771 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,771 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,771 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,771 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,771 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,771 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,771 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,771 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,778 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,778 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,779 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,779 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,779 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,779 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,779 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,779 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,779 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,779 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,779 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,779 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,780 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,780 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,780 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,780 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,780 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,780 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,780 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,780 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,780 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,780 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,780 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,780 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,786 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,787 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,787 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,787 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,787 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,788 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,788 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,788 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,788 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,788 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,788 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,788 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,789 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,789 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,789 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,789 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,789 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,789 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,789 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,789 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,789 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,789 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,789 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,789 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,790 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,790 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,790 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,790 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,790 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,790 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,790 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,790 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,790 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,790 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,791 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,791 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,816 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,816 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,817 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,817 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,817 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,817 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,817 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,817 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,817 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,817 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,817 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,817 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,817 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,818 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,818 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,818 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,819 [grpc-default-executor-6] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s0@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:37937
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,822 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,822 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,823 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,823 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,823 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,823 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,823 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,823 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,824 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,828 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,828 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,828 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,828 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,828 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,828 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,828 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,828 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,828 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,828 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,828 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,829 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,829 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,829 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,829 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,829 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,829 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,829 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,829 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,829 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,834 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,834 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,834 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,835 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,835 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,835 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,835 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,835 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,835 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,835 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,835 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,835 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,835 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,835 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,835 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,836 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,836 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,836 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,836 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,836 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,836 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,836 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,836 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,836 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,836 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,836 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,836 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,837 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,837 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,837 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,837 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,837 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,837 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,837 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,837 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,837 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,837 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,837 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,837 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,837 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,838 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,838 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,838 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,838 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,838 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,838 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,838 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,838 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,838 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,838 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,838 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,839 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,839 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,839 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,839 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,839 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,839 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,839 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,839 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,839 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,839 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,839 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,839 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,840 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,840 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,840 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,840 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,840 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,840 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,840 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,840 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,840 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,840 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,840 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,840 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,840 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,841 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,841 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,841 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,841 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,841 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,841 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,841 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,841 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,841 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,841 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,841 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,841 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,841 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,842 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,842 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,842 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,842 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,842 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,842 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,842 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,842 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,842 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,842 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,842 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,842 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,843 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,843 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,843 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,843 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,843 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,843 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,843 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,843 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,843 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,843 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,843 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,844 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,844 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,844 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,844 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,844 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,844 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,844 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,844 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,844 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,844 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,844 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,844 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,844 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,845 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,845 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,845 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,845 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,845 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,845 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,845 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,845 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,845 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,845 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,845 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,845 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,846 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,846 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,846 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,846 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,846 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,846 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,846 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,846 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,846 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,846 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,846 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,846 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,846 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,847 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,847 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,847 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,847 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,847 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,847 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,847 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,847 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,847 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,847 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,847 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,848 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,848 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,848 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,848 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,848 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,848 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,848 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,848 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,848 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,848 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,848 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,848 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,848 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,848 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,849 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,849 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,849 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,849 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,849 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,849 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,849 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,849 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,849 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,849 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,849 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,849 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,849 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,849 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,850 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,850 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,850 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,850 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,850 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,850 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,850 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,850 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,850 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,850 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,850 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,850 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,850 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,850 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,851 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,851 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,851 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,851 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,851 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,851 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,851 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,851 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,851 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,851 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,851 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,851 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,851 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,851 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,851 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,852 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,852 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,852 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,852 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,852 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,852 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,852 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,852 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,852 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,852 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,852 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,852 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,852 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,853 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,853 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,853 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,853 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,853 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,853 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,853 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,853 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,853 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,853 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,853 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,853 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,854 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,854 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,854 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,854 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,854 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,854 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,854 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,854 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,854 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,854 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,854 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,855 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,855 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,855 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,855 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,855 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,855 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,855 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,855 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,855 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,855 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,855 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,855 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,855 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,856 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,856 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,856 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,856 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,856 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,856 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,856 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,856 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,856 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,856 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,856 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,856 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,857 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,857 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,857 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,857 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,857 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,857 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,857 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,857 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,857 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,857 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,857 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,857 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,858 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,858 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,858 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,858 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,858 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,858 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,858 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,858 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,858 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,858 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,858 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,858 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,859 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,859 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,859 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,859 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,859 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,859 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,859 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,859 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,859 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,859 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,859 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,859 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,860 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,860 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,860 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,860 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,860 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,860 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,860 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,860 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,860 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,860 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,860 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,860 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,861 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,861 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,861 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,861 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,861 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,861 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,861 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,861 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,861 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,861 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,861 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,861 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,862 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,862 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,862 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,862 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,862 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,862 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,862 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,862 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,862 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,862 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,862 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,862 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,863 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,863 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,863 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,863 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,863 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,863 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,863 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,863 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,863 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,863 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,863 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,863 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,863 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,864 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,864 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,864 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,864 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,864 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,864 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,864 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,864 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,864 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,864 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,864 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,864 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,864 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,865 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,865 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,865 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,865 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,865 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,865 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,865 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,865 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,865 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,865 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,865 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,865 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,865 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,866 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,866 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,866 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,866 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,866 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,866 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,866 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,866 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,866 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,866 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,866 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,867 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,867 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,867 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,867 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,867 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,867 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,867 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,867 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,867 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,867 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,867 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,867 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,867 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,867 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,868 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,868 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,868 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,868 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,868 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,868 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,868 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,868 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,868 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,868 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,868 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,868 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,868 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,868 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,869 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,869 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,869 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,869 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,869 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,869 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,869 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,869 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,869 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,869 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,869 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,869 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,869 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,869 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,869 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,869 [s3-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(891)) - s3@group-54E8E36963C5: receive client request(RaftClientRequest:client-97CC9EBF2E25->s3@group-54E8E36963C5, cid=999, seq=null, RW, Message:6d657373616765)
2023-10-31 16:09:09,869 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,870 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,870 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,871 [s4@group-54E8E36963C5-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s4@group-54E8E36963C5-FollowerState: change to CANDIDATE, lastRpcElapsedTime:189826714ns, electionTimeout:181ms
2023-10-31 16:09:09,871 [Time-limited test] INFO  grpc.TestRetryCacheWithGrpc (RetryCacheTests.java:runTestRetryOnNewLeader(157)) - successfully sent out the retry request_6
2023-10-31 16:09:09,871 [s4@group-54E8E36963C5-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(109)) - s4: shutdown s4@group-54E8E36963C5-FollowerState
2023-10-31 16:09:09,871 [s4@group-54E8E36963C5-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s4@group-54E8E36963C5: changes role from  FOLLOWER to CANDIDATE at term 2 for changeToCandidate
2023-10-31 16:09:09,871 [s4@group-54E8E36963C5-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2023-10-31 16:09:09,871 [s4@group-54E8E36963C5-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s4: start s4@group-54E8E36963C5-LeaderElection18
2023-10-31 16:09:09,874 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,874 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,875 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,875 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,875 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,875 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,875 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,875 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,875 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,875 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,875 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,875 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,877 [s4@group-54E8E36963C5-LeaderElection18] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(323)) - s4@group-54E8E36963C5-LeaderElection18 PRE_VOTE round 0: submit vote requests at term 2 for 7: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:09,878 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,878 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,878 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,878 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,878 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,878 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,878 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,878 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,878 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,878 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,878 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,878 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,879 [s4@group-54E8E36963C5-LeaderElection18] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(136)) - s4@group-54E8E36963C5-LeaderElection18 got exception when requesting votes: java.util.concurrent.ExecutionException: java.lang.IllegalStateException: ILLEGAL TRANSITION: In s3, STARTING -> STARTING
2023-10-31 16:09:09,880 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s2@group-54E8E36963C5: receive requestVote(PRE_VOTE, s4, group-54E8E36963C5, 2, (t:1, i:8))
2023-10-31 16:09:09,880 [grpc-default-executor-4] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-54E8E36963C5-FOLLOWER: reject PRE_VOTE from s4: this server is a follower and still has a valid leader s3
2023-10-31 16:09:09,881 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s2@group-54E8E36963C5 replies to PRE_VOTE vote request: s4<-s2#0:FAIL-t2. Peer's state: s2@group-54E8E36963C5:t2, leader=s3, voted=s3, raftlog=Memoized:s2@group-54E8E36963C5-SegmentedRaftLog:OPENED:c10, conf=9: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:09,881 [s4@group-54E8E36963C5-LeaderElection18] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s4@group-54E8E36963C5-LeaderElection18: PRE_VOTE REJECTED received 1 response(s) and 1 exception(s):
2023-10-31 16:09:09,881 [s4@group-54E8E36963C5-LeaderElection18] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s4<-s2#0:FAIL-t2
2023-10-31 16:09:09,881 [s4@group-54E8E36963C5-LeaderElection18] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(136)) -   Exception 1: java.util.concurrent.ExecutionException: java.lang.IllegalStateException: ILLEGAL TRANSITION: In s3, STARTING -> STARTING
2023-10-31 16:09:09,881 [s4@group-54E8E36963C5-LeaderElection18] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(325)) - s4@group-54E8E36963C5-LeaderElection18 PRE_VOTE round 0: result REJECTED
2023-10-31 16:09:09,882 [s4@group-54E8E36963C5-LeaderElection18] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s4@group-54E8E36963C5: changes role from CANDIDATE to FOLLOWER at term 2 for REJECTED
2023-10-31 16:09:09,882 [s4@group-54E8E36963C5-LeaderElection18] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(129)) - s4: shutdown s4@group-54E8E36963C5-LeaderElection18
2023-10-31 16:09:09,882 [s4@group-54E8E36963C5-LeaderElection18] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s4: start s4@group-54E8E36963C5-FollowerState
2023-10-31 16:09:09,882 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,882 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,882 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,883 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,883 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,883 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,883 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,883 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,883 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,883 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,883 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,883 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,888 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,888 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,888 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,888 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,888 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,888 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,888 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,888 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,888 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,888 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,888 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,888 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,889 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,889 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,889 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,889 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,889 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,889 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,890 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,890 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,890 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,890 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,890 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,890 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,891 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,891 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,891 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,891 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,891 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,891 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,891 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,891 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,891 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,891 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,891 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,891 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,892 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,892 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,892 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,892 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,892 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,892 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,892 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,892 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,892 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,892 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,892 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,892 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,893 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,893 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,899 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,899 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,899 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,900 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,900 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,900 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,900 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,900 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,900 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,900 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,903 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,903 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,903 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,903 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,903 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,903 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,903 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,903 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,903 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,903 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,903 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,903 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,904 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,905 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,906 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,906 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,906 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,906 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,906 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,906 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,906 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,906 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,906 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,906 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,907 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,907 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,907 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,907 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,907 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,907 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,907 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,907 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,907 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,907 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,907 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,907 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,908 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,909 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,909 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,909 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,909 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,910 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,910 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,910 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,910 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,910 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,910 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,910 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,910 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,910 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,910 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,911 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,911 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,911 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,911 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,911 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,911 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,911 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,911 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,911 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,911 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,911 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,912 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,912 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,913 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,913 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,913 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,913 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,913 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,913 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,913 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,913 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,913 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,913 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,914 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,914 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,914 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,914 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,914 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,914 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,914 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,914 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,914 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,914 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,914 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,915 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,915 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,915 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,915 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,915 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,915 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,915 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,915 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,915 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,915 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,915 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,915 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,915 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,916 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,916 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,916 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,916 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,916 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,916 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,916 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,916 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,916 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,916 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,916 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,916 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,917 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,917 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,917 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,917 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,917 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,917 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,917 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,917 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,917 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,917 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,918 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,918 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,919 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,919 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,920 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,920 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,920 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,920 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,920 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,920 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,920 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,920 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,920 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,922 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,926 [grpc-default-executor-4] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s1@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.drainPendingCallbacks(DelayedClientCall.java:510)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$1DrainListenerRunnable.runInContext(DelayedClientCall.java:299)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 11 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 11 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:37189
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,929 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,929 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,929 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,929 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,929 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,929 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,929 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,929 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,929 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,929 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,930 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,930 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,930 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,930 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,930 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,930 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,930 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,930 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,930 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,930 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,930 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,930 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,931 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,931 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,931 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,931 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,931 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,931 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,931 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,931 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,931 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,931 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,931 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,931 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,932 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,932 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,932 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,932 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,932 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,932 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,932 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,932 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,932 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,932 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,932 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,932 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,933 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,933 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,933 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,933 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,933 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,933 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,933 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,933 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,933 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,933 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,933 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,933 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,934 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,934 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,934 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,934 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,934 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,934 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,934 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,934 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,934 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,934 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,934 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,934 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,934 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,935 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,935 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,935 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,935 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,935 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,935 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,935 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,935 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,935 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,935 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,935 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,935 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,935 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,936 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,936 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,936 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,936 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,936 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,936 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,936 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,936 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,936 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,936 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,936 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,936 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,936 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,936 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,936 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,937 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,937 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,937 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,937 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,937 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,937 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,937 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,937 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,937 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,937 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,937 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,937 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,937 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,937 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,937 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,937 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,938 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,938 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,938 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,938 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,938 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,938 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,938 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,938 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,938 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,938 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,938 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,938 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,938 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,938 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,938 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,939 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,939 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,939 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,939 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,939 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,939 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,939 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,939 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,939 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,939 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,939 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,939 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,940 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,940 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,940 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,940 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,940 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,940 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,940 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,940 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,940 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,940 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,940 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,940 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,941 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,941 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,941 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,941 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,941 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,941 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,941 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,941 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,941 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,941 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,941 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,941 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,942 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,942 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,942 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,942 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,942 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,943 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,943 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,943 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,943 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,943 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,943 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,943 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,943 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,943 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,944 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,944 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,944 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,944 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,944 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,944 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,944 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,944 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,944 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,944 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,944 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,944 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,944 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,944 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,944 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,945 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,945 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,945 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,945 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,945 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,945 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,945 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,945 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,945 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,945 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,945 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,945 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,945 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,945 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,945 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,945 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,946 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,946 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,946 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,946 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,946 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,946 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,946 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,946 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,946 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,946 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,946 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,946 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,946 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,946 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,946 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,947 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,947 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,947 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,947 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,947 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,947 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,947 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,947 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,947 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,947 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,947 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,947 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,948 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,948 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,948 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,948 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,948 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,948 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,948 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,948 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,948 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,948 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,948 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,948 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,949 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,949 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,949 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,949 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,949 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,949 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,949 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,949 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,949 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,949 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,949 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,949 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,950 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,950 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,950 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,950 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,950 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,950 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,950 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,950 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,950 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,950 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,950 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,950 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,951 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,951 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,951 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,951 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,951 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,951 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,951 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,951 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,951 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,951 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,951 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,951 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,951 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,951 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,952 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,952 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,952 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,952 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,952 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,952 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,952 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,952 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,952 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,952 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,952 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,952 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,952 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,953 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,953 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,953 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,953 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,953 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,953 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,953 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,953 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,953 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,953 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,953 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,953 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,953 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,953 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,953 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,954 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,954 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,954 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,954 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,954 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,954 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,954 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,954 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,954 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,954 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,954 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,954 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,954 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,954 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,954 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,954 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,955 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,955 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,955 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,955 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,955 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,955 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,955 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,955 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,955 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,955 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,955 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,955 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,955 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,955 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,956 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,956 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,956 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,956 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,956 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,956 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,956 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,956 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,957 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,957 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,957 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,957 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,957 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,957 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,958 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,958 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,958 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,958 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,958 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,958 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,958 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,958 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,958 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,958 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,959 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,959 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,959 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,959 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,959 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,959 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,959 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,959 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,959 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,959 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,959 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,959 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,960 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,960 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,960 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,960 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,960 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,960 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,960 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,960 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,960 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,960 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,960 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,960 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,961 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,961 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,961 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,961 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,961 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,961 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,961 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,961 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,961 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,961 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,961 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,961 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,962 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,962 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,962 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,962 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,962 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,962 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,962 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,962 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,962 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,962 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,962 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,962 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,962 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,963 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,963 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,963 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,963 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,963 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,963 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,963 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,963 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,963 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,963 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,963 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,963 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,963 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,964 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,964 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,964 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,964 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,964 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,964 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,964 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,964 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,964 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,964 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,964 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,964 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,965 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,965 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,966 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,966 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,966 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,966 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,966 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,966 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,966 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,966 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,966 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,966 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,966 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,966 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,966 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,967 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,967 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,967 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,967 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,967 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,967 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,967 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,967 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,967 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,967 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,967 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,967 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,967 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,968 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,968 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,968 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,968 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,968 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,968 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,968 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,968 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,968 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,968 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,968 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,968 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,968 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,968 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,968 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,968 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,969 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,969 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,969 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,969 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,969 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,969 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,969 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,969 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,969 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,969 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,969 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,969 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,969 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,969 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,970 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,970 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,970 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,970 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,970 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,970 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,970 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,970 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,970 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,970 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,970 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,970 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,971 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,971 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,971 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,971 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,971 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,971 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,971 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,971 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,971 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,971 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,971 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,971 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,974 [s3-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(891)) - s3@group-54E8E36963C5: receive client request(RaftClientRequest:client-97CC9EBF2E25->s3@group-54E8E36963C5, cid=999, seq=null, RW, Message:6d657373616765)
2023-10-31 16:09:09,978 [Time-limited test] INFO  grpc.TestRetryCacheWithGrpc (RetryCacheTests.java:runTestRetryOnNewLeader(157)) - successfully sent out the retry request_7
2023-10-31 16:09:09,978 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,978 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,978 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,978 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,979 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,979 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,979 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,979 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,979 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,979 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,982 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,982 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,983 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,983 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,983 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,983 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,983 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,983 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,983 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,983 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,983 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,983 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,983 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,983 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,984 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,984 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,984 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,984 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,984 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,984 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,984 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,984 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,984 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,985 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,985 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,985 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,985 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,985 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,985 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,985 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,985 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,985 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,985 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,985 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,985 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,985 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,985 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,985 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,986 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,986 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,986 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,986 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,986 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,986 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,986 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,986 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,986 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,986 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,986 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,986 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,987 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,987 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,987 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,987 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,987 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,987 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,987 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,987 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,987 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,987 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,987 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,987 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,988 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,988 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,988 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,988 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,988 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,988 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,988 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,988 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,988 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,988 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,988 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,988 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,989 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,989 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,989 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,989 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,989 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,989 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,989 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,989 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,989 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,989 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,989 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,989 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,989 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,989 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,990 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,990 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,990 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,990 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,990 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,990 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,990 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,990 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,990 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,990 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,990 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,990 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,990 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,990 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,990 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,991 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,991 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,991 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,991 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,991 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,991 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,991 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,991 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,991 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,991 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,991 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,991 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,991 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,991 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,991 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,991 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,991 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,992 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,992 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,992 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,992 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,992 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,992 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,992 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,992 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,992 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,992 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,992 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,992 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,992 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,992 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,993 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,993 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,993 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,993 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,993 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,993 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,993 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,993 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,993 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,993 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,993 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,993 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,994 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,994 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,994 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,994 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,994 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,994 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,994 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,994 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,994 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,994 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,994 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,994 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,995 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,995 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,995 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,995 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,995 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,995 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,995 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,995 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,995 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,995 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,995 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,995 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,995 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,995 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,996 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,996 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,996 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,996 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,996 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,996 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,996 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,996 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,996 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,996 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,996 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,996 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,996 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,996 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,997 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,997 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,997 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,997 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,997 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,997 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,997 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,997 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,997 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,997 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,997 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,997 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,997 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,997 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,997 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,997 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,998 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,998 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,998 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,998 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,998 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,998 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,998 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,998 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,998 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,998 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,998 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,998 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,998 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,998 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,998 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,998 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:09,999 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:09,999 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:09,999 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:09,999 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:09,999 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:09,999 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:09,999 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:09,999 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:09,999 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:09,999 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:09,999 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:09,999 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,000 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,000 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,000 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,000 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,000 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,000 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,000 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,000 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,000 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,000 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,000 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,000 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,001 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,001 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,001 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,001 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,001 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,001 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,001 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,001 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,001 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,001 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,001 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,001 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,001 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,001 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,002 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,002 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,002 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,002 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,002 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,002 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,002 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,002 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,002 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,002 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,002 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,002 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,002 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,003 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,003 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,003 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,003 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,003 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,003 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,003 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,003 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,003 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,003 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,003 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,003 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,003 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,003 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,003 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,003 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,003 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,004 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,004 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,004 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,004 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,004 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,004 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,004 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,004 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,004 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,004 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,004 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,004 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,004 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,004 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,004 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,004 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,005 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,005 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,005 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,005 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,005 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,005 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,005 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,005 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,005 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,005 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,005 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,005 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,006 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,006 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,006 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,006 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,006 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,006 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,006 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,006 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,006 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,006 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,006 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,006 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,007 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,007 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,007 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,007 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,007 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,007 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,007 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,007 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,007 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,007 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,007 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,007 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,007 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,008 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,008 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,008 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,008 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,008 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,008 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,008 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,008 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,008 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,008 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,008 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,008 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,009 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,009 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,009 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,009 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,009 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,009 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,009 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,009 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,009 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,009 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,009 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,009 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,009 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,009 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,010 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,010 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,010 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,010 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,010 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,010 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,010 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,010 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,010 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,010 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,010 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,010 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,010 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,010 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,010 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,011 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,011 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,011 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,011 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,011 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,011 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,011 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,011 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,011 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,011 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,011 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,011 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,011 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,011 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,011 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,011 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,011 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,012 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,012 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,012 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,012 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,012 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,012 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,012 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,012 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,012 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,012 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,012 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,012 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,012 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,013 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,013 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,013 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,013 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,013 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,013 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,013 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,013 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,013 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,013 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,013 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,013 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,014 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,014 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,014 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,014 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,014 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,014 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,014 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,014 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,014 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,014 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,014 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,014 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,014 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,015 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,015 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,015 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,015 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,015 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,015 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,015 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,015 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,015 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,015 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,015 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,015 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,015 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,016 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,016 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,016 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,016 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,016 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,016 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,016 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,016 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,016 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,016 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,016 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,016 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,016 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,016 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,016 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,016 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,017 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,017 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,017 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,017 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,017 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,017 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,017 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,017 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,017 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,017 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,017 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,017 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,017 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,017 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,017 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,017 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,017 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,017 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,018 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,018 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,018 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,018 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,018 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,018 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,018 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,018 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,018 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,018 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,018 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,018 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,019 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,019 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,019 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,019 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,019 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,019 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,019 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,019 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,019 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,019 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,019 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,019 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,020 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,020 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,020 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,020 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,020 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,020 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,020 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,020 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,020 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,020 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,020 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,020 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,020 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,020 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,021 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,021 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,021 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,021 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,021 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,021 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,021 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,021 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,021 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,021 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,021 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,021 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,021 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,021 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,021 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,022 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,022 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,022 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,022 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,022 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,022 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,022 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,022 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,022 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,022 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,022 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,022 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,023 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,023 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,023 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,023 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,023 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,023 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,023 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,023 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,023 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,023 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,023 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,023 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,023 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,023 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,023 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,024 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,024 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,024 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,024 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,024 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,024 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,024 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,024 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,024 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,024 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,024 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,024 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,024 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,024 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,024 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,024 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,025 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,025 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,025 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,025 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,025 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,025 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,025 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,025 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,025 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,025 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,025 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,025 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,026 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,026 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,026 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,026 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,026 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,026 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,026 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,026 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,026 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,026 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,026 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,026 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,028 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,028 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,028 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,028 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,028 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,028 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,028 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,028 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,028 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,028 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,028 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,028 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,029 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,029 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,029 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,029 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,029 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,029 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,029 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,029 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,029 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,029 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,029 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,029 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,030 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,030 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,030 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,030 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,030 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,030 [grpc-default-executor-5] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s0@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.drainPendingCallbacks(DelayedClientCall.java:510)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$1DrainListenerRunnable.runInContext(DelayedClientCall.java:299)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 11 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 11 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:37937
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,030 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,030 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,030 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,030 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,030 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,031 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,031 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,031 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,031 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,031 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,031 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,031 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,031 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,031 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,031 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,031 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,031 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,031 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,031 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,032 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,032 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,032 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,032 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,032 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,032 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,032 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,032 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,032 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,032 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,032 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,032 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,033 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,033 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,033 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,033 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,033 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,033 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,033 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,033 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,033 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,033 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,033 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,033 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,034 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,034 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,034 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,034 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,034 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,034 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,034 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,034 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,034 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,034 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,034 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,034 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,035 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,035 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,035 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,035 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,035 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,035 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,035 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,035 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,035 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,035 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,035 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,035 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,035 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,035 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,036 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,036 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,036 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,036 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,036 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,036 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,036 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,036 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,036 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,036 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,036 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,036 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,036 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,037 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,037 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,037 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,037 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,037 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,037 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,037 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,037 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,037 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,037 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,037 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,037 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,037 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,037 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,037 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,037 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,037 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,038 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,038 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,038 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,038 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,038 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,038 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,038 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,038 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,038 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,038 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,038 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,038 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,038 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,038 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,038 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,038 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,039 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,039 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,039 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,039 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,039 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,039 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,039 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,039 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,039 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,039 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,039 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,039 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,040 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,040 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,040 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,040 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,040 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,040 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,040 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,040 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,040 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,040 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,040 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,040 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,041 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,041 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,041 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,041 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,041 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,041 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,041 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,041 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,041 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,041 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,041 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,041 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,041 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,042 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,042 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,042 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,042 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,042 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,042 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,042 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,042 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,042 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,042 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,042 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,042 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,042 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,043 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,043 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,043 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,043 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,043 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,043 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,043 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,043 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,043 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,043 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,043 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,043 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,043 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,043 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,043 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,043 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,044 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,044 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,044 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,044 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,044 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,044 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,044 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,044 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,044 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,044 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,044 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,044 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,044 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,044 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,044 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,044 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,044 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,044 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,045 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,045 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,045 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,045 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,045 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,045 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,045 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,045 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,045 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,045 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,045 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,045 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,046 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,046 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,046 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,046 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,046 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,046 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,046 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,046 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,046 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,046 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,046 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,046 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,047 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,047 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,047 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,047 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,047 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,047 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,047 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,047 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,047 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,047 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,047 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,047 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,047 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,048 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,048 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,048 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,048 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,048 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,048 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,048 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,048 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,048 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,048 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,048 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,048 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,048 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,048 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,049 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,049 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,049 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,049 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,049 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,049 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,049 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,049 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,049 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,049 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,049 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,049 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,049 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,049 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,049 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,050 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,050 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,050 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,050 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,050 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,050 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,058 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,058 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,059 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,059 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,059 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,059 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,059 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,059 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,059 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,059 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,059 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,059 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,059 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,060 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,060 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,060 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,060 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,060 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,060 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,060 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,060 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,060 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,060 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,060 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,061 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,062 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,062 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,062 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,062 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,062 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,062 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,062 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,062 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,062 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,062 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,062 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,062 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,062 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,063 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,063 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,063 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,063 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,063 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,063 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,063 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,063 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,063 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,063 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,063 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,063 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,063 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,063 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,064 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,064 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,064 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,064 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,064 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,064 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,064 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,064 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,064 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,064 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,064 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,064 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,064 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,064 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,064 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,064 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,065 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,065 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,065 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,065 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,066 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,066 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,067 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,068 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,068 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,068 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,068 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,068 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,068 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,068 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,068 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,068 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,068 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,070 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,070 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,071 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,071 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,071 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,071 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,071 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,071 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,071 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,071 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,071 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,071 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,071 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,071 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,071 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,071 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,072 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,072 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,072 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,072 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,072 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,072 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,072 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,072 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,072 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,072 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,072 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,072 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,072 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,072 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,073 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,073 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,073 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,073 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,073 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,073 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,073 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,073 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,073 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,073 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,073 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,073 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,073 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,073 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,073 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,073 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,073 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,074 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,074 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,074 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,074 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,074 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,074 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,074 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,074 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,074 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,074 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,074 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,074 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,075 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,075 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,075 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,075 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,075 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,075 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,075 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,075 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,075 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,075 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,075 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,075 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,076 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,076 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,076 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,076 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,076 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,076 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,076 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,076 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,076 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,076 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,076 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,076 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,076 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,077 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,077 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,077 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,077 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,077 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,077 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,077 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,077 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,077 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,077 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,077 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,078 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,078 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,078 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,078 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,078 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,078 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,082 [s3-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(891)) - s3@group-54E8E36963C5: receive client request(RaftClientRequest:client-97CC9EBF2E25->s3@group-54E8E36963C5, cid=999, seq=null, RW, Message:6d657373616765)
2023-10-31 16:09:10,083 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,083 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,083 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,083 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,083 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,083 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,084 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,084 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,084 [Time-limited test] INFO  grpc.TestRetryCacheWithGrpc (RetryCacheTests.java:runTestRetryOnNewLeader(157)) - successfully sent out the retry request_8
2023-10-31 16:09:10,084 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,084 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,084 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,084 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,084 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,084 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,084 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,084 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,084 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,084 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,085 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,085 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,085 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,085 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,085 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,085 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,085 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,085 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,085 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,085 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,085 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,085 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,086 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,086 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,086 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,086 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,086 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,086 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,086 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,086 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,086 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,086 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,086 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,086 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,087 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,087 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,087 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,087 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,087 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,087 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,087 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,087 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,087 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,087 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,087 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,087 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,088 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,088 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,088 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,088 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,088 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,088 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,088 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,088 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,088 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,088 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,088 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,088 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,090 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,090 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,090 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,090 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,090 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,090 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,090 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,090 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,090 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,090 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,090 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,090 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,091 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,091 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,091 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,091 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,091 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,091 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,091 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,091 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,091 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,091 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,091 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,091 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,092 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,092 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,092 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,092 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,092 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,092 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,092 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,092 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,092 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,092 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,092 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,092 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,092 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,093 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,093 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,093 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,093 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,093 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,093 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,093 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,093 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,093 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,093 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,093 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,093 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,093 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,093 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,094 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,094 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,094 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,094 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,094 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,094 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,094 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,094 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,094 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,094 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,094 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,094 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,094 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,094 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,094 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,094 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,095 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,095 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,095 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,095 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,095 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,095 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,095 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,095 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,095 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,095 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,095 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,095 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,095 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,095 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,095 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,095 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,095 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,096 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,096 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,096 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,096 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,096 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,096 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,096 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,096 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,096 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,096 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,096 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,096 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,097 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,097 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,097 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,097 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,097 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,097 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,097 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,097 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,097 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,097 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,097 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,097 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,098 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,098 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,098 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,098 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,098 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,098 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,098 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,098 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,098 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,098 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,098 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,098 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,098 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,099 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,099 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,099 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,099 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,099 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,099 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,099 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,099 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,099 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,099 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,099 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,099 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,099 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,099 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,100 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,100 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,100 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,100 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,100 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,100 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,100 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,100 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,100 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,100 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,100 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,100 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,100 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,100 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,100 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,101 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,101 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,101 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,101 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,101 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,101 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,101 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,101 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,101 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,101 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,101 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,101 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,101 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,101 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,101 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,101 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,101 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,101 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,102 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,102 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,102 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,102 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,102 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,102 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,102 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,102 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,102 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,102 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,102 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,102 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,103 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,103 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,103 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,103 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,103 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,103 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,103 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,103 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,103 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,103 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,103 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,103 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,104 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,104 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,104 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,104 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,104 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,104 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,104 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,104 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,104 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,104 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,104 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,104 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,104 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,104 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,105 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,105 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,105 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,105 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,105 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,105 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,105 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,105 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,105 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,105 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,105 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,105 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,105 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,105 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,105 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,106 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,106 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,106 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,106 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,106 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,106 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,106 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,106 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,106 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,106 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,106 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,106 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,106 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,106 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,106 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,106 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,106 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,107 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,107 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,107 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,107 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,107 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,107 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,107 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,107 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,107 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,107 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,107 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,107 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,107 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,107 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,108 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,108 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,108 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,108 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,108 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,108 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,108 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,108 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,108 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,108 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,108 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,108 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,109 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,109 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,109 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,109 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,109 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,109 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,109 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,109 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,109 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,109 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,109 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,109 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,109 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,109 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,110 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,110 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,110 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,110 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,110 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,110 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,110 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,110 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,110 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,110 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,110 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,110 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,110 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,110 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,110 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,111 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,111 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,111 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,111 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,111 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,111 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,111 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,111 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,111 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,111 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,111 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,111 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,111 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,111 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,111 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,111 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,111 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,111 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,111 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,112 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,112 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,112 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,112 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,112 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,112 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,112 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,112 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,112 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,112 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,112 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,112 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,113 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,113 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,113 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,113 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,113 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,113 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,113 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,113 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,113 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,113 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,113 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,113 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,113 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,114 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,114 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,114 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,114 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,114 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,114 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,114 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,114 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,114 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,114 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,114 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,114 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,114 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,114 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,114 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,115 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,115 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,115 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,115 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,115 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,115 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,115 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,115 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,115 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,115 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,115 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,115 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,115 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,115 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,115 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,115 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,116 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,116 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,116 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,116 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,116 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,116 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,116 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,116 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,116 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,116 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,116 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,116 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,116 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,116 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,116 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,116 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,117 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,117 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,117 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,117 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,117 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,117 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,117 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,117 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,117 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,117 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,117 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,117 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,118 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,118 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,118 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,118 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,118 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,118 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,118 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,118 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,118 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,118 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,118 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,118 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,119 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,119 [s4@group-54E8E36963C5-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s4@group-54E8E36963C5-FollowerState: change to CANDIDATE, lastRpcElapsedTime:237008262ns, electionTimeout:231ms
2023-10-31 16:09:10,119 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,119 [s4@group-54E8E36963C5-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(109)) - s4: shutdown s4@group-54E8E36963C5-FollowerState
2023-10-31 16:09:10,119 [s4@group-54E8E36963C5-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s4@group-54E8E36963C5: changes role from  FOLLOWER to CANDIDATE at term 2 for changeToCandidate
2023-10-31 16:09:10,119 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,119 [s4@group-54E8E36963C5-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2023-10-31 16:09:10,119 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,119 [s4@group-54E8E36963C5-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s4: start s4@group-54E8E36963C5-LeaderElection19
2023-10-31 16:09:10,119 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,119 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,119 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,119 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,119 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,119 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,119 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,119 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,119 [s4@group-54E8E36963C5-LeaderElection19] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(323)) - s4@group-54E8E36963C5-LeaderElection19 PRE_VOTE round 0: submit vote requests at term 2 for 7: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:10,120 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,120 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,120 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,120 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,120 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,120 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,120 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,120 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,120 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,120 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,120 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,120 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,121 [s4@group-54E8E36963C5-LeaderElection19] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(136)) - s4@group-54E8E36963C5-LeaderElection19 got exception when requesting votes: java.util.concurrent.ExecutionException: java.lang.IllegalStateException: ILLEGAL TRANSITION: In s3, STARTING -> STARTING
2023-10-31 16:09:10,124 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1368)) - s2@group-54E8E36963C5: receive requestVote(PRE_VOTE, s4, group-54E8E36963C5, 2, (t:1, i:8))
2023-10-31 16:09:10,124 [grpc-default-executor-4] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-54E8E36963C5-FOLLOWER: reject PRE_VOTE from s4: this server is a follower and still has a valid leader s3
2023-10-31 16:09:10,124 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1401)) - s2@group-54E8E36963C5 replies to PRE_VOTE vote request: s4<-s2#0:FAIL-t2. Peer's state: s2@group-54E8E36963C5:t2, leader=s3, voted=s3, raftlog=Memoized:s2@group-54E8E36963C5-SegmentedRaftLog:OPENED:c10, conf=9: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null
2023-10-31 16:09:10,125 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,125 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,125 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,125 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,125 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,125 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,125 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,125 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,125 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,125 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,125 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,125 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,126 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,126 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,126 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,126 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,126 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,126 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,126 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,126 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,126 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,126 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,126 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,126 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,126 [s4@group-54E8E36963C5-LeaderElection19] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s4@group-54E8E36963C5-LeaderElection19: PRE_VOTE REJECTED received 1 response(s) and 1 exception(s):
2023-10-31 16:09:10,127 [s4@group-54E8E36963C5-LeaderElection19] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s4<-s2#0:FAIL-t2
2023-10-31 16:09:10,127 [s4@group-54E8E36963C5-LeaderElection19] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(136)) -   Exception 1: java.util.concurrent.ExecutionException: java.lang.IllegalStateException: ILLEGAL TRANSITION: In s3, STARTING -> STARTING
2023-10-31 16:09:10,127 [s4@group-54E8E36963C5-LeaderElection19] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(325)) - s4@group-54E8E36963C5-LeaderElection19 PRE_VOTE round 0: result REJECTED
2023-10-31 16:09:10,127 [s4@group-54E8E36963C5-LeaderElection19] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(377)) - s4@group-54E8E36963C5: changes role from CANDIDATE to FOLLOWER at term 2 for REJECTED
2023-10-31 16:09:10,127 [s4@group-54E8E36963C5-LeaderElection19] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(129)) - s4: shutdown s4@group-54E8E36963C5-LeaderElection19
2023-10-31 16:09:10,127 [s4@group-54E8E36963C5-LeaderElection19] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(138)) - s4: start s4@group-54E8E36963C5-FollowerState
2023-10-31 16:09:10,127 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,127 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,127 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,127 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,127 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,127 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,127 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,127 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,127 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,127 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,127 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,127 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,128 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,128 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,128 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,128 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,128 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,128 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,128 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,128 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,128 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,128 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,128 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,128 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,129 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,129 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,129 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,129 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,129 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,129 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,129 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,129 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,129 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,129 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,129 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,129 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,130 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,130 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,130 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,130 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,130 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,130 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,130 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,130 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,130 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,130 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,130 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,130 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,130 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,130 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,131 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,131 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,131 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,131 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,131 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,131 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,134 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,134 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,134 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,134 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,134 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,134 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,134 [grpc-default-executor-1] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s1@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.drainPendingCallbacks(DelayedClientCall.java:510)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$1DrainListenerRunnable.runInContext(DelayedClientCall.java:299)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 11 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 11 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:37189
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,135 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,135 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,135 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,135 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,135 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,135 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,135 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,135 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,135 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,135 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,136 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,136 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,136 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,136 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,136 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,136 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,136 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,136 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,136 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,136 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,136 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,136 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,136 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,137 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,137 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,137 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,137 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,137 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,137 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,137 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,137 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,137 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,137 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,137 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,137 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,137 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,137 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,137 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,138 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,138 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,138 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,138 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,138 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,138 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,138 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,138 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,138 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,138 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,138 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,138 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,138 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,139 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,139 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,139 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,139 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,139 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,139 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,139 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,139 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,139 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,139 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,139 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,139 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,139 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,139 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,139 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,139 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,139 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,139 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,140 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,140 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,140 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,140 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,140 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,140 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,140 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,140 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,140 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,140 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,140 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,140 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,140 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,141 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,141 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,141 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,141 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,141 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,141 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,141 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,141 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,141 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,141 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,141 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,141 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,141 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,142 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,142 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,142 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,142 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,142 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,142 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,142 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,142 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,142 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,142 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,142 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,142 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,142 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,143 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,143 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,143 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,143 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,143 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,143 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,143 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,143 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,143 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,143 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,143 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,143 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,144 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,144 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,144 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,144 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,144 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,144 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,144 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,144 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,144 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,144 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,144 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,144 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,144 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,144 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,145 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,145 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,145 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,145 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,145 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,145 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,145 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,145 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,145 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,145 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,145 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,145 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,145 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,145 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,145 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,145 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,145 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,145 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,145 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,145 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,146 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,146 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,146 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,146 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,146 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,146 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,146 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,146 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,146 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,146 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,146 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,146 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,147 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,147 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,147 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,147 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,147 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,147 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,147 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,147 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,147 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,147 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,147 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,147 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,147 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,147 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,148 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,148 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,148 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,148 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,148 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,148 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,148 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,148 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,148 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,148 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,148 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,148 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,148 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,148 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,148 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,149 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,149 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,149 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,149 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,149 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,149 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,149 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,149 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,149 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,149 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,149 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,149 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,149 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,149 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,149 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,149 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,149 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,149 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,149 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,150 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,150 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,150 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,150 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,150 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,150 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,150 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,150 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,150 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,150 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,150 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,150 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,151 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,151 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,151 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,151 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,151 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,151 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,151 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,151 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,151 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,151 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,151 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,151 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,151 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,152 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,152 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,152 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,152 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,152 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,152 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,152 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,152 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,152 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,152 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,152 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,152 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,152 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,152 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,152 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,152 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,153 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,153 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,153 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,153 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,153 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,153 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,153 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,153 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,153 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,153 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,153 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,153 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,153 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,153 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,153 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,153 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,153 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,153 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,153 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,154 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,154 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,154 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,154 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,154 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,154 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,154 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,154 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,154 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,154 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,154 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,154 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,155 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,155 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,155 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,155 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,155 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,155 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,155 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,155 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,155 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,155 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,155 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,155 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,156 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,156 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,156 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,156 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,156 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,156 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,156 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,156 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,156 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,156 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,156 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,156 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,156 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,156 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,157 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,157 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,157 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,157 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,157 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,157 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,157 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,157 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,157 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,157 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,157 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,157 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,157 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,157 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,157 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,157 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,158 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,158 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,158 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,158 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,158 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,158 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,158 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,158 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,158 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,158 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,158 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,158 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,158 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,158 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,158 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,158 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,158 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,158 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,159 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,159 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,159 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,159 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,159 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,159 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,159 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,159 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,159 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,159 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,159 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,159 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,160 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,160 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,160 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,160 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,160 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,160 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,160 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,160 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,160 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,160 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,160 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,160 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,161 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,161 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,161 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,161 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,161 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,161 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,161 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,161 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,161 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,161 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,161 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,161 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,161 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,161 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,161 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,162 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,162 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,162 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,162 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,162 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,162 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,162 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,162 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,162 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,162 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,162 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,162 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,162 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,162 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,162 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,162 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,162 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,163 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,163 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,163 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,163 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,163 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,163 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,163 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,163 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,163 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,163 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,163 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,163 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,163 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,163 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,163 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,163 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,164 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,164 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,164 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,164 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,164 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,164 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,164 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,164 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,164 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,164 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,164 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,164 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,165 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,165 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,165 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,165 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,165 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,165 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,165 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,165 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,165 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,165 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,165 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,165 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,165 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,165 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,166 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,166 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,166 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,166 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,166 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,166 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,166 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,166 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,166 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,166 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,166 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,166 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,166 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,166 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,166 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,167 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,167 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,167 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,167 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,167 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,167 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,167 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,167 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,167 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,167 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,167 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,167 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,167 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,167 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,167 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,167 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,167 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,167 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,167 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,168 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,168 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,168 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,168 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,168 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,168 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,168 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,168 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,168 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,168 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,168 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,168 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,169 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,169 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,169 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,169 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,169 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,169 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,169 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,169 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,169 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,169 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,169 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,169 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,169 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,170 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,170 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,170 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,170 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,170 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,170 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,170 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,170 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,170 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,170 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,170 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,170 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,170 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,170 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,170 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,170 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,171 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,171 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,171 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,171 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,171 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,171 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,171 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,171 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,171 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,171 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,171 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,171 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,171 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,171 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,171 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,171 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,171 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,171 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,172 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,172 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,172 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,172 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,172 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,172 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,172 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,172 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,172 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,172 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,172 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,172 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,172 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,173 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,173 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,173 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,173 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,173 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,173 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,173 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,173 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,173 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,173 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,173 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,173 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,174 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,174 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,174 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,174 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,174 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,174 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,174 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,174 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,174 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,174 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,174 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,174 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,174 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,174 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,175 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,175 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,175 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,175 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,175 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,175 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,175 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,175 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,175 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,175 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,175 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,175 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,175 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,175 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,175 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,175 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,175 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,176 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,176 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,176 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,176 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,176 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,176 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,176 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,176 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,176 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,176 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,176 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,176 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,176 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,176 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,176 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,176 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,176 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,177 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,177 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,177 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,177 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,177 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,177 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,177 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,177 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,177 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,177 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,177 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,177 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,178 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,178 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,178 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,178 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,178 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,178 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,178 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,178 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,178 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,178 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,178 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,178 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,178 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,179 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,179 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,179 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,179 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,179 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,179 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,179 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,179 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,179 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,179 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,179 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,179 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,179 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,179 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,179 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,179 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,180 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,180 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,180 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,180 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,180 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,180 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,180 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,180 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,180 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,180 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,180 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,180 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,180 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,180 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,180 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,180 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,180 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,180 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,180 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,181 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,181 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,181 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,181 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,181 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,181 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,181 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,181 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,181 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,181 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,181 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,181 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,182 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,182 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,182 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,182 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,182 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,182 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,182 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,182 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,182 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,182 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,182 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,182 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,182 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,182 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,183 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,183 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,183 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,183 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,183 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,183 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,183 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,183 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,183 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,183 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,183 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,183 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,183 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,183 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,183 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,184 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,184 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,184 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,184 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,184 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,184 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,184 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,184 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,184 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,184 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,184 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,184 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,184 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,184 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,184 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,184 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,184 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,185 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,185 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,185 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,185 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,185 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,185 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,185 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,185 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,185 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,185 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,185 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,185 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,185 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,185 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,186 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,186 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,186 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,186 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,186 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,186 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,186 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,186 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,186 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,186 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,186 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,186 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,187 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,187 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,187 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,187 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,187 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,187 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,187 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,187 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,187 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,187 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,187 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,187 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,187 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,187 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,188 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,188 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,188 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,188 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,188 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,188 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,188 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,188 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,188 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,188 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,188 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,188 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,188 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,189 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,189 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,189 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,189 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,189 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,189 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,189 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,189 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,189 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,189 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,189 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,189 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,189 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,189 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,189 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,189 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,189 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,189 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,190 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,190 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,190 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,190 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,190 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,191 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,191 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,191 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,191 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,191 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,191 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,191 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,191 [s3-client-thread1] DEBUG server.RaftServer$Division (RaftServerImpl.java:submitClientRequestAsync(891)) - s3@group-54E8E36963C5: receive client request(RaftClientRequest:client-97CC9EBF2E25->s3@group-54E8E36963C5, cid=999, seq=null, RW, Message:6d657373616765)
2023-10-31 16:09:10,191 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,191 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,191 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,196 [Time-limited test] INFO  grpc.TestRetryCacheWithGrpc (RetryCacheTests.java:runTestRetryOnNewLeader(157)) - successfully sent out the retry request_9
2023-10-31 16:09:10,196 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,196 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,196 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,196 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,196 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,196 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,196 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,196 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,197 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,197 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,197 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,197 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,197 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,197 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,197 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,197 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,197 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,197 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,197 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,197 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,197 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,197 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,197 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,197 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,198 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,198 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,198 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,198 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,198 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,198 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,198 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,198 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,198 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,198 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,198 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,198 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,199 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,199 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,199 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,199 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,199 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,199 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,199 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,199 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,199 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,199 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,199 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,199 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,199 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,199 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,200 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,200 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,200 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,200 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,200 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,200 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,200 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,200 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,200 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,200 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,200 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,200 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,200 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,200 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,200 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,200 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,200 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,200 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,201 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,201 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,201 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,201 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,201 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,201 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,201 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,201 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,201 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,201 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,201 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,201 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,201 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,201 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,201 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,201 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,202 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,202 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,202 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,202 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,202 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,202 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,202 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,202 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,202 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,202 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,202 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,202 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,203 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,203 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,203 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,203 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,203 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,203 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,203 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,203 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,203 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,203 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,203 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,203 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,203 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,204 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,204 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,204 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,204 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,204 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,204 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,204 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,204 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,204 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,204 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,204 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,204 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,204 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,204 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,204 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,204 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,205 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,205 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,205 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,205 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,205 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,205 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,205 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,205 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,205 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,205 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,205 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,205 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,205 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,205 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,205 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,205 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,205 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,205 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,206 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,206 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,206 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,206 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,206 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,206 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,206 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,206 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,206 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,206 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,206 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,206 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,206 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,207 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,207 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,207 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,207 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,207 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,207 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,207 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,207 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,207 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,207 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,207 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,207 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,207 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,208 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,208 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,208 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,208 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,208 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,208 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,208 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,208 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,208 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,208 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,208 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,208 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,208 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,208 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,209 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,209 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,209 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,209 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,209 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,209 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,209 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,209 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,209 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,209 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,209 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,209 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,209 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,209 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,209 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,209 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,209 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,209 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,209 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,209 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,210 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,210 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,210 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,210 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,210 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,210 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,210 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,210 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,210 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,210 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,210 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,210 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,210 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,211 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,211 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,211 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,211 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,211 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,211 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,211 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,211 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,211 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,211 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,211 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,211 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,211 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,212 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,212 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,212 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,212 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,213 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,213 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,213 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,213 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,213 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,213 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,213 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,213 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,213 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,213 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,214 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,214 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,214 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,214 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,214 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,214 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,214 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,214 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,214 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,214 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,214 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,214 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,214 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,214 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,214 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,214 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,214 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,214 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,215 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,215 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,215 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,215 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,215 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,215 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,215 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,215 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,215 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,215 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,215 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,215 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,215 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,215 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,215 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,216 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,216 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,216 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,216 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,216 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,216 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,216 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,216 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,216 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,216 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,216 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,216 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,224 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,224 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,225 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,225 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,225 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,225 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,225 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,225 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,225 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,225 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,225 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,225 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,225 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,225 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,225 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,226 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,226 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,226 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,226 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,226 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,226 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,226 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,226 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,226 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,226 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,226 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,226 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,226 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,226 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,226 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,226 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,226 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,226 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,227 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,227 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,227 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,227 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,227 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,227 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,227 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,227 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,227 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,227 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,227 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,227 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,227 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,227 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,227 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,228 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,228 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,228 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,228 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,228 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,228 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,228 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,228 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,228 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,228 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,228 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,228 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,228 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,229 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,229 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,229 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,229 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,229 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,229 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,229 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,229 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,229 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,229 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,229 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,229 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,229 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,229 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,229 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,230 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,230 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,230 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,230 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,230 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,230 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,230 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,230 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,230 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,230 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,230 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,230 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,230 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,230 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,230 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,230 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,230 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,230 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,230 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,230 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,231 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,231 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,231 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,231 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,231 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,231 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,231 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,231 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,231 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,231 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,231 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,231 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,232 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,232 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,232 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,232 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,232 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,232 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,232 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,232 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,232 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,232 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,232 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,232 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,232 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,232 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,233 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,233 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,233 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,233 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,233 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,233 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,233 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,233 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,233 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,233 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,233 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,233 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,233 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,233 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,233 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,233 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,233 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,233 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,233 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,234 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,234 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,234 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,234 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,234 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,234 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,234 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,234 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,234 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,234 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,234 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,234 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,234 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,234 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,234 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,235 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,235 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,235 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,235 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,235 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,235 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,235 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,235 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,235 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,235 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,238 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,238 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,238 [grpc-default-executor-6] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s0@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:37937
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,238 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,239 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,239 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,239 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,239 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,239 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,239 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,239 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,239 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,239 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,239 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,239 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,239 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,239 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,240 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,240 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,240 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,240 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,240 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,240 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,240 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,240 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,240 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,240 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,240 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,240 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,240 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,240 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,240 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,240 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,240 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,240 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,240 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,240 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,241 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,241 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,241 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,241 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,241 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,241 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,241 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,241 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,241 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,241 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,241 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,241 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,241 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,241 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,242 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,242 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,242 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,242 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,242 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,242 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,242 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,242 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,242 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,242 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,242 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,242 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,242 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,242 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,243 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,243 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,243 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,243 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,243 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,243 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,243 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,243 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,243 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,243 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,243 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,243 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,243 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,243 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,243 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,244 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,244 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,244 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,244 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,244 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,244 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,244 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,244 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,244 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,244 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,244 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,244 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,244 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,244 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,244 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,244 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,244 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,244 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,244 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,245 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,245 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,245 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,245 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,245 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,245 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,245 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,245 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,245 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,245 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,245 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,245 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,246 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,246 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,246 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,246 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,246 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,246 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,246 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,246 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,246 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,246 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,246 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,246 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,246 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,246 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,246 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,247 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,247 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,247 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,247 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,247 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,247 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,247 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,247 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,247 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,247 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,247 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,247 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,247 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,247 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,247 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,247 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,247 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,247 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,247 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,247 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,247 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,248 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,248 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,248 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,248 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,248 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,248 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,248 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,248 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,248 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,248 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,248 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,248 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,249 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,249 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,249 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,249 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,249 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,249 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,249 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,249 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,249 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,249 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,249 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,249 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,249 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,249 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,249 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,250 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,250 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,250 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,250 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,250 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,250 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,250 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,250 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,250 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,250 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,250 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,250 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,250 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,250 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,250 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,250 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,250 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,250 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,251 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,251 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,251 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,251 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,251 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,251 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,251 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,251 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,251 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,251 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,251 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,251 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,251 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,251 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,251 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,252 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,252 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,252 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,252 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,252 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,252 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,252 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,252 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,252 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,252 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,252 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,252 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,252 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,252 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,253 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,253 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,253 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,253 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,253 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,253 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,253 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,253 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,253 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,253 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,253 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,253 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,253 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,253 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,253 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,253 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,254 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,254 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,254 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,254 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,254 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,254 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,254 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,254 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,254 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,254 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,254 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,254 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,254 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,254 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,254 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,254 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,254 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,254 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,255 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,255 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,255 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,255 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,255 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,255 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,255 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,255 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,255 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,255 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,255 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,255 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,256 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,256 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,256 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,256 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,256 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,256 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,256 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,256 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,256 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,256 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,256 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,256 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,256 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,256 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,257 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,257 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,257 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,257 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,257 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,257 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,257 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,257 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,257 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,257 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,257 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,257 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,257 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,257 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,257 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,257 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,257 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,257 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,258 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,258 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,258 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,258 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,258 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,258 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,258 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,258 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,258 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,258 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,258 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,258 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,258 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,258 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,258 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,258 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,259 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,259 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,259 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,259 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,259 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,259 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,259 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,259 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,259 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,259 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,259 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,259 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,259 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,260 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,260 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,260 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,260 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,260 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,260 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,260 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,260 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,260 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,260 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,260 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,260 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,260 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,260 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,260 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,260 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,260 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,261 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,261 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,261 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,261 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,261 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,261 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,261 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,261 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,261 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,261 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,261 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,261 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,261 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,261 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,261 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,261 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,261 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,261 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,262 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,262 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,262 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,262 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,262 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,262 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,262 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,262 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,262 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,262 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,262 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,262 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,263 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,263 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,263 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,263 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,263 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,263 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,263 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,263 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,263 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,263 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,263 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,263 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,263 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,263 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,263 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,263 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,264 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,264 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,264 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,264 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,264 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,264 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,264 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,264 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,264 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,264 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,264 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,264 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,264 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,264 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,264 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,264 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,264 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,264 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,264 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,264 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,265 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,265 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,265 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,265 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,265 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,265 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,265 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,265 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,265 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,265 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,265 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,265 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,266 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,266 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,266 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,266 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,266 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,266 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,266 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,266 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,266 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,266 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,266 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,266 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,266 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,266 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,267 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,267 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,267 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,267 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,267 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,267 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,267 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,267 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,267 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,267 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,267 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,267 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,267 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,267 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,267 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,267 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,267 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,267 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,267 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,268 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,268 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,268 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,268 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,268 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,268 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,268 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,268 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,268 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,268 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,268 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,268 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,268 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,268 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,268 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,269 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,269 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,269 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,269 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,269 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,269 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,269 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,269 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,269 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,269 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,269 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,269 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,269 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,269 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,270 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,270 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,270 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,270 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,270 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,270 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,270 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,270 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,270 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,270 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,270 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,270 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,270 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,270 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,270 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,270 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,270 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,271 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,271 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,271 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,271 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,271 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,271 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,271 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,271 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,271 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,271 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,271 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,271 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,271 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,271 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,271 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,271 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,271 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,272 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,272 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,272 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,272 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,272 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,272 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,272 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,272 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,272 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,272 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,272 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,272 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,272 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,273 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,273 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,273 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,273 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,273 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,273 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,273 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,273 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,273 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,273 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,273 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,273 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,273 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,273 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,273 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,273 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,273 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,273 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,274 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,274 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,274 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,274 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,274 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,274 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,274 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,274 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,274 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,274 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,274 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,274 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,274 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,274 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,274 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,274 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,274 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,275 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,275 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,275 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,275 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,275 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,275 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,275 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,275 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,275 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,275 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,275 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,275 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,275 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,276 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,276 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,276 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,276 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,276 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,276 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,276 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,276 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,276 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,276 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,276 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,276 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,276 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,276 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,276 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,276 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,277 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,277 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,277 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,277 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,277 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,277 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,277 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,277 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,277 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,277 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,277 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,277 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,277 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,277 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,277 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,277 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,277 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,277 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,277 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,278 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,278 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,278 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,278 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,278 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,278 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,278 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,278 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,278 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,278 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,278 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,278 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,279 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,279 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,279 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,279 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,279 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,279 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,279 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,279 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,279 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,279 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,279 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,279 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,279 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,279 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,280 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,280 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,280 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,280 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,280 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,280 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,280 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,280 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,280 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,280 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,280 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,280 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,280 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,280 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,280 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,280 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,280 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,280 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,280 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,281 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,281 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,281 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,281 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,281 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,281 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,281 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,281 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,281 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,281 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,281 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,281 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,281 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,281 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,281 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,282 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,282 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,282 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,282 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,282 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,282 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,282 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,282 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,282 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,282 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,282 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,282 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,282 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,282 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,283 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,283 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,283 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,283 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,283 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,283 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,283 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,283 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,283 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,283 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,283 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,283 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,283 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,283 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,283 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,283 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,283 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,283 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,284 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,284 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,284 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,284 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,284 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,284 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,284 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,284 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,284 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,284 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,284 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,284 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,284 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,284 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,284 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,284 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,285 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,285 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,285 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,285 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,285 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,285 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,285 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,285 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,285 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,285 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,285 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,285 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,285 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,286 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,286 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,286 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,286 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,286 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,286 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,286 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,286 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,286 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,286 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,286 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,286 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,286 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,286 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,287 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,287 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,287 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,287 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,287 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,287 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,287 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,287 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,287 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,287 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,287 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,287 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,287 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,287 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,287 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,287 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,287 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,287 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,287 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,287 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,288 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,288 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,288 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,288 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,288 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,288 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,288 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,288 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,288 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,288 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,288 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,288 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,288 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,289 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,289 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,289 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,289 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,289 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,289 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,289 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,289 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,289 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,289 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,289 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,289 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,290 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,291 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,291 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,291 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,291 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,291 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,291 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,291 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,291 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,291 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,291 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,291 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,291 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,292 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,292 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,292 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,292 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,292 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,292 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,292 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,292 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,292 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,292 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,292 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,292 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,292 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,292 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,292 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,292 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,292 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,293 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,293 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,293 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,293 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,293 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,293 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,293 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,293 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,293 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,293 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,293 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,293 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,293 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,293 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,293 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,293 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,293 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,293 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,294 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,294 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,294 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,294 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,294 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,294 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,294 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,294 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,294 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,294 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,294 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,294 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,295 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,295 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,295 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,295 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,295 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,295 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,295 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,295 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,295 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,295 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,295 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,295 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,295 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,295 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,295 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,296 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,296 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,296 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,296 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,296 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,296 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,296 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,296 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,296 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,296 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,296 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,296 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,296 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,296 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,296 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,296 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,296 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,296 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,296 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,296 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,296 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,298 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,298 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,298 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,298 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,298 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,298 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,298 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,298 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,298 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,298 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,298 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,298 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,299 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,299 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,299 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,299 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,299 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,299 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,299 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,299 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,299 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,299 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,299 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,299 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,299 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,300 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,300 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,300 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,300 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,300 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,300 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,300 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,300 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,300 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,300 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,300 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,301 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,301 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,301 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,301 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,301 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,301 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,302 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,302 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,302 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,302 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,302 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,302 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,302 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,302 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,302 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,302 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,302 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,303 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,303 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,303 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,303 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,303 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,303 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,303 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,303 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(831)) - ************************************************************** 
2023-10-31 16:09:10,303 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(832)) - *** 
2023-10-31 16:09:10,303 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(833)) - ***     Stopping MiniRaftClusterWithGrpc
2023-10-31 16:09:10,303 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(834)) - *** 
2023-10-31 16:09:10,303 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(835)) - ************************************************************** 
2023-10-31 16:09:10,303 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] ERROR leader.LogAppenderDaemon (LogAppenderDaemon.java:run(87)) - s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon failed
java.lang.IllegalStateException: ILLEGAL TRANSITION: In s4, STARTING -> STARTING
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:61)
	at org.apache.ratis.util.LifeCycle$State.validate(LifeCycle.java:121)
	at org.apache.ratis.util.LifeCycle.transition(LifeCycle.java:164)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:268)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:63)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:110)
	at org.apache.ratis.grpc.server.GrpcLogAppender.getClient(GrpcLogAppender.java:120)
	at org.apache.ratis.grpc.server.GrpcLogAppender.appendLog(GrpcLogAppender.java:312)
	at org.apache.ratis.grpc.server.GrpcLogAppender.run(GrpcLogAppender.java:180)
	at org.apache.ratis.server.leader.LogAppenderDaemon.run(LogAppenderDaemon.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,303 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(836)) - printing ALL groups
  s3:  RUNNING    LEADER s3@group-54E8E36963C5:t2, leader=s3, voted=s3, raftlog=Memoized:s3@group-54E8E36963C5-SegmentedRaftLog:OPENED:c10, conf=9: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null RUNNING
  s4:  RUNNING  FOLLOWER s4@group-54E8E36963C5:t2, leader=null, voted=null, raftlog=Memoized:s4@group-54E8E36963C5-SegmentedRaftLog:OPENED:c7, conf=7: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null RUNNING
  s0:  RUNNING    LEADER s0@group-54E8E36963C5:t1, leader=s0, voted=s0, raftlog=Memoized:s0@group-54E8E36963C5-SegmentedRaftLog:CLOSED:c7, conf=7: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null CLOSED
  s1:   CLOSED CANDIDATE s1@group-54E8E36963C5:t1, leader=null, voted=s0, raftlog=Memoized:s1@group-54E8E36963C5-SegmentedRaftLog:CLOSED:c5, conf=5: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=peers:[s0|localhost:38037, s1|localhost:45329, s2|localhost:44689]|listeners:[] CLOSED
  s2:  RUNNING  FOLLOWER s2@group-54E8E36963C5:t2, leader=s3, voted=s3, raftlog=Memoized:s2@group-54E8E36963C5-SegmentedRaftLog:OPENED:c10, conf=9: peers:[s3|0.0.0.0:39449, s4|0.0.0.0:42259, s2|localhost:44689]|listeners:[], old=null RUNNING
2023-10-31 16:09:10,303 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServer$Division (LeaderStateImpl.java:restart(654)) - s3@group-54E8E36963C5-LeaderStateImpl: Restarting GrpcLogAppender for s3@group-54E8E36963C5->s4
2023-10-31 16:09:10,303 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-10-31 16:09:10,303 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-10-31 16:09:10,303 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-10-31 16:09:10,304 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 1ms (default)
2023-10-31 16:09:10,304 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-10-31 16:09:10,304 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-10-31 16:09:10,304 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.element-limit = 8 (default)
2023-10-31 16:09:10,304 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.install_snapshot.request.timeout = 3000ms (default)
2023-10-31 16:09:10,304 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-10-31 16:09:10,304 [s3@group-54E8E36963C5->s4-GrpcLogAppender-LogAppenderDaemon] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-10-31 16:09:10,304 [MiniRaftCluster-10] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$9(416)) - s3: close
2023-10-31 16:09:10,306 [MiniRaftCluster-10] INFO  server.GrpcService (GrpcService.java:closeImpl(311)) - s3: shutdown server GrpcServerProtocolService now
2023-10-31 16:09:10,306 [s3-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$3(514)) - s3@group-54E8E36963C5: shutdown
2023-10-31 16:09:10,306 [s3-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-54E8E36963C5,id=s3
2023-10-31 16:09:10,306 [s3-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(92)) - s3: shutdown s3@group-54E8E36963C5-LeaderStateImpl
2023-10-31 16:09:10,306 [MiniRaftCluster-11] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$9(416)) - s4: close
2023-10-31 16:09:10,306 [s3-impl-thread1] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(289)) - s3@group-54E8E36963C5-PendingRequests: sendNotLeaderResponses
2023-10-31 16:09:10,307 [MiniRaftCluster-12] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$9(416)) - s0: close
2023-10-31 16:09:10,307 [s3-impl-thread1] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(157)) - s3@group-54E8E36963C5-StateMachineUpdater: set stopIndex = 10
2023-10-31 16:09:10,307 [s3@group-54E8E36963C5->s2-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(211)) - s3@group-54E8E36963C5->s2-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2023-10-31 16:09:10,307 [s3-impl-thread1] INFO  server.RaftServer$Division (ServerState.java:close(423)) - s3@group-54E8E36963C5: applyIndex: 10
2023-10-31 16:09:10,307 [s3@group-54E8E36963C5-cacheEviction-AwaitToRun] INFO  util.AwaitToRun (AwaitToRun.java:run(49)) - s3@group-54E8E36963C5-cacheEviction-AwaitToRun-AwaitForSignal is interrupted
2023-10-31 16:09:10,308 [grpc-default-executor-6] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(157)) - s2: Completed APPEND_ENTRIES, lastRequest: s3->s2#2-t2,previous=(t:2, i:9),leaderCommit=9,initializing? true,entries: size=1, first=(t:2, i:10), METADATAENTRY(c:9)
2023-10-31 16:09:10,308 [grpc-default-executor-6] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:lambda$onCompleted$5(159)) - s2: Completed APPEND_ENTRIES, lastReply: null
2023-10-31 16:09:10,309 [grpc-default-executor-6] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(157)) - s2: Completed APPEND_ENTRIES, lastRequest: null
2023-10-31 16:09:10,309 [grpc-default-executor-6] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:lambda$onCompleted$5(159)) - s2: Completed APPEND_ENTRIES, lastReply: serverReply {
  requestorId: "s3"
  replyId: "s2"
  raftGroupId {
    id: "\251y\304\030\n\037G\330\237\376T\350\343ic\305"
  }
  callId: 20
  success: true
}
term: 2
nextIndex: 11
followerCommit: 10
matchIndex: 18446744073709551615
isHearbeat: true

2023-10-31 16:09:10,310 [grpc-default-executor-1] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(468)) - s3@group-54E8E36963C5->s2-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2023-10-31 16:09:10,310 [grpc-default-executor-6] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(468)) - s3@group-54E8E36963C5->s2-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2023-10-31 16:09:10,310 [MiniRaftCluster-14] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$9(416)) - s2: close
2023-10-31 16:09:10,314 [Thread-1045] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:close(103)) - s0 Close channels
2023-10-31 16:09:10,315 [Thread-1046] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:close(103)) - s1 Close channels
2023-10-31 16:09:10,315 [Thread-1047] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:close(103)) - s2 Close channels
2023-10-31 16:09:10,316 [MiniRaftCluster-10] INFO  server.GrpcService (GrpcService.java:closeImpl(320)) - s3: shutdown server GrpcServerProtocolService successfully
2023-10-31 16:09:10,319 [MiniRaftCluster-11] INFO  server.GrpcService (GrpcService.java:closeImpl(311)) - s4: shutdown server GrpcServerProtocolService now
2023-10-31 16:09:10,319 [MiniRaftCluster-12] INFO  server.GrpcService (GrpcService.java:closeImpl(311)) - s0: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService now
2023-10-31 16:09:10,319 [s4-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$3(514)) - s4@group-54E8E36963C5: shutdown
2023-10-31 16:09:10,319 [s4-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-54E8E36963C5,id=s4
2023-10-31 16:09:10,319 [s4-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(109)) - s4: shutdown s4@group-54E8E36963C5-FollowerState
2023-10-31 16:09:10,319 [s4-impl-thread1] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(157)) - s4@group-54E8E36963C5-StateMachineUpdater: set stopIndex = 7
2023-10-31 16:09:10,319 [MiniRaftCluster-14] INFO  server.GrpcService (GrpcService.java:closeImpl(311)) - s2: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService now
2023-10-31 16:09:10,320 [s4@group-54E8E36963C5-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(152)) - s4@group-54E8E36963C5-FollowerState was interrupted
2023-10-31 16:09:10,321 [s2-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$3(514)) - s2@group-54E8E36963C5: shutdown
2023-10-31 16:09:10,321 [s2-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-54E8E36963C5,id=s2
2023-10-31 16:09:10,321 [s2-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(109)) - s2: shutdown s2@group-54E8E36963C5-FollowerState
2023-10-31 16:09:10,321 [s2-impl-thread1] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(157)) - s2@group-54E8E36963C5-StateMachineUpdater: set stopIndex = 10
2023-10-31 16:09:10,321 [s2@group-54E8E36963C5-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(152)) - s2@group-54E8E36963C5-FollowerState was interrupted
2023-10-31 16:09:10,321 [s2-impl-thread1] INFO  server.RaftServer$Division (ServerState.java:close(423)) - s2@group-54E8E36963C5: applyIndex: 10
2023-10-31 16:09:10,321 [s4-impl-thread1] INFO  server.RaftServer$Division (ServerState.java:close(423)) - s4@group-54E8E36963C5: applyIndex: 7
2023-10-31 16:09:10,321 [s4@group-54E8E36963C5-cacheEviction-AwaitToRun] INFO  util.AwaitToRun (AwaitToRun.java:run(49)) - s4@group-54E8E36963C5-cacheEviction-AwaitToRun-AwaitForSignal is interrupted
2023-10-31 16:09:10,321 [s2@group-54E8E36963C5-cacheEviction-AwaitToRun] INFO  util.AwaitToRun (AwaitToRun.java:run(49)) - s2@group-54E8E36963C5-cacheEviction-AwaitToRun-AwaitForSignal is interrupted
2023-10-31 16:09:10,322 [Thread-1048] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:close(103)) - s3 Close channels
2023-10-31 16:09:10,322 [Thread-1050] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:close(103)) - s4 Close channels
2023-10-31 16:09:10,322 [Thread-1053] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:close(103)) - s1 Close channels
2023-10-31 16:09:10,328 [Thread-1054] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:close(103)) - s2 Close channels
2023-10-31 16:09:10,329 [MiniRaftCluster-12] INFO  server.GrpcService (GrpcService.java:closeImpl(320)) - s0: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService successfully
2023-10-31 16:09:10,329 [MiniRaftCluster-12] INFO  server.GrpcService (GrpcService.java:closeImpl(311)) - s0: shutdown server GrpcServerProtocolService now
2023-10-31 16:09:10,331 [Thread-1056] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:close(103)) - s0 Close channels
2023-10-31 16:09:10,332 [Thread-1058] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:close(103)) - s1 Close channels
2023-10-31 16:09:10,332 [Thread-1059] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:close(103)) - s2 Close channels
2023-10-31 16:09:10,332 [MiniRaftCluster-11] INFO  server.GrpcService (GrpcService.java:closeImpl(320)) - s4: shutdown server GrpcServerProtocolService successfully
2023-10-31 16:09:10,333 [Thread-1061] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:close(103)) - s0 Close channels
2023-10-31 16:09:10,334 [Thread-1062] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:close(103)) - s1 Close channels
2023-10-31 16:09:10,334 [MiniRaftCluster-14] INFO  server.GrpcService (GrpcService.java:closeImpl(320)) - s2: shutdown server org.apache.ratis.grpc.server.GrpcClientProtocolService successfully
2023-10-31 16:09:10,334 [MiniRaftCluster-14] INFO  server.GrpcService (GrpcService.java:closeImpl(311)) - s2: shutdown server GrpcServerProtocolService now
2023-10-31 16:09:10,340 [MiniRaftCluster-14] INFO  server.GrpcService (GrpcService.java:closeImpl(320)) - s2: shutdown server GrpcServerProtocolService successfully
2023-10-31 16:09:10,341 [MiniRaftCluster-14] INFO  server.GrpcService (GrpcService.java:closeImpl(311)) - s2: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService now
2023-10-31 16:09:10,341 [MiniRaftCluster-12] INFO  server.GrpcService (GrpcService.java:closeImpl(320)) - s0: shutdown server GrpcServerProtocolService successfully
2023-10-31 16:09:10,341 [MiniRaftCluster-12] INFO  server.GrpcService (GrpcService.java:closeImpl(311)) - s0: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService now
2023-10-31 16:09:10,343 [MiniRaftCluster-14] INFO  server.GrpcService (GrpcService.java:closeImpl(320)) - s2: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService successfully
2023-10-31 16:09:10,345 [grpc-default-executor-6] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s1@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.drainPendingCallbacks(DelayedClientCall.java:510)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$1DrainListenerRunnable.runInContext(DelayedClientCall.java:299)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 11 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 11 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:37189
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,351 [MiniRaftCluster-12] INFO  server.GrpcService (GrpcService.java:closeImpl(320)) - s0: shutdown server org.apache.ratis.grpc.server.GrpcAdminProtocolService successfully
2023-10-31 16:09:10,352 [JvmPauseMonitor9] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(152)) - JvmPauseMonitor-s0: Stopped
2023-10-31 16:09:10,450 [grpc-default-executor-1] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s0@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:37937
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,498 [s4-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(243)) - s4@group-54E8E36963C5-SegmentedRaftLogWorker close()
2023-10-31 16:09:10,498 [JvmPauseMonitor13] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(152)) - JvmPauseMonitor-s4: Stopped
2023-10-31 16:09:10,553 [grpc-default-executor-1] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s1@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.drainPendingCallbacks(DelayedClientCall.java:510)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$1DrainListenerRunnable.runInContext(DelayedClientCall.java:299)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 11 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 11 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:37189
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,657 [grpc-default-executor-6] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s2@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:42947
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,760 [grpc-default-executor-1] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s1@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:37189
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,865 [grpc-default-executor-4] ERROR impl.OrderedAsync (OrderedAsync.java:lambda$sendRequest$9(247)) - client-FD2E1031AE34: Failed* RaftClientRequest:client-FD2E1031AE34->s2@group-4D7A7540CAE6, cid=7, seq=2*, RW, m6
java.util.concurrent.CompletionException: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.completeReplyExceptionally(GrpcClientProtocolClient.java:394)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.access$000(GrpcClientProtocolClient.java:300)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:331)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:487)
	at org.apache.ratis.thirdparty.io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)
	at org.apache.ratis.thirdparty.io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)
	at org.apache.ratis.grpc.metrics.intercept.client.MetricClientCallListener.onClose(MetricClientCallListener.java:47)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener$3.run(DelayedClientCall.java:471)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.delayOrExecute(DelayedClientCall.java:435)
	at org.apache.ratis.thirdparty.io.grpc.internal.DelayedClientCall$DelayedListener.onClose(DelayedClientCall.java:468)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:563)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:70)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:744)
	at org.apache.ratis.thirdparty.io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:723)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:99)
	at org.apache.ratis.grpc.GrpcUtil.unwrapIOException(GrpcUtil.java:159)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers$1.onError(GrpcClientProtocolClient.java:330)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.Status.asRuntimeException(Status.java:539)
	... 16 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: localhost/127.0.0.1:42947
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.newConnectException0(Errors.java:155)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Errors.handleConnectErrno(Errors.java:128)
	at org.apache.ratis.thirdparty.io.netty.channel.unix.Socket.finishConnect(Socket.java:359)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:710)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:687)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:567)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:489)
	at org.apache.ratis.thirdparty.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:397)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at org.apache.ratis.thirdparty.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-10-31 16:09:10,913 [s3-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(243)) - s3@group-54E8E36963C5-SegmentedRaftLogWorker close()
2023-10-31 16:09:10,914 [s2-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(243)) - s2@group-54E8E36963C5-SegmentedRaftLogWorker close()
2023-10-31 16:09:10,914 [JvmPauseMonitor12] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(152)) - JvmPauseMonitor-s3: Stopped
2023-10-31 16:09:10,915 [JvmPauseMonitor11] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(152)) - JvmPauseMonitor-s2: Stopped
2023-10-31 16:09:10,915 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:shutdown(855)) - MiniRaftClusterWithGrpc shutdown completed
