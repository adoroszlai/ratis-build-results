<?xml version="1.0" encoding="UTF-8"?>
<testsuite xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="https://maven.apache.org/surefire/maven-surefire-plugin/xsd/surefire-test-report.xsd" name="org.apache.ratis.datastream.TestNettyDataStreamStarTopologyWithGrpcCluster" time="380.605" tests="4" errors="1" skipped="0" failures="0">
  <properties>
    <property name="awt.toolkit" value="sun.awt.X11.XToolkit"/>
    <property name="java.specification.version" value="11"/>
    <property name="sun.cpu.isalist" value=""/>
    <property name="sun.jnu.encoding" value="UTF-8"/>
    <property name="java.class.path" value="/home/runner/work/ratis/ratis/ratis-test/target/test-classes:/home/runner/work/ratis/ratis/ratis-test/target/classes:/home/runner/work/ratis/ratis/ratis-common/target/classes:/home/runner/.m2/repository/org/apache/ratis/ratis-thirdparty-misc/1.0.3/ratis-thirdparty-misc-1.0.3.jar:/home/runner/work/ratis/ratis/ratis-proto/target/ratis-proto-3.0.0-SNAPSHOT.jar:/home/runner/work/ratis/ratis/ratis-common/target/test-classes:/home/runner/work/ratis/ratis/ratis-client/target/classes:/home/runner/work/ratis/ratis/ratis-server/target/classes:/home/runner/work/ratis/ratis/ratis-server-api/target/classes:/home/runner/work/ratis/ratis/ratis-metrics-api/target/classes:/home/runner/work/ratis/ratis/ratis-server/target/test-classes:/home/runner/work/ratis/ratis/ratis-metrics-default/target/classes:/home/runner/work/ratis/ratis/ratis-netty/target/classes:/home/runner/work/ratis/ratis/ratis-netty/target/test-classes:/home/runner/work/ratis/ratis/ratis-grpc/target/classes:/home/runner/work/ratis/ratis/ratis-grpc/target/test-classes:/home/runner/work/ratis/ratis/ratis-shell/target/classes:/home/runner/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/runner/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/runner/.m2/repository/org/javassist/javassist/3.28.0-GA/javassist-3.28.0-GA.jar:/home/runner/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:/home/runner/.m2/repository/org/bouncycastle/bcprov-jdk15on/1.70/bcprov-jdk15on-1.70.jar:/home/runner/.m2/repository/org/bouncycastle/bcpkix-jdk15on/1.70/bcpkix-jdk15on-1.70.jar:/home/runner/.m2/repository/org/bouncycastle/bcutil-jdk15on/1.70/bcutil-jdk15on-1.70.jar:/home/runner/.m2/repository/org/slf4j/slf4j-api/1.7.36/slf4j-api-1.7.36.jar:/home/runner/.m2/repository/org/slf4j/slf4j-reload4j/1.7.36/slf4j-reload4j-1.7.36.jar:/home/runner/.m2/repository/ch/qos/reload4j/reload4j/1.2.19/reload4j-1.2.19.jar:/home/runner/.m2/repository/junit/junit/4.13.2/junit-4.13.2.jar:/home/runner/.m2/repository/org/hamcrest/hamcrest-core/1.3/hamcrest-core-1.3.jar:/home/runner/.m2/repository/org/mockito/mockito-core/4.3.1/mockito-core-4.3.1.jar:/home/runner/.m2/repository/net/bytebuddy/byte-buddy/1.12.7/byte-buddy-1.12.7.jar:/home/runner/.m2/repository/net/bytebuddy/byte-buddy-agent/1.12.7/byte-buddy-agent-1.12.7.jar:/home/runner/.m2/repository/org/objenesis/objenesis/3.2/objenesis-3.2.jar:"/>
    <property name="java.vm.vendor" value="Eclipse Adoptium"/>
    <property name="sun.arch.data.model" value="64"/>
    <property name="java.vendor.url" value="https://adoptium.net/"/>
    <property name="user.timezone" value=""/>
    <property name="java.vm.specification.version" value="11"/>
    <property name="os.name" value="Linux"/>
    <property name="sun.java.launcher" value="SUN_STANDARD"/>
    <property name="sun.boot.library.path" value="/usr/lib/jvm/temurin-11-jdk-amd64/lib"/>
    <property name="sun.java.command" value="/home/runner/work/ratis/ratis/ratis-test/target/surefire/surefirebooter8120111978817085712.jar /home/runner/work/ratis/ratis/ratis-test/target/surefire 2023-01-22T10-23-51_388-jvmRun1 surefire2721576852020188822tmp surefire_35178861476599575732tmp"/>
    <property name="jdk.debug" value="release"/>
    <property name="surefire.test.class.path" value="/home/runner/work/ratis/ratis/ratis-test/target/test-classes:/home/runner/work/ratis/ratis/ratis-test/target/classes:/home/runner/work/ratis/ratis/ratis-common/target/classes:/home/runner/.m2/repository/org/apache/ratis/ratis-thirdparty-misc/1.0.3/ratis-thirdparty-misc-1.0.3.jar:/home/runner/work/ratis/ratis/ratis-proto/target/ratis-proto-3.0.0-SNAPSHOT.jar:/home/runner/work/ratis/ratis/ratis-common/target/test-classes:/home/runner/work/ratis/ratis/ratis-client/target/classes:/home/runner/work/ratis/ratis/ratis-server/target/classes:/home/runner/work/ratis/ratis/ratis-server-api/target/classes:/home/runner/work/ratis/ratis/ratis-metrics-api/target/classes:/home/runner/work/ratis/ratis/ratis-server/target/test-classes:/home/runner/work/ratis/ratis/ratis-metrics-default/target/classes:/home/runner/work/ratis/ratis/ratis-netty/target/classes:/home/runner/work/ratis/ratis/ratis-netty/target/test-classes:/home/runner/work/ratis/ratis/ratis-grpc/target/classes:/home/runner/work/ratis/ratis/ratis-grpc/target/test-classes:/home/runner/work/ratis/ratis/ratis-shell/target/classes:/home/runner/.m2/repository/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar:/home/runner/.m2/repository/org/reflections/reflections/0.10.2/reflections-0.10.2.jar:/home/runner/.m2/repository/org/javassist/javassist/3.28.0-GA/javassist-3.28.0-GA.jar:/home/runner/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:/home/runner/.m2/repository/org/bouncycastle/bcprov-jdk15on/1.70/bcprov-jdk15on-1.70.jar:/home/runner/.m2/repository/org/bouncycastle/bcpkix-jdk15on/1.70/bcpkix-jdk15on-1.70.jar:/home/runner/.m2/repository/org/bouncycastle/bcutil-jdk15on/1.70/bcutil-jdk15on-1.70.jar:/home/runner/.m2/repository/org/slf4j/slf4j-api/1.7.36/slf4j-api-1.7.36.jar:/home/runner/.m2/repository/org/slf4j/slf4j-reload4j/1.7.36/slf4j-reload4j-1.7.36.jar:/home/runner/.m2/repository/ch/qos/reload4j/reload4j/1.2.19/reload4j-1.2.19.jar:/home/runner/.m2/repository/junit/junit/4.13.2/junit-4.13.2.jar:/home/runner/.m2/repository/org/hamcrest/hamcrest-core/1.3/hamcrest-core-1.3.jar:/home/runner/.m2/repository/org/mockito/mockito-core/4.3.1/mockito-core-4.3.1.jar:/home/runner/.m2/repository/net/bytebuddy/byte-buddy/1.12.7/byte-buddy-1.12.7.jar:/home/runner/.m2/repository/net/bytebuddy/byte-buddy-agent/1.12.7/byte-buddy-agent-1.12.7.jar:/home/runner/.m2/repository/org/objenesis/objenesis/3.2/objenesis-3.2.jar:"/>
    <property name="sun.cpu.endian" value="little"/>
    <property name="user.home" value="/home/runner"/>
    <property name="user.language" value="en"/>
    <property name="java.specification.vendor" value="Oracle Corporation"/>
    <property name="java.version.date" value="2022-10-18"/>
    <property name="java.home" value="/usr/lib/jvm/temurin-11-jdk-amd64"/>
    <property name="file.separator" value="/"/>
    <property name="basedir" value="/home/runner/work/ratis/ratis/ratis-test"/>
    <property name="java.vm.compressedOopsMode" value="32-bit"/>
    <property name="line.separator" value="&#10;"/>
    <property name="java.specification.name" value="Java Platform API Specification"/>
    <property name="java.vm.specification.vendor" value="Oracle Corporation"/>
    <property name="java.awt.graphicsenv" value="sun.awt.X11GraphicsEnvironment"/>
    <property name="surefire.real.class.path" value="/home/runner/work/ratis/ratis/ratis-test/target/surefire/surefirebooter8120111978817085712.jar"/>
    <property name="sun.management.compiler" value="HotSpot 64-Bit Tiered Compilers"/>
    <property name="java.runtime.version" value="11.0.17+8"/>
    <property name="user.name" value="runner"/>
    <property name="java.net.preferIPv4Stack" value="true"/>
    <property name="path.separator" value=":"/>
    <property name="os.version" value="5.15.0-1031-azure"/>
    <property name="java.runtime.name" value="OpenJDK Runtime Environment"/>
    <property name="file.encoding" value="UTF-8"/>
    <property name="java.vm.name" value="OpenJDK 64-Bit Server VM"/>
    <property name="java.vendor.version" value="Temurin-11.0.17+8"/>
    <property name="localRepository" value="/home/runner/.m2/repository"/>
    <property name="java.vendor.url.bug" value="https://github.com/adoptium/adoptium-support/issues"/>
    <property name="java.io.tmpdir" value="/tmp"/>
    <property name="java.version" value="11.0.17"/>
    <property name="user.dir" value="/home/runner/work/ratis/ratis/ratis-test"/>
    <property name="os.arch" value="amd64"/>
    <property name="ratis.tmp.dir" value="/home/runner/work/ratis/ratis/ratis-test/target/tmp"/>
    <property name="java.vm.specification.name" value="Java Virtual Machine Specification"/>
    <property name="java.awt.printerjob" value="sun.print.PSPrinterJob"/>
    <property name="ratis.log.dir" value="/home/runner/work/ratis/ratis/ratis-test/target/log"/>
    <property name="sun.os.patch.level" value="unknown"/>
    <property name="java.library.path" value="/usr/java/packages/lib:/usr/lib64:/lib64:/lib:/usr/lib"/>
    <property name="java.vm.info" value="mixed mode"/>
    <property name="java.vendor" value="Eclipse Adoptium"/>
    <property name="java.vm.version" value="11.0.17+8"/>
    <property name="sun.io.unicode.encoding" value="UnicodeLittle"/>
    <property name="java.class.version" value="55.0"/>
  </properties>
  <testcase name="testMultipleStreamsSingleServer" classname="org.apache.ratis.datastream.TestNettyDataStreamStarTopologyWithGrpcCluster" time="14.299"/>
  <testcase name="testMultipleStreamsMultipleServers" classname="org.apache.ratis.datastream.TestNettyDataStreamStarTopologyWithGrpcCluster" time="61.432"/>
  <testcase name="testMultipleStreamsMultipleServersStepDownLeader" classname="org.apache.ratis.datastream.TestNettyDataStreamStarTopologyWithGrpcCluster" time="300.012">
    <error message="test timed out after 300 seconds" type="org.junit.runners.model.TestTimedOutException">org.junit.runners.model.TestTimedOutException: test timed out after 300 seconds
	at java.base@11.0.17/jdk.internal.misc.Unsafe.park(Native Method)
	at java.base@11.0.17/java.util.concurrent.locks.LockSupport.park(LockSupport.java:194)
	at java.base@11.0.17/java.util.concurrent.CompletableFuture$Signaller.block(CompletableFuture.java:1796)
	at java.base@11.0.17/java.util.concurrent.ForkJoinPool.managedBlock(ForkJoinPool.java:3128)
	at java.base@11.0.17/java.util.concurrent.CompletableFuture.waitingGet(CompletableFuture.java:1823)
	at java.base@11.0.17/java.util.concurrent.CompletableFuture.join(CompletableFuture.java:2043)
	at app//org.apache.ratis.datastream.DataStreamAsyncClusterTests$$Lambda$516/0x0000000100341040.apply(Unknown Source)
	at java.base@11.0.17/java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:195)
	at java.base@11.0.17/java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1655)
	at java.base@11.0.17/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:484)
	at java.base@11.0.17/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:474)
	at java.base@11.0.17/java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:913)
	at java.base@11.0.17/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.base@11.0.17/java.util.stream.ReferencePipeline.reduce(ReferencePipeline.java:558)
	at java.base@11.0.17/java.util.stream.ReferencePipeline.max(ReferencePipeline.java:594)
	at app//org.apache.ratis.datastream.DataStreamAsyncClusterTests.runTestDataStream(DataStreamAsyncClusterTests.java:97)
	at app//org.apache.ratis.datastream.DataStreamAsyncClusterTests.runTestDataStreamStepDownLeader(DataStreamAsyncClusterTests.java:82)
	at app//org.apache.ratis.datastream.DataStreamAsyncClusterTests$$Lambda$963/0x00000001004a5440.accept(Unknown Source)
	at app//org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:141)
	at app//org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:121)
	at app//org.apache.ratis.datastream.DataStreamAsyncClusterTests.testMultipleStreamsMultipleServersStepDownLeader(DataStreamAsyncClusterTests.java:78)
	at java.base@11.0.17/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base@11.0.17/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base@11.0.17/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base@11.0.17/java.lang.reflect.Method.invoke(Method.java:566)
	at app//org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at app//org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at app//org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at app//org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at app//org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at app//org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at app//org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at app//org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.base@11.0.17/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base@11.0.17/java.lang.Thread.run(Thread.java:829)
</error>
    <system-out><![CDATA[2023-01-22 10:25:53,851 [main] INFO  util.LogUtils (Slf4jUtils.java:setLogLevel(38)) - Successfully set org.apache.ratis.conf.ConfUtils log level to WARN
2023-01-22 10:25:53,851 [main] INFO  util.LogUtils (Slf4jUtils.java:setLogLevel(38)) - Successfully set org.apache.ratis.util.FileUtils log level to TRACE
2023-01-22 10:25:53,856 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:runWithNewCluster(135)) - Running runWithNewCluster
2023-01-22 10:25:53,857 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:<init>(306)) - new MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty with group-4446C9F0D259:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]
2023-01-22 10:25:53,857 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(339)) - .............................................................. 
2023-01-22 10:25:53,857 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(340)) - ... 
2023-01-22 10:25:53,857 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(341)) - ...     Starting MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty
2023-01-22 10:25:53,857 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(342)) - ... 
2023-01-22 10:25:53,857 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:start(343)) - .............................................................. 
2023-01-22 10:25:53,857 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:initServers(318)) - servers = {}
2023-01-22 10:25:53,857 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(382)) - newRaftServer: s0, group-4446C9F0D259:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER], format? true
2023-01-22 10:25:53,857 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(201)) - deleteFully target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s0
2023-01-22 10:25:53,857 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(217)) - deleteFully: target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s0 does not exist.
2023-01-22 10:25:53,857 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(387)) - Formatted directory target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s0
2023-01-22 10:25:53,859 [Time-limited test] INFO  server.RaftServer (ConfUtils.java:logGet(46)) - raft.rpc.type = GRPC (default)
2023-01-22 10:25:53,860 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.admin.host = null (fallback to raft.grpc.server.host)
2023-01-22 10:25:53,860 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.admin.port = 38755 (custom)
2023-01-22 10:25:53,860 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.client.host = null (fallback to raft.grpc.server.host)
2023-01-22 10:25:53,860 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.client.port = 42097 (custom)
2023-01-22 10:25:53,860 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.host = null (default)
2023-01-22 10:25:53,860 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.port = 42029 (custom)
2023-01-22 10:25:53,860 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.message.size.max = 64MB (=67108864) (default)
2023-01-22 10:25:53,860 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-01-22 10:25:53,860 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2023-01-22 10:25:53,860 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-01-22 10:25:53,860 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-01-22 10:25:53,860 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.cached = true (default)
2023-01-22 10:25:53,860 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.size = 32 (default)
2023-01-22 10:25:53,863 [Time-limited test] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:53,863 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.data-stream.async.request.thread.pool.cached = false (default)
2023-01-22 10:25:53,863 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.data-stream.async.request.thread.pool.size = 32 (default)
2023-01-22 10:25:53,863 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.data-stream.async.write.thread.pool.size = 16 (default)
2023-01-22 10:25:53,863 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.data-stream.client.pool.size = 10 (default)
2023-01-22 10:25:53,863 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.server.use-epoll = false (default)
2023-01-22 10:25:53,863 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.server.boss-group.size = 0 (default)
2023-01-22 10:25:53,864 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.server.worker-group.size = 0 (default)
2023-01-22 10:25:53,864 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.server.tls.conf = null (default)
2023-01-22 10:25:53,864 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.host = null (default)
2023-01-22 10:25:53,864 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.port = 46279 (custom)
2023-01-22 10:25:53,865 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.cached = true (default)
2023-01-22 10:25:53,865 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.size = 0 (default)
2023-01-22 10:25:53,865 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2023-01-22 10:25:53,865 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2023-01-22 10:25:53,865 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s0] (custom)
2023-01-22 10:25:53,865 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd3172420] REGISTERED
2023-01-22 10:25:53,869 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd3172420] BIND: 0.0.0.0/0.0.0.0:46279
2023-01-22 10:25:53,869 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd3172420, L:/0.0.0.0:46279] ACTIVE
2023-01-22 10:25:53,869 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:addNew(99)) - s0: addNew group-4446C9F0D259:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER] returns group-4446C9F0D259:java.util.concurrent.CompletableFuture@6caf4cc7[Not completed]
2023-01-22 10:25:53,869 [pool-10-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(198)) - s0: new RaftServerImpl for group-4446C9F0D259:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER] with MultiDataStreamStateMachine:uninitialized
2023-01-22 10:25:53,869 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.min = 150ms (default)
2023-01-22 10:25:53,870 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2023-01-22 10:25:53,870 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.sleep.time = 25ms (default)
2023-01-22 10:25:53,870 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2023-01-22 10:25:53,870 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2023-01-22 10:25:53,870 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(382)) - newRaftServer: s1, group-4446C9F0D259:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER], format? true
2023-01-22 10:25:53,875 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(201)) - deleteFully target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s1
2023-01-22 10:25:53,875 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(217)) - deleteFully: target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s1 does not exist.
2023-01-22 10:25:53,875 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(387)) - Formatted directory target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s1
2023-01-22 10:25:53,875 [Time-limited test] INFO  server.RaftServer (ConfUtils.java:logGet(46)) - raft.rpc.type = GRPC (default)
2023-01-22 10:25:53,875 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.admin.host = null (fallback to raft.grpc.server.host)
2023-01-22 10:25:53,875 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.admin.port = 46179 (custom)
2023-01-22 10:25:53,875 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.client.host = null (fallback to raft.grpc.server.host)
2023-01-22 10:25:53,876 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.client.port = 36677 (custom)
2023-01-22 10:25:53,876 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.host = null (default)
2023-01-22 10:25:53,876 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.port = 35183 (custom)
2023-01-22 10:25:53,876 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.message.size.max = 64MB (=67108864) (default)
2023-01-22 10:25:53,876 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-01-22 10:25:53,876 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2023-01-22 10:25:53,876 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-01-22 10:25:53,876 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-01-22 10:25:53,876 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.cached = true (default)
2023-01-22 10:25:53,876 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.size = 32 (default)
2023-01-22 10:25:53,877 [Time-limited test] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:53,877 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.data-stream.async.request.thread.pool.cached = false (default)
2023-01-22 10:25:53,877 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.data-stream.async.request.thread.pool.size = 32 (default)
2023-01-22 10:25:53,877 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.data-stream.async.write.thread.pool.size = 16 (default)
2023-01-22 10:25:53,877 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.data-stream.client.pool.size = 10 (default)
2023-01-22 10:25:53,877 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.server.use-epoll = false (default)
2023-01-22 10:25:53,877 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.server.boss-group.size = 0 (default)
2023-01-22 10:25:53,877 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.server.worker-group.size = 0 (default)
2023-01-22 10:25:53,878 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.server.tls.conf = null (default)
2023-01-22 10:25:53,878 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.host = null (default)
2023-01-22 10:25:53,878 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.port = 46499 (custom)
2023-01-22 10:25:53,879 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.cached = true (default)
2023-01-22 10:25:53,879 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.size = 0 (default)
2023-01-22 10:25:53,879 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2023-01-22 10:25:53,879 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2023-01-22 10:25:53,879 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s1] (custom)
2023-01-22 10:25:53,879 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xdc9b03da] REGISTERED
2023-01-22 10:25:53,880 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:addNew(99)) - s1: addNew group-4446C9F0D259:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER] returns group-4446C9F0D259:java.util.concurrent.CompletableFuture@10d35915[Not completed]
2023-01-22 10:25:53,879 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.sleep.deviation.threshold = 300ms (default)
2023-01-22 10:25:53,880 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xdc9b03da] BIND: 0.0.0.0/0.0.0.0:46499
2023-01-22 10:25:53,882 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xdc9b03da, L:/0.0.0.0:46499] ACTIVE
2023-01-22 10:25:53,882 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(382)) - newRaftServer: s2, group-4446C9F0D259:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER], format? true
2023-01-22 10:25:53,882 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(201)) - deleteFully target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s2
2023-01-22 10:25:53,882 [Time-limited test] TRACE util.FileUtils (FileUtils.java:deleteFully(217)) - deleteFully: target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s2 does not exist.
2023-01-22 10:25:53,883 [Time-limited test] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(387)) - Formatted directory target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s2
2023-01-22 10:25:53,883 [Time-limited test] INFO  server.RaftServer (ConfUtils.java:logGet(46)) - raft.rpc.type = GRPC (default)
2023-01-22 10:25:53,883 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.admin.host = null (fallback to raft.grpc.server.host)
2023-01-22 10:25:53,883 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.admin.port = 37461 (custom)
2023-01-22 10:25:53,883 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logFallback(53)) - raft.grpc.client.host = null (fallback to raft.grpc.server.host)
2023-01-22 10:25:53,883 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.client.port = 38577 (custom)
2023-01-22 10:25:53,883 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.host = null (default)
2023-01-22 10:25:53,883 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.port = 36837 (custom)
2023-01-22 10:25:53,883 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.message.size.max = 64MB (=67108864) (default)
2023-01-22 10:25:53,883 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-01-22 10:25:53,883 [Time-limited test] INFO  server.GrpcService (ConfUtils.java:logGet(46)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2023-01-22 10:25:53,883 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-01-22 10:25:53,883 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-01-22 10:25:53,883 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.cached = true (default)
2023-01-22 10:25:53,883 [Time-limited test] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.async.request.thread.pool.size = 32 (default)
2023-01-22 10:25:53,884 [Time-limited test] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:53,885 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.data-stream.async.request.thread.pool.cached = false (default)
2023-01-22 10:25:53,885 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.data-stream.async.request.thread.pool.size = 32 (default)
2023-01-22 10:25:53,885 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.data-stream.async.write.thread.pool.size = 16 (default)
2023-01-22 10:25:53,885 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.data-stream.client.pool.size = 10 (default)
2023-01-22 10:25:53,885 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.server.use-epoll = false (default)
2023-01-22 10:25:53,885 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.server.boss-group.size = 0 (default)
2023-01-22 10:25:53,881 [pool-11-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(198)) - s1: new RaftServerImpl for group-4446C9F0D259:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER] with MultiDataStreamStateMachine:uninitialized
2023-01-22 10:25:53,886 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.min = 150ms (default)
2023-01-22 10:25:53,886 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2023-01-22 10:25:53,886 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.sleep.time = 25ms (default)
2023-01-22 10:25:53,886 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2023-01-22 10:25:53,886 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2023-01-22 10:25:53,886 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.sleep.deviation.threshold = 300ms (default)
2023-01-22 10:25:53,886 [pool-11-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(113)) - s1@group-4446C9F0D259: ConfigurationManager, init=-1: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null, confs=<EMPTY_MAP>
2023-01-22 10:25:53,882 [pool-10-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(113)) - s0@group-4446C9F0D259: ConfigurationManager, init=-1: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null, confs=<EMPTY_MAP>
2023-01-22 10:25:53,886 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.notification.no-leader.timeout = 60s (default)
2023-01-22 10:25:53,887 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.timeout = 10s (default)
2023-01-22 10:25:53,887 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.expirytime = 60s (default)
2023-01-22 10:25:53,887 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2023-01-22 10:25:53,887 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.option = DEFAULT (default)
2023-01-22 10:25:53,886 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.notification.no-leader.timeout = 60s (default)
2023-01-22 10:25:53,889 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.timeout = 10s (default)
2023-01-22 10:25:53,889 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.expirytime = 60s (default)
2023-01-22 10:25:53,889 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2023-01-22 10:25:53,889 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.option = DEFAULT (default)
2023-01-22 10:25:53,888 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.server.worker-group.size = 0 (default)
2023-01-22 10:25:53,890 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.server.tls.conf = null (default)
2023-01-22 10:25:53,891 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.host = null (default)
2023-01-22 10:25:53,891 [Time-limited test] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.port = 32781 (custom)
2023-01-22 10:25:53,893 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-01-22 10:25:53,893 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.cached = true (default)
2023-01-22 10:25:53,893 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.size = 0 (default)
2023-01-22 10:25:53,893 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.cached = true (default)
2023-01-22 10:25:53,893 [pool-10-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.size = 0 (default)
2023-01-22 10:25:53,893 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-01-22 10:25:53,893 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.cached = true (default)
2023-01-22 10:25:53,893 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.size = 0 (default)
2023-01-22 10:25:53,893 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.cached = true (default)
2023-01-22 10:25:53,893 [pool-11-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.size = 0 (default)
2023-01-22 10:25:53,896 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.cached = true (default)
2023-01-22 10:25:53,896 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.proxy.size = 0 (default)
2023-01-22 10:25:53,896 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2023-01-22 10:25:53,896 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2023-01-22 10:25:53,897 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s2] (custom)
2023-01-22 10:25:53,897 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd6bb0a2e] REGISTERED
2023-01-22 10:25:53,897 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd6bb0a2e] BIND: 0.0.0.0/0.0.0.0:32781
2023-01-22 10:25:53,897 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd6bb0a2e, L:/0.0.0.0:32781] ACTIVE
2023-01-22 10:25:53,905 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:addNew(99)) - s2: addNew group-4446C9F0D259:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER] returns group-4446C9F0D259:java.util.concurrent.CompletableFuture@30eee2b2[Not completed]
2023-01-22 10:25:53,906 [pool-12-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(198)) - s2: new RaftServerImpl for group-4446C9F0D259:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER] with MultiDataStreamStateMachine:uninitialized
2023-01-22 10:25:53,906 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2023-01-22 10:25:53,912 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.corruption.policy = EXCEPTION (default)
2023-01-22 10:25:53,912 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s0] (custom)
2023-01-22 10:25:53,913 [s0-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(138)) - The storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s0/413bbc71-f185-43d2-9989-4446c9f0d259 does not exist. Creating ...
2023-01-22 10:25:53,913 [s0-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s0/413bbc71-f185-43d2-9989-4446c9f0d259
2023-01-22 10:25:53,913 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.min = 150ms (default)
2023-01-22 10:25:53,914 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2023-01-22 10:25:53,914 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.sleep.time = 25ms (default)
2023-01-22 10:25:53,914 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.slowness.timeout = 60s (default)
2023-01-22 10:25:53,914 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2023-01-22 10:25:53,914 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.sleep.deviation.threshold = 300ms (default)
2023-01-22 10:25:53,914 [pool-12-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(113)) - s2@group-4446C9F0D259: ConfigurationManager, init=-1: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null, confs=<EMPTY_MAP>
2023-01-22 10:25:53,914 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.notification.no-leader.timeout = 60s (default)
2023-01-22 10:25:53,914 [s0-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(232)) - Lock on /home/runner/work/ratis/ratis/ratis-test/target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s0/413bbc71-f185-43d2-9989-4446c9f0d259/in_use.lock acquired by nodename 2337@fv-az937-841
2023-01-22 10:25:53,915 [s0-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s0/413bbc71-f185-43d2-9989-4446c9f0d259/current
2023-01-22 10:25:53,915 [s0-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s0/413bbc71-f185-43d2-9989-4446c9f0d259/sm
2023-01-22 10:25:53,914 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.timeout = 10s (default)
2023-01-22 10:25:53,916 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.expirytime = 60s (default)
2023-01-22 10:25:53,916 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2023-01-22 10:25:53,916 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.read.option = DEFAULT (default)
2023-01-22 10:25:53,917 [s0-impl-thread1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(96)) - Storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s0/413bbc71-f185-43d2-9989-4446c9f0d259 has been successfully formatted.
2023-01-22 10:25:53,917 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.use.memory = false (default)
2023-01-22 10:25:53,917 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.gap = 1024 (default)
2023-01-22 10:25:53,917 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-01-22 10:25:53,917 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.read.timeout = 1000ms (default)
2023-01-22 10:25:53,917 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.preservation.log.num = 0 (default)
2023-01-22 10:25:53,920 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 8MB (=8388608) (default)
2023-01-22 10:25:53,920 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.num.max = 6 (default)
2023-01-22 10:25:53,920 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2023-01-22 10:25:53,921 [s0-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(184)) - new s0@group-4446C9F0D259-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s0/413bbc71-f185-43d2-9989-4446c9f0d259
2023-01-22 10:25:53,921 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2023-01-22 10:25:53,921 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.element-limit = 4096 (default)
2023-01-22 10:25:53,921 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 8MB (=8388608) (default)
2023-01-22 10:25:53,921 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2023-01-22 10:25:53,921 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.force.sync.num = 128 (default)
2023-01-22 10:25:53,921 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync = true (default)
2023-01-22 10:25:53,921 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2023-01-22 10:25:53,921 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2023-01-22 10:25:53,921 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2023-01-22 10:25:53,921 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-01-22 10:25:53,922 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.unsafe-flush.enabled = false (default)
2023-01-22 10:25:53,922 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.async-flush.enabled = false (default)
2023-01-22 10:25:53,922 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.caching.enabled = false (default)
2023-01-22 10:25:53,922 [s0-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(134)) - s0@group-4446C9F0D259-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2023-01-22 10:25:53,922 [s0-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(134)) - s0@group-4446C9F0D259-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2023-01-22 10:25:53,923 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-01-22 10:25:53,923 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.cached = true (default)
2023-01-22 10:25:53,923 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.server.size = 0 (default)
2023-01-22 10:25:53,923 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.cached = true (default)
2023-01-22 10:25:53,923 [pool-12-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.threadpool.client.size = 0 (default)
2023-01-22 10:25:53,926 [s0-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(338)) - s0@group-4446C9F0D259: start as a follower, conf=-1: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2023-01-22 10:25:53,926 [s0-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s0@group-4446C9F0D259: changes role from      null to FOLLOWER at term 0 for startAsFollower
2023-01-22 10:25:53,926 [s0-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-4446C9F0D259-FollowerState
2023-01-22 10:25:53,930 [s0-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-4446C9F0D259,id=s0
2023-01-22 10:25:53,930 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.auto.trigger.enabled = false (default)
2023-01-22 10:25:53,930 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.retention.file.num = -1 (default)
2023-01-22 10:25:53,930 [s0-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.upto.snapshot.index = false (default)
2023-01-22 10:25:53,930 [s0@group-4446C9F0D259-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2023-01-22 10:25:53,931 [s0@group-4446C9F0D259-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2023-01-22 10:25:53,931 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:startImpl(396)) - s0: start RPC server
2023-01-22 10:25:53,933 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s0: GrpcService started, listening on 42097
2023-01-22 10:25:53,935 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s0: GrpcService started, listening on 42029
2023-01-22 10:25:53,936 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s0: GrpcService started, listening on 38755
2023-01-22 10:25:53,937 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2023-01-22 10:25:53,937 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.corruption.policy = EXCEPTION (default)
2023-01-22 10:25:53,937 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s1] (custom)
2023-01-22 10:25:53,938 [s1-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(138)) - The storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s1/413bbc71-f185-43d2-9989-4446c9f0d259 does not exist. Creating ...
2023-01-22 10:25:53,938 [s1-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s1/413bbc71-f185-43d2-9989-4446c9f0d259
2023-01-22 10:25:53,938 [JvmPauseMonitor4] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(105)) - JvmPauseMonitor-s0: Started
2023-01-22 10:25:53,939 [s1-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(232)) - Lock on /home/runner/work/ratis/ratis/ratis-test/target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s1/413bbc71-f185-43d2-9989-4446c9f0d259/in_use.lock acquired by nodename 2337@fv-az937-841
2023-01-22 10:25:53,939 [s1-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s1/413bbc71-f185-43d2-9989-4446c9f0d259/current
2023-01-22 10:25:53,939 [s1-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s1/413bbc71-f185-43d2-9989-4446c9f0d259/sm
2023-01-22 10:25:53,941 [s1-impl-thread1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(96)) - Storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s1/413bbc71-f185-43d2-9989-4446c9f0d259 has been successfully formatted.
2023-01-22 10:25:53,941 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.use.memory = false (default)
2023-01-22 10:25:53,941 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.gap = 1024 (default)
2023-01-22 10:25:53,941 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-01-22 10:25:53,941 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.read.timeout = 1000ms (default)
2023-01-22 10:25:53,941 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.preservation.log.num = 0 (default)
2023-01-22 10:25:53,942 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 8MB (=8388608) (default)
2023-01-22 10:25:53,942 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.num.max = 6 (default)
2023-01-22 10:25:53,942 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2023-01-22 10:25:53,942 [s1-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(184)) - new s1@group-4446C9F0D259-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s1/413bbc71-f185-43d2-9989-4446c9f0d259
2023-01-22 10:25:53,942 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2023-01-22 10:25:53,942 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.element-limit = 4096 (default)
2023-01-22 10:25:53,942 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 8MB (=8388608) (default)
2023-01-22 10:25:53,942 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2023-01-22 10:25:53,942 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.force.sync.num = 128 (default)
2023-01-22 10:25:53,942 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync = true (default)
2023-01-22 10:25:53,943 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2023-01-22 10:25:53,943 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2023-01-22 10:25:53,943 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2023-01-22 10:25:53,943 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-01-22 10:25:53,944 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.unsafe-flush.enabled = false (default)
2023-01-22 10:25:53,944 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.async-flush.enabled = false (default)
2023-01-22 10:25:53,944 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.caching.enabled = false (default)
2023-01-22 10:25:53,944 [s1-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(134)) - s1@group-4446C9F0D259-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2023-01-22 10:25:53,944 [s1-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(134)) - s1@group-4446C9F0D259-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2023-01-22 10:25:53,944 [s1-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(338)) - s1@group-4446C9F0D259: start as a follower, conf=-1: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2023-01-22 10:25:53,945 [s1-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s1@group-4446C9F0D259: changes role from      null to FOLLOWER at term 0 for startAsFollower
2023-01-22 10:25:53,945 [s1-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s1: start s1@group-4446C9F0D259-FollowerState
2023-01-22 10:25:53,945 [s1-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-4446C9F0D259,id=s1
2023-01-22 10:25:53,945 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.auto.trigger.enabled = false (default)
2023-01-22 10:25:53,945 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.retention.file.num = -1 (default)
2023-01-22 10:25:53,945 [s1-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.upto.snapshot.index = false (default)
2023-01-22 10:25:53,946 [s1@group-4446C9F0D259-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2023-01-22 10:25:53,946 [s1@group-4446C9F0D259-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2023-01-22 10:25:53,947 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:startImpl(396)) - s1: start RPC server
2023-01-22 10:25:53,949 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s1: GrpcService started, listening on 36677
2023-01-22 10:25:53,951 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s1: GrpcService started, listening on 35183
2023-01-22 10:25:53,953 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s1: GrpcService started, listening on 46179
2023-01-22 10:25:53,958 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2023-01-22 10:25:53,958 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.corruption.policy = EXCEPTION (default)
2023-01-22 10:25:53,958 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.storage.dir = [/home/runner/work/ratis/ratis/ratis-test/target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s2] (custom)
2023-01-22 10:25:53,958 [s2-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(138)) - The storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s2/413bbc71-f185-43d2-9989-4446c9f0d259 does not exist. Creating ...
2023-01-22 10:25:53,958 [s2-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s2/413bbc71-f185-43d2-9989-4446c9f0d259
2023-01-22 10:25:53,959 [JvmPauseMonitor5] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(105)) - JvmPauseMonitor-s1: Started
2023-01-22 10:25:53,960 [s2-impl-thread1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(232)) - Lock on /home/runner/work/ratis/ratis/ratis-test/target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s2/413bbc71-f185-43d2-9989-4446c9f0d259/in_use.lock acquired by nodename 2337@fv-az937-841
2023-01-22 10:25:53,960 [s2-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s2/413bbc71-f185-43d2-9989-4446c9f0d259/current
2023-01-22 10:25:53,960 [s2-impl-thread1] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Files.createDirectories /home/runner/work/ratis/ratis/ratis-test/target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s2/413bbc71-f185-43d2-9989-4446c9f0d259/sm
2023-01-22 10:25:53,963 [s2-impl-thread1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(96)) - Storage directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s2/413bbc71-f185-43d2-9989-4446c9f0d259 has been successfully formatted.
2023-01-22 10:25:53,963 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.use.memory = false (default)
2023-01-22 10:25:53,963 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.gap = 1024 (default)
2023-01-22 10:25:53,963 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-01-22 10:25:53,963 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.read.timeout = 1000ms (default)
2023-01-22 10:25:53,963 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.preservation.log.num = 0 (default)
2023-01-22 10:25:53,964 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 8MB (=8388608) (default)
2023-01-22 10:25:53,964 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.num.max = 6 (default)
2023-01-22 10:25:53,964 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2023-01-22 10:25:53,964 [s2-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(184)) - new s2@group-4446C9F0D259-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ratis/ratis/ratis-test/target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s2/413bbc71-f185-43d2-9989-4446c9f0d259
2023-01-22 10:25:53,964 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2023-01-22 10:25:53,964 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.queue.element-limit = 4096 (default)
2023-01-22 10:25:53,964 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.segment.size.max = 8MB (=8388608) (default)
2023-01-22 10:25:53,964 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2023-01-22 10:25:53,964 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.force.sync.num = 128 (default)
2023-01-22 10:25:53,964 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync = true (default)
2023-01-22 10:25:53,964 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2023-01-22 10:25:53,964 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2023-01-22 10:25:53,964 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2023-01-22 10:25:53,964 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-01-22 10:25:53,965 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.unsafe-flush.enabled = false (default)
2023-01-22 10:25:53,965 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.async-flush.enabled = false (default)
2023-01-22 10:25:53,965 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.statemachine.data.caching.enabled = false (default)
2023-01-22 10:25:53,966 [s2-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(134)) - s2@group-4446C9F0D259-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2023-01-22 10:25:53,966 [s2-impl-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(134)) - s2@group-4446C9F0D259-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2023-01-22 10:25:53,966 [s2-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(338)) - s2@group-4446C9F0D259: start as a follower, conf=-1: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2023-01-22 10:25:53,966 [s2-impl-thread1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s2@group-4446C9F0D259: changes role from      null to FOLLOWER at term 0 for startAsFollower
2023-01-22 10:25:53,966 [s2-impl-thread1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s2: start s2@group-4446C9F0D259-FollowerState
2023-01-22 10:25:53,966 [s2-impl-thread1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-4446C9F0D259,id=s2
2023-01-22 10:25:53,967 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.auto.trigger.enabled = false (default)
2023-01-22 10:25:53,967 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.snapshot.retention.file.num = -1 (default)
2023-01-22 10:25:53,967 [s2-impl-thread1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.purge.upto.snapshot.index = false (default)
2023-01-22 10:25:53,967 [s2@group-4446C9F0D259-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2023-01-22 10:25:53,970 [s2@group-4446C9F0D259-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2023-01-22 10:25:53,970 [Time-limited test] INFO  server.RaftServer (RaftServerProxy.java:startImpl(396)) - s2: start RPC server
2023-01-22 10:25:53,972 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s2: GrpcService started, listening on 38577
2023-01-22 10:25:53,981 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s2: GrpcService started, listening on 36837
2023-01-22 10:25:53,983 [Time-limited test] INFO  server.GrpcService (GrpcService.java:startImpl(302)) - s2: GrpcService started, listening on 37461
2023-01-22 10:25:53,983 [JvmPauseMonitor6] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(105)) - JvmPauseMonitor-s2: Started
2023-01-22 10:25:53,992 [Time-limited test] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2023-01-22 10:25:53,992 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(100)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-4446C9F0D259:t0, leader=null, voted=, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4446C9F0D259:t0, leader=null, voted=, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-4446C9F0D259:t0, leader=null, voted=, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2023-01-22 10:25:53,992 [Time-limited test] WARN  ratis.RaftTestUtil (JavaUtils.java:attempt(217)) - FAILED "waitForLeader-null-(expectLeader? true)", attempt #1/100: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-4446C9F0D259:t0, leader=null, voted=, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4446C9F0D259:t0, leader=null, voted=, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-4446C9F0D259:t0, leader=null, voted=, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING, sleep 450ms and then retry.
java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-4446C9F0D259:t0, leader=null, voted=, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4446C9F0D259:t0, leader=null, voted=, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-4446C9F0D259:t0, leader=null, voted=, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
	at org.apache.ratis.server.impl.MiniRaftCluster.newIllegalStateExceptionForNoLeaders(MiniRaftCluster.java:581)
	at org.apache.ratis.RaftTestUtil.lambda$waitForLeader$1(RaftTestUtil.java:104)
	at org.apache.ratis.server.impl.MiniRaftCluster.getLeader(MiniRaftCluster.java:615)
	at org.apache.ratis.server.impl.MiniRaftCluster.getLeader(MiniRaftCluster.java:608)
	at org.apache.ratis.RaftTestUtil.lambda$waitForLeader$3(RaftTestUtil.java:112)
	at org.apache.ratis.util.JavaUtils.attempt(JavaUtils.java:211)
	at org.apache.ratis.util.JavaUtils.attemptRepeatedly(JavaUtils.java:197)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:111)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:92)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:87)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.runTestDataStream(DataStreamAsyncClusterTests.java:90)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.runTestDataStreamStepDownLeader(DataStreamAsyncClusterTests.java:82)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:141)
	at org.apache.ratis.server.impl.MiniRaftCluster$Factory$Get.runWithNewCluster(MiniRaftCluster.java:121)
	at org.apache.ratis.datastream.DataStreamAsyncClusterTests.testMultipleStreamsMultipleServersStepDownLeader(DataStreamAsyncClusterTests.java:78)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-01-22 10:25:54,120 [s2@group-4446C9F0D259-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s2@group-4446C9F0D259-FollowerState: change to CANDIDATE, lastRpcElapsedTime:154135316ns, electionTimeout:150ms
2023-01-22 10:25:54,125 [s2@group-4446C9F0D259-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s2: shutdown s2@group-4446C9F0D259-FollowerState
2023-01-22 10:25:54,125 [s2@group-4446C9F0D259-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s2@group-4446C9F0D259: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2023-01-22 10:25:54,126 [s2@group-4446C9F0D259-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2023-01-22 10:25:54,126 [s2@group-4446C9F0D259-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s2: start s2@group-4446C9F0D259-LeaderElection3
2023-01-22 10:25:54,130 [s1@group-4446C9F0D259-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s1@group-4446C9F0D259-FollowerState: change to CANDIDATE, lastRpcElapsedTime:184999780ns, electionTimeout:175ms
2023-01-22 10:25:54,130 [s1@group-4446C9F0D259-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s1: shutdown s1@group-4446C9F0D259-FollowerState
2023-01-22 10:25:54,130 [s1@group-4446C9F0D259-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s1@group-4446C9F0D259: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2023-01-22 10:25:54,131 [s2@group-4446C9F0D259-LeaderElection3] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(309)) - s2@group-4446C9F0D259-LeaderElection3 PRE_VOTE round 0: submit vote requests at term 0 for -1: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2023-01-22 10:25:54,131 [s2@group-4446C9F0D259-LeaderElection3-1] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(63)) - Build channel for s0
2023-01-22 10:25:54,131 [s1@group-4446C9F0D259-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2023-01-22 10:25:54,135 [s1@group-4446C9F0D259-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s1: start s1@group-4446C9F0D259-LeaderElection4
2023-01-22 10:25:54,134 [s2@group-4446C9F0D259-LeaderElection3-2] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(63)) - Build channel for s1
2023-01-22 10:25:54,134 [s2@group-4446C9F0D259-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2023-01-22 10:25:54,136 [s2@group-4446C9F0D259-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2023-01-22 10:25:54,139 [s1@group-4446C9F0D259-LeaderElection4] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(309)) - s1@group-4446C9F0D259-LeaderElection4 PRE_VOTE round 0: submit vote requests at term 0 for -1: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2023-01-22 10:25:54,141 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1298)) - s0@group-4446C9F0D259: receive requestVote(PRE_VOTE, s2, group-4446C9F0D259, 0, (t:0, i:0))
2023-01-22 10:25:54,141 [grpc-default-executor-6] INFO  impl.VoteContext (VoteContext.java:log(49)) - s0@group-4446C9F0D259-FOLLOWER: accept PRE_VOTE from s2: our priority 0 <= candidate's priority 0
2023-01-22 10:25:54,141 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1331)) - s0@group-4446C9F0D259 replies to PRE_VOTE vote request: s2<-s0#0:OK-t0. Peer's state: s0@group-4446C9F0D259:t0, leader=null, voted=, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2023-01-22 10:25:54,147 [s1@group-4446C9F0D259-LeaderElection4-1] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(63)) - Build channel for s0
2023-01-22 10:25:54,150 [s0@group-4446C9F0D259-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2023-01-22 10:25:54,154 [s2@group-4446C9F0D259-LeaderElection3] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s2@group-4446C9F0D259-LeaderElection3: PRE_VOTE PASSED received 1 response(s) and 0 exception(s):
2023-01-22 10:25:54,154 [s2@group-4446C9F0D259-LeaderElection3] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s2<-s0#0:OK-t0
2023-01-22 10:25:54,147 [s1@group-4446C9F0D259-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2023-01-22 10:25:54,154 [s1@group-4446C9F0D259-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2023-01-22 10:25:54,154 [s1@group-4446C9F0D259-LeaderElection4-2] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(63)) - Build channel for s2
2023-01-22 10:25:54,154 [s2@group-4446C9F0D259-LeaderElection3] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(311)) - s2@group-4446C9F0D259-LeaderElection3 PRE_VOTE round 0: result PASSED
2023-01-22 10:25:54,154 [s0@group-4446C9F0D259-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2023-01-22 10:25:54,157 [s2@group-4446C9F0D259-LeaderElection3] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(309)) - s2@group-4446C9F0D259-LeaderElection3 ELECTION round 0: submit vote requests at term 1 for -1: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2023-01-22 10:25:54,163 [s2@group-4446C9F0D259-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2023-01-22 10:25:54,163 [s2@group-4446C9F0D259-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2023-01-22 10:25:54,172 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1298)) - s0@group-4446C9F0D259: receive requestVote(ELECTION, s2, group-4446C9F0D259, 1, (t:0, i:0))
2023-01-22 10:25:54,173 [grpc-default-executor-3] INFO  impl.VoteContext (VoteContext.java:log(49)) - s0@group-4446C9F0D259-FOLLOWER: accept ELECTION from s2: our priority 0 <= candidate's priority 0
2023-01-22 10:25:54,173 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s0@group-4446C9F0D259: changes role from  FOLLOWER to FOLLOWER at term 1 for candidate:s2
2023-01-22 10:25:54,173 [grpc-default-executor-3] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s0: shutdown s0@group-4446C9F0D259-FollowerState
2023-01-22 10:25:54,173 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1298)) - s2@group-4446C9F0D259: receive requestVote(PRE_VOTE, s1, group-4446C9F0D259, 0, (t:0, i:0))
2023-01-22 10:25:54,174 [grpc-default-executor-2] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-4446C9F0D259-CANDIDATE: accept PRE_VOTE from s1: our priority 0 <= candidate's priority 0
2023-01-22 10:25:54,174 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1331)) - s2@group-4446C9F0D259 replies to PRE_VOTE vote request: s1<-s2#0:OK-t1. Peer's state: s2@group-4446C9F0D259:t1, leader=null, voted=s2, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2023-01-22 10:25:54,174 [s0@group-4446C9F0D259-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(152)) - s0@group-4446C9F0D259-FollowerState was interrupted
2023-01-22 10:25:54,173 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1298)) - s0@group-4446C9F0D259: receive requestVote(PRE_VOTE, s1, group-4446C9F0D259, 0, (t:0, i:0))
2023-01-22 10:25:54,173 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1298)) - s1@group-4446C9F0D259: receive requestVote(ELECTION, s2, group-4446C9F0D259, 1, (t:0, i:0))
2023-01-22 10:25:54,172 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1298)) - s1@group-4446C9F0D259: receive requestVote(PRE_VOTE, s2, group-4446C9F0D259, 0, (t:0, i:0))
2023-01-22 10:25:54,176 [grpc-default-executor-4] INFO  impl.VoteContext (VoteContext.java:log(49)) - s1@group-4446C9F0D259-CANDIDATE: accept ELECTION from s2: our priority 0 <= candidate's priority 0
2023-01-22 10:25:54,176 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s1@group-4446C9F0D259: changes role from CANDIDATE to FOLLOWER at term 1 for candidate:s2
2023-01-22 10:25:54,176 [grpc-default-executor-4] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(130)) - s1: shutdown s1@group-4446C9F0D259-LeaderElection4
2023-01-22 10:25:54,176 [grpc-default-executor-4] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s1: start s1@group-4446C9F0D259-FollowerState
2023-01-22 10:25:54,177 [s1@group-4446C9F0D259-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2023-01-22 10:25:54,177 [s1@group-4446C9F0D259-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2023-01-22 10:25:54,175 [grpc-default-executor-3] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-4446C9F0D259-FollowerState
2023-01-22 10:25:54,177 [s0@group-4446C9F0D259-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.min = 150ms (fallback to raft.server.rpc.timeout.min)
2023-01-22 10:25:54,177 [s0@group-4446C9F0D259-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logFallback(53)) - raft.server.rpc.first-election.timeout.max = 300ms (fallback to raft.server.rpc.timeout.max)
2023-01-22 10:25:54,177 [s1@group-4446C9F0D259-LeaderElection4] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s1@group-4446C9F0D259-LeaderElection4: PRE_VOTE DISCOVERED_A_NEW_TERM (term=1) received 1 response(s) and 0 exception(s):
2023-01-22 10:25:54,177 [s1@group-4446C9F0D259-LeaderElection4] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s1<-s2#0:OK-t1
2023-01-22 10:25:54,178 [s1@group-4446C9F0D259-LeaderElection4] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(311)) - s1@group-4446C9F0D259-LeaderElection4 PRE_VOTE round 0: result DISCOVERED_A_NEW_TERM (term=1)
2023-01-22 10:25:54,179 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1331)) - s1@group-4446C9F0D259 replies to ELECTION vote request: s2<-s1#0:OK-t1. Peer's state: s1@group-4446C9F0D259:t1, leader=null, voted=s2, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2023-01-22 10:25:54,180 [grpc-default-executor-6] INFO  impl.VoteContext (VoteContext.java:log(49)) - s1@group-4446C9F0D259-FOLLOWER: accept PRE_VOTE from s2: our priority 0 <= candidate's priority 0
2023-01-22 10:25:54,180 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1331)) - s1@group-4446C9F0D259 replies to PRE_VOTE vote request: s2<-s1#0:OK-t1. Peer's state: s1@group-4446C9F0D259:t1, leader=null, voted=s2, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2023-01-22 10:25:54,181 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1331)) - s0@group-4446C9F0D259 replies to ELECTION vote request: s2<-s0#0:OK-t1. Peer's state: s0@group-4446C9F0D259:t1, leader=null, voted=s2, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2023-01-22 10:25:54,182 [grpc-default-executor-0] INFO  impl.VoteContext (VoteContext.java:log(49)) - s0@group-4446C9F0D259-FOLLOWER: accept PRE_VOTE from s1: our priority 0 <= candidate's priority 0
2023-01-22 10:25:54,182 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1331)) - s0@group-4446C9F0D259 replies to PRE_VOTE vote request: s1<-s0#0:OK-t1. Peer's state: s0@group-4446C9F0D259:t1, leader=null, voted=s2, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c-1, conf=-1: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2023-01-22 10:25:54,185 [s2@group-4446C9F0D259-LeaderElection3] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s2@group-4446C9F0D259-LeaderElection3: ELECTION PASSED received 1 response(s) and 0 exception(s):
2023-01-22 10:25:54,186 [s2@group-4446C9F0D259-LeaderElection3] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s2<-s1#0:OK-t1
2023-01-22 10:25:54,186 [s2@group-4446C9F0D259-LeaderElection3] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(311)) - s2@group-4446C9F0D259-LeaderElection3 ELECTION round 0: result PASSED
2023-01-22 10:25:54,186 [s2@group-4446C9F0D259-LeaderElection3] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(130)) - s2: shutdown s2@group-4446C9F0D259-LeaderElection3
2023-01-22 10:25:54,186 [s2@group-4446C9F0D259-LeaderElection3] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s2@group-4446C9F0D259: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2023-01-22 10:25:54,186 [s2@group-4446C9F0D259-LeaderElection3] INFO  server.RaftServer$Division (ServerState.java:setLeader(260)) - s2@group-4446C9F0D259: change Leader from null to s2 at term 1 for becomeLeader, leader elected after 271ms
2023-01-22 10:25:54,186 [s2@group-4446C9F0D259-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.staging.catchup.gap = 1000 (default)
2023-01-22 10:25:54,186 [s2@group-4446C9F0D259-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.element-limit = 4096 (default)
2023-01-22 10:25:54,186 [s2@group-4446C9F0D259-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.byte-limit = 64MB (=67108864) (default)
2023-01-22 10:25:54,187 [s2@group-4446C9F0D259-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.timeout = 10s (default)
2023-01-22 10:25:54,187 [s2@group-4446C9F0D259-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.timeout.denomination = 1s (default)
2023-01-22 10:25:54,187 [s2@group-4446C9F0D259-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.element-limit = 65536 (default)
2023-01-22 10:25:54,187 [s2@group-4446C9F0D259-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.element-limit = 4096 (default)
2023-01-22 10:25:54,187 [s2@group-4446C9F0D259-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.follower.gap.ratio.max = -1.0 (default)
2023-01-22 10:25:54,187 [s2@group-4446C9F0D259-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-01-22 10:25:54,187 [s2@group-4446C9F0D259-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-01-22 10:25:54,187 [s2@group-4446C9F0D259-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-01-22 10:25:54,187 [s2@group-4446C9F0D259-LeaderElection3] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-01-22 10:25:54,190 [s2@group-4446C9F0D259-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-01-22 10:25:54,190 [s2@group-4446C9F0D259-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-01-22 10:25:54,190 [s2@group-4446C9F0D259-LeaderElection3] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-01-22 10:25:54,190 [s2@group-4446C9F0D259-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 10ms (default)
2023-01-22 10:25:54,190 [s2@group-4446C9F0D259-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-01-22 10:25:54,191 [s2@group-4446C9F0D259-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-01-22 10:25:54,191 [s2@group-4446C9F0D259-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-01-22 10:25:54,191 [s2@group-4446C9F0D259-LeaderElection3] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-01-22 10:25:54,191 [s2@group-4446C9F0D259-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-01-22 10:25:54,191 [s2@group-4446C9F0D259-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-01-22 10:25:54,191 [s2@group-4446C9F0D259-LeaderElection3] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-01-22 10:25:54,191 [s2@group-4446C9F0D259-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 10ms (default)
2023-01-22 10:25:54,191 [s2@group-4446C9F0D259-LeaderElection3] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s2: start s2@group-4446C9F0D259-LeaderStateImpl
2023-01-22 10:25:54,191 [s2@group-4446C9F0D259-LeaderElection3] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(431)) - s2@group-4446C9F0D259-SegmentedRaftLogWorker: Starting segment from index:0
2023-01-22 10:25:54,198 [s2@group-4446C9F0D259-LeaderElection3] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(378)) - s2@group-4446C9F0D259: set configuration 0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2023-01-22 10:25:54,202 [s2@group-4446C9F0D259-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(635)) - s2@group-4446C9F0D259-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s2/413bbc71-f185-43d2-9989-4446c9f0d259/current/log_inprogress_0
2023-01-22 10:25:54,205 [s0-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setLeader(260)) - s0@group-4446C9F0D259: change Leader from null to s2 at term 1 for appendEntries, leader elected after 318ms
2023-01-22 10:25:54,215 [s0-server-thread3] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(378)) - s0@group-4446C9F0D259: set configuration 0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2023-01-22 10:25:54,215 [s0-server-thread3] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(431)) - s0@group-4446C9F0D259-SegmentedRaftLogWorker: Starting segment from index:0
2023-01-22 10:25:54,217 [s1-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setLeader(260)) - s1@group-4446C9F0D259: change Leader from null to s2 at term 1 for appendEntries, leader elected after 331ms
2023-01-22 10:25:54,222 [s1-server-thread3] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(378)) - s1@group-4446C9F0D259: set configuration 0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2023-01-22 10:25:54,222 [s1-server-thread3] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(431)) - s1@group-4446C9F0D259-SegmentedRaftLogWorker: Starting segment from index:0
2023-01-22 10:25:54,224 [s0@group-4446C9F0D259-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(635)) - s0@group-4446C9F0D259-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s0/413bbc71-f185-43d2-9989-4446c9f0d259/current/log_inprogress_0
2023-01-22 10:25:54,232 [s1@group-4446C9F0D259-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(635)) - s1@group-4446C9F0D259-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s1/413bbc71-f185-43d2-9989-4446c9f0d259/current/log_inprogress_0
2023-01-22 10:25:54,443 [Time-limited test] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(119)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-4446C9F0D259:t1, leader=s2, voted=s2, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4446C9F0D259:t1, leader=s2, voted=s2, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING    LEADER s2@group-4446C9F0D259:t1, leader=s2, voted=s2, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2023-01-22 10:25:54,444 [pool-9-thread-3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2023-01-22 10:25:54,444 [pool-9-thread-5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2023-01-22 10:25:54,445 [pool-9-thread-4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2023-01-22 10:25:54,445 [pool-9-thread-8] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2023-01-22 10:25:54,445 [pool-9-thread-7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2023-01-22 10:25:54,453 [pool-9-thread-8] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(100)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-4446C9F0D259:t1, leader=s2, voted=s2, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4446C9F0D259:t1, leader=s2, voted=s2, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING    LEADER s2@group-4446C9F0D259:t1, leader=s2, voted=s2, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2023-01-22 10:25:54,453 [pool-9-thread-7] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(100)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-4446C9F0D259:t1, leader=s2, voted=s2, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4446C9F0D259:t1, leader=s2, voted=s2, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING    LEADER s2@group-4446C9F0D259:t1, leader=s2, voted=s2, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2023-01-22 10:25:54,453 [pool-9-thread-8] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(119)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-4446C9F0D259:t1, leader=s2, voted=s2, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4446C9F0D259:t1, leader=s2, voted=s2, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING    LEADER s2@group-4446C9F0D259:t1, leader=s2, voted=s2, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2023-01-22 10:25:54,454 [pool-9-thread-8] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:54,454 [pool-9-thread-8] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2023-01-22 10:25:54,454 [pool-9-thread-8] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2023-01-22 10:25:54,454 [pool-9-thread-8] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2023-01-22 10:25:54,454 [pool-9-thread-8] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2023-01-22 10:25:54,444 [pool-9-thread-6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2023-01-22 10:25:54,457 [pool-9-thread-6] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(100)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-4446C9F0D259:t1, leader=s2, voted=s2, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4446C9F0D259:t1, leader=s2, voted=s2, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING    LEADER s2@group-4446C9F0D259:t1, leader=s2, voted=s2, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2023-01-22 10:25:54,457 [pool-9-thread-6] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(119)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-4446C9F0D259:t1, leader=s2, voted=s2, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4446C9F0D259:t1, leader=s2, voted=s2, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING    LEADER s2@group-4446C9F0D259:t1, leader=s2, voted=s2, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2023-01-22 10:25:54,458 [pool-9-thread-6] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:54,458 [pool-9-thread-6] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2023-01-22 10:25:54,458 [pool-9-thread-6] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2023-01-22 10:25:54,458 [pool-9-thread-6] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2023-01-22 10:25:54,458 [pool-9-thread-6] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2023-01-22 10:25:54,453 [pool-9-thread-9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.timeout.max = 300ms (default)
2023-01-22 10:25:54,453 [pool-9-thread-4] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(100)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-4446C9F0D259:t1, leader=s2, voted=s2, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4446C9F0D259:t1, leader=s2, voted=s2, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING    LEADER s2@group-4446C9F0D259:t1, leader=s2, voted=s2, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2023-01-22 10:25:54,464 [pool-9-thread-9] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(100)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-4446C9F0D259:t1, leader=s2, voted=s2, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4446C9F0D259:t1, leader=s2, voted=s2, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING    LEADER s2@group-4446C9F0D259:t1, leader=s2, voted=s2, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2023-01-22 10:25:54,465 [pool-9-thread-4] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(119)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-4446C9F0D259:t1, leader=s2, voted=s2, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4446C9F0D259:t1, leader=s2, voted=s2, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING    LEADER s2@group-4446C9F0D259:t1, leader=s2, voted=s2, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2023-01-22 10:25:54,453 [pool-9-thread-7] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(119)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-4446C9F0D259:t1, leader=s2, voted=s2, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4446C9F0D259:t1, leader=s2, voted=s2, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING    LEADER s2@group-4446C9F0D259:t1, leader=s2, voted=s2, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2023-01-22 10:25:54,453 [pool-9-thread-5] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(100)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-4446C9F0D259:t1, leader=s2, voted=s2, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4446C9F0D259:t1, leader=s2, voted=s2, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING    LEADER s2@group-4446C9F0D259:t1, leader=s2, voted=s2, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2023-01-22 10:25:54,474 [pool-9-thread-5] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(119)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-4446C9F0D259:t1, leader=s2, voted=s2, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4446C9F0D259:t1, leader=s2, voted=s2, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING    LEADER s2@group-4446C9F0D259:t1, leader=s2, voted=s2, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2023-01-22 10:25:54,453 [pool-9-thread-3] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(100)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-4446C9F0D259:t1, leader=s2, voted=s2, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4446C9F0D259:t1, leader=s2, voted=s2, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING    LEADER s2@group-4446C9F0D259:t1, leader=s2, voted=s2, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2023-01-22 10:25:54,474 [pool-9-thread-3] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(119)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-4446C9F0D259:t1, leader=s2, voted=s2, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4446C9F0D259:t1, leader=s2, voted=s2, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING    LEADER s2@group-4446C9F0D259:t1, leader=s2, voted=s2, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2023-01-22 10:25:54,474 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd3172420, L:/0.0.0.0:46279] READ: [id: 0x0c6c322c, L:/127.0.0.1:46279 - R:/127.0.0.1:32800]
2023-01-22 10:25:54,469 [pool-9-thread-4] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:54,465 [pool-9-thread-9] INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(119)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-4446C9F0D259:t1, leader=s2, voted=s2, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4446C9F0D259:t1, leader=s2, voted=s2, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING    LEADER s2@group-4446C9F0D259:t1, leader=s2, voted=s2, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2023-01-22 10:25:54,475 [pool-9-thread-4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2023-01-22 10:25:54,475 [pool-9-thread-4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2023-01-22 10:25:54,475 [pool-9-thread-4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2023-01-22 10:25:54,475 [pool-9-thread-4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2023-01-22 10:25:54,476 [pool-9-thread-7] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:54,476 [pool-9-thread-7] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2023-01-22 10:25:54,476 [pool-9-thread-7] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2023-01-22 10:25:54,476 [pool-9-thread-10] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream376
2023-01-22 10:25:54,476 [pool-9-thread-7] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2023-01-22 10:25:54,476 [pool-9-thread-7] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2023-01-22 10:25:54,477 [pool-9-thread-9] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:54,477 [pool-9-thread-9] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2023-01-22 10:25:54,477 [pool-9-thread-9] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2023-01-22 10:25:54,477 [pool-9-thread-3] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:54,477 [pool-9-thread-3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2023-01-22 10:25:54,478 [pool-9-thread-3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2023-01-22 10:25:54,478 [pool-9-thread-9] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2023-01-22 10:25:54,478 [pool-9-thread-3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2023-01-22 10:25:54,478 [pool-9-thread-3] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2023-01-22 10:25:54,477 [pool-9-thread-5] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:54,478 [pool-9-thread-5] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2023-01-22 10:25:54,478 [pool-9-thread-5] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2023-01-22 10:25:54,478 [pool-9-thread-5] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2023-01-22 10:25:54,478 [pool-9-thread-5] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2023-01-22 10:25:54,478 [pool-9-thread-9] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2023-01-22 10:25:54,486 [pool-9-thread-11] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream378
2023-01-22 10:25:54,488 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xdc9b03da, L:/0.0.0.0:46499] READ: [id: 0x8939e5af, L:/127.0.0.1:46499 - R:/127.0.0.1:59564]
2023-01-22 10:25:54,488 [pool-9-thread-12] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream379
2023-01-22 10:25:54,488 [pool-9-thread-13] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream380
2023-01-22 10:25:54,508 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd3172420, L:/0.0.0.0:46279] READ COMPLETE
2023-01-22 10:25:54,508 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd3172420, L:/0.0.0.0:46279] READ: [id: 0xf8c42f01, L:/127.0.0.1:46279 - R:/127.0.0.1:32814]
2023-01-22 10:25:54,510 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:54,510 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2023-01-22 10:25:54,510 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2023-01-22 10:25:54,510 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2023-01-22 10:25:54,510 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2023-01-22 10:25:54,518 [pool-9-thread-16] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream382
2023-01-22 10:25:54,526 [pool-9-thread-15] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream381
2023-01-22 10:25:54,528 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xdc9b03da, L:/0.0.0.0:46499] READ COMPLETE
2023-01-22 10:25:54,529 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xdc9b03da, L:/0.0.0.0:46499] READ: [id: 0xc8e56361, L:/127.0.0.1:46499 - R:/127.0.0.1:59576]
2023-01-22 10:25:54,529 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:54,530 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2023-01-22 10:25:54,530 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2023-01-22 10:25:54,530 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2023-01-22 10:25:54,530 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2023-01-22 10:25:54,531 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xdc9b03da, L:/0.0.0.0:46499] READ COMPLETE
2023-01-22 10:25:54,532 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:54,533 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2023-01-22 10:25:54,533 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2023-01-22 10:25:54,533 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2023-01-22 10:25:54,533 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2023-01-22 10:25:54,536 [pool-9-thread-14] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(311)) - start Stream377
2023-01-22 10:25:54,546 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:54,546 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2023-01-22 10:25:54,546 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2023-01-22 10:25:54,547 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2023-01-22 10:25:54,547 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2023-01-22 10:25:54,548 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:54,548 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2023-01-22 10:25:54,548 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2023-01-22 10:25:54,548 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2023-01-22 10:25:54,548 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2023-01-22 10:25:54,551 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd6bb0a2e, L:/0.0.0.0:32781] READ: [id: 0xde97ba40, L:/127.0.0.1:32781 - R:/127.0.0.1:56540]
2023-01-22 10:25:54,552 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:54,552 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2023-01-22 10:25:54,552 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2023-01-22 10:25:54,552 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2023-01-22 10:25:54,552 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2023-01-22 10:25:54,553 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xdc9b03da, L:/0.0.0.0:46499] READ: [id: 0xe8a96ad3, L:/127.0.0.1:46499 - R:/127.0.0.1:59590]
2023-01-22 10:25:54,558 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd3172420, L:/0.0.0.0:46279] READ: [id: 0x10612a85, L:/127.0.0.1:46279 - R:/127.0.0.1:32824]
2023-01-22 10:25:54,558 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:54,558 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2023-01-22 10:25:54,559 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2023-01-22 10:25:54,559 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2023-01-22 10:25:54,559 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2023-01-22 10:25:54,559 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd3172420, L:/0.0.0.0:46279] READ: [id: 0x68ee4d43, L:/127.0.0.1:46279 - R:/127.0.0.1:32840]
2023-01-22 10:25:54,560 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd3172420, L:/0.0.0.0:46279] READ: [id: 0xba603494, L:/127.0.0.1:46279 - R:/127.0.0.1:32856]
2023-01-22 10:25:54,560 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd3172420, L:/0.0.0.0:46279] READ COMPLETE
2023-01-22 10:25:54,560 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd3172420, L:/0.0.0.0:46279] READ: [id: 0x147694c7, L:/127.0.0.1:46279 - R:/127.0.0.1:32872]
2023-01-22 10:25:54,560 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd3172420, L:/0.0.0.0:46279] READ: [id: 0x8fd68386, L:/127.0.0.1:46279 - R:/127.0.0.1:32874]
2023-01-22 10:25:54,560 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd3172420, L:/0.0.0.0:46279] READ COMPLETE
2023-01-22 10:25:54,561 [s0-NettyServerStreamRpc-workerGroup--thread4] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:54,561 [s0-NettyServerStreamRpc-workerGroup--thread4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2023-01-22 10:25:54,561 [s0-NettyServerStreamRpc-workerGroup--thread4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2023-01-22 10:25:54,561 [s0-NettyServerStreamRpc-workerGroup--thread4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2023-01-22 10:25:54,562 [s0-NettyServerStreamRpc-workerGroup--thread4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2023-01-22 10:25:54,562 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xdc9b03da, L:/0.0.0.0:46499] READ COMPLETE
2023-01-22 10:25:54,565 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd6bb0a2e, L:/0.0.0.0:32781] READ COMPLETE
2023-01-22 10:25:54,566 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd6bb0a2e, L:/0.0.0.0:32781] READ: [id: 0xc92ff113, L:/127.0.0.1:32781 - R:/127.0.0.1:56548]
2023-01-22 10:25:54,567 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd6bb0a2e, L:/0.0.0.0:32781] READ COMPLETE
2023-01-22 10:25:54,571 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd6bb0a2e, L:/0.0.0.0:32781] READ: [id: 0x308ce876, L:/127.0.0.1:32781 - R:/127.0.0.1:56554]
2023-01-22 10:25:54,571 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd6bb0a2e, L:/0.0.0.0:32781] READ COMPLETE
2023-01-22 10:25:54,572 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:54,572 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2023-01-22 10:25:54,572 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2023-01-22 10:25:54,572 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2023-01-22 10:25:54,572 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2023-01-22 10:25:54,576 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xdc9b03da, L:/0.0.0.0:46499] READ: [id: 0xc8cf6b13, L:/127.0.0.1:46499 - R:/127.0.0.1:59598]
2023-01-22 10:25:54,576 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:54,576 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2023-01-22 10:25:54,576 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2023-01-22 10:25:54,576 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2023-01-22 10:25:54,576 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2023-01-22 10:25:54,579 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:54,579 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2023-01-22 10:25:54,579 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2023-01-22 10:25:54,579 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2023-01-22 10:25:54,579 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2023-01-22 10:25:54,581 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd3172420, L:/0.0.0.0:46279] READ: [id: 0xdb9d4c16, L:/127.0.0.1:46279 - R:/127.0.0.1:32890]
2023-01-22 10:25:54,581 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd3172420, L:/0.0.0.0:46279] READ COMPLETE
2023-01-22 10:25:54,581 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:54,581 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2023-01-22 10:25:54,581 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2023-01-22 10:25:54,581 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2023-01-22 10:25:54,582 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2023-01-22 10:25:54,582 [s0-NettyServerStreamRpc-workerGroup--thread4] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:54,582 [s0-NettyServerStreamRpc-workerGroup--thread4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2023-01-22 10:25:54,582 [s0-NettyServerStreamRpc-workerGroup--thread4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2023-01-22 10:25:54,583 [s0-NettyServerStreamRpc-workerGroup--thread4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2023-01-22 10:25:54,583 [s0-NettyServerStreamRpc-workerGroup--thread4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2023-01-22 10:25:54,583 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:54,584 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2023-01-22 10:25:54,584 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2023-01-22 10:25:54,584 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2023-01-22 10:25:54,584 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2023-01-22 10:25:54,586 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd6bb0a2e, L:/0.0.0.0:32781] READ: [id: 0x5d32b73e, L:/127.0.0.1:32781 - R:/127.0.0.1:56564]
2023-01-22 10:25:54,587 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xdc9b03da, L:/0.0.0.0:46499] READ COMPLETE
2023-01-22 10:25:54,587 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xdc9b03da, L:/0.0.0.0:46499] READ: [id: 0xd8c245a9, L:/127.0.0.1:46499 - R:/127.0.0.1:59602]
2023-01-22 10:25:54,587 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xdc9b03da, L:/0.0.0.0:46499] READ: [id: 0xf53ee430, L:/127.0.0.1:46499 - R:/127.0.0.1:59606]
2023-01-22 10:25:54,587 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xdc9b03da, L:/0.0.0.0:46499] READ COMPLETE
2023-01-22 10:25:54,589 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd6bb0a2e, L:/0.0.0.0:32781] READ COMPLETE
2023-01-22 10:25:54,591 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd6bb0a2e, L:/0.0.0.0:32781] READ: [id: 0xc10dfb5c, L:/127.0.0.1:32781 - R:/127.0.0.1:56566]
2023-01-22 10:25:54,591 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd6bb0a2e, L:/0.0.0.0:32781] READ COMPLETE
2023-01-22 10:25:54,591 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:54,591 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2023-01-22 10:25:54,591 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2023-01-22 10:25:54,592 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2023-01-22 10:25:54,592 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2023-01-22 10:25:54,597 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd6bb0a2e, L:/0.0.0.0:32781] READ: [id: 0x9837bfb3, L:/127.0.0.1:32781 - R:/127.0.0.1:56572]
2023-01-22 10:25:54,597 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd6bb0a2e, L:/0.0.0.0:32781] READ COMPLETE
2023-01-22 10:25:54,597 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd6bb0a2e, L:/0.0.0.0:32781] READ: [id: 0xf24b941e, L:/127.0.0.1:32781 - R:/127.0.0.1:56588]
2023-01-22 10:25:54,597 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd6bb0a2e, L:/0.0.0.0:32781] READ COMPLETE
2023-01-22 10:25:54,598 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:54,599 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2023-01-22 10:25:54,599 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2023-01-22 10:25:54,599 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2023-01-22 10:25:54,599 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2023-01-22 10:25:54,600 [s0-NettyServerStreamRpc-workerGroup--thread4] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:54,600 [s0-NettyServerStreamRpc-workerGroup--thread4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2023-01-22 10:25:54,600 [s0-NettyServerStreamRpc-workerGroup--thread4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2023-01-22 10:25:54,600 [s0-NettyServerStreamRpc-workerGroup--thread4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2023-01-22 10:25:54,600 [s0-NettyServerStreamRpc-workerGroup--thread4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2023-01-22 10:25:54,603 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xdc9b03da, L:/0.0.0.0:46499] READ: [id: 0xf847dc7e, L:/127.0.0.1:46499 - R:/127.0.0.1:59616]
2023-01-22 10:25:54,604 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xdc9b03da, L:/0.0.0.0:46499] READ COMPLETE
2023-01-22 10:25:54,604 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:54,604 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2023-01-22 10:25:54,604 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2023-01-22 10:25:54,604 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2023-01-22 10:25:54,604 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2023-01-22 10:25:54,606 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xdc9b03da, L:/0.0.0.0:46499] READ: [id: 0xf5f5f14a, L:/127.0.0.1:46499 - R:/127.0.0.1:59630]
2023-01-22 10:25:54,607 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xdc9b03da, L:/0.0.0.0:46499] READ COMPLETE
2023-01-22 10:25:54,607 [s0-NettyServerStreamRpc-workerGroup--thread4] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:54,607 [s0-NettyServerStreamRpc-workerGroup--thread4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2023-01-22 10:25:54,607 [s0-NettyServerStreamRpc-workerGroup--thread4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2023-01-22 10:25:54,607 [s0-NettyServerStreamRpc-workerGroup--thread4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2023-01-22 10:25:54,607 [s0-NettyServerStreamRpc-workerGroup--thread4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2023-01-22 10:25:54,630 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd6bb0a2e, L:/0.0.0.0:32781] READ: [id: 0x99433f8e, L:/127.0.0.1:32781 - R:/127.0.0.1:56590]
2023-01-22 10:25:54,630 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd6bb0a2e, L:/0.0.0.0:32781] READ COMPLETE
2023-01-22 10:25:54,634 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd6bb0a2e, L:/0.0.0.0:32781] READ: [id: 0xdf95d077, L:/127.0.0.1:32781 - R:/127.0.0.1:56600]
2023-01-22 10:25:54,634 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd6bb0a2e, L:/0.0.0.0:32781] READ COMPLETE
2023-01-22 10:25:54,635 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd3172420, L:/0.0.0.0:46279] READ: [id: 0xaae1ba4c, L:/127.0.0.1:46279 - R:/127.0.0.1:32898]
2023-01-22 10:25:54,635 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd3172420, L:/0.0.0.0:46279] READ COMPLETE
2023-01-22 10:25:54,635 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:54,635 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2023-01-22 10:25:54,635 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2023-01-22 10:25:54,636 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2023-01-22 10:25:54,636 [s1-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2023-01-22 10:25:54,639 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd6bb0a2e, L:/0.0.0.0:32781] READ: [id: 0x5bd234b9, L:/127.0.0.1:32781 - R:/127.0.0.1:56616]
2023-01-22 10:25:54,639 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd6bb0a2e, L:/0.0.0.0:32781] READ COMPLETE
2023-01-22 10:25:54,640 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:54,640 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2023-01-22 10:25:54,640 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2023-01-22 10:25:54,640 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2023-01-22 10:25:54,640 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2023-01-22 10:25:54,641 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xdc9b03da, L:/0.0.0.0:46499] READ: [id: 0x7c23866d, L:/127.0.0.1:46499 - R:/127.0.0.1:59644]
2023-01-22 10:25:54,641 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xdc9b03da, L:/0.0.0.0:46499] READ COMPLETE
2023-01-22 10:25:54,641 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:54,641 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2023-01-22 10:25:54,641 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2023-01-22 10:25:54,642 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2023-01-22 10:25:54,642 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2023-01-22 10:25:54,643 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd6bb0a2e, L:/0.0.0.0:32781] READ: [id: 0x2030aac0, L:/127.0.0.1:32781 - R:/127.0.0.1:56622]
2023-01-22 10:25:54,643 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd6bb0a2e, L:/0.0.0.0:32781] READ COMPLETE
2023-01-22 10:25:54,644 [s0-NettyServerStreamRpc-workerGroup--thread4] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:54,644 [s0-NettyServerStreamRpc-workerGroup--thread4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2023-01-22 10:25:54,645 [s0-NettyServerStreamRpc-workerGroup--thread4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2023-01-22 10:25:54,645 [s0-NettyServerStreamRpc-workerGroup--thread4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2023-01-22 10:25:54,645 [s0-NettyServerStreamRpc-workerGroup--thread4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2023-01-22 10:25:54,646 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xdc9b03da, L:/0.0.0.0:46499] READ: [id: 0x1e6ad224, L:/127.0.0.1:46499 - R:/127.0.0.1:59658]
2023-01-22 10:25:54,646 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xdc9b03da, L:/0.0.0.0:46499] READ COMPLETE
2023-01-22 10:25:54,653 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:54,653 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2023-01-22 10:25:54,653 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2023-01-22 10:25:54,653 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2023-01-22 10:25:54,653 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2023-01-22 10:25:54,654 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd3172420, L:/0.0.0.0:46279] READ: [id: 0xba847561, L:/127.0.0.1:46279 - R:/127.0.0.1:32914]
2023-01-22 10:25:54,654 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd3172420, L:/0.0.0.0:46279] READ COMPLETE
2023-01-22 10:25:54,655 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:54,655 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2023-01-22 10:25:54,655 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2023-01-22 10:25:54,655 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2023-01-22 10:25:54,655 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2023-01-22 10:25:54,667 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd6bb0a2e, L:/0.0.0.0:32781] READ: [id: 0x0b499680, L:/127.0.0.1:32781 - R:/127.0.0.1:56638]
2023-01-22 10:25:54,667 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd6bb0a2e, L:/0.0.0.0:32781] READ COMPLETE
2023-01-22 10:25:54,668 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:54,668 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2023-01-22 10:25:54,668 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2023-01-22 10:25:54,668 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2023-01-22 10:25:54,668 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2023-01-22 10:25:54,670 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:54,670 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2023-01-22 10:25:54,670 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2023-01-22 10:25:54,670 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2023-01-22 10:25:54,670 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2023-01-22 10:25:54,671 [s0-NettyServerStreamRpc-workerGroup--thread4] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:54,671 [s0-NettyServerStreamRpc-workerGroup--thread4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2023-01-22 10:25:54,671 [s0-NettyServerStreamRpc-workerGroup--thread4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2023-01-22 10:25:54,671 [s0-NettyServerStreamRpc-workerGroup--thread4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2023-01-22 10:25:54,678 [s0-NettyServerStreamRpc-workerGroup--thread4] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2023-01-22 10:25:54,678 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd3172420, L:/0.0.0.0:46279] READ: [id: 0x0875997d, L:/127.0.0.1:46279 - R:/127.0.0.1:32920]
2023-01-22 10:25:54,679 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd3172420, L:/0.0.0.0:46279] READ COMPLETE
2023-01-22 10:25:54,679 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:54,679 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2023-01-22 10:25:54,679 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2023-01-22 10:25:54,679 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2023-01-22 10:25:54,679 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2023-01-22 10:25:54,679 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:54,680 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2023-01-22 10:25:54,680 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2023-01-22 10:25:54,680 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2023-01-22 10:25:54,680 [s0-NettyServerStreamRpc-workerGroup--thread2] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2023-01-22 10:25:54,681 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd6bb0a2e, L:/0.0.0.0:32781] READ: [id: 0x3a2dddea, L:/127.0.0.1:32781 - R:/127.0.0.1:56642]
2023-01-22 10:25:54,681 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd6bb0a2e, L:/0.0.0.0:32781] READ COMPLETE
2023-01-22 10:25:54,681 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:54,681 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2023-01-22 10:25:54,681 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2023-01-22 10:25:54,681 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2023-01-22 10:25:54,682 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2023-01-22 10:25:54,682 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xdc9b03da, L:/0.0.0.0:46499] READ: [id: 0x585b1d69, L:/127.0.0.1:46499 - R:/127.0.0.1:59674]
2023-01-22 10:25:54,682 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xdc9b03da, L:/0.0.0.0:46499] READ COMPLETE
2023-01-22 10:25:54,683 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd3172420, L:/0.0.0.0:46279] READ: [id: 0xa88b8439, L:/127.0.0.1:46279 - R:/127.0.0.1:32930]
2023-01-22 10:25:54,683 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd3172420, L:/0.0.0.0:46279] READ COMPLETE
2023-01-22 10:25:54,683 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:54,683 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2023-01-22 10:25:54,683 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2023-01-22 10:25:54,684 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2023-01-22 10:25:54,684 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2023-01-22 10:25:54,685 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd6bb0a2e, L:/0.0.0.0:32781] READ: [id: 0xa8f3c546, L:/127.0.0.1:32781 - R:/127.0.0.1:56644]
2023-01-22 10:25:54,685 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd6bb0a2e, L:/0.0.0.0:32781] READ COMPLETE
2023-01-22 10:25:54,685 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:54,685 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2023-01-22 10:25:54,685 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2023-01-22 10:25:54,685 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2023-01-22 10:25:54,685 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2023-01-22 10:25:54,701 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd3172420, L:/0.0.0.0:46279] READ: [id: 0x77b30ccb, L:/127.0.0.1:46279 - R:/127.0.0.1:32938]
2023-01-22 10:25:54,701 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd3172420, L:/0.0.0.0:46279] READ COMPLETE
2023-01-22 10:25:54,703 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:54,703 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2023-01-22 10:25:54,703 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2023-01-22 10:25:54,703 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2023-01-22 10:25:54,703 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2023-01-22 10:25:54,704 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd6bb0a2e, L:/0.0.0.0:32781] READ: [id: 0x92b1616e, L:/127.0.0.1:32781 - R:/127.0.0.1:56658]
2023-01-22 10:25:54,704 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd6bb0a2e, L:/0.0.0.0:32781] READ COMPLETE
2023-01-22 10:25:54,706 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd6bb0a2e, L:/0.0.0.0:32781] READ: [id: 0xd4a2ab50, L:/127.0.0.1:32781 - R:/127.0.0.1:56668]
2023-01-22 10:25:54,706 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd6bb0a2e, L:/0.0.0.0:32781] READ COMPLETE
2023-01-22 10:25:54,719 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd6bb0a2e, L:/0.0.0.0:32781] READ: [id: 0x5171d0cb, L:/127.0.0.1:32781 - R:/127.0.0.1:56682]
2023-01-22 10:25:54,719 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd6bb0a2e, L:/0.0.0.0:32781] READ COMPLETE
2023-01-22 10:25:54,719 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:54,720 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2023-01-22 10:25:54,720 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2023-01-22 10:25:54,720 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2023-01-22 10:25:54,720 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2023-01-22 10:25:54,722 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd3172420, L:/0.0.0.0:46279] READ: [id: 0x17a5f7ee, L:/127.0.0.1:46279 - R:/127.0.0.1:32946]
2023-01-22 10:25:54,722 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd3172420, L:/0.0.0.0:46279] READ COMPLETE
2023-01-22 10:25:54,722 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:54,723 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2023-01-22 10:25:54,723 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2023-01-22 10:25:54,723 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2023-01-22 10:25:54,723 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2023-01-22 10:25:54,724 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:54,724 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2023-01-22 10:25:54,724 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2023-01-22 10:25:54,724 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2023-01-22 10:25:54,724 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2023-01-22 10:25:54,725 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xdc9b03da, L:/0.0.0.0:46499] READ: [id: 0x87299468, L:/127.0.0.1:46499 - R:/127.0.0.1:59680]
2023-01-22 10:25:54,725 [s1-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xdc9b03da, L:/0.0.0.0:46499] READ COMPLETE
2023-01-22 10:25:54,725 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:54,725 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2023-01-22 10:25:54,725 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2023-01-22 10:25:54,725 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2023-01-22 10:25:54,725 [s0-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2023-01-22 10:25:54,727 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd6bb0a2e, L:/0.0.0.0:32781] READ: [id: 0x25cb95a4, L:/127.0.0.1:32781 - R:/127.0.0.1:56698]
2023-01-22 10:25:54,727 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd6bb0a2e, L:/0.0.0.0:32781] READ COMPLETE
2023-01-22 10:25:54,751 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd6bb0a2e, L:/0.0.0.0:32781] READ: [id: 0x4c2712f5, L:/127.0.0.1:32781 - R:/127.0.0.1:56704]
2023-01-22 10:25:54,751 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd6bb0a2e, L:/0.0.0.0:32781] READ COMPLETE
2023-01-22 10:25:54,751 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:54,751 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2023-01-22 10:25:54,751 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2023-01-22 10:25:54,751 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2023-01-22 10:25:54,751 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2023-01-22 10:25:54,766 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd3172420, L:/0.0.0.0:46279] READ: [id: 0x9afc465e, L:/127.0.0.1:46279 - R:/127.0.0.1:32948]
2023-01-22 10:25:54,766 [s0-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd3172420, L:/0.0.0.0:46279] READ COMPLETE
2023-01-22 10:25:54,767 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  client.DataStreamClient (ConfUtils.java:logGet(46)) - raft.datastream.type = NETTY (custom)
2023-01-22 10:25:54,767 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.tls.conf = null (default)
2023-01-22 10:25:54,767 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.reply.queue.grace-period = 1s (default)
2023-01-22 10:25:54,767 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.share = false (default)
2023-01-22 10:25:54,767 [s1-NettyServerStreamRpc-workerGroup--thread1] INFO  netty.NettyConfigKeys$DataStream (ConfUtils.java:logGet(46)) - raft.netty.dataStream.client.worker-group.size = 4 (default)
2023-01-22 10:25:54,798 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd6bb0a2e, L:/0.0.0.0:32781] READ: [id: 0x0b43055f, L:/127.0.0.1:32781 - R:/127.0.0.1:56720]
2023-01-22 10:25:54,799 [s2-NettyServerStreamRpc-bossGroup--thread1] INFO  logging.LoggingHandler (AbstractInternalLogger.java:log(148)) - [id: 0xd6bb0a2e, L:/0.0.0.0:32781] READ COMPLETE
2023-01-22 10:25:55,098 [s0@group-4446C9F0D259-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s0@group-4446C9F0D259-FollowerState: change to CANDIDATE, lastRpcElapsedTime:302612428ns, electionTimeout:153ms
2023-01-22 10:25:55,098 [s0@group-4446C9F0D259-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s0: shutdown s0@group-4446C9F0D259-FollowerState
2023-01-22 10:25:55,098 [s0@group-4446C9F0D259-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s0@group-4446C9F0D259: changes role from  FOLLOWER to CANDIDATE at term 1 for changeToCandidate
2023-01-22 10:25:55,098 [s0@group-4446C9F0D259-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2023-01-22 10:25:55,098 [s0@group-4446C9F0D259-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-4446C9F0D259-LeaderElection5
2023-01-22 10:25:55,099 [JvmPauseMonitor6] WARN  util.JvmPauseMonitor (JvmPauseMonitor.java:detectPause(126)) - JvmPauseMonitor-s2: Detected pause in JVM or host machine (eg GC): pause of approximately 114833232ns.
GC pool 'G1 Young Generation' had collection(s): count=1 time=177ms
2023-01-22 10:25:55,099 [s1@group-4446C9F0D259-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s1@group-4446C9F0D259-FollowerState: change to CANDIDATE, lastRpcElapsedTime:251832301ns, electionTimeout:197ms
2023-01-22 10:25:55,099 [s1@group-4446C9F0D259-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s1: shutdown s1@group-4446C9F0D259-FollowerState
2023-01-22 10:25:55,099 [s1@group-4446C9F0D259-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s1@group-4446C9F0D259: changes role from  FOLLOWER to CANDIDATE at term 1 for changeToCandidate
2023-01-22 10:25:55,099 [s1@group-4446C9F0D259-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2023-01-22 10:25:55,099 [s1@group-4446C9F0D259-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s1: start s1@group-4446C9F0D259-LeaderElection6
2023-01-22 10:25:55,099 [s0@group-4446C9F0D259-LeaderElection5] INFO  server.RaftServer$Division (ServerState.java:setLeader(260)) - s0@group-4446C9F0D259: change Leader from s2 to null at term 1 for PRE_VOTE
2023-01-22 10:25:55,099 [s0@group-4446C9F0D259-LeaderElection5] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(309)) - s0@group-4446C9F0D259-LeaderElection5 PRE_VOTE round 0: submit vote requests at term 1 for 0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2023-01-22 10:25:55,100 [JvmPauseMonitor5] WARN  util.JvmPauseMonitor (JvmPauseMonitor.java:detectPause(126)) - JvmPauseMonitor-s1: Detected pause in JVM or host machine (eg GC): pause of approximately 139947091ns.
GC pool 'G1 Young Generation' had collection(s): count=1 time=177ms
2023-01-22 10:25:55,100 [JvmPauseMonitor4] WARN  util.JvmPauseMonitor (JvmPauseMonitor.java:detectPause(126)) - JvmPauseMonitor-s0: Detected pause in JVM or host machine (eg GC): pause of approximately 160914975ns.
GC pool 'G1 Young Generation' had collection(s): count=1 time=177ms
2023-01-22 10:25:55,101 [s1-server-thread3] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s1@group-4446C9F0D259: changes role from CANDIDATE to FOLLOWER at term 1 for appendEntries
2023-01-22 10:25:55,101 [s1-server-thread3] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(130)) - s1: shutdown s1@group-4446C9F0D259-LeaderElection6
2023-01-22 10:25:55,101 [s1-server-thread3] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s1: start s1@group-4446C9F0D259-FollowerState
2023-01-22 10:25:55,103 [s1@group-4446C9F0D259-LeaderElection6] INFO  impl.LeaderElection (LeaderElection.java:run(232)) - s1@group-4446C9F0D259-LeaderElection6: skip running since this is already CLOSING
2023-01-22 10:25:55,108 [s0@group-4446C9F0D259-LeaderElection5-1] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(63)) - Build channel for s1
2023-01-22 10:25:55,114 [s0@group-4446C9F0D259-LeaderElection5-2] INFO  server.GrpcServerProtocolClient (GrpcServerProtocolClient.java:<init>(63)) - Build channel for s2
2023-01-22 10:25:55,124 [s0-server-thread3] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s0@group-4446C9F0D259: changes role from CANDIDATE to FOLLOWER at term 1 for appendEntries
2023-01-22 10:25:55,124 [s0-server-thread3] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(130)) - s0: shutdown s0@group-4446C9F0D259-LeaderElection5
2023-01-22 10:25:55,124 [s0-server-thread3] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-4446C9F0D259-FollowerState
2023-01-22 10:25:55,125 [s0-server-thread3] INFO  server.RaftServer$Division (ServerState.java:setLeader(260)) - s0@group-4446C9F0D259: change Leader from null to s2 at term 1 for appendEntries, leader elected after 26ms
2023-01-22 10:25:55,138 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1298)) - s1@group-4446C9F0D259: receive requestVote(PRE_VOTE, s0, group-4446C9F0D259, 1, (t:1, i:0))
2023-01-22 10:25:55,139 [grpc-default-executor-3] INFO  impl.VoteContext (VoteContext.java:log(49)) - s1@group-4446C9F0D259-FOLLOWER: reject PRE_VOTE from s0: this server is a follower and still has a valid leader s2
2023-01-22 10:25:55,139 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1331)) - s1@group-4446C9F0D259 replies to PRE_VOTE vote request: s0<-s1#0:FAIL-t1. Peer's state: s1@group-4446C9F0D259:t1, leader=s2, voted=s2, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2023-01-22 10:25:55,143 [pool-9-thread-14] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream377: bytesWritten=770123
2023-01-22 10:25:55,145 [pool-9-thread-15] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream381: bytesWritten=734008
2023-01-22 10:25:55,151 [pool-9-thread-13] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream380: bytesWritten=806321
2023-01-22 10:25:55,153 [pool-9-thread-12] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream379: bytesWritten=848711
2023-01-22 10:25:55,163 [pool-9-thread-10] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream376: bytesWritten=783620
2023-01-22 10:25:55,163 [pool-9-thread-11] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream378: bytesWritten=789535
2023-01-22 10:25:55,167 [s0@group-4446C9F0D259-LeaderElection5] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s0@group-4446C9F0D259-LeaderElection5: PRE_VOTE REJECTED received 1 response(s) and 0 exception(s):
2023-01-22 10:25:55,167 [s0@group-4446C9F0D259-LeaderElection5] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s0<-s1#0:FAIL-t1
2023-01-22 10:25:55,167 [s0@group-4446C9F0D259-LeaderElection5] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(311)) - s0@group-4446C9F0D259-LeaderElection5 PRE_VOTE round 0: result REJECTED
2023-01-22 10:25:55,175 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1298)) - s2@group-4446C9F0D259: receive requestVote(PRE_VOTE, s0, group-4446C9F0D259, 1, (t:1, i:0))
2023-01-22 10:25:55,175 [grpc-default-executor-6] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-4446C9F0D259-LEADER: reject PRE_VOTE from s0: this server is the leader and still has leadership
2023-01-22 10:25:55,175 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1331)) - s2@group-4446C9F0D259 replies to PRE_VOTE vote request: s0<-s2#0:FAIL-t1. Peer's state: s2@group-4446C9F0D259:t1, leader=s2, voted=s2, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c0, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2023-01-22 10:25:55,255 [s2-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-57A28927E51B->s0@group-4446C9F0D259, cid=380, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2023-01-22 10:25:55,256 [s1-server-thread3] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-57A28927E51B->s0@group-4446C9F0D259, cid=380, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2023-01-22 10:25:55,256 [s0-server-thread3] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-57A28927E51B->s0@group-4446C9F0D259, cid=380, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2023-01-22 10:25:55,276 [s2-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-4ACD4B782495->s1@group-4446C9F0D259, cid=377, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2023-01-22 10:25:55,277 [s1-server-thread3] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-4ACD4B782495->s1@group-4446C9F0D259, cid=377, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2023-01-22 10:25:55,278 [s0-server-thread3] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-4ACD4B782495->s1@group-4446C9F0D259, cid=377, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2023-01-22 10:25:57,031 [JvmPauseMonitor4] WARN  util.JvmPauseMonitor (JvmPauseMonitor.java:detectPause(126)) - JvmPauseMonitor-s0: Detected pause in JVM or host machine (eg GC): pause of approximately 1431086366ns.
GC pool 'G1 Young Generation' had collection(s): count=1 time=40ms
GC pool 'G1 Old Generation' had collection(s): count=1 time=1700ms
2023-01-22 10:25:57,032 [JvmPauseMonitor5] WARN  util.JvmPauseMonitor (JvmPauseMonitor.java:detectPause(126)) - JvmPauseMonitor-s1: Detected pause in JVM or host machine (eg GC): pause of approximately 1431735578ns.
GC pool 'G1 Young Generation' had collection(s): count=1 time=40ms
GC pool 'G1 Old Generation' had collection(s): count=1 time=1700ms
2023-01-22 10:25:57,032 [JvmPauseMonitor6] WARN  util.JvmPauseMonitor (JvmPauseMonitor.java:detectPause(126)) - JvmPauseMonitor-s2: Detected pause in JVM or host machine (eg GC): pause of approximately 1432860299ns.
GC pool 'G1 Young Generation' had collection(s): count=1 time=40ms
GC pool 'G1 Old Generation' had collection(s): count=1 time=1700ms
2023-01-22 10:25:57,032 [s2@group-4446C9F0D259-LeaderStateImpl] WARN  server.RaftServer$Division (LeaderStateImpl.java:checkLeadership(1105)) - s2@group-4446C9F0D259-LeaderStateImpl: Lost leadership on term: 1. Election timeout: 300ms. In charge for: 2845ms. Conf: 0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2023-01-22 10:25:57,033 [s2@group-4446C9F0D259-LeaderStateImpl] WARN  server.RaftServer$Division (LeaderStateImpl.java:lambda$checkLeadership$19(1109)) - Follower s2@group-4446C9F0D259->s0(c3,m4,n5, attendVote=true, lastRpcSendTime=1753, lastRpcResponseTime=1751)
2023-01-22 10:25:57,033 [s2@group-4446C9F0D259-LeaderStateImpl] WARN  server.RaftServer$Division (LeaderStateImpl.java:lambda$checkLeadership$19(1109)) - Follower s2@group-4446C9F0D259->s1(c3,m4,n5, attendVote=true, lastRpcSendTime=1754, lastRpcResponseTime=1751)
2023-01-22 10:25:57,033 [s2@group-4446C9F0D259-LeaderStateImpl] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s2@group-4446C9F0D259: changes role from    LEADER to FOLLOWER at term 1 for StepDownReason:LOST_MAJORITY_HEARTBEATS
2023-01-22 10:25:57,033 [s2@group-4446C9F0D259-LeaderStateImpl] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(93)) - s2: shutdown s2@group-4446C9F0D259-LeaderStateImpl
2023-01-22 10:25:57,034 [s2@group-4446C9F0D259-LeaderStateImpl] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(282)) - s2@group-4446C9F0D259-PendingRequests: sendNotLeaderResponses
2023-01-22 10:25:57,034 [s1@group-4446C9F0D259-FollowerState] WARN  impl.FollowerState (FollowerState.java:run(130)) - Unexpected long sleep: sleep 237ms but took extra 1683561073ns (> threshold = 300ms)
2023-01-22 10:25:57,034 [s0@group-4446C9F0D259-FollowerState] WARN  impl.FollowerState (FollowerState.java:run(130)) - Unexpected long sleep: sleep 197ms but took extra 1698214310ns (> threshold = 300ms)
2023-01-22 10:25:57,036 [s2@group-4446C9F0D259-LeaderStateImpl] INFO  server.RaftServer$Division (ServerState.java:setLeader(260)) - s2@group-4446C9F0D259: change Leader from s2 to null at term 1 for StepDownReason:LOST_MAJORITY_HEARTBEATS
2023-01-22 10:25:57,037 [s2@group-4446C9F0D259-LeaderStateImpl] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s2: start s2@group-4446C9F0D259-FollowerState
2023-01-22 10:25:57,049 [s2@group-4446C9F0D259->s0-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(198)) - s2@group-4446C9F0D259->s0-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2023-01-22 10:25:57,046 [s2@group-4446C9F0D259->s1-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(198)) - s2@group-4446C9F0D259->s1-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2023-01-22 10:25:57,058 [grpc-default-executor-6] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(143)) - s0: Completed APPEND_ENTRIES, lastRequest: s2->s0#27-t1,previous=(t:1, i:3),leaderCommit=3,initializing? true,entries: size=1, first=(t:1, i:4), METADATAENTRY(c:3)
2023-01-22 10:25:57,059 [grpc-default-executor-0] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(143)) - s1: Completed APPEND_ENTRIES, lastRequest: s2->s1#27-t1,previous=(t:1, i:3),leaderCommit=3,initializing? true,entries: size=1, first=(t:1, i:4), METADATAENTRY(c:3)
2023-01-22 10:25:57,060 [grpc-default-executor-2] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(412)) - s2@group-4446C9F0D259->s1-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2023-01-22 10:25:57,060 [grpc-default-executor-3] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(412)) - s2@group-4446C9F0D259->s0-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2023-01-22 10:25:57,060 [grpc-default-executor-2] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(52)) - s2@group-4446C9F0D259->s1: nextIndex: updateUnconditionally 5 -> 4
2023-01-22 10:25:57,060 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(52)) - s2@group-4446C9F0D259->s0: nextIndex: updateUnconditionally 5 -> 4
2023-01-22 10:25:57,060 [grpc-default-executor-3] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(143)) - s0: Completed APPEND_ENTRIES, lastRequest: null
2023-01-22 10:25:57,061 [grpc-default-executor-2] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(412)) - s2@group-4446C9F0D259->s0-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2023-01-22 10:25:57,061 [grpc-default-executor-2] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(52)) - s2@group-4446C9F0D259->s0: nextIndex: updateUnconditionally 4 -> 3
2023-01-22 10:25:57,061 [grpc-default-executor-3] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(143)) - s1: Completed APPEND_ENTRIES, lastRequest: null
2023-01-22 10:25:57,061 [grpc-default-executor-3] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(412)) - s2@group-4446C9F0D259->s1-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2023-01-22 10:25:57,061 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(52)) - s2@group-4446C9F0D259->s1: nextIndex: updateUnconditionally 4 -> 3
2023-01-22 10:25:57,296 [s1@group-4446C9F0D259-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s1@group-4446C9F0D259-FollowerState: change to CANDIDATE, lastRpcElapsedTime:2016003025ns, electionTimeout:262ms
2023-01-22 10:25:57,297 [s1@group-4446C9F0D259-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s1: shutdown s1@group-4446C9F0D259-FollowerState
2023-01-22 10:25:57,297 [s1@group-4446C9F0D259-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s1@group-4446C9F0D259: changes role from  FOLLOWER to CANDIDATE at term 1 for changeToCandidate
2023-01-22 10:25:57,297 [s1@group-4446C9F0D259-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2023-01-22 10:25:57,297 [s1@group-4446C9F0D259-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s1: start s1@group-4446C9F0D259-LeaderElection7
2023-01-22 10:25:57,304 [s1@group-4446C9F0D259-LeaderElection7] INFO  server.RaftServer$Division (ServerState.java:setLeader(260)) - s1@group-4446C9F0D259: change Leader from s2 to null at term 1 for PRE_VOTE
2023-01-22 10:25:57,305 [s1@group-4446C9F0D259-LeaderElection7] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(309)) - s1@group-4446C9F0D259-LeaderElection7 PRE_VOTE round 0: submit vote requests at term 1 for 0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2023-01-22 10:25:57,315 [s0@group-4446C9F0D259-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - s0@group-4446C9F0D259-FollowerState: change to CANDIDATE, lastRpcElapsedTime:2033930546ns, electionTimeout:280ms
2023-01-22 10:25:57,315 [s0@group-4446C9F0D259-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s0: shutdown s0@group-4446C9F0D259-FollowerState
2023-01-22 10:25:57,315 [s0@group-4446C9F0D259-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s0@group-4446C9F0D259: changes role from  FOLLOWER to CANDIDATE at term 1 for changeToCandidate
2023-01-22 10:25:57,315 [s0@group-4446C9F0D259-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.leaderelection.pre-vote = true (default)
2023-01-22 10:25:57,315 [s0@group-4446C9F0D259-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-4446C9F0D259-LeaderElection8
2023-01-22 10:25:57,323 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1298)) - s0@group-4446C9F0D259: receive requestVote(PRE_VOTE, s1, group-4446C9F0D259, 1, (t:1, i:4))
2023-01-22 10:25:57,323 [grpc-default-executor-6] INFO  impl.VoteContext (VoteContext.java:log(49)) - s0@group-4446C9F0D259-CANDIDATE: accept PRE_VOTE from s1: our priority 0 <= candidate's priority 0
2023-01-22 10:25:57,323 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1331)) - s0@group-4446C9F0D259 replies to PRE_VOTE vote request: s1<-s0#0:OK-t1. Peer's state: s0@group-4446C9F0D259:t1, leader=s2, voted=s2, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c3, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2023-01-22 10:25:57,336 [s0@group-4446C9F0D259-LeaderElection8] INFO  server.RaftServer$Division (ServerState.java:setLeader(260)) - s0@group-4446C9F0D259: change Leader from s2 to null at term 1 for PRE_VOTE
2023-01-22 10:25:57,336 [s0@group-4446C9F0D259-LeaderElection8] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(309)) - s0@group-4446C9F0D259-LeaderElection8 PRE_VOTE round 0: submit vote requests at term 1 for 0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2023-01-22 10:25:57,341 [s1@group-4446C9F0D259-LeaderElection7] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s1@group-4446C9F0D259-LeaderElection7: PRE_VOTE PASSED received 1 response(s) and 0 exception(s):
2023-01-22 10:25:57,341 [s1@group-4446C9F0D259-LeaderElection7] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s1<-s0#0:OK-t1
2023-01-22 10:25:57,341 [s1@group-4446C9F0D259-LeaderElection7] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(311)) - s1@group-4446C9F0D259-LeaderElection7 PRE_VOTE round 0: result PASSED
2023-01-22 10:25:57,349 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1298)) - s1@group-4446C9F0D259: receive requestVote(PRE_VOTE, s0, group-4446C9F0D259, 1, (t:1, i:4))
2023-01-22 10:25:57,351 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1298)) - s2@group-4446C9F0D259: receive requestVote(PRE_VOTE, s0, group-4446C9F0D259, 1, (t:1, i:4))
2023-01-22 10:25:57,351 [grpc-default-executor-6] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-4446C9F0D259-FOLLOWER: accept PRE_VOTE from s0: our priority 0 <= candidate's priority 0
2023-01-22 10:25:57,352 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1331)) - s2@group-4446C9F0D259 replies to PRE_VOTE vote request: s0<-s2#0:OK-t1. Peer's state: s2@group-4446C9F0D259:t1, leader=null, voted=s2, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c4, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2023-01-22 10:25:57,353 [s0@group-4446C9F0D259-LeaderElection8] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s0@group-4446C9F0D259-LeaderElection8: PRE_VOTE PASSED received 1 response(s) and 0 exception(s):
2023-01-22 10:25:57,353 [s0@group-4446C9F0D259-LeaderElection8] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s0<-s2#0:OK-t1
2023-01-22 10:25:57,353 [s0@group-4446C9F0D259-LeaderElection8] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(311)) - s0@group-4446C9F0D259-LeaderElection8 PRE_VOTE round 0: result PASSED
2023-01-22 10:25:57,354 [s1@group-4446C9F0D259-LeaderElection7] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(309)) - s1@group-4446C9F0D259-LeaderElection7 ELECTION round 0: submit vote requests at term 2 for 0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2023-01-22 10:25:57,354 [grpc-default-executor-3] INFO  impl.VoteContext (VoteContext.java:log(49)) - s1@group-4446C9F0D259-CANDIDATE: accept PRE_VOTE from s0: our priority 0 <= candidate's priority 0
2023-01-22 10:25:57,354 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1331)) - s1@group-4446C9F0D259 replies to PRE_VOTE vote request: s0<-s1#0:OK-t2. Peer's state: s1@group-4446C9F0D259:t2, leader=null, voted=s1, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c3, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2023-01-22 10:25:57,355 [s0@group-4446C9F0D259-LeaderElection8] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(309)) - s0@group-4446C9F0D259-LeaderElection8 ELECTION round 0: submit vote requests at term 2 for 0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2023-01-22 10:25:57,358 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1298)) - s2@group-4446C9F0D259: receive requestVote(PRE_VOTE, s1, group-4446C9F0D259, 1, (t:1, i:4))
2023-01-22 10:25:57,358 [grpc-default-executor-2] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-4446C9F0D259-FOLLOWER: accept PRE_VOTE from s1: our priority 0 <= candidate's priority 0
2023-01-22 10:25:57,359 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1331)) - s2@group-4446C9F0D259 replies to PRE_VOTE vote request: s1<-s2#0:OK-t1. Peer's state: s2@group-4446C9F0D259:t1, leader=null, voted=s2, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c4, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2023-01-22 10:25:57,361 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1298)) - s0@group-4446C9F0D259: receive requestVote(ELECTION, s1, group-4446C9F0D259, 2, (t:1, i:4))
2023-01-22 10:25:57,361 [grpc-default-executor-2] INFO  impl.VoteContext (VoteContext.java:log(49)) - s0@group-4446C9F0D259-CANDIDATE: reject ELECTION from s1: already has voted for s0 at current term 2
2023-01-22 10:25:57,361 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1331)) - s0@group-4446C9F0D259 replies to ELECTION vote request: s1<-s0#0:FAIL-t2. Peer's state: s0@group-4446C9F0D259:t2, leader=null, voted=s0, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c3, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2023-01-22 10:25:57,374 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1298)) - s2@group-4446C9F0D259: receive requestVote(ELECTION, s0, group-4446C9F0D259, 2, (t:1, i:4))
2023-01-22 10:25:57,374 [grpc-default-executor-2] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-4446C9F0D259-FOLLOWER: accept ELECTION from s0: our priority 0 <= candidate's priority 0
2023-01-22 10:25:57,374 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s2@group-4446C9F0D259: changes role from  FOLLOWER to FOLLOWER at term 2 for candidate:s0
2023-01-22 10:25:57,374 [grpc-default-executor-2] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(110)) - s2: shutdown s2@group-4446C9F0D259-FollowerState
2023-01-22 10:25:57,374 [grpc-default-executor-2] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s2: start s2@group-4446C9F0D259-FollowerState
2023-01-22 10:25:57,375 [s2@group-4446C9F0D259-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(152)) - s2@group-4446C9F0D259-FollowerState was interrupted
2023-01-22 10:25:57,381 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1298)) - s1@group-4446C9F0D259: receive requestVote(ELECTION, s0, group-4446C9F0D259, 2, (t:1, i:4))
2023-01-22 10:25:57,381 [grpc-default-executor-3] INFO  impl.VoteContext (VoteContext.java:log(49)) - s1@group-4446C9F0D259-CANDIDATE: reject ELECTION from s0: already has voted for s1 at current term 2
2023-01-22 10:25:57,381 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1331)) - s1@group-4446C9F0D259 replies to ELECTION vote request: s0<-s1#0:FAIL-t2. Peer's state: s1@group-4446C9F0D259:t2, leader=null, voted=s1, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c3, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2023-01-22 10:25:57,382 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1298)) - s2@group-4446C9F0D259: receive requestVote(ELECTION, s1, group-4446C9F0D259, 2, (t:1, i:4))
2023-01-22 10:25:57,420 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1331)) - s2@group-4446C9F0D259 replies to ELECTION vote request: s0<-s2#0:OK-t2. Peer's state: s2@group-4446C9F0D259:t2, leader=null, voted=s0, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c4, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2023-01-22 10:25:57,420 [grpc-default-executor-6] INFO  impl.VoteContext (VoteContext.java:log(49)) - s2@group-4446C9F0D259-FOLLOWER: reject ELECTION from s1: already has voted for s0 at current term 2
2023-01-22 10:25:57,420 [grpc-default-executor-6] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1331)) - s2@group-4446C9F0D259 replies to ELECTION vote request: s1<-s2#0:FAIL-t2. Peer's state: s2@group-4446C9F0D259:t2, leader=null, voted=s0, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c4, conf=0: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2023-01-22 10:25:57,421 [s0@group-4446C9F0D259-LeaderElection8] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s0@group-4446C9F0D259-LeaderElection8: ELECTION PASSED received 2 response(s) and 0 exception(s):
2023-01-22 10:25:57,421 [s0@group-4446C9F0D259-LeaderElection8] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s0<-s1#0:FAIL-t2
2023-01-22 10:25:57,421 [s0@group-4446C9F0D259-LeaderElection8] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 1: s0<-s2#0:OK-t2
2023-01-22 10:25:57,421 [s0@group-4446C9F0D259-LeaderElection8] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(311)) - s0@group-4446C9F0D259-LeaderElection8 ELECTION round 0: result PASSED
2023-01-22 10:25:57,421 [s0@group-4446C9F0D259-LeaderElection8] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(130)) - s0: shutdown s0@group-4446C9F0D259-LeaderElection8
2023-01-22 10:25:57,421 [s0@group-4446C9F0D259-LeaderElection8] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s0@group-4446C9F0D259: changes role from CANDIDATE to LEADER at term 2 for changeToLeader
2023-01-22 10:25:57,421 [s0@group-4446C9F0D259-LeaderElection8] INFO  server.RaftServer$Division (ServerState.java:setLeader(260)) - s0@group-4446C9F0D259: change Leader from null to s0 at term 2 for becomeLeader, leader elected after 85ms
2023-01-22 10:25:57,421 [s0@group-4446C9F0D259-LeaderElection8] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.staging.catchup.gap = 1000 (default)
2023-01-22 10:25:57,421 [s0@group-4446C9F0D259-LeaderElection8] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.element-limit = 4096 (default)
2023-01-22 10:25:57,421 [s0@group-4446C9F0D259-LeaderElection8] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.byte-limit = 64MB (=67108864) (default)
2023-01-22 10:25:57,422 [s1@group-4446C9F0D259-LeaderElection7] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - s1@group-4446C9F0D259-LeaderElection7: ELECTION REJECTED received 2 response(s) and 0 exception(s):
2023-01-22 10:25:57,422 [s1@group-4446C9F0D259-LeaderElection7] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: s1<-s0#0:FAIL-t2
2023-01-22 10:25:57,422 [s1@group-4446C9F0D259-LeaderElection7] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 1: s1<-s2#0:FAIL-t2
2023-01-22 10:25:57,422 [s1@group-4446C9F0D259-LeaderElection7] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(311)) - s1@group-4446C9F0D259-LeaderElection7 ELECTION round 0: result REJECTED
2023-01-22 10:25:57,422 [s1@group-4446C9F0D259-LeaderElection7] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(325)) - s1@group-4446C9F0D259: changes role from CANDIDATE to FOLLOWER at term 2 for REJECTED
2023-01-22 10:25:57,422 [s1@group-4446C9F0D259-LeaderElection7] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(130)) - s1: shutdown s1@group-4446C9F0D259-LeaderElection7
2023-01-22 10:25:57,422 [s1@group-4446C9F0D259-LeaderElection7] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s1: start s1@group-4446C9F0D259-FollowerState
2023-01-22 10:25:57,422 [s0@group-4446C9F0D259-LeaderElection8] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.timeout = 10s (default)
2023-01-22 10:25:57,422 [s0@group-4446C9F0D259-LeaderElection8] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.timeout.denomination = 1s (default)
2023-01-22 10:25:57,422 [s0@group-4446C9F0D259-LeaderElection8] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.watch.element-limit = 65536 (default)
2023-01-22 10:25:57,422 [s0@group-4446C9F0D259-LeaderElection8] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.element-limit = 4096 (default)
2023-01-22 10:25:57,422 [s0@group-4446C9F0D259-LeaderElection8] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.write.follower.gap.ratio.max = -1.0 (default)
2023-01-22 10:25:57,423 [s0@group-4446C9F0D259-LeaderElection8] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-01-22 10:25:57,423 [s0@group-4446C9F0D259-LeaderElection8] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-01-22 10:25:57,423 [s0@group-4446C9F0D259-LeaderElection8] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-01-22 10:25:57,423 [s0@group-4446C9F0D259-LeaderElection8] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-01-22 10:25:57,423 [s0@group-4446C9F0D259-LeaderElection8] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-01-22 10:25:57,423 [s0@group-4446C9F0D259-LeaderElection8] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-01-22 10:25:57,423 [s0@group-4446C9F0D259-LeaderElection8] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-01-22 10:25:57,423 [s0@group-4446C9F0D259-LeaderElection8] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 10ms (default)
2023-01-22 10:25:57,424 [s0@group-4446C9F0D259-LeaderElection8] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2023-01-22 10:25:57,424 [s0@group-4446C9F0D259-LeaderElection8] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2023-01-22 10:25:57,424 [s0@group-4446C9F0D259-LeaderElection8] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.buffer.element-limit = 0 (default)
2023-01-22 10:25:57,424 [s0@group-4446C9F0D259-LeaderElection8] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2023-01-22 10:25:57,424 [s0@group-4446C9F0D259-LeaderElection8] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.rpc.request.timeout = 3000ms (default)
2023-01-22 10:25:57,424 [s0@group-4446C9F0D259-LeaderElection8] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2023-01-22 10:25:57,424 [s0@group-4446C9F0D259-LeaderElection8] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(46)) - raft.grpc.server.heartbeat.channel = true (default)
2023-01-22 10:25:57,424 [s0@group-4446C9F0D259-LeaderElection8] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(46)) - raft.server.log.appender.wait-time.min = 10ms (default)
2023-01-22 10:25:57,424 [s0@group-4446C9F0D259-LeaderElection8] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(139)) - s0: start s0@group-4446C9F0D259-LeaderStateImpl
2023-01-22 10:25:57,424 [s0@group-4446C9F0D259-LeaderElection8] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(436)) - s0@group-4446C9F0D259-SegmentedRaftLogWorker: Rolling segment log-0_4 to index:4
2023-01-22 10:25:57,427 [s0@group-4446C9F0D259-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s0/413bbc71-f185-43d2-9989-4446c9f0d259/current/log_inprogress_0 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s0/413bbc71-f185-43d2-9989-4446c9f0d259/current/log_0-4
2023-01-22 10:25:57,427 [s0@group-4446C9F0D259-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(592)) - s0@group-4446C9F0D259-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s0/413bbc71-f185-43d2-9989-4446c9f0d259/current/log_inprogress_0 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s0/413bbc71-f185-43d2-9989-4446c9f0d259/current/log_0-4
2023-01-22 10:25:57,458 [s0@group-4446C9F0D259-LeaderElection8] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(378)) - s0@group-4446C9F0D259: set configuration 5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2023-01-22 10:25:57,462 [s0@group-4446C9F0D259-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(635)) - s0@group-4446C9F0D259-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s0/413bbc71-f185-43d2-9989-4446c9f0d259/current/log_inprogress_5
2023-01-22 10:25:57,464 [s1-server-thread3] INFO  server.RaftServer$Division (ServerState.java:setLeader(260)) - s1@group-4446C9F0D259: change Leader from null to s0 at term 2 for appendEntries, leader elected after 159ms
2023-01-22 10:25:57,471 [s2-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setLeader(260)) - s2@group-4446C9F0D259: change Leader from null to s0 at term 2 for appendEntries, leader elected after 434ms
2023-01-22 10:25:57,478 [s1-server-thread2] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(378)) - s1@group-4446C9F0D259: set configuration 5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2023-01-22 10:25:57,478 [s1-server-thread2] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(436)) - s1@group-4446C9F0D259-SegmentedRaftLogWorker: Rolling segment log-0_4 to index:4
2023-01-22 10:25:57,479 [s1@group-4446C9F0D259-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s1/413bbc71-f185-43d2-9989-4446c9f0d259/current/log_inprogress_0 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s1/413bbc71-f185-43d2-9989-4446c9f0d259/current/log_0-4
2023-01-22 10:25:57,479 [s1@group-4446C9F0D259-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(592)) - s1@group-4446C9F0D259-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s1/413bbc71-f185-43d2-9989-4446c9f0d259/current/log_inprogress_0 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s1/413bbc71-f185-43d2-9989-4446c9f0d259/current/log_0-4
2023-01-22 10:25:57,487 [s2-server-thread1] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(378)) - s2@group-4446C9F0D259: set configuration 5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null
2023-01-22 10:25:57,487 [s2-server-thread1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(436)) - s2@group-4446C9F0D259-SegmentedRaftLogWorker: Rolling segment log-0_4 to index:4
2023-01-22 10:25:57,488 [s2@group-4446C9F0D259-SegmentedRaftLogWorker] TRACE util.FileUtils (LogUtils.java:runAndLog(49)) - Successfully ran Atomic Files.move /home/runner/work/ratis/ratis/ratis-test/target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s2/413bbc71-f185-43d2-9989-4446c9f0d259/current/log_inprogress_0 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s2/413bbc71-f185-43d2-9989-4446c9f0d259/current/log_0-4
2023-01-22 10:25:57,488 [s2@group-4446C9F0D259-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(592)) - s2@group-4446C9F0D259-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ratis/ratis/ratis-test/target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s2/413bbc71-f185-43d2-9989-4446c9f0d259/current/log_inprogress_0 to /home/runner/work/ratis/ratis/ratis-test/target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s2/413bbc71-f185-43d2-9989-4446c9f0d259/current/log_0-4
2023-01-22 10:25:57,508 [s2@group-4446C9F0D259-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(635)) - s2@group-4446C9F0D259-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s2/413bbc71-f185-43d2-9989-4446c9f0d259/current/log_inprogress_5
2023-01-22 10:25:57,515 [s1@group-4446C9F0D259-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(635)) - s1@group-4446C9F0D259-SegmentedRaftLogWorker: created new log segment /home/runner/work/ratis/ratis/ratis-test/target/test/data/b0cd0f94/MiniRaftClusterWithRpcTypeGrpcAndDataStreamTypeNetty18eef55e/s1/413bbc71-f185-43d2-9989-4446c9f0d259/current/log_inprogress_5
2023-01-22 10:25:57,606 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2023-01-22 10:25:57,818 [s2-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2023-01-22 10:25:57,819 [s2-server-thread1] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s0->s2#13-t2,previous=(t:2, i:6),leaderCommit=6,initializing? true,entries: size=1, first=(t:2, i:7), STATEMACHINELOGENTRY, 380@client-57A28927E51B
java.util.concurrent.CompletionException: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$BiRelay.tryFire(CompletableFuture.java:1423)
	at java.base/java.util.concurrent.CompletableFuture$CoCompletion.tryFire(CompletableFuture.java:1144)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog$Task.failed(SegmentedRaftLog.java:105)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.failed(SegmentedRaftLogWorker.java:519)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:317)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:25:57,827 [s1-server-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2023-01-22 10:25:57,834 [s0-client-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2023-01-22 10:25:57,834 [s1-server-thread2] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s1: Failed APPEND_ENTRIES request s0->s1#12-t2,previous=(t:2, i:6),leaderCommit=6,initializing? true,entries: size=1, first=(t:2, i:7), STATEMACHINELOGENTRY, 380@client-57A28927E51B
java.util.concurrent.CompletionException: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$BiRelay.tryFire(CompletableFuture.java:1423)
	at java.base/java.util.concurrent.CompletableFuture$CoCompletion.tryFire(CompletableFuture.java:1144)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog$Task.failed(SegmentedRaftLog.java:105)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.failed(SegmentedRaftLogWorker.java:519)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:317)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:25:57,835 [s1-server-thread3] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2023-01-22 10:25:57,835 [s2-server-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2023-01-22 10:25:57,848 [s2-server-thread2] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s0->s2#14-t2,previous=(t:2, i:7),leaderCommit=6,initializing? true,entries: size=1, first=(t:2, i:8), STATEMACHINELOGENTRY, 377@client-4ACD4B782495
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$BiRelay.tryFire(CompletableFuture.java:1423)
	at java.base/java.util.concurrent.CompletableFuture$CoCompletion.tryFire(CompletableFuture.java:1144)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog$Task.failed(SegmentedRaftLog.java:105)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.failed(SegmentedRaftLogWorker.java:519)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:317)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:25:57,848 [s1-server-thread3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s1: Failed APPEND_ENTRIES request s0->s1#13-t2,previous=(t:2, i:7),leaderCommit=6,initializing? true,entries: size=1, first=(t:2, i:8), STATEMACHINELOGENTRY, 377@client-4ACD4B782495
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$BiRelay.tryFire(CompletableFuture.java:1423)
	at java.base/java.util.concurrent.CompletableFuture$CoCompletion.tryFire(CompletableFuture.java:1144)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog$Task.failed(SegmentedRaftLog.java:105)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.failed(SegmentedRaftLogWorker.java:519)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:317)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:25:57,893 [grpc-default-executor-0] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-4446C9F0D259->s2-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:25:57,895 [grpc-default-executor-0] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(52)) - s0@group-4446C9F0D259->s2: nextIndex: updateUnconditionally 9 -> 7
2023-01-22 10:25:57,899 [grpc-default-executor-6] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-4446C9F0D259->s1-AppendLogResponseHandler: Failed appendEntries
java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:25:57,901 [grpc-default-executor-6] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(52)) - s0@group-4446C9F0D259->s1: nextIndex: updateUnconditionally 9 -> 7
2023-01-22 10:25:58,681 [pool-9-thread-16] INFO  datastream.DataStreamTestUtils (DataStreamTestUtils.java:writeAndCloseAndAssertReplies(320)) - Stream382: bytesWritten=3744804
2023-01-22 10:25:58,693 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-BB15DEA19774->s0@group-4446C9F0D259, cid=382, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2023-01-22 10:25:58,694 [s1-server-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-BB15DEA19774->s0@group-4446C9F0D259, cid=382, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2023-01-22 10:25:58,695 [grpc-default-executor-2] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s1: Failed APPEND_ENTRIES request s0->s1#26-t2,previous=(t:2, i:8),leaderCommit=6,initializing? true,entries: size=1, first=(t:2, i:9), STATEMACHINELOGENTRY, 382@client-BB15DEA19774
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$BiRelay.tryFire(CompletableFuture.java:1423)
	at java.base/java.util.concurrent.CompletableFuture$CoCompletion.tryFire(CompletableFuture.java:1144)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog$Task.failed(SegmentedRaftLog.java:105)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.failed(SegmentedRaftLogWorker.java:519)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:317)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:25:58,698 [s2-server-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link SingleDataStream: writeRequest=RaftClientRequest:client-BB15DEA19774->s0@group-4446C9F0D259, cid=382, seq=0, DataStream, Message:<EMPTY>, logEntry=null
2023-01-22 10:25:58,701 [s2-server-thread2] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s0->s2#27-t2,previous=(t:2, i:8),leaderCommit=6,initializing? true,entries: size=1, first=(t:2, i:9), STATEMACHINELOGENTRY, 382@client-BB15DEA19774
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$BiRelay.tryFire(CompletableFuture.java:1423)
	at java.base/java.util.concurrent.CompletableFuture$CoCompletion.tryFire(CompletableFuture.java:1144)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog$Task.failed(SegmentedRaftLog.java:105)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.failed(SegmentedRaftLogWorker.java:519)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:317)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:25:58,724 [grpc-default-executor-2] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-4446C9F0D259->s2-AppendLogResponseHandler: Failed appendEntries
org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:25:58,724 [grpc-default-executor-2] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(52)) - s0@group-4446C9F0D259->s2: nextIndex: updateUnconditionally 10 -> 9
2023-01-22 10:25:58,715 [grpc-default-executor-6] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-4446C9F0D259->s1-AppendLogResponseHandler: Failed appendEntries
org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:25:58,725 [grpc-default-executor-6] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(52)) - s0@group-4446C9F0D259->s1: nextIndex: updateUnconditionally 10 -> 9
2023-01-22 10:26:03,598 [timer2] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=393, target=localhost:42097}}. 
2023-01-22 10:26:03,636 [timer3] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=400, target=localhost:42097}}. 
2023-01-22 10:26:03,993 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4446C9F0D259:t2, leader=s0, voted=s1, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2023-01-22 10:26:04,693 [timer4] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=407, target=localhost:42097}}. 
2023-01-22 10:26:09,722 [timer7] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=421, target=localhost:42097}}. 
2023-01-22 10:26:10,824 [timer6] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=449, target=localhost:42097}}. 
2023-01-22 10:26:12,724 [timer7] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=435, target=localhost:42097}}. 
2023-01-22 10:26:13,993 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4446C9F0D259:t2, leader=s0, voted=s1, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2023-01-22 10:26:15,835 [timer2] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=463, target=localhost:42097}}. 
2023-01-22 10:26:16,942 [timer7] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=477, target=localhost:42097}}. 
2023-01-22 10:26:18,840 [timer1] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=491, target=localhost:42097}}. 
2023-01-22 10:26:21,946 [timer3] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=505, target=localhost:42097}}. 
2023-01-22 10:26:23,994 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4446C9F0D259:t2, leader=s0, voted=s1, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2023-01-22 10:26:24,949 [timer3] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=519, target=localhost:42097}}. 
2023-01-22 10:26:24,955 [timer7] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=533, target=localhost:42097}}. 
2023-01-22 10:26:28,064 [timer5] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=547, target=localhost:42097}}. 
2023-01-22 10:26:31,075 [timer5] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=568, target=localhost:42097}}. 
2023-01-22 10:26:31,079 [timer3] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=574, target=localhost:42097}}. 
2023-01-22 10:26:33,994 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4446C9F0D259:t2, leader=s0, voted=s1, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2023-01-22 10:26:34,175 [timer7] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=589, target=localhost:42097}}. 
2023-01-22 10:26:37,192 [timer2] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=610, target=localhost:42097}}. 
2023-01-22 10:26:37,196 [timer7] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=617, target=localhost:42097}}. 
2023-01-22 10:26:43,209 [timer4] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=631, target=localhost:42097}}. 
2023-01-22 10:26:43,325 [timer3] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=659, target=localhost:42097}}. 
2023-01-22 10:26:43,995 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4446C9F0D259:t2, leader=s0, voted=s1, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2023-01-22 10:26:46,212 [timer4] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=652, target=localhost:42097}}. 
2023-01-22 10:26:52,225 [timer7] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=680, target=localhost:42097}}. 
2023-01-22 10:26:52,227 [timer4] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=687, target=localhost:42097}}. 
2023-01-22 10:26:53,994 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4446C9F0D259:t2, leader=s0, voted=s1, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2023-01-22 10:26:55,227 [timer7] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=701, target=localhost:42097}}. 
2023-01-22 10:26:58,343 [timer1] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=722, target=localhost:42097}}. 
2023-01-22 10:26:58,346 [timer2] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=728, target=localhost:42097}}. 
2023-01-22 10:26:58,470 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2023-01-22 10:26:58,475 [s2-server-thread3] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2023-01-22 10:26:58,475 [s1-server-thread3] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2023-01-22 10:26:58,477 [grpc-default-executor-0] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s0->s2#807-t2,previous=(t:2, i:9),leaderCommit=6,initializing? true,entries: size=1, first=(t:2, i:10), STATEMACHINELOGENTRY, 377@client-4ACD4B782495
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.andTree(CompletableFuture.java:1452)
	at java.base/java.util.concurrent.CompletableFuture.allOf(CompletableFuture.java:2337)
	at org.apache.ratis.util.JavaUtils.allOf(JavaUtils.java:278)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1535)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:26:58,480 [s1-server-thread3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s1: Failed APPEND_ENTRIES request s0->s1#806-t2,previous=(t:2, i:9),leaderCommit=6,initializing? true,entries: size=1, first=(t:2, i:10), STATEMACHINELOGENTRY, 377@client-4ACD4B782495
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$BiRelay.tryFire(CompletableFuture.java:1423)
	at java.base/java.util.concurrent.CompletableFuture$CoCompletion.tryFire(CompletableFuture.java:1144)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog$Task.failed(SegmentedRaftLog.java:105)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.failed(SegmentedRaftLogWorker.java:519)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:317)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:26:58,488 [grpc-default-executor-0] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-4446C9F0D259->s2-AppendLogResponseHandler: Failed appendEntries
org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:26:58,489 [grpc-default-executor-0] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(52)) - s0@group-4446C9F0D259->s2: nextIndex: updateUnconditionally 11 -> 10
2023-01-22 10:26:58,491 [grpc-default-executor-0] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-4446C9F0D259->s1-AppendLogResponseHandler: Failed appendEntries
org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:26:58,491 [grpc-default-executor-0] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(52)) - s0@group-4446C9F0D259->s1: nextIndex: updateUnconditionally 11 -> 10
2023-01-22 10:27:01,346 [timer6] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=743, target=localhost:42097}}. 
2023-01-22 10:27:01,351 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2023-01-22 10:27:01,352 [s1-server-thread3] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2023-01-22 10:27:01,353 [s1-server-thread3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s1: Failed APPEND_ENTRIES request s0->s1#845-t2,previous=(t:2, i:10),leaderCommit=6,initializing? true,entries: size=1, first=(t:2, i:11), STATEMACHINELOGENTRY, 380@client-57A28927E51B
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$BiRelay.tryFire(CompletableFuture.java:1423)
	at java.base/java.util.concurrent.CompletableFuture$CoCompletion.tryFire(CompletableFuture.java:1144)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog$Task.failed(SegmentedRaftLog.java:105)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.failed(SegmentedRaftLogWorker.java:519)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:317)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:27:01,357 [s2-server-thread3] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2023-01-22 10:27:01,358 [grpc-default-executor-6] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s0->s2#846-t2,previous=(t:2, i:10),leaderCommit=6,initializing? true,entries: size=1, first=(t:2, i:11), STATEMACHINELOGENTRY, 380@client-57A28927E51B
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.andTree(CompletableFuture.java:1452)
	at java.base/java.util.concurrent.CompletableFuture.allOf(CompletableFuture.java:2337)
	at org.apache.ratis.util.JavaUtils.allOf(JavaUtils.java:278)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1535)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:27:01,367 [grpc-default-executor-2] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-4446C9F0D259->s2-AppendLogResponseHandler: Failed appendEntries
org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:27:01,368 [grpc-default-executor-2] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(52)) - s0@group-4446C9F0D259->s2: nextIndex: updateUnconditionally 12 -> 11
2023-01-22 10:27:01,369 [grpc-default-executor-0] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-4446C9F0D259->s1-AppendLogResponseHandler: Failed appendEntries
org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:27:01,369 [grpc-default-executor-0] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(52)) - s0@group-4446C9F0D259->s1: nextIndex: updateUnconditionally 12 -> 11
2023-01-22 10:27:01,459 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2023-01-22 10:27:01,460 [s2-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2023-01-22 10:27:01,460 [s1-server-thread3] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2023-01-22 10:27:01,461 [s1-server-thread3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s1: Failed APPEND_ENTRIES request s0->s1#848-t2,previous=(t:2, i:11),leaderCommit=6,initializing? true,entries: size=1, first=(t:2, i:12), STATEMACHINELOGENTRY, 382@client-BB15DEA19774
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$BiRelay.tryFire(CompletableFuture.java:1423)
	at java.base/java.util.concurrent.CompletableFuture$CoCompletion.tryFire(CompletableFuture.java:1144)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog$Task.failed(SegmentedRaftLog.java:105)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.failed(SegmentedRaftLogWorker.java:519)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:317)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:27:01,461 [s2-server-thread1] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s0->s2#849-t2,previous=(t:2, i:11),leaderCommit=6,initializing? true,entries: size=1, first=(t:2, i:12), STATEMACHINELOGENTRY, 382@client-BB15DEA19774
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$BiRelay.tryFire(CompletableFuture.java:1423)
	at java.base/java.util.concurrent.CompletableFuture$CoCompletion.tryFire(CompletableFuture.java:1144)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog$Task.failed(SegmentedRaftLog.java:105)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.failed(SegmentedRaftLogWorker.java:519)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:317)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:27:01,468 [grpc-default-executor-0] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-4446C9F0D259->s2-AppendLogResponseHandler: Failed appendEntries
org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:27:01,468 [grpc-default-executor-0] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(52)) - s0@group-4446C9F0D259->s2: nextIndex: updateUnconditionally 13 -> 12
2023-01-22 10:27:01,472 [grpc-default-executor-1] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-4446C9F0D259->s1-AppendLogResponseHandler: Failed appendEntries
org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:27:01,472 [grpc-default-executor-1] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(52)) - s0@group-4446C9F0D259->s1: nextIndex: updateUnconditionally 13 -> 12
2023-01-22 10:27:03,995 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4446C9F0D259:t2, leader=s0, voted=s1, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2023-01-22 10:27:04,463 [timer5] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=764, target=localhost:42097}}. 
2023-01-22 10:27:07,348 [timer3] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=771, target=localhost:42097}}. 
2023-01-22 10:27:07,457 [timer0] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=785, target=localhost:42097}}. 
2023-01-22 10:27:13,359 [timer2] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=799, target=localhost:42097}}. 
2023-01-22 10:27:13,995 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4446C9F0D259:t2, leader=s0, voted=s1, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2023-01-22 10:27:16,362 [timer2] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=813, target=localhost:42097}}. 
2023-01-22 10:27:19,365 [timer2] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=827, target=localhost:42097}}. 
2023-01-22 10:27:19,472 [timer6] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=841, target=localhost:42097}}. 
2023-01-22 10:27:22,474 [timer0] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=855, target=localhost:42097}}. 
2023-01-22 10:27:23,996 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4446C9F0D259:t2, leader=s0, voted=s1, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2023-01-22 10:27:25,477 [timer7] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=869, target=localhost:42097}}. 
2023-01-22 10:27:25,587 [timer3] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=883, target=localhost:42097}}. 
2023-01-22 10:27:28,584 [timer2] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=897, target=localhost:42097}}. 
2023-01-22 10:27:31,592 [timer6] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=911, target=localhost:42097}}. 
2023-01-22 10:27:31,701 [timer2] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=925, target=localhost:42097}}. 
2023-01-22 10:27:33,995 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4446C9F0D259:t2, leader=s0, voted=s1, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2023-01-22 10:27:34,699 [timer1] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=939, target=localhost:42097}}. 
2023-01-22 10:27:37,707 [timer0] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=953, target=localhost:42097}}. 
2023-01-22 10:27:37,813 [timer3] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=967, target=localhost:42097}}. 
2023-01-22 10:27:43,713 [timer6] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=981, target=localhost:42097}}. 
2023-01-22 10:27:43,822 [timer7] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=995, target=localhost:42097}}. 
2023-01-22 10:27:43,922 [timer2] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1009, target=localhost:42097}}. 
2023-01-22 10:27:43,996 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4446C9F0D259:t2, leader=s0, voted=s1, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2023-01-22 10:27:49,827 [timer4] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1023, target=localhost:42097}}. 
2023-01-22 10:27:49,937 [timer2] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1037, target=localhost:42097}}. 
2023-01-22 10:27:52,940 [timer2] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1051, target=localhost:42097}}. 
2023-01-22 10:27:53,996 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4446C9F0D259:t2, leader=s0, voted=s1, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2023-01-22 10:27:55,938 [timer4] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1065, target=localhost:42097}}. 
2023-01-22 10:27:56,050 [timer2] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1079, target=localhost:42097}}. 
2023-01-22 10:27:59,051 [timer1] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1093, target=localhost:42097}}. 
2023-01-22 10:27:59,165 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2023-01-22 10:27:59,166 [s2-server-thread3] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2023-01-22 10:27:59,167 [grpc-default-executor-6] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s0->s2#1606-t2,previous=(t:2, i:12),leaderCommit=6,initializing? true,entries: size=1, first=(t:2, i:13), STATEMACHINELOGENTRY, 377@client-4ACD4B782495
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$BiRelay.tryFire(CompletableFuture.java:1423)
	at java.base/java.util.concurrent.CompletableFuture$CoCompletion.tryFire(CompletableFuture.java:1144)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog$Task.failed(SegmentedRaftLog.java:105)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.failed(SegmentedRaftLogWorker.java:519)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:317)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:27:59,168 [s1-server-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2023-01-22 10:27:59,170 [grpc-default-executor-1] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s1: Failed APPEND_ENTRIES request s0->s1#1604-t2,previous=(t:2, i:12),leaderCommit=6,initializing? true,entries: size=1, first=(t:2, i:13), STATEMACHINELOGENTRY, 377@client-4ACD4B782495
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$BiRelay.tryFire(CompletableFuture.java:1423)
	at java.base/java.util.concurrent.CompletableFuture.unipush(CompletableFuture.java:589)
	at java.base/java.util.concurrent.CompletableFuture.bipush(CompletableFuture.java:1172)
	at java.base/java.util.concurrent.CompletableFuture.andTree(CompletableFuture.java:1447)
	at java.base/java.util.concurrent.CompletableFuture.allOf(CompletableFuture.java:2337)
	at org.apache.ratis.util.JavaUtils.allOf(JavaUtils.java:278)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1535)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:27:59,176 [grpc-default-executor-1] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-4446C9F0D259->s1-AppendLogResponseHandler: Failed appendEntries
org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:27:59,176 [grpc-default-executor-1] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(52)) - s0@group-4446C9F0D259->s1: nextIndex: updateUnconditionally 14 -> 13
2023-01-22 10:27:59,177 [grpc-default-executor-6] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-4446C9F0D259->s2-AppendLogResponseHandler: Failed appendEntries
org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:27:59,177 [grpc-default-executor-6] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(52)) - s0@group-4446C9F0D259->s2: nextIndex: updateUnconditionally 14 -> 13
2023-01-22 10:28:02,048 [timer5] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1107, target=localhost:42097}}. 
2023-01-22 10:28:02,159 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2023-01-22 10:28:02,160 [s1-server-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2023-01-22 10:28:02,161 [s1-server-thread2] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s1: Failed APPEND_ENTRIES request s0->s1#1644-t2,previous=(t:2, i:13),leaderCommit=6,initializing? true,entries: size=1, first=(t:2, i:14), STATEMACHINELOGENTRY, 380@client-57A28927E51B
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$BiRelay.tryFire(CompletableFuture.java:1423)
	at java.base/java.util.concurrent.CompletableFuture$CoCompletion.tryFire(CompletableFuture.java:1144)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog$Task.failed(SegmentedRaftLog.java:105)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.failed(SegmentedRaftLogWorker.java:519)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:317)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:28:02,164 [s2-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2023-01-22 10:28:02,165 [timer1] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1121, target=localhost:42097}}. 
2023-01-22 10:28:02,165 [s2-server-thread1] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s0->s2#1646-t2,previous=(t:2, i:13),leaderCommit=6,initializing? true,entries: size=1, first=(t:2, i:14), STATEMACHINELOGENTRY, 380@client-57A28927E51B
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$BiRelay.tryFire(CompletableFuture.java:1423)
	at java.base/java.util.concurrent.CompletableFuture$CoCompletion.tryFire(CompletableFuture.java:1144)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog$Task.failed(SegmentedRaftLog.java:105)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.failed(SegmentedRaftLogWorker.java:519)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:317)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:28:02,169 [grpc-default-executor-2] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-4446C9F0D259->s2-AppendLogResponseHandler: Failed appendEntries
org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:28:02,169 [grpc-default-executor-2] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(52)) - s0@group-4446C9F0D259->s2: nextIndex: updateUnconditionally 15 -> 14
2023-01-22 10:28:02,175 [grpc-default-executor-2] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-4446C9F0D259->s1-AppendLogResponseHandler: Failed appendEntries
org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:28:02,176 [grpc-default-executor-2] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(52)) - s0@group-4446C9F0D259->s1: nextIndex: updateUnconditionally 15 -> 14
2023-01-22 10:28:02,279 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2023-01-22 10:28:02,279 [s2-server-thread3] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2023-01-22 10:28:02,279 [s1-server-thread3] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2023-01-22 10:28:02,280 [s2-server-thread3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s0->s2#1650-t2,previous=(t:2, i:14),leaderCommit=6,initializing? true,entries: size=1, first=(t:2, i:15), STATEMACHINELOGENTRY, 382@client-BB15DEA19774
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$BiRelay.tryFire(CompletableFuture.java:1423)
	at java.base/java.util.concurrent.CompletableFuture$CoCompletion.tryFire(CompletableFuture.java:1144)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog$Task.failed(SegmentedRaftLog.java:105)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.failed(SegmentedRaftLogWorker.java:519)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:317)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:28:02,281 [grpc-default-executor-2] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s1: Failed APPEND_ENTRIES request s0->s1#1648-t2,previous=(t:2, i:14),leaderCommit=6,initializing? true,entries: size=1, first=(t:2, i:15), STATEMACHINELOGENTRY, 382@client-BB15DEA19774
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$BiRelay.tryFire(CompletableFuture.java:1423)
	at java.base/java.util.concurrent.CompletableFuture$CoCompletion.tryFire(CompletableFuture.java:1144)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog$Task.failed(SegmentedRaftLog.java:105)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.failed(SegmentedRaftLogWorker.java:519)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:317)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:28:02,286 [grpc-default-executor-2] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-4446C9F0D259->s2-AppendLogResponseHandler: Failed appendEntries
org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:28:02,286 [grpc-default-executor-2] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(52)) - s0@group-4446C9F0D259->s2: nextIndex: updateUnconditionally 16 -> 15
2023-01-22 10:28:02,288 [grpc-default-executor-2] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-4446C9F0D259->s1-AppendLogResponseHandler: Failed appendEntries
org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:28:02,289 [grpc-default-executor-2] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(52)) - s0@group-4446C9F0D259->s1: nextIndex: updateUnconditionally 16 -> 15
2023-01-22 10:28:03,997 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4446C9F0D259:t2, leader=s0, voted=s1, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2023-01-22 10:28:05,164 [timer3] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1135, target=localhost:42097}}. 
2023-01-22 10:28:08,158 [timer7] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1149, target=localhost:42097}}. 
2023-01-22 10:28:08,276 [timer1] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1163, target=localhost:42097}}. 
2023-01-22 10:28:13,996 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4446C9F0D259:t2, leader=s0, voted=s1, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2023-01-22 10:28:14,160 [timer6] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1177, target=localhost:42097}}. 
2023-01-22 10:28:14,271 [timer5] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1191, target=localhost:42097}}. 
2023-01-22 10:28:17,279 [timer5] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1205, target=localhost:42097}}. 
2023-01-22 10:28:20,281 [timer3] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1219, target=localhost:42097}}. 
2023-01-22 10:28:20,388 [timer4] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1233, target=localhost:42097}}. 
2023-01-22 10:28:23,392 [timer7] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1247, target=localhost:42097}}. 
2023-01-22 10:28:23,997 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4446C9F0D259:t2, leader=s0, voted=s1, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2023-01-22 10:28:26,397 [timer3] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1261, target=localhost:42097}}. 
2023-01-22 10:28:26,505 [timer5] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1275, target=localhost:42097}}. 
2023-01-22 10:28:32,511 [timer4] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1296, target=localhost:42097}}. 
2023-01-22 10:28:32,511 [timer3] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1300, target=localhost:42097}}. 
2023-01-22 10:28:32,616 [timer6] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1317, target=localhost:42097}}. 
2023-01-22 10:28:33,996 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4446C9F0D259:t2, leader=s0, voted=s1, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2023-01-22 10:28:38,627 [timer5] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1338, target=localhost:42097}}. 
2023-01-22 10:28:38,632 [timer6] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1344, target=localhost:42097}}. 
2023-01-22 10:28:38,727 [timer7] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1359, target=localhost:42097}}. 
2023-01-22 10:28:43,996 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4446C9F0D259:t2, leader=s0, voted=s1, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2023-01-22 10:28:44,740 [timer5] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1380, target=localhost:42097}}. 
2023-01-22 10:28:44,745 [timer6] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1387, target=localhost:42097}}. 
2023-01-22 10:28:47,744 [timer5] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1401, target=localhost:42097}}. 
2023-01-22 10:28:50,856 [timer1] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1422, target=localhost:42097}}. 
2023-01-22 10:28:50,859 [timer2] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1429, target=localhost:42097}}. 
2023-01-22 10:28:53,851 [timer3] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1443, target=localhost:42097}}. 
2023-01-22 10:28:53,996 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4446C9F0D259:t2, leader=s0, voted=s1, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2023-01-22 10:28:56,980 [timer5] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1464, target=localhost:42097}}. 
2023-01-22 10:28:59,857 [timer7] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1471, target=localhost:42097}}. 
2023-01-22 10:28:59,983 [timer5] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1485, target=localhost:42097}}. 
2023-01-22 10:29:00,000 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2023-01-22 10:29:00,001 [s2-server-thread3] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2023-01-22 10:29:00,001 [grpc-default-executor-2] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s0->s2#2409-t2,previous=(t:2, i:15),leaderCommit=6,initializing? true,entries: size=1, first=(t:2, i:16), STATEMACHINELOGENTRY, 377@client-4ACD4B782495
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.andTree(CompletableFuture.java:1452)
	at java.base/java.util.concurrent.CompletableFuture.allOf(CompletableFuture.java:2337)
	at org.apache.ratis.util.JavaUtils.allOf(JavaUtils.java:278)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1535)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:29:00,004 [s1-server-thread3] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2023-01-22 10:29:00,004 [grpc-default-executor-2] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s1: Failed APPEND_ENTRIES request s0->s1#2407-t2,previous=(t:2, i:15),leaderCommit=6,initializing? true,entries: size=1, first=(t:2, i:16), STATEMACHINELOGENTRY, 377@client-4ACD4B782495
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$BiRelay.tryFire(CompletableFuture.java:1423)
	at java.base/java.util.concurrent.CompletableFuture$CoCompletion.tryFire(CompletableFuture.java:1144)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog$Task.failed(SegmentedRaftLog.java:105)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.failed(SegmentedRaftLogWorker.java:519)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:317)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:29:00,013 [grpc-default-executor-6] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-4446C9F0D259->s2-AppendLogResponseHandler: Failed appendEntries
org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:29:00,013 [grpc-default-executor-6] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(52)) - s0@group-4446C9F0D259->s2: nextIndex: updateUnconditionally 17 -> 16
2023-01-22 10:29:00,015 [grpc-default-executor-6] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-4446C9F0D259->s1-AppendLogResponseHandler: Failed appendEntries
org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:29:00,015 [grpc-default-executor-6] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(52)) - s0@group-4446C9F0D259->s1: nextIndex: updateUnconditionally 17 -> 16
2023-01-22 10:29:03,996 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4446C9F0D259:t2, leader=s0, voted=s1, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2023-01-22 10:29:05,968 [timer0] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1499, target=localhost:42097}}. 
2023-01-22 10:29:05,999 [timer6] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1513, target=localhost:42097}}. 
2023-01-22 10:29:06,082 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2023-01-22 10:29:06,083 [s1-server-thread3] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2023-01-22 10:29:06,083 [s2-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2023-01-22 10:29:06,083 [grpc-default-executor-2] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s1: Failed APPEND_ENTRIES request s0->s1#2488-t2,previous=(t:2, i:16),leaderCommit=6,initializing? true,entries: size=1, first=(t:2, i:17), STATEMACHINELOGENTRY, 382@client-BB15DEA19774
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$BiRelay.tryFire(CompletableFuture.java:1423)
	at java.base/java.util.concurrent.CompletableFuture$CoCompletion.tryFire(CompletableFuture.java:1144)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog$Task.failed(SegmentedRaftLog.java:105)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.failed(SegmentedRaftLogWorker.java:519)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:317)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:29:06,083 [grpc-default-executor-8] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s0->s2#2490-t2,previous=(t:2, i:16),leaderCommit=6,initializing? true,entries: size=1, first=(t:2, i:17), STATEMACHINELOGENTRY, 382@client-BB15DEA19774
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.andTree(CompletableFuture.java:1452)
	at java.base/java.util.concurrent.CompletableFuture.allOf(CompletableFuture.java:2337)
	at org.apache.ratis.util.JavaUtils.allOf(JavaUtils.java:278)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1535)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:29:06,093 [timer7] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1527, target=localhost:42097}}. 
2023-01-22 10:29:06,099 [grpc-default-executor-8] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-4446C9F0D259->s1-AppendLogResponseHandler: Failed appendEntries
org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:29:06,100 [grpc-default-executor-8] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(52)) - s0@group-4446C9F0D259->s1: nextIndex: updateUnconditionally 18 -> 17
2023-01-22 10:29:06,101 [grpc-default-executor-8] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-4446C9F0D259->s2-AppendLogResponseHandler: Failed appendEntries
org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:29:06,101 [grpc-default-executor-8] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(52)) - s0@group-4446C9F0D259->s2: nextIndex: updateUnconditionally 18 -> 17
2023-01-22 10:29:06,212 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2023-01-22 10:29:06,213 [s2-server-thread3] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2023-01-22 10:29:06,213 [grpc-default-executor-1] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s0->s2#2493-t2,previous=(t:2, i:17),leaderCommit=6,initializing? true,entries: size=1, first=(t:2, i:18), STATEMACHINELOGENTRY, 380@client-57A28927E51B
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.andTree(CompletableFuture.java:1452)
	at java.base/java.util.concurrent.CompletableFuture.allOf(CompletableFuture.java:2337)
	at org.apache.ratis.util.JavaUtils.allOf(JavaUtils.java:278)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1535)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:29:06,218 [s1-server-thread3] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2023-01-22 10:29:06,218 [s1-server-thread3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s1: Failed APPEND_ENTRIES request s0->s1#2491-t2,previous=(t:2, i:17),leaderCommit=6,initializing? true,entries: size=1, first=(t:2, i:18), STATEMACHINELOGENTRY, 380@client-57A28927E51B
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$BiRelay.tryFire(CompletableFuture.java:1423)
	at java.base/java.util.concurrent.CompletableFuture$CoCompletion.tryFire(CompletableFuture.java:1144)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog$Task.failed(SegmentedRaftLog.java:105)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.failed(SegmentedRaftLogWorker.java:519)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:317)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:29:06,221 [grpc-default-executor-1] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-4446C9F0D259->s2-AppendLogResponseHandler: Failed appendEntries
org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:29:06,221 [grpc-default-executor-1] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(52)) - s0@group-4446C9F0D259->s2: nextIndex: updateUnconditionally 19 -> 18
2023-01-22 10:29:06,223 [grpc-default-executor-1] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-4446C9F0D259->s1-AppendLogResponseHandler: Failed appendEntries
org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:29:06,224 [grpc-default-executor-1] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(52)) - s0@group-4446C9F0D259->s1: nextIndex: updateUnconditionally 19 -> 18
2023-01-22 10:29:12,079 [timer3] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1541, target=localhost:42097}}. 
2023-01-22 10:29:12,112 [timer0] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1555, target=localhost:42097}}. 
2023-01-22 10:29:12,209 [timer1] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1569, target=localhost:42097}}. 
2023-01-22 10:29:13,996 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4446C9F0D259:t2, leader=s0, voted=s1, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2023-01-22 10:29:18,191 [timer3] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1583, target=localhost:42097}}. 
2023-01-22 10:29:18,231 [timer4] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1597, target=localhost:42097}}. 
2023-01-22 10:29:18,322 [timer5] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1611, target=localhost:42097}}. 
2023-01-22 10:29:23,997 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4446C9F0D259:t2, leader=s0, voted=s1, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2023-01-22 10:29:24,303 [timer4] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1625, target=localhost:42097}}. 
2023-01-22 10:29:24,432 [timer5] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1653, target=localhost:42097}}. 
2023-01-22 10:29:27,304 [timer4] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1639, target=localhost:42097}}. 
2023-01-22 10:29:30,543 [timer1] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1667, target=localhost:42097}}. 
2023-01-22 10:29:33,315 [timer4] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1681, target=localhost:42097}}. 
2023-01-22 10:29:33,419 [timer5] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1695, target=localhost:42097}}. 
2023-01-22 10:29:33,996 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4446C9F0D259:t2, leader=s0, voted=s1, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2023-01-22 10:29:36,652 [timer3] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1709, target=localhost:42097}}. 
2023-01-22 10:29:39,429 [timer4] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1723, target=localhost:42097}}. 
2023-01-22 10:29:39,532 [timer7] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1737, target=localhost:42097}}. 
2023-01-22 10:29:42,763 [timer6] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1751, target=localhost:42097}}. 
2023-01-22 10:29:43,997 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4446C9F0D259:t2, leader=s0, voted=s1, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2023-01-22 10:29:45,643 [timer5] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1779, target=localhost:42097}}. 
2023-01-22 10:29:45,766 [timer6] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1765, target=localhost:42097}}. 
2023-01-22 10:29:51,751 [timer0] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1793, target=localhost:42097}}. 
2023-01-22 10:29:51,775 [timer4] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1807, target=localhost:42097}}. 
2023-01-22 10:29:51,880 [timer7] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1821, target=localhost:42097}}. 
2023-01-22 10:29:53,996 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4446C9F0D259:t2, leader=s0, voted=s1, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2023-01-22 10:29:57,863 [timer3] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1835, target=localhost:42097}}. 
2023-01-22 10:29:57,883 [timer4] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1849, target=localhost:42097}}. 
2023-01-22 10:29:57,988 [timer6] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1863, target=localhost:42097}}. 
2023-01-22 10:30:03,974 [timer1] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1877, target=localhost:42097}}. 
2023-01-22 10:30:03,993 [timer4] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1891, target=localhost:42097}}. 
2023-01-22 10:30:03,996 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4446C9F0D259:t2, leader=s0, voted=s1, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2023-01-22 10:30:04,085 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2023-01-22 10:30:04,086 [s1-server-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2023-01-22 10:30:04,086 [s2-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2023-01-22 10:30:04,087 [grpc-default-executor-0] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s1: Failed APPEND_ENTRIES request s0->s1#3252-t2,previous=(t:2, i:18),leaderCommit=6,initializing? true,entries: size=1, first=(t:2, i:19), STATEMACHINELOGENTRY, 377@client-4ACD4B782495
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$BiRelay.tryFire(CompletableFuture.java:1423)
	at java.base/java.util.concurrent.CompletableFuture$CoCompletion.tryFire(CompletableFuture.java:1144)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog$Task.failed(SegmentedRaftLog.java:105)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.failed(SegmentedRaftLogWorker.java:519)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:317)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:30:04,087 [s2-server-thread1] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s0->s2#3254-t2,previous=(t:2, i:18),leaderCommit=6,initializing? true,entries: size=1, first=(t:2, i:19), STATEMACHINELOGENTRY, 377@client-4ACD4B782495
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$BiRelay.tryFire(CompletableFuture.java:1423)
	at java.base/java.util.concurrent.CompletableFuture$CoCompletion.tryFire(CompletableFuture.java:1144)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog$Task.failed(SegmentedRaftLog.java:105)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.failed(SegmentedRaftLogWorker.java:519)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:317)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:30:04,096 [grpc-default-executor-8] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-4446C9F0D259->s1-AppendLogResponseHandler: Failed appendEntries
org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:30:04,096 [grpc-default-executor-8] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(52)) - s0@group-4446C9F0D259->s1: nextIndex: updateUnconditionally 20 -> 19
2023-01-22 10:30:04,099 [timer7] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1905, target=localhost:42097}}. 
2023-01-22 10:30:04,108 [grpc-default-executor-0] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-4446C9F0D259->s2-AppendLogResponseHandler: Failed appendEntries
org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:30:04,108 [grpc-default-executor-0] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(52)) - s0@group-4446C9F0D259->s2: nextIndex: updateUnconditionally 20 -> 19
2023-01-22 10:30:10,084 [timer3] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1919, target=localhost:42097}}. 
2023-01-22 10:30:10,114 [timer1] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1933, target=localhost:42097}}. 
2023-01-22 10:30:10,225 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2023-01-22 10:30:10,226 [s2-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2023-01-22 10:30:10,227 [grpc-default-executor-0] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s0->s2#3335-t2,previous=(t:2, i:19),leaderCommit=6,initializing? true,entries: size=1, first=(t:2, i:20), STATEMACHINELOGENTRY, 380@client-57A28927E51B
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$BiRelay.tryFire(CompletableFuture.java:1423)
	at java.base/java.util.concurrent.CompletableFuture.unipush(CompletableFuture.java:589)
	at java.base/java.util.concurrent.CompletableFuture.bipush(CompletableFuture.java:1172)
	at java.base/java.util.concurrent.CompletableFuture.andTree(CompletableFuture.java:1447)
	at java.base/java.util.concurrent.CompletableFuture.allOf(CompletableFuture.java:2337)
	at org.apache.ratis.util.JavaUtils.allOf(JavaUtils.java:278)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1535)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:30:10,229 [s1-server-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2023-01-22 10:30:10,229 [grpc-default-executor-8] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s1: Failed APPEND_ENTRIES request s0->s1#3334-t2,previous=(t:2, i:19),leaderCommit=6,initializing? true,entries: size=1, first=(t:2, i:20), STATEMACHINELOGENTRY, 380@client-57A28927E51B
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.andTree(CompletableFuture.java:1452)
	at java.base/java.util.concurrent.CompletableFuture.allOf(CompletableFuture.java:2337)
	at org.apache.ratis.util.JavaUtils.allOf(JavaUtils.java:278)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1535)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:30:10,238 [grpc-default-executor-0] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-4446C9F0D259->s2-AppendLogResponseHandler: Failed appendEntries
org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:30:10,238 [grpc-default-executor-0] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(52)) - s0@group-4446C9F0D259->s2: nextIndex: updateUnconditionally 21 -> 20
2023-01-22 10:30:10,240 [grpc-default-executor-0] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-4446C9F0D259->s1-AppendLogResponseHandler: Failed appendEntries
org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:30:10,240 [grpc-default-executor-0] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(52)) - s0@group-4446C9F0D259->s1: nextIndex: updateUnconditionally 21 -> 20
2023-01-22 10:30:13,117 [timer1] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1947, target=localhost:42097}}. 
2023-01-22 10:30:13,997 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4446C9F0D259:t2, leader=s0, voted=s1, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2023-01-22 10:30:16,199 [timer6] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1961, target=localhost:42097}}. 
2023-01-22 10:30:16,224 [timer0] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1975, target=localhost:42097}}. 
2023-01-22 10:30:16,234 [s0-client-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2023-01-22 10:30:16,235 [s1-server-thread2] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2023-01-22 10:30:16,235 [s2-server-thread1] INFO  statemachine.StateMachine (DataStreamTestUtils.java:link(157)) - link null
2023-01-22 10:30:16,236 [s2-server-thread1] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s2: Failed APPEND_ENTRIES request s0->s2#3416-t2,previous=(t:2, i:20),leaderCommit=6,initializing? true,entries: size=1, first=(t:2, i:21), STATEMACHINELOGENTRY, 382@client-BB15DEA19774
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$BiRelay.tryFire(CompletableFuture.java:1423)
	at java.base/java.util.concurrent.CompletableFuture$CoCompletion.tryFire(CompletableFuture.java:1144)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog$Task.failed(SegmentedRaftLog.java:105)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.failed(SegmentedRaftLogWorker.java:519)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:317)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:30:16,236 [s1-server-thread2] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(124)) - s1: Failed APPEND_ENTRIES request s0->s1#3414-t2,previous=(t:2, i:20),leaderCommit=6,initializing? true,entries: size=1, first=(t:2, i:21), STATEMACHINELOGENTRY, 382@client-BB15DEA19774
java.util.concurrent.CompletionException: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)
	at java.base/java.util.concurrent.CompletableFuture$BiRelay.tryFire(CompletableFuture.java:1423)
	at java.base/java.util.concurrent.CompletableFuture$CoCompletion.tryFire(CompletableFuture.java:1144)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog$Task.failed(SegmentedRaftLog.java:105)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.failed(SegmentedRaftLogWorker.java:519)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:317)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	... 1 more
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:30:16,244 [grpc-default-executor-6] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-4446C9F0D259->s2-AppendLogResponseHandler: Failed appendEntries
org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:30:16,245 [grpc-default-executor-6] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(52)) - s0@group-4446C9F0D259->s2: nextIndex: updateUnconditionally 22 -> 21
2023-01-22 10:30:16,246 [grpc-default-executor-6] WARN  server.GrpcLogAppender (LogUtils.java:warn(124)) - s0@group-4446C9F0D259->s1-AppendLogResponseHandler: Failed appendEntries
org.apache.ratis.server.raftlog.RaftLogIOException: Log already failed at index 7 for task WriteLog:7: (t:2, i:7), STATEMACHINELOGENTRY, StateMachineLogEntryProto:380@client-57A28927E51B
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:320)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.util.IOUtils.asIOException(IOUtils.java:56)
	at org.apache.ratis.util.IOUtils.toIOException(IOUtils.java:61)
	at org.apache.ratis.util.IOUtils.getFromFuture(IOUtils.java:85)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$StateMachineDataPolicy.getFromFuture(SegmentedRaftLogWorker.java:88)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.execute(SegmentedRaftLogWorker.java:540)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.run(SegmentedRaftLogWorker.java:308)
	... 1 more
Caused by: java.lang.IllegalStateException: Null stream: entry=term: 2
index: 7
stateMachineLogEntry {
  type: DATASTREAM
  clientId: "\035t7\270\021\260J\314\243\240W\242\211\'\345\033"
  callId: 380
}

	at org.apache.ratis.datastream.DataStreamTestUtils$MultiDataStreamStateMachine.link(DataStreamTestUtils.java:159)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker$WriteLog.<init>(SegmentedRaftLogWorker.java:497)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLogWorker.writeLogEntry(SegmentedRaftLogWorker.java:443)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendEntryImpl(SegmentedRaftLog.java:409)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$appendEntry$10(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:78)
	at org.apache.ratis.server.raftlog.RaftLogBase.appendEntry(RaftLogBase.java:330)
	at org.apache.ratis.server.raftlog.segmented.SegmentedRaftLog.appendImpl(SegmentedRaftLog.java:456)
	at org.apache.ratis.server.raftlog.RaftLogBase.lambda$append$11(RaftLogBase.java:337)
	at org.apache.ratis.server.raftlog.RaftLogSequentialOps$Runner.runSequentially(RaftLogSequentialOps.java:69)
	at org.apache.ratis.server.raftlog.RaftLogBase.append(RaftLogBase.java:337)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1524)
	at org.apache.ratis.server.impl.RaftServerImpl.appendEntriesAsync(RaftServerImpl.java:1392)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$appendEntriesAsync$26(RaftServerProxy.java:634)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:117)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$executeSubmitServerRequestAsync$11(RaftServerImpl.java:814)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
2023-01-22 10:30:16,246 [grpc-default-executor-6] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(52)) - s0@group-4446C9F0D259->s1: nextIndex: updateUnconditionally 22 -> 21
2023-01-22 10:30:22,233 [timer5] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=1989, target=localhost:42097}}. 
2023-01-22 10:30:22,338 [timer0] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=2017, target=localhost:42097}}. 
2023-01-22 10:30:23,997 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4446C9F0D259:t2, leader=s0, voted=s1, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2023-01-22 10:30:25,236 [timer5] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=2003, target=localhost:42097}}. 
2023-01-22 10:30:28,350 [timer5] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=2031, target=localhost:42097}}. 
2023-01-22 10:30:28,449 [timer1] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=2045, target=localhost:42097}}. 
2023-01-22 10:30:31,344 [timer6] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=2059, target=localhost:42097}}. 
2023-01-22 10:30:33,998 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4446C9F0D259:t2, leader=s0, voted=s1, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2023-01-22 10:30:34,461 [timer6] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=2073, target=localhost:42097}}. 
2023-01-22 10:30:37,453 [timer5] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=2101, target=localhost:42097}}. 
2023-01-22 10:30:37,462 [timer6] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=2087, target=localhost:42097}}. 
2023-01-22 10:30:40,571 [timer5] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=2115, target=localhost:42097}}. 
2023-01-22 10:30:43,564 [timer4] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=2129, target=localhost:42097}}. 
2023-01-22 10:30:43,998 [Timer-2] INFO  impl.MiniRaftCluster (MiniRaftCluster.java:lambda$start$6(349)) - TIMED-PRINT: printing ALL groups
  s0:  RUNNING    LEADER s0@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s0@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s1:  RUNNING  FOLLOWER s1@group-4446C9F0D259:t2, leader=s0, voted=s1, raftlog=Memoized:s1@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
  s2:  RUNNING  FOLLOWER s2@group-4446C9F0D259:t2, leader=s0, voted=s0, raftlog=Memoized:s2@group-4446C9F0D259-SegmentedRaftLog:OPENED:c6, conf=5: peers:[s0|rpc:localhost:42029|admin:localhost:38755|client:localhost:42097|dataStream:localhost:46279|priority:0|startupRole:FOLLOWER, s1|rpc:localhost:35183|admin:localhost:46179|client:localhost:36677|dataStream:localhost:46499|priority:0|startupRole:FOLLOWER, s2|rpc:localhost:36837|admin:localhost:37461|client:localhost:38577|dataStream:localhost:32781|priority:0|startupRole:FOLLOWER]|listeners:[], old=null RUNNING
2023-01-22 10:30:46,565 [timer4] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=2143, target=localhost:42097}}. 
2023-01-22 10:30:46,678 [timer6] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=2157, target=localhost:42097}}. 
2023-01-22 10:30:49,672 [timer4] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=2171, target=localhost:42097}}. 
2023-01-22 10:30:52,675 [timer1] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=2185, target=localhost:42097}}. 
2023-01-22 10:30:52,787 [timer6] WARN  grpc.GrpcUtil (GrpcUtil.java:shutdownManagedChannel(223)) - Timed out gracefully shutting down connection: ManagedChannelOrphanWrapper{delegate=ManagedChannelImpl{logId=2199, target=localhost:42097}}. 
]]></system-out>
  </testcase>
  <testcase name="testStreamWrites" classname="org.apache.ratis.datastream.TestNettyDataStreamStarTopologyWithGrpcCluster" time="3.936"/>
</testsuite>